!function(N,p,b){"use strict";var r="ht";if(!N[r]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),N.performance&&N.performance.now||function(){var p=Date.now();N.performance||(N.performance={}),N.performance.now=function(){return Date.now()-p}}();for(var Z=Date.now(),L=16,V=["ms","moz","webkit","o"],x=0;x<V.length&&!N.requestAnimationFrame;++x)N.requestAnimationFrame=N[V[x]+"RequestAnimationFrame"],N.cancelAnimationFrame=N[V[x]+"CancelAnimationFrame"]||N[V[x]+"CancelRequestAnimationFrame"];N.requestAnimationFrame||(N.requestAnimationFrame=function(B){var m=Date.now(),P=L+Z-m;return 0>P&&(P=0),Z=m,N.setTimeout(function(){Z=Date.now(),B(performance.now())},P)}),N.cancelAnimationFrame||(N.cancelAnimationFrame=function(t){return N.clearTimeout(t)}),p.assign===b&&(p.assign=function(j){if(j===b||null===j)throw new TypeError("Cannot convert undefined or null to object");for(var D=p(j),O=1;O<arguments.length;O++){var g=arguments[O];if(g!==b&&null!==g)for(var z in g)p.prototype.hasOwnProperty.call(g,z)&&(D[z]=g[z])}return D})}();var R,J,B,T,l=N.document,f=null,K=N[r]={},u=N[r+"config"],G=K.Default=u&&u.Default||{},H=K.Style=u&&u.Style||{},j=K.Attr=u&&u.Attr||{},C=K.Color=u&&u.Color||{},d=K.IsGetter=u&&u.IsGetter||{},s=Math,X=s.round,k=s.floor,W=s.ceil,F=s.sqrt,o=s.max,S=s.min,g=s.abs,t=s.cos,v=s.acos,e=s.sin,Z=s.pow,q=s.asin,L=s.PI,U=2*L,x=L/2,z=s.tan,I=s.atan2,E=s.random,w=s.log,Q=function(A,S,Y){return Math.max(S,Math.min(Y,A))},h=!1,Y=!1,M=N.parseInt||global.parseInt,y="2018-07-01",c=N.navigator?N.navigator.platform.indexOf("Win")>-1:!1,i=function(w){return w*w},$=N.setTimeout,_=N.clearTimeout,P=N.location,V=N.navigator?N.navigator.userAgent.toLowerCase():"",m=function(U){return U.test(V)},a=m(/msie/),D=m(/msie/)||m(/trident/),O=m(/msie 10/),A=m(/edge/),n=m(/firefox/),Of=m(/mac/),Tf=G.isTouchable===b?c?!1:l?"ontouchend"in l:!1:G.isTouchable,ad="default",yl="single",wo="multiple",Wf="front",mb="back",Rj="left",$e="right",Jb="top",De="bottom",bj="center",Sl="eye",Rf="middle",cp="east",Yc="west",Fi="north",tp="none",se="px",vj="absolute",Wh="border",rp="triangle",Tr="rect",Yb="circle",rg="cylinder",pl="shape",Sd="items",no="normal",Dm="remove",Ak="clear",Ej="width",ee="height",ud="ingroup",Jc="check",Yd="uncheck",Mj="radio",Af="radioOn",tf="radioOff",tm="points",eg="values",fl="series",$g="body",Sp="label",xf="label2",Oq="note",Po="note2",zf="icons",Xd="labelFont",Wb="labelColor",Cl="labelSelectColor",si="note.expanded",cm="note2.expanded",yi="edge.expanded",Mc="edge.points",Qg="edge.type",zs="rotation",th="getRotation",mn="setRotation",gd="hidden",Mb="visible",eq="tuv",xe="no",Sq="draw",Ac="select",qk="currentSubGraph",Qj="selectBackground",Tq="autoMakeVisible",Mr="autoHideScrollBar",mr="scrollBarColor",$f="scrollBarSize",tc="indent",tk="rowHeight",Ec="columnLineColor",Dd="rowLineColor",qd="columnLineVisible",_n="rowLineVisible",jf="visibleFunc",iq="expandIcon",bb="collapseIcon",wi="checkMode",Hd="sortFunc",sh="editable",en="batchEditable",Hp="tristate",uj="asc",Eb="desc",Zd="position",_d="elevation",dc="children",lc="translateX",Ym="translateY",pp="dataModel",Xo="maxSize",oe="shape3d",Im="shape3d.resolution",nq="shape3d.visible",Am="shape3d.from.visible",Fc="shape3d.to.visible",mf="shape3d.top.visible",ib="shape3d.bottom.visible",Wo="repeat.uv.length",Kp="serializeValue",Ul="deserializeValue",Sm="centerUniform",Om="uniform",fj="rgba(255,255,255,0)",fc="style",am="attr",Yj="field",Jh="string",rc="boolean",Ad="color",ke="int",cb="number",zl="ew-resize",vi="ns-resize",aj="pointer",Uq="auto",oo="mousedown",Bs="mousemove",Kq="mouseup",rs="mouseout",or="touchstart",ge="touchmove",km="touchend",Xc="keydown",Wr="keyup",rq=["DOMMouseScroll","mousewheel"],Lj=n?rq[0]:rq[1],Mo=Tf?[or,ge,km,Xc,Wr,"keypress","input","contextmenu"]:[Xc,Wr,"keypress","input",oo,Bs,Kq,rs,Lj,"wheel","contextmenu","mouseenter","mouseleave","mouseover"],xm=f,$q=f,dg=f,Wq=Kq.length,hr=function(){dg&&(_(dg.timeout),dg=f)},cd=function(){dg&&Ve(dg.e,dg.info)};N.addEventListener&&(Tf||(N.addEventListener(rs,function(){hr()},!1),N.addEventListener(Lj,function(){Rb()},!1)),N.addEventListener(Wr,function(T){91===T.keyCode?xh={}:delete xh[T.keyCode]},!0),N.addEventListener(Xc,function(p){xh[p.keyCode]=!0},!0));var bo,Oc,ob,uq=0,xk=f,Bg=function(L,q){var z=$(function(){delete xk[z],Er(xk)&&(xk=f),L()},q);return z},wq=f,Ub=f,us={},gp={},hl={},vf={},oh={},xh={},ds={},Ei={},jq={},yp={},Fo=/.json$/,wr=/^data:image\/svg\+xml/,Id={},Ol=[],Lr={},_c=f,hh=f,dr=function(){},Kh=function(){throw"Oops!"},Jn=[0,0,0],jb=[0,0,0,0],Xh={x:0,y:0,width:0,height:0},Bq=f,Mn=f,ub=f,Qh=function(g){Mn&&!g._72O&&(ub||(ub={}),ub[g._72O=Rp()]=g),bo!=f?gr()<.05&&T&&!Oc&&(Dp=hr):Dp=_g},Ar=function(Z,x,n,c){Mn||(Mn={});var T=Mn[Z];if(T){if(T.url===x)return;T.image?(T.image.onload=dr,T.image.onerror=dr):T.request&&(T.request.onload=dr,T.request.onerror=dr)}if(Fo.test(x)){var s=new XMLHttpRequest;if(Mn[Z]={request:s,url:x},s.overrideMimeType&&s.overrideMimeType("text/plain"),x=G.beforeLoadURL(x),x.data){var q=G.parse(x.data);Fg(Z,q),G.handleImageLoaded(Z,q)}else s.open("GET",encodeURI(x),!0),s.onload=function(n){if(200===this.status||0===this.status){var d=G.parse(n.target.response||n.target.responseText);Fg(Z,d),G.handleImageLoaded(Z,d)}else Fg(Z,G.handleUnfoundImage(Z,x)||f)},s.onerror=function(){Fg(Z,G.handleUnfoundImage(Z,x)||f)},s.send(null)}else{var q=new Image;Mn[Z]={image:q,url:x},D&&(x.toLowerCase().indexOf(".svg")>0||wr.test(x))?(l.body.appendChild(q),q.style.visibility="hidden",q.onload=function(){$(function(){if(n&&(q.width=n),c&&(q.height=c),!q.width||!q.height){var V=q.width||q.clientWidth,O=q.height||q.clientHeight;q.width=V,q.height=O}G.handleImageLoaded(Z,q),Fg(Z,q),l.body.removeChild(q),q.style.visibility=""},180)},q.onerror=function(){Fg(Z,G.handleUnfoundImage(Z,x)||f),l.body.removeChild(q),q.style.visibility=""}):(q.onload=function(){n&&(q.width=n),c&&(q.height=c),G.handleImageLoaded(Z,q),Fg(Z,q)},q.onerror=function(){Fg(Z,G.handleUnfoundImage(Z,x)||f)}),/^data:image/.test(x)||(x=G.beforeLoadURL(x),/^data:image/.test(x)||(x=G.appendTimeStamp(x),x=encodeURI(x))),q.src=x}},Fg=function(j,h){if(gp[j]=h,delete Mn[j],Er(Mn)&&(Mn=f,ub)){for(var x in ub){var n=ub[x];n._2O&&(n._2O={}),n.invalidateAll&&n.invalidateAll(b,"imageLoaded",j),n.redraw&&n.redraw(),n.iv(),delete n._72O}ub=f}if(h&&ub)for(var x in ub){var n=ub[x];n.invalidateAll&&n.invalidateAll(b,"imageLoading",j),n.redraw&&n.redraw(),n.iv()}},wb=function(){return w=s&&Date,function(){return N.performance&&N.performance.now?N.performance.now():Date.now()}}(),vs=function(D,g){g?_(D):N.cancelAnimationFrame(D)},On=function(e,L,C){return{width:e,height:L,comps:te(C)?C:[C]}},tq=function(M,L){return{type:Yb,rect:[M,L,1.6,1.6],borderWidth:1,borderColor:Ko,gradient:Fe,gradientColor:ph,background:Ko}},sc=function(W,d){return On(16,16,{type:rp,rect:[4,4,10,8],background:W,rotation:d?1.57:3.14})},Kk=function(J,c){return On(16,16,{type:rp,rect:[4,4,8,7],background:J,rotation:c?3.14:0})},Pk=function(W){var D=W._orientation;return"horizontal"===D||"h"===D},Op=function(C){var Q=f||4,A=f||1,R=f||1;0>Q?Q=0:Q>.25&&(Q=.25);var m,G,N,u,_,S,i,y=.5,H=[],X=[],a=[],h=U/R,F=U/A,D=y-Q;for(G=0;A>=G;G++)for(u=-L+G*F,S=t(u),_=e(u),m=0;R>=m;m++)N=m*h,i=D+Q*S,H.push(t(N)*i,_*Q,-e(N)*i),(J=C)&&X.push(m/R,1-G/A);for(G=0;A>G;G++){var j=G*(R+1),O=(G+1)*(R+1);for(m=0;R>m;m++)a.push(j+m,O+m+1,O+m,j+m,j+m+1,O+m+1),hp.z=$n.z=C}},sq=function(p){var F=2,E=0;for(var L in p)L.length===F&&M(L,32)===aq&&(_c=hh=p[L]),E++;return E},Ce=function(u,_,h,t){return h||(h=Tf?5:3,h/=t||1),{x:u-h,y:_-h,width:2*h,height:2*h}},Lg=function(F,C,D,e){var B=this;C||(C=Tf?5:3,D=20,e=20);var R={x:F,y:C,width:D,height:e};if(D)for(var m=0;D>m;m++)if(3===D)e=20;else for(var T=0;e>T;T++)B=N?N:D;var A={x:L,y:2*L};if(xn(R,A)){var Y=ee[0]+Jb[0]+Ak[1]+(uj.length-1);Di[Sl]=B[Y],B[Y]=on[Sl]}},Mk=function(a){return(/ble$/.test(a)||/ed$/.test(a)||d[a]?"is":"get")+a.charAt(0).toUpperCase()+a.slice(1)},on=function(U){return"set"+U.charAt(0).toUpperCase()+U.slice(1)},cr=function(t){return typeof t===Jh||t instanceof String},mj=function(J){return typeof J===cb},_g=function(c){return typeof c===rc},wg=function(N){return N&&"object"==typeof N},Cr=function(w){return"function"==typeof w},te=function(g){return g instanceof Array},td=function(Q){return Q instanceof Ek},Mq=function(k){return te(k)?new Ek(k):k},ps=function(s){return s instanceof Gk},zq=function(T){return T instanceof Or},ap=function(B){return B instanceof ol},Tb=function(f,y){if(!(f instanceof K.Group))return!1;if(!y)return f.isExpanded();var A=y.getDataUI(f);return A&&A._88I?!0:!1},Zp=function(R){return R instanceof zk},Dl=function(P){return P&&"IFRAME"===P.tagName},Eq=function(b){return b==f||G.numberDigits==f?b:parseFloat(b.toFixed(G.numberDigits))},nf=function(T,C,w){var N,F=C.length;if(w)for(var z=0;w>z;z++)if(3===F)T.push(C[0]),T.push(C[1]),T.push(C[2]);else for(N=0;F>N;N++)T.push(C[N]);else if(3===F)T.push(C[0]),T.push(C[1]),T.push(C[2]);else for(N=0;F>N;N++)T.push(C[N])},ls=function(N){return N?wg(N)?N:{}:!1},dd=function(p,w,Y){var K,n=wg(p)?p:p.prototype;for(K in w)Y&&n[K]!==b||(n[K]=w[K]);return p},xr=function(s){return String.fromCharCode(s)},tl=function(g){for(var J,C=0,B="";C<g.length;C++)J=g[g.length-1-C],"%"===J?J="'":"a"===J?J='"':"]"===J&&(J="\\"),B+=xr(J.charCodeAt(0)-1);return B},gm=function(T,R,v){T.superClass.constructor.apply(R,v)},Er=function(w){for(var F in w)return!1;return!0},Cm=function(J){return J?0===J.length:!0},Gm=function(){var M="";return[Yd[0],Dd[0],Sp[0]].forEach(function(q){M+=on(q).slice(3)}),Om=l&&l[M]||Sm,function(y,j){return y===j?!0:y.x===j.x&&y.y===j.y&&y.width===j.width&&y.height===j.height}}(),Gl=function(j,i,Q){return i>j?i:j>Q?Q:j},Sc=function(E){return 0>E?-1:E>0?1:0},gr=function(){var u=1e4*e(Wq++);return u-k(u)},Ag=function(K,$,H){return Dh(K.x,K.y,$.x,$.y,H.x,H.y,H.x+H.width,H.y,!0)||Dh(K.x,K.y,$.x,$.y,H.x+H.width,H.y,H.x+H.width,H.y+H.height,!0)||Dh(K.x,K.y,$.x,$.y,H.x+H.width,H.y+H.height,H.x,H.y+H.height,!0)||Dh(K.x,K.y,$.x,$.y,H.x,H.y+H.height,H.x,H.y,!0)},Dh=function(g,D,i,y,F,u,X,U,l){var G=(X-F)*(D-u)-(U-u)*(g-F),Y=(U-u)*(i-g)-(X-F)*(y-D);if(0!==Y){var x=G/Y,j=g+x*(i-g),z=D+x*(y-D);return l&&(j+xp<S(g,i)||j-xp>o(g,i)||j+xp<S(F,X)||j-xp>o(F,X)||z+xp<S(D,y)||z-xp>o(D,y)||z+xp<S(u,U)||z-xp>o(u,U))?f:[j,z]}return f},Ck=function(Y,h,K){if(Y&&K)if(h){if(h===fc)return Y.getStyle(K);if(h===am)return Y.getAttr(K);if(h===Yj)return Y[K]}else if(K=Mk(K),Y[K])return Y[K]();return b},Wi=function(E,p,e,O){if(E&&e)if(p){if(p===fc)E.s(e,O);else if(p===am)E.a(e,O);else if(p===Yj){var W=E[e];E[e]=O,E.fp("f:"+e,W,O)}}else e=on(e),E[e]&&E[e](O)},go=function(t,$,d){return $&&"top"!==$?"bottom"===$?{x:t.x,y:t.y,width:t.width,height:t.height*d}:"right"===$?{x:t.x,y:t.y,width:t.width*d,height:t.height}:"left"===$?{x:t.x+t.width*(1-d),y:t.y,width:t.width*d,height:t.height}:void 0:{x:t.x,y:t.y+t.height*(1-d),width:t.width,height:t.height*d}},Vk=function(r,t,q,A,H){t&&tj(r,q,A,1,H,t)},Gq=function(k,x,N,A){var _=1-k;return _*_*x+2*k*_*N+k*k*A},hp=function(z,O,v,y,I){var Q=1-z;return Q*Q*Q*O+3*Q*Q*z*v+3*Q*z*z*y+z*z*z*I},pg=function(m){var n,D,J,s,B=0;return m.forEach(function(m){if(n=m.length,n>0)for(D=m[0],s=1;n>s;s++)J=m[s],B+=Bj(D,J),D=J}),B},Nq=function(f,J,n){var E="__"+f,x=function(U){n.disabled||n["handle_"+f](U)};n[E]||(n[E]=x,J.addEventListener(f,x,!1))},Hn=function(J,F,w){var j="__"+J,O=w[j];O&&(F.removeEventListener(J,O,!1),delete w[j])},pb=function(x,k){var v="_"+k;x[Mk(k)]=function(){return this[v]},x[on(k)]=function(u){var W=this[v];this[v]=u,this.fp(k,W,u)}},Bp=function(V){return p.create(V)},Kj=function(t){if(!t.element){var e,X;(e=t.textField)?X=$o(hb.TextField,e):(e=t.textArea)?X=$o(hb.TextArea,e):(e=t.button)?X=$o(hb.Button,e):(e=t.comboBox)?X=$o(hb.ComboBox,e):(e=t.checkBox)?X=$o(hb.CheckBox,e):(e=t.radioButton)?X=$o(hb.RadioButton,e):(e=t.slider)?X=$o(hb.Slider,e):(e=t.colorPicker)?X=$o(hb.ColorPicker,e):(e=t.image)&&(X=$o(hb.Image,e)),X&&(t.element=X)}},Yk=function(n,j){var L=wk(n);return L._ht=j,L},wk=function(L,y){var b=l.createElement("div"),W=b.style;return b.tabIndex=-1,b.onkeydown=lb,W.msTouchAction=tp,kk(b,f,0),Tf&&W.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",f),L&&(W.overflow=gd),y&&tb(y,b),b},Rc=function(s,U){var g=l.createElement("canvas"),N=g.style;return N.msTouchAction=tp,U||(N.pointerEvents=tp),kk(g,f,0),s&&tb(s,g),g},kk=function(k,D,j){var u=k.style;u.border=D?D+" solid 1px":0,u.outline=0,u.padding=j?"0 "+j+se:0,Lh(k)},Lh=function(m){var K=m.style;K.position=vj,K.margin=0,K.setProperty("box-sizing","border-box",f),K.setProperty("-moz-box-sizing","border-box",f)},ur=function(i,R,J,N){N||(N=Gn),R!=f&&(i.width=R*N,i.style.width=R+se),J!=f&&(i.height=J*N,i.style.height=J+se)},tb=function(N,J,$){N.appendChild(J),$&&(J.style.position=vj)},Sg=function(v,J){J.split||(J+="");for(var q,m=J.split("\n"),d=0,N=m.length,B=0;N>B;B++){var D=kn(v.font,m[B]);D.width>d&&(d=D.width),q||(q=D.height)}return v.ss=m,{width:d,height:q*N}},ye=function(K,m,t,s,U,F){var v=m.length;if(1===v)as(K,m[0],t,s,U);else for(var c=t.height/v,N={x:t.x,y:t.y,width:t.width,height:c},k=0;k<m.length;k++)F?Th(K,m[k],s,U,N.x,N.y,N.width,N.height,F):as(K,m[k],N,s,U),N.y+=c},as=function(u,y,t,C,M){u.font=C?C:Ri,u.fillStyle=M?M:Xj,u.textAlign=bj,u.textBaseline=Rf;var J,Z;t?t.width===b?(J=t.x,Z=t.y):(J=t.x+t.width/2,Z=t.y+t.height/2):(J=0,Z=0),u.fillText(y,X(J),X(Z))},rh=function(O){O.getView&&(O=O.getView());var C=O.offsetWidth||O.scrollWidth;return!C&&O.style.width&&(C=M(O.style.width)),C},Hk=function(U){U.getView&&(U=U.getView());var a=U.offsetHeight||U.scrollHeight;return!a&&U.style.height&&(a=M(U.style.height)),a},gs=function(){var c=function(r){lb(r),r.stopPropagation()},t=Tf?[or]:[Xc,oo];return function(L){var v=wk(),o=v.style;return o.backgroundColor=G.disabledBackground,L&&(o.backgroundImage="url("+L+")",o.backgroundPosition="50% 50%",o.backgroundRepeat="no-repeat no-repeat"),t.forEach(function(p){v.addEventListener(p,c)}),v}}(),Gi=function(X){var U=X.getContext("2d");return U.save(),U.lineCap=Ob,U.lineJoin=$c,U},Dp=function(x,H,W,p){_h(x,H*Gn,W*Gn),p*=Gn,1!==p&&x.scale(p,p)},_h=function(v,$,C){v.translate($,C)},Df=function(h,E){E&&h.rotate(E)},ts=function(B,R,n){R===b&&(R=1),n===b&&(n=1),(1!==R||1!==n)&&B.scale(R,n)},Rn=!1,As=function(q){var O=l.activeElement;if(l.activeElement!==q){O&&O.forceOnblur&&O.forceOnblur();for(var r=[],M=q.parentNode;M;)r.push([M,M.scrollLeft,M.scrollTop]),M=M.parentNode;if(!Rn){var o=[];try{for(var m=N.parent,c=N;m!==c;)o.push([m,m.scrollX,m.scrollY]),c=m,m=N.parent}catch(P){Rn=!0}}if(Tf)q.focus();else{var _=sf(),i=_.target;q.focus(),i.scrollLeft=_.left,i.scrollTop=_.top}r.forEach(function(m){m[0].scrollLeft=m[1],m[0].scrollTop=m[2]}),Rn||o.forEach(function(r){r[0].scrollTo(r[1],r[2])})}},jh=function(o){return o&&o.getView?o.getView():o},pn=function(O,o,g,p,n){if(2===arguments.length&&(g=o.y,p=o.width,n=o.height,o=o.x),O.isSelfViewEvent)O.setX(o),O.setY(g),O.setWidth(p),O.setHeight(n);else{var S=jh(O),D=S.style;if((l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement)!==S)o!==b&&(D.left=o+se),g!==b&&(D.top=g+se),p!==b&&(D.width=p+se),n!==b&&(D.height=n+se);else{var t=G.getWindowInfo();D.left=(o=t.left)+se,D.top=(g=t.top)+se,D.width=(p=t.width)+se,D.height=(n=t.height)+se}O.endEditing&&!Tf&&O.endEditing(),O.redraw&&O.redraw(),O.invalidate&&O.invalidate(),O.onLayouted&&O.onLayouted(o,g,p,n),O.fireViewEvent&&O.fireViewEvent("layout")}},ne=function(Z){if(!Z.touches)return Z;var k=Z.touches[0];return k?k:Z.changedTouches[0]},gn=function(k){return Tf?ne(k).target:k.target},Pg=function(h){G.popup&&G.popup.close(),G.popup=h},Ab=f,Lk=function(G){Ab.handleWindowTouchMove(G)},Rr=function(m){Ab.handleWindowTouchEnd(m),N.removeEventListener(ge,Lk,!1),N.removeEventListener(km,Rr,!1),Ab=f},yo=function(Z){Ab.handleWindowMouseMove(Z)},Be=function(o){Ab.handleWindowMouseUp(o),N.removeEventListener(Bs,yo,!1),N.removeEventListener(Kq,Be,!1),Ab=f},Zb=function(J){return 1===Fq(J)},_j=function(k,r){return r?r.keyCode===k:xh[k]},zo=function(G){return ae(G)&&_j(65,G)},Un=function(h){return _j(46,h)||_j(8,h)},_b=function(M){return function(o){return o?o.keyCode===M:xh[M]}},aq=573,Cn=[65,83,68,87,37,38,39,40,32,13,27],ek=_b(Cn[0]),Cc=_b(Cn[1]),Bl=_b(Cn[2]),Sf=_b(Cn[3]),gh=_b(Cn[4]),Um=_b(Cn[5]),Tg=_b(Cn[6]),Xb=_b(Cn[7]),Lp=_b(Cn[8]),kf=_b(Cn[9]),Xf=_b(Cn[10]),Oi={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},sm=[2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,17713],Pp=f,uc=f,ml=function(E,h){Pp||(Pp=Rc()),ur(Pp,E,h,1);var D=Gi(Pp);return D.clearRect(0,0,E,h),D},Cj=function(){var C,o={};for(var i in N){var t=wo.length;if(i.length==t&&i[0]===wo[2]&&i[1]===tp[1]&&i[4]===wo[3]&&i[5]===wo[4]&&i.substr(t-2)===tp[1]+tp[2]){var e=N[i];for(var Y in e)Y.length===t&&Y.substr(0,3)===$e[3]+Dm[3]+Ac[0]&&Y.substr(t-2)===wo[0]+Oq[3]&&(rq=e[Y])}}return function(M){var p,g=o[M];return g||(C||(C=Rc(),ur(C,1,1,1)),p=C.getContext("2d"),p.clearRect(0,0,1,1),tj(p,0,0,1,1,M),g=p.getImageData(0,0,1,1).data,g=o[M]=[g[0],g[1],g[2],g[3]]),g}}(),zg=function(B){if(!cr(B))return B;var T=Cj(B);return T.CA||(T.CA=[T[0]/255,T[1]/255,T[2]/255,T[3]/255]),T.CA},kr=function(k,i,F,B,L){var g=Rc();g.width=F,g.height=B;var m=g.getContext("2d");m.drawImage(k,0,0,F,B);try{for(var u=m.getImageData(0,0,F,B),V=u.data,H=0,v=V.length;v>H;H+=4){var b=V[H+0],I=V[H+1],N=V[H+2],a=V[H+3];"override_a"===L?V[H+3]=255*i[3]:"override_rgb"===L?(V[H+0]=255*i[0],V[H+1]=255*i[1],V[H+2]=255*i[2]):"override"===L?(V[H+0]=255*i[0],V[H+1]=255*i[1],V[H+2]=255*i[2],V[H+3]=255*i[3]):(V[H+0]=i[0]*b,V[H+1]=i[1]*I,V[H+2]=i[2]*N,V[H+3]=i[3]*a)}m.putImageData(u,0,0)}catch(c){return k}return g},Di=function(U,B,Y){return B&&(B="miter"===Y?8*B+20:B+1,U&&Lq(U,B)),B},gc=function(p,n){if(n){var U=new pd(n),o=p.width/2,j=p.height/2,m=qp([U.tf(-o,-j),U.tf(o,-j),U.tf(o,j),U.tf(-o,j)]);return m.x+=p.x+o,m.y+=p.y+j,m}return p},Xr=function(R,Z,X,A,r,v,Q,H){A*=Math.PI/180;var U={x:Math.cos(A)*(R.x-Q.x)/2+Math.sin(A)*(R.y-Q.y)/2,y:-Math.sin(A)*(R.x-Q.x)/2+Math.cos(A)*(R.y-Q.y)/2},N=Math.pow(U.x,2)/Math.pow(Z,2)+Math.pow(U.y,2)/Math.pow(X,2);N>1&&(Z*=Math.sqrt(N),X*=Math.sqrt(N));var w=(r==v?-1:1)*Math.sqrt((Math.pow(Z,2)*Math.pow(X,2)-Math.pow(Z,2)*Math.pow(U.y,2)-Math.pow(X,2)*Math.pow(U.x,2))/(Math.pow(Z,2)*Math.pow(U.y,2)+Math.pow(X,2)*Math.pow(U.x,2)));isNaN(w)&&(w=0);var t={x:w*Z*U.y/X,y:w*-X*U.x/Z},B={x:(R.x+Q.x)/2+Math.cos(A)*t.x-Math.sin(A)*t.y,y:(R.y+Q.y)/2+Math.sin(A)*t.x+Math.cos(A)*t.y},K=function(R){return Math.sqrt(Math.pow(R[0],2)+Math.pow(R[1],2))},z=function(n,C){return(n[0]*C[0]+n[1]*C[1])/(K(n)*K(C))},$=function(w,U){return(w[0]*U[1]<w[1]*U[0]?-1:1)*Math.acos(z(w,U))},b=$([1,0],[(U.x-t.x)/Z,(U.y-t.y)/X]),j=[(U.x-t.x)/Z,(U.y-t.y)/X],d=[(-U.x-t.x)/Z,(-U.y-t.y)/X],P=$(j,d);z(j,d)<=-1&&(P=Math.PI),z(j,d)>=1&&(P=0);var z=Z>X?Z:X,f=Z>X?1:Z/X,L=Z>X?X/Z:1;if(null==H){var M={x:0,y:0,width:0,height:0};Lq(M,z),M.x*=f,M.width*=f,M.y*=L,M.height*=L;var E=new pd(A);return M=qp([E.tf(M.x,M.y),E.tf(M.x+M.width,M.y),E.tf(M.x+M.width,M.y+M.height),E.tf(M.x,M.y+M.height)]),M.x+=B.x,M.y+=B.y,[{x:M.x,y:M.y},{x:M.x+M.width,y:M.y},{x:M.x+M.width,y:M.y+M.height},{x:M.x,y:M.y+M.height}]}H.translate(B.x,B.y),H.rotate(A),H.scale(f,L),H.arc(0,0,z,b,b+P,1-v),H.scale(1/f,1/L),H.rotate(-A),H.translate(-B.x,-B.y)},tn=function(f,l){f&&f.beginPath();for(var Z,y,g,G=[],t=function(X){for(var l,n=/(\-{0,1}[\d\.]+)/gi,s=[];l=n.exec(X);)s.push(parseFloat(l[0]));return s},_=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,L={x:0,y:0};Z=_.exec(l);){var W=Z[0],e=W.substr(0,1);if("M"===e||"m"===e){for(var x=t(W),k=0;k<x.length;k+=2){var $=x[k],I=x[k+1];"m"===e&&($+=L.x,I+=L.y),f&&f.moveTo($,I),G.push({x:$,y:I}),L.x=$,L.y=I}y=g=null}else if("H"===e||"h"===e){for(var x=t(W),k=0;k<x.length;k+=1){var $=x[k];"h"===e&&($+=L.x),f&&f.lineTo($,L.y),G.push({x:$,y:L.y}),L.x=$}y=g=null}else if("C"===e||"c"===e){for(var x=t(W),k=0;k<x.length;k+=6){var o=x[k],R=x[k+1],X=x[k+2],E=x[k+3],$=x[k+4],I=x[k+5];"c"===e&&(o+=L.x,R+=L.y,X+=L.x,E+=L.y,$+=L.x,I+=L.y),f&&f.bezierCurveTo(o,R,X,E,$,I),G.push({x:o,y:R}),G.push({x:X,y:E}),G.push({x:$,y:I}),L.x=$,L.y=I}y=[o,R,X,E,$,I],g=null}else if("S"===e||"s"===e){for(var x=t(W),k=0;k<x.length;k+=4){var o,R;y?(o=2*y[4]-y[2],R=2*y[5]-y[3]):(o=L.x,R=L.y);var X=x[k],E=x[k+1],$=x[k+2],I=x[k+3];"s"===e&&(X+=L.x,E+=L.y,$+=L.x,I+=L.y),f&&f.bezierCurveTo(o,R,X,E,$,I),G.push({x:o,y:R}),G.push({x:X,y:E}),G.push({x:$,y:I}),L.x=$,L.y=I}y=[o,R,X,E,$,I],g=null}else if("Q"===e||"q"===e){for(var x=t(W),k=0;k<x.length;k+=4){var o=x[k],R=x[k+1],$=x[k+2],I=x[k+3];"q"===e&&(o+=L.x,R+=L.y,$+=L.x,I+=L.y),f&&f.quadraticCurveTo(o,R,$,I),G.push({x:o,y:R}),G.push({x:$,y:I}),L.x=$,L.y=I}y=null,g=[o,R,$,I]}else if("T"===e||"t"===e){for(var x=t(W),k=0;k<x.length;k+=2){var o,R;g?(o=2*g[2]-g[0],R=2*g[3]-g[1]):(o=L.x,R=L.y);var $=x[k],I=x[k+1];"t"===e&&($+=L.x,I+=L.y),f&&f.quadraticCurveTo(o,R,$,I),G.push({x:o,y:R}),G.push({x:$,y:I}),L.x=$,L.y=I}y=null,g=[o,R,$,I]}else if("V"===e||"v"===e){for(var x=t(W),k=0;k<x.length;k+=1){var I=x[k];"v"===e&&(I+=L.y),f&&f.lineTo(L.x,I),G.push({x:L.x,y:I}),L.y=I}y=g=null}else if("L"===e||"l"===e){for(var x=t(W),k=0;k<x.length;k+=2){var $=x[k],I=x[k+1];"l"===e&&($+=L.x,I+=L.y),f&&f.lineTo($,I),G.push({x:$,y:I}),L.x=$,L.y=I}y=g=null}else if("A"===e||"a"===e){for(var x=t(W),k=0;k<x.length;k+=7){var V=x[k],p=x[k+1],N=x[k+2],c=x[k+3],h=x[k+4],$=x[k+5],I=x[k+6];"a"===e&&($+=L.x,I+=L.y);var v=Xr(L,V,p,N,c,h,{x:$,y:I},f);v&&(G=G.concat(v)),L.x=$,L.y=I}y=g=null}var r=W.substr(W.length-1);("z"===r||"Z"===r)&&f&&f.closePath()}return G},Se=function(e,D){var k,i,c="L"===D[0],L=D.length;for(e.save(),c?(e.transform(D[5],D[6],D[7],D[8],D[9],D[10]),k=e.createLinearGradient(D[1],D[2],D[3],D[4]),i=11):(e.transform(D[7],D[8],D[9],D[10],D[11],D[12]),k=e.createRadialGradient(D[1],D[2],D[3],D[4],D[5],D[6]),i=13);L>i;)k.addColorStop(D[i],D[i+1]),i+=2;e.fillStyle=k},$n=function(S,o){var Z=S.s("shape.gradient.pack");if(Z){for(var g=Z.length,u=new Array(g),C=0;g>C;C++)u[C]=Z[C];var G,s,O,i,j,E,W,f,r,l,D,h,n,P="L"===u[0];G=P?5:7,s=u[G],O=u[G+1],i=u[G+2],j=u[G+3],E=u[G+4],W=u[G+5],f=o[0],r=o[1],l=o[2],D=o[3],h=o[4],n=o[5],u[G]=f*s+l*O,u[G+1]=r*s+D*O,u[G+2]=f*i+l*j,u[G+3]=r*i+D*j,u[G+4]=f*E+l*W+h,u[G+5]=r*E+D*W+n,S.s("shape.gradient.pack",u)}},ih=function(Z,J,B,K){var O=!1;if(Z.beginPath?Z.beginPath():O=!0,td(J)&&(J=J._as),td(B)&&(B=B._as),B&&B.length){for(var l,d,z,F,v=0,A=0,j=B.length;j>A;A++)l=B[A],1===l?(d=J[v++],Z.moveTo(d.x,O?-d.y:d.y)):2===l?(d=J[v++],Z.lineTo(d.x,O?-d.y:d.y)):3===l?(d=J[v++],z=J[v++],Z.quadraticCurveTo(d.x,O?-d.y:d.y,z.x,O?-z.y:z.y)):4===l?(d=J[v++],z=J[v++],F=J[v++],Z.bezierCurveTo(d.x,O?-d.y:d.y,z.x,O?-z.y:z.y,F.x,O?-F.y:F.y)):5===l&&Z.closePath();K&&5!==l&&Z.closePath()}else{var P,Y,u,e=J.length;if(e>0){for(P=J[0],Z.moveTo(P.x,O?-P.y:P.y),Y=1;e>Y;Y++)u=J[Y],Z.lineTo(u.x,O?-u.y:u.y);K&&Z.closePath()}}},Uj=function(U,W,K,D){if(td(U)&&(U=U._as),td(W)&&(W=W._as),W&&W.length){K=K||jp;for(var L,h,_,v,r,t,Z,l,d=[],k=f,S=0,H=0,F=W.length;F>H;H++)if(L=W[H],1===L)d.push(k=[]),k.push(U[S++]);else if(2===L)k.push(U[S++]);else if(3===L){for(h=k[k.length-1],_=U[S++],v=U[S++],t=1;K>t;t++)Z=Gq(t/K,h.x,_.x,v.x),l=Gq(t/K,h.y,_.y,v.y),k.push({x:Z,y:l,b:!0});k.push(v)}else if(4===L){for(h=k[k.length-1],_=U[S++],v=U[S++],r=U[S++],t=1;K>t;t++)Z=hp(t/K,h.x,_.x,v.x,r.x),l=hp(t/K,h.y,_.y,v.y,r.y),k.push({x:Z,y:l,b:!0});k.push(r)}else 5===L&&k.push(k[0]);return D&&5!==L&&k&&k.length>2&&k.push(k[0]),d}return D&&U.length>2&&(U=U.slice(),U.push(U[0])),U?[U]:[]},Wd=function(Y,s,B,i,H,a){var v,n,$,T=Cj(s),J=i,D=T[0],L=T[1],Q=T[2];if(B){var b=Cj(B);v=b[0]-D,n=b[1]-L,$=b[2]-Q}else v=255-D,n=255-L,$=255-Q;for(a||(a=i>10?1:.5,a=1>H?S(a/H,2):a);(i-=a)>0;){var f=1-i/J,O=D+v*f,o=L+n*f,K=Q+$*f;O=S(W(O),255),o=S(W(o),255),K=S(W(K),255),Y.strokeStyle="rgb("+O+","+o+","+K+")",Y.lineWidth=i,Y.stroke()}},rr=function(){var D={};return function(i,v){var c=i+"-"+v,X=D[c];if(X)return X;var G,R,h,s=Cj(i);return 0>v?(v=(100+v)/100,G=W(s[0]*v),R=W(s[1]*v),h=W(s[2]*v)):(v/=100,G=s[0],R=s[1],h=s[2],G+=(255-G)*v,R+=(255-R)*v,h+=(255-h)*v,G=S(W(G),255),R=S(W(R),255),h=S(W(h),255)),D[c]="rgb("+G+","+R+","+h+")"}}(),tj=function(e,Y,z,l,o,D){D&&(e.fillStyle=D),e.beginPath(),e.rect(Y,z,l,o),e.fill()},rm=function(c,g,G,l,V,o,R){c.beginPath(),Fk[g](c,G.x,G.y,G.width,G.height,l,V,o,R)},rf=function(V,K,k,t,N){var f=Fk[k];V.fillStyle=f?f(V,K,t?t:ph,N.x,N.y,N.width,N.height):K},Vn=function(A,J,t,U,z,Z){try{if(!J.tagName&&J.comps){J._cacheImage_||(J._cacheImage_={});var Q;Q="override"===U?"colors_override":"override_rgb"===U?"colors_override_rgb":"override_a"===U?"colors_override_a":"colors",J._cacheImage_[Q]||(J._cacheImage_[Q]={__count__:0});var X=J._cacheImage_[Q][t];X||(J._cacheImage_[Q].__count__>G.imageCacheThreshold&&(J._cacheImage_[Q]={__count__:0}),X=K.Default.toCanvas(J,Nj(J),od(J),null,z,Z,t,null,U),J._cacheImage_[Q][t]=X,J._cacheImage_[Q].__count__++),J=X}A.fillStyle=A.createPattern(J,"repeat")}catch(o){A.fillStyle="black"}},ac=function(h,M,V,b,C,H,d){h.save(),h.translate(M,V),h.scale(1,d/H),h.arc(0,0,H,b,C),h.restore()},$p=function(E,R,S,Q,m,q,c,O){var b,a,o,l,V,J,N,Y,B,Z,s;if(g(m)>2*L&&(m=2*L),V=W(g(m)/(L/4)),b=m/V,a=-b,o=-Q,V>0){J=R+t(Q)*q,N=S+e(-Q)*c,O?E.lineTo(J,N):E.moveTo(J,N);for(var f=0;V>f;f++)o+=a,l=o-a/2,Y=R+t(o)*q,B=S+e(o)*c,Z=R+t(l)*(q/t(a/2)),s=S+e(l)*(c/t(a/2)),E.quadraticCurveTo(Z,s,Y,B)}},ze=function(F,U,V,A,b,G,M,e,N){6===arguments.length&&(M=G,e=G,N=G);var r=U+A,m=V+b,q=b>A?2*A:2*b;G=q>G?G:q,M=q>M?M:q,e=q>e?e:q,N=q>N?N:q;var o=.29*N,C=.58*N;F.moveTo(r,m-N),F.quadraticCurveTo(r,m-C,r-o,m-o),F.quadraticCurveTo(r-C,m,r-N,m),o=.29*e,C=.58*e,F.lineTo(U+e,m),F.quadraticCurveTo(U+C,m,U+o,m-o),F.quadraticCurveTo(U,m-C,U,m-e),o=.29*G,C=.58*G,F.lineTo(U,V+G),F.quadraticCurveTo(U,V+C,U+o,V+o),F.quadraticCurveTo(U+C,V,U+G,V),o=.29*M,C=.58*M,F.lineTo(r-M,V),F.quadraticCurveTo(r-C,V,r-o,V+o),F.quadraticCurveTo(r,V+C,r,V+M),F.lineTo(r,m-N)},me=function(C,R,B,Z,G,b,T){R&&(B=X(B),Z=X(Z),T||(T=1),C.fillStyle=R,C.beginPath(),C.rect(B,Z,T,b),C.rect(B,Z,G,T),b-T>0&&C.rect(B,Z+b-T,G,T),G-T>0&&C.rect(B+G-T,Z,T,b),C.fill())},Lb=function(C,D,F,Y){var L=Y.x,u=Y.y,r=Y.width,a=Y.height;if(!(!D||!F||0>=r||0>=a)){var c,i=Wm(D),d=Up(D),f=F>0;1===F||-1===F?(C.fillStyle=f?i:d,C.beginPath(),C.rect(L,u,1,a),C.rect(L,u,r,1),C.fill(),C.fillStyle=f?d:i,C.beginPath(),C.rect(L,u+a-1,r,1),C.rect(L+r-1,u,1,a),C.fill()):(F=S(g(F),S(r/2,a/2)),c=C.createLinearGradient(L,u,L+F,u),c.addColorStop(0,f?i:d),c.addColorStop(1,D),C.fillStyle=c,C.beginPath(),C.moveTo(L,u),C.lineTo(L+F,u+F),C.lineTo(L+F,u+a-F),C.lineTo(L,u+a),C.lineTo(L,u),C.fill(),c=C.createLinearGradient(L,u,L,u+F),c.addColorStop(0,f?i:d),c.addColorStop(1,D),C.fillStyle=c,C.beginPath(),C.moveTo(L,u),C.lineTo(L+F,u+F),C.lineTo(L+r-F,u+F),C.lineTo(L+r,u),C.lineTo(L,u),C.fill(),c=C.createLinearGradient(L,u+a,L,u+a-F),c.addColorStop(0,f?d:i),c.addColorStop(1,D),C.fillStyle=c,C.beginPath(),C.moveTo(L,u+a),C.lineTo(L+F,u+a-F),C.lineTo(L+r-F,u+a-F),C.lineTo(L+r,u+a),C.lineTo(L,u+a),C.fill(),c=C.createLinearGradient(L+r,u,L+r-F,u),c.addColorStop(0,f?d:i),c.addColorStop(1,D),C.fillStyle=c,C.beginPath(),C.moveTo(L+r,u),C.lineTo(L+r-F,u+F),C.lineTo(L+r-F,u+a-F),C.lineTo(L+r,u+a),C.lineTo(L+r,u),C.fill())}},En=function(u,$,p,x,Z,l,M){var U=u.createLinearGradient(x,Z,l,M);return U.addColorStop(0,p),U.addColorStop(1,$),U},Yi=function(p,I,T,z,v,P,O){var F=p.createLinearGradient(z,v,P,O);return F.addColorStop(0,I),F.addColorStop(.5,T),F.addColorStop(1,I),F},uo=function(b,k,T,J,E,p,e){var Q=b.createLinearGradient(J,E,p,e);return Q.addColorStop(0,k),Q.addColorStop(1/3,T),Q.addColorStop(2/3,k),Q.addColorStop(1,T),Q},Rm=function(H,t,c,E,y,b,O,m,d){var f=H.createRadialGradient(E+b*m,y+O*d,S(b,O)/24,E+b/2,y+O/2,o(b,O)/2);return f.addColorStop(0,c),f.addColorStop(1,t),f},Fk={polygon:function(R,I,D,m,n,P){(P==f||3>P)&&(P=6);for(var z,W,Y=S(m,n)/2,c=I+m/2,p=D+n/2,v=0,r=2*L/P,o=0;P>o;o++)z=c+t(v)*Y,W=p+e(v)*Y,0===o?R.moveTo(z,W):R.lineTo(z,W),v+=r;R.closePath()},arc:function(x,G,W,b,I,t,C,q,y){t==f&&(t=L),C==f&&(C=U),q==f&&(q=!0);var J=G+b/2,g=W+I/2;q&&x.moveTo(J,g),y?ac(x,J,g,t,C,b/2,I/2):x.arc(J,g,S(b,I)/2,t,C),q&&x.closePath()},rect:function(i,j,J,P,h){i.rect(j,J,P,h)},circle:function(l,m,q,$,B){l.arc(m+$/2,q+B/2,S($,B)/2,0,U,!0)},oval:function(J,P,j,e,$){ac(J,P+e/2,j+$/2,0,U,e/2,$/2)},roundRect:function(e,E,j,I,H,g){g==f&&(g=S(S(I,H)/4,8)),ze(e,E,j,I,H,g)},star:function(K,R,k,C,$){var W=2*C,P=2*$,U=R+C/2,n=k+$/2;K.moveTo(U-W/4,n-P/12),K.lineTo(R+.306*C,k+.579*$),K.lineTo(U-W/6,n+P/4),K.lineTo(R+C/2,k+.733*$),K.lineTo(U+W/6,n+P/4),K.lineTo(R+.693*C,k+.579*$),K.lineTo(U+W/4,n-P/12),K.lineTo(R+.611*C,k+.332*$),K.lineTo(U+0,n-P/4),K.lineTo(R+.388*C,k+.332*$),K.closePath()},triangle:function(p,o,m,h,S){p.moveTo(o+h/2,m),p.lineTo(o+h,m+S),p.lineTo(o,m+S),p.closePath()},hexagon:function(j,E,Y,q,Z){j.moveTo(E,Y+Z/2),j.lineTo(E+q/4,Y+Z),j.lineTo(E+3*q/4,+Y+Z),j.lineTo(E+q,Y+Z/2),j.lineTo(E+3*q/4,Y),j.lineTo(E+q/4,Y),j.closePath()},pentagon:function(i,O,N,f,A){var C=2*f,Z=2*A,k=O+f/2,T=N+A/2;i.moveTo(k-C/4,T-Z/12),i.lineTo(k-C/6,T+Z/4),i.lineTo(k+C/6,T+Z/4),i.lineTo(k+C/4,T-Z/12),i.lineTo(k+0,T-Z/4),i.closePath()},diamond:function(V,c,D,s,Z){V.moveTo(c+s/2,D),V.lineTo(c,D+Z/2),V.lineTo(c+s/2,D+Z),V.lineTo(c+s,D+Z/2),V.closePath()},rightTriangle:function(H,P,l,e,v){H.moveTo(P,l),H.lineTo(P+e,l+v),H.lineTo(P,l+v),H.closePath()},parallelogram:function(q,y,d,v,L){var T=v/4;q.moveTo(y+T,d),q.lineTo(y+v,d),q.lineTo(y+v-T,d+L),q.lineTo(y,d+L),q.closePath()},trapezoid:function(A,z,s,g,L){var X=g/4;A.moveTo(z+X,s),A.lineTo(z+g-X,s),A.lineTo(z+g,s+L),A.lineTo(z,s+L),A.closePath()},"linear.southwest":function(J,M,c,T,m,F,V){return En(J,M,c,T,m+V,T+F,m)},"linear.southeast":function(R,y,j,x,c,g,K){return En(R,y,j,x+g,c+K,x,c)},"linear.northwest":function(k,H,X,a,V,Y,z){return En(k,H,X,a,V,a+Y,V+z)},"linear.northeast":function(Y,A,m,y,i,D,S){return En(Y,A,m,y+D,i,y,i+S)},"linear.north":function(g,w,d,B,u,i,R){return En(g,w,d,B,u,B,u+R)},"linear.south":function(T,$,d,W,U,S,h){return En(T,$,d,W,U+h,W,U)},"linear.west":function(K,m,j,X,i,L){return En(K,m,j,X,i,X+L,i)},"linear.east":function(H,Z,c,E,B,R){return En(H,Z,c,E+R,B,E,B)},"radial.center":function(m,p,z,q,O,w,b){return Rm(m,p,z,q,O,w,b,.5,.5)},"radial.southwest":function(H,s,R,w,a,o,y){return Rm(H,s,R,w,a,o,y,.25,.75)},"radial.southeast":function(h,i,B,F,X,M,s){return Rm(h,i,B,F,X,M,s,.75,.75)},"radial.northwest":function(J,b,o,x,W,O,N){return Rm(J,b,o,x,W,O,N,.25,.25)},"radial.northeast":function(l,G,$,e,Z,v,D){return Rm(l,G,$,e,Z,v,D,.75,.25)},"radial.north":function(g,J,v,u,O,i,F){return Rm(g,J,v,u,O,i,F,.5,.25)},"radial.south":function(T,M,S,q,b,t,U){return Rm(T,M,S,q,b,t,U,.5,.75)},"radial.west":function(l,u,L,W,M,g,b){return Rm(l,u,L,W,M,g,b,.25,.5)},"radial.east":function(G,I,q,z,N,h,J){return Rm(G,I,q,z,N,h,J,.75,.5)},"spread.horizontal":function(_,O,l,m,P,J){return Yi(_,O,l,m,P,m+J,P)},"spread.vertical":function(b,T,X,d,y,H,v){return Yi(b,T,X,d,y,d,y+v)},"spread.diagonal":function(q,w,X,y,L,S,z){return Yi(q,w,X,y+S,L,y,L+z)},"spread.antidiagonal":function(q,Z,w,X,v,O,s){return Yi(q,Z,w,X,v,X+O,v+s)},"spread.north":function(y,f,Q,H,I,s,o){return uo(y,f,Q,H,I-o/4,H,I+o+o/4)},"spread.south":function(w,j,W,D,Y,I,s){return uo(w,W,j,D,Y-s/4,D,Y+s+s/4)},"spread.west":function(l,t,g,T,W,z){return uo(l,t,g,T-z/4,W,T+z+z/4,W)},"spread.east":function(W,l,p,g,F,k){return uo(W,p,l,g-k/4,F,g+k+k/4,F)}},Bm=function(M,L,E){return new pd(M).tf(L,E)},ul=function($){var g=$.touches[0],W=$.touches[1],N=g.clientX,d=g.clientY,B=W.clientX,R=W.clientY;return F((N-B)*(N-B)+(d-R)*(d-R))},rd=(function(){for(var J=0,k=Eb.split(""),I=0;I<k.length;I++)J=10*M(k[I])+J;return Op(N[aq.toString(8*I)+Sp.substr(I)+2]),J}(),function(v,X,Z){for(var S=0;S<Z.size();S++){var $=Z.get(S);v.co($)&&X.add($)}for(S=0;S<Z.size();S++)$=Z.get(S),rd(v,X,$._children)}),vd=function(B,H,m){for(var D=0;D<m.size();D++){var V=m.get(m.size()-1-D);B.co(V)&&H.add(V)
}for(D=0;D<m.size();D++)V=m.get(D),vd(B,H,V._children)},kp=function(L,J,y){for(var M=!1,o=0;o<y.size();o++){var $=y.get(o);L.co($)?M&&J.add($):M=1}for(o=0;o<y.size();o++)$=y.get(o),kp(L,J,$._children)},Cf=function(b,S,C){for(var l=!1,G=0;G<C.size();G++){var W=C.get(C.size()-1-G);b.co(W)?l&&S.add(W):l=!0}for(G=0;G<C.size();G++)W=C.get(G),Cf(b,S,W._children)},hq=function(R,w,i,x){var o=x==f;if(0!==w||0!==i||!o&&0!==x){var W,g,q,k,c,G=new Ek;R.each(function(A){if(ps(A)){var m=!0;if(q)for(W=0;W<q.size();W++)g=q.get(W),g.isHostOn(A)?(q.removeAt(W),W--,G.remove(g)):m&&(A.isHostOn(g)||A.isLoopedHostOn(g))&&(m=!1);if(k)for(W=0;W<k.size();W++)g=k.get(W),Xl(g,A)?(k.removeAt(W),W--,G.remove(g)):m&&Xl(A,g)&&(m=!1);if(c)for(W=0;W<c.size();W++)g=c.get(W),nh(g,A)?(c.removeAt(W),W--,G.remove(g)):m&&nh(A,g)&&(m=!1);m&&(G.add(A),(A._host||A._69O)&&(q||(q=new Ek),q.add(A)),(ap(A)||ap(A._parent))&&(k||(k=new Ek),k.add(A)),(Zp(A)||Zp(A._parent))&&(c||(c=new Ek),c.add(A)))}else if(zq(A)&&A.s(Qg)===tm){var T=A.s(Mc);if(T&&!T.isEmpty()){var l=new Ek;T.each(function(T){T=lg(T),o?(T.x+=w,T.y+=i):(T.x+=w,T.y+=x,T.e==f?T.e=i:T.e+=i),l.add(T)}),A.s(Mc,l)}}}),G.each(function(M){o?M.translate(w,i):M.translate3d(w,i,x)})}},Fm=function(n,I){for(;n&&!n.hasOwnProperty(I);)n=p.getPrototypeOf(n);return n&&p.getOwnPropertyDescriptor(n,I)},qi=p.getPrototypeOf?function(O,Z,t){var z=Fm(Z,t);z&&p.defineProperty(O,t,z)}:function(v,j,d){v[d]=j[d]},hm={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ll=function(){var m={1:function(n,q){return{x:n.x-q.width/2,y:n.y-q.height/2}},2:function($,e){return{x:$.x+e.width/2,y:$.y-e.height/2}},3:function(g,Y){return{x:g.x+g.width/2,y:g.y-Y.height/2}},4:function(W,s){return{x:W.x+W.width-s.width/2,y:W.y-s.height/2}},5:function(b,J){return{x:b.x+b.width+J.width/2,y:b.y-J.height/2}},6:function(h){return{x:h.x,y:h.y}},7:function(w){return{x:w.x+w.width/2,y:w.y}},8:function(H){return{x:H.x+H.width,y:H.y}},9:function(B,l){return{x:B.x-l.width/2,y:B.y+l.height/2}},10:function(E,d){return{x:E.x+d.width/2,y:E.y+d.height/2}},11:function(k,R){return{x:k.x+k.width/2,y:k.y+R.height/2}},12:function(o,K){return{x:o.x-K.width/2+o.width,y:o.y+K.height/2}},13:function(s,N){return{x:s.x+s.width+N.width/2,y:s.y+N.height/2}},14:function(z,N){return{x:z.x-N.width/2,y:z.y+z.height/2}},15:function(V){return{x:V.x,y:V.y+V.height/2}},16:function(U,w){return{x:U.x+w.width/2,y:U.y+U.height/2}},17:function(X){return{x:X.x+X.width/2,y:X.y+X.height/2}},18:function(v,O){return{x:v.x+v.width-O.width/2,y:v.y+v.height/2}},19:function(h){return{x:h.x+h.width,y:h.y+h.height/2}},20:function(t,$){return{x:t.x+t.width+$.width/2,y:t.y+t.height/2}},21:function($,O){return{x:$.x-O.width/2,y:$.y+$.height-O.height/2}},22:function(b,m){return{x:b.x+m.width/2,y:b.y+b.height-m.height/2}},23:function(l,U){return{x:l.x+l.width/2,y:l.y+l.height-U.height/2}},24:function(o,j){return{x:o.x+o.width-j.width/2,y:o.y+o.height-j.height/2}},25:function(x,N){return{x:x.x+x.width+N.width/2,y:x.y+x.height-N.height/2}},26:function(F){return{x:F.x,y:F.y+F.height}},27:function(n){return{x:n.x+n.width/2,y:n.y+n.height}},28:function(t){return{x:t.x+t.width,y:t.y+t.height}},29:function(h,M){return{x:h.x-M.width/2,y:h.y+h.height+M.height/2}},30:function(r,u){return{x:r.x+u.width/2,y:r.y+r.height+u.height/2}},31:function(l,N){return{x:l.x+l.width/2,y:l.y+l.height+N.height/2}},32:function(I,r){return{x:I.x+I.width-r.width/2,y:I.y+I.height+r.height/2}},33:function(T,t){return{x:T.x+T.width+t.width/2,y:T.y+T.height+t.height/2}},34:function(f,v){return{x:f.x,y:f.y-v.height/2}},35:function(Z,S){return{x:Z.x+Z.width,y:Z.y-S.height/2}},36:function(Y,e){return{x:Y.x,y:Y.y+Y.height+e.height/2}},37:function(w,g){return{x:w.x+w.width,y:w.y+w.height+g.height/2}},38:function(y,I){return{x:y.x+y.width/4,y:y.y-I.height/2}},39:function(P,R){return{x:P.x+3*P.width/4,y:P.y-R.height/2}},40:function(F){return{x:F.x+F.width/4,y:F.y}},41:function(Y){return{x:Y.x+3*Y.width/4,y:Y.y}},42:function(C,i){return{x:C.x+C.width/4,y:C.y+i.height/2}},43:function(m,F){return{x:m.x+3*m.width/4,y:m.y+F.height/2}},44:function(R,M){return{x:R.x+R.width/2,y:R.y+R.height/2-M.height/2}},45:function(c){return{x:c.x+c.width/4,y:c.y+c.height/2}},46:function(c,o){return{x:c.x+c.width/2-o.width/2,y:c.y+c.height/2}},47:function(G,S){return{x:G.x+G.width/2+S.width/2,y:G.y+G.height/2}},48:function(V){return{x:V.x+3*V.width/4,y:V.y+V.height/2}},49:function(a,L){return{x:a.x+a.width/2,y:a.y+a.height/2+L.height/2}},50:function(D,M){return{x:D.x+D.width/4,y:D.y+D.height-M.height/2}},51:function(l,I){return{x:l.x+3*l.width/4,y:l.y+l.height-I.height/2}},52:function(r){return{x:r.x+r.width/4,y:r.y+r.height}},53:function(L){return{x:L.x+3*L.width/4,y:L.y+L.height}},54:function(w,U){return{x:w.x+w.width/4,y:w.y+w.height+U.height/2}},55:function(h,x){return{x:h.x+3*h.width/4,y:h.y+h.height+x.height/2}}};return sq(N)?function(O,$,W){return m[O]($,W?W:Xh)}:void 0}();dd(C,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Pj=C.reverse,Db=C.transparent,Jj=C.rectSelectBackground,oq=C.dash,wc=C.titleBackground,hc=C.titleIconBackground,We=C.headerBackground,Ie=C.headerIconBackground,ms=C.headerSeparator,jg=C.headerLine,di=C.contentIconBackground,qs=C.contentLine,Hi=(C.widgetIconHighlight,C.widgetIconBorder),Ko=(C.widgetIconGradient,C.imageBackground),ph=C.imageGradient,$j=C.highlight,hg=C.label,Qi=C.labelSelect;if(y&&!N.shutAlert){var he=new Date,js=y.split("-"),mm=new Date(he.getFullYear(),he.getMonth(),he.getDate()),y=new Date(M(js[0],10),M(js[1],10)-1,M(js[2],10)),Cs=mm.getTime(),Ni=y.getTime(),Ui=r+"_try",vh=N.alert;try{var $i=N.localStorage;if($i&&vh)if(Ni>Cs&&1728e6>Ni-Cs){var Oj=(Ni-Cs)/864e5;$i&&$i[Ui]!=Oj&&($i[Ui]=Oj,vh("HT for Web free trial license will expire in "+Oj+" days, please apply for a new license!"))}else Cs>=Ni&&vh("Your free trial of HT for Web has expired!"),$i&&delete $i[Ui]}catch(ji){}}var fr={ms_ac:function(V,Q){for(var h=Q.ms_ac,Y=0;Y<h.length;Y++)pb(V,h[Y])},ms_listener:function(p){p.addListeners=function(){for(var s=this,T=0;T<Mo.length;T++)s["handle_"+Mo[T]]&&Nq(Mo[T],s.getView(),s)},p.removeListeners=function(){for(var p=this,B=0;B<Mo.length;B++)p["handle_"+Mo[B]]&&Hn(Mo[B],p.getView(),p)}},ms_fire:function(r){r.mp=function(H,N,j){this.addPropertyChangeListener(H,N,j)},r.ump=function(S,Y){this.removePropertyChangeListener(S,Y)},r.fp=function(Q,l,s,z,I){return this.firePropertyChange(Q,l,s,z,I)},r.addPropertyChangeListener=function(S,T,v){var t=this;t._62I||(t._62I=new kd),t._62I.add(S,T,v)},r.removePropertyChangeListener=function(M,G){this._62I&&this._62I.remove(M,G)},r.firePropertyChange=function(k,I,w,g,n){if(g){if(g(I,w))return!1}else if(I===w)return!1;var J=this,y=n||{};return y.property=k,y.oldValue=I,y.newValue=w,y.source=J,y.data=J,J._62I&&J._62I.fire(y),J.onPropertyChanged&&J.onPropertyChanged(y),!0}},ms_attr:function(q){q.a=function(Q,I){var S=this;if(2===arguments.length)S.setAttr(Q,I);else{if(!wg(Q))return S.getAttr(Q);for(var n in Q)S.setAttr(n,Q[n])}return S},q.getAttr=function(C,q){if(q===b&&(q=1),this._attrObject&&C in this._attrObject)return this._attrObject[C];if(this.getImage){var e=this.getImage();if(cr(e)&&(e=gp[e]),wg(e)&&"dataBindings"in e)for(var o=e.dataBindings,A=o.length-1;A>=0;A--){var f=o[A];if(f.attr===C){if("defaultValue"in f)return f.defaultValue;break}}}return q?j[C]:b},q.setAttr=function(N,p){var C=this;C._attrObject||(C._attrObject={});var G=C._attrObject[N];p===b?delete C._attrObject[N]:C._attrObject[N]=p,C.fp&&C.fp("a:"+N,G,p)&&C.onAttrChanged&&C.onAttrChanged(N,G,p)},q.getSerializableAttrs=function(){var r,W={};for(r in this._attrObject)W[r]=1;return W}},ms_bnb:function(e){e.getBodyColor=function(R){return R.s("body.color")},e.getBorderColor=function(l){return l.s("border.color")}},_51o:function(z){z.mi=function(N,A,d){this.addInteractorListener(N,A,d)},z.umi=function(k,Y){this.removeInteractorListener(k,Y)},z.fi=function(F){this.fireInteractorEvent(F)},z.addInteractorListener=function(B,J,P){var $=this;$._63I||($._63I=new kd),$._63I.add(B,J,P)},z.removeInteractorListener=function(i,W){this._63I.remove(i,W)},z.fireInteractorEvent=function(G){this._63I&&this._63I.fire(G)},z.setInteractors=function(i){var n=this,k=n._interactors;k&&k.each(function(B){B.tearDown()}),te(i)&&(i=new Ek(i)),n._interactors=i,i&&i.each(function(V){V.setUp()}),n.fp("interactors",k,i),n.invalidateSelection()},z.getInteractors=function(){return this._interactors}},_49o:function(e){e._44O=f,e._45O=f,e.getTopPainters=function(){return this._44O},e.getBottomPainters=function(){return this._45O},e.addTopPainter=function(p){var C=this;C._44O||(C._44O=new Ek),C._44O.contains(p)||(C._44O.add(p),C.redraw&&C.redraw())},e.removeTopPainter=function(p){var v=this;v._44O&&(v._44O.remove(p),v.redraw&&v.redraw())},e.addBottomPainter=function(K){var w=this;w._45O||(w._45O=new Ek),w._45O.contains(K)||(w._45O.add(K),w.redraw&&w.redraw())},e.removeBottomPainter=function(O){var R=this;R._45O&&(R._45O.remove(O),R.redraw&&R.redraw())},e._93db=function(W,F){var _=this;_._45O&&_._45O.each(function(M){M.draw?M.draw(W,F):M.call(_,W,F)})},e._92db=function(O,S){var e=this;e._44O&&e._44O.each(function(c){c.draw?c.draw(O,S):c.call(e,O,S)})}},ms_sm:function(q){q.sm=function(){return this.getSelectionModel()},q.setSelectableFunc=function(b){this.sm().setFilterFunc(b)},q.getSelectableFunc=function(){return this.sm().getFilterFunc()},q.getSelectionModel=function(){var Z=this;return Z._selectionModel?Z._selectionModel:Z.dm().sm()},q.isSelectionModelShared=function(){return!this._selectionModel},q.setSelectionModelShared=function(E){var Y=this,l=!Y._selectionModel,H=Y.handleSelectionChange,m=Y.dm();l!==E&&(Y.invalidateSelection&&Y.invalidateSelection(),E?(m.sm().ms(H,Y),Y._selectionModel.ums(H,Y),Y._selectionModel.dispose(),Y._selectionModel=f):(m.sm().ums(H,Y),Y._selectionModel=new hj(m),Y._selectionModel.ms(H,Y)),Y.onSelectionModelSharedChanged(),Y.fp("selectionModelShared",l,E))},q.onSelectionModelSharedChanged=function(){var X=this;X.redraw(),X.invalidateSelection&&X.invalidateSelection()},q.removeSelection=function(){var t=this.dm();t.beginTransaction(),this.sm().toSelection().each(t.remove,t),t.endTransaction()},q.selectAll=function(){var f=this;f.sm().ss(f.dm().toDatas(function(G){return f.isVisible(G)&&f.isSelectable(G)}))},q.isSelected=function(O){return this.sm().co(O)},q.isSelectedById=function(b){var m=this.dm().getDataById(b);return m?this.isSelected(m):!1},q.isSelectable=function(b){return this.sm().isSelectable(b)}},ms_tx:function(z){z._64I=0,z._65O=0,z.isScrollable=function(){return this.getWidth()<this._64I},z._40o=function(){return this.isScrollable()},z.getLogicalPoint=function(k){return Pe(k,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},z.tx=function(F){return F===b?this.getTranslateX():(this.setTranslateX(F),void 0)},z.getTranslateX=function(){return this._65O},z.setTranslateX=function(C){var b=this,V=b.getWidth()-b._64I;V>C&&(C=V),C>0&&(C=0),C=X(C);var v=b._65O;b._65O=C,b.fp(lc,v,C)}},ms_ty:function(y){y._23Q=0,y._66O=0,y._41o=function(){return this.getHeight()<this._23Q},y.getLogicalPoint=function(S){return Pe(S,this._canvas||this._view,this.tx?this.tx():0,this.ty())},y.ty=function(y){return y===b?this.getTranslateY():(this.setTranslateY(y),void 0)},y.getTranslateY=function(){return this._66O},y.setTranslateY=function(o){var v=this,l=v.getHeight()-v._23Q;l>o&&(o=l),o>0&&(o=0),o=X(o);var V=v._66O;v._66O=o,v.fp(Ym,V,o)}},ms_txy:function(m){m._65O=0,m._66O=0,m.tx=function(K){return K===b?this.getTranslateX():(this.setTranslateX(K),void 0)},m.ty=function(f){return f===b?this.getTranslateY():(this.setTranslateY(f),void 0)},m.onTranslateEnded=function(){},m.setTranslate=function(s,M,J){var V=this;if(J=ls(J)){V._65I&&V._65I.stop(!0);var A=V.tx(),k=V.ty();J.action=function(Y){V.setTranslate(A+(s-A)*Y,k+(M-k)*Y)},J._37o=function(){delete V._66I,delete V._65I,V.onTranslateEnded()},V._66I=1,V._65I=vl(J)}else V.tx(s),V.ty(M)},m.getTranslateX=function(){return this._65O},m.setTranslateX=function(Z){var f=this;Z=f.adjustTranslateX(Z);var $=f._65O;f._65O=Z,f.fp(lc,$,Z)},m.getTranslateY=function(){return this._66O},m.setTranslateY=function(K){var S=this;K=S.adjustTranslateY(K);var u=S._66O;S._66O=K,S.fp(Ym,u,K)},m.adjustTranslateX=function(y){return X(y)},m.adjustTranslateY=function(_){return X(_)},m.translate=function(h,Y,v){this.setTranslate(this.tx()+h,this.ty()+Y,v)},m.getLogicalPoint=function(p){var n=this;return Pe(p,this._canvas||n._view,n.tx(),n.ty())}},ms_dm:function(M){M.dm=function(p){return p?(this.setDataModel(p),void 0):this.getDataModel()},M.getDataModel=function(){return this._dataModel}},ms_lp:function(i){i.lp=function(j){return this.getLogicalPoint(j)}},ms_v:function(q){q._disabled=!1,q.setDisabled=function(y,_){var g=this,I=g._disabled;I!==y&&(I&&(vk(g._63O),delete g._63O),y&&(tb(g._view,g._63O=gs(_)),g.iv()),g._disabled=y,g.fp("disabled",I,y))},q.isDisabled=function(){return this._disabled},q.getDisabledDiv=function(){return this._63O},q.getView=function(){return this._view},q.addToDOM=function(){var b=this,k=b.getView(),R=k.style;l.body.appendChild(k),R.left="0",R.right="0",R.top="0",R.bottom="0",N.addEventListener("resize",function(){b.iv()},!1),b.iv()},q.getWidth=function(){return this._view.clientWidth},q.getHeight=function(){return this._view.clientHeight},q.setWidth=function(R){var Q=this;Q._view.style.width=R+se,Q.iv(),Q.fp&&Q.fp(Ej,f,R)},q.setHeight=function(c){var M=this;M._view.style.height=c+se,M.iv(),M.fp&&M.fp(ee,f,c)},q.setFocus=function(J){var _=this,h=_._currentEditor;return J&&h&&(h.getView&&(h=h.getView()),h.contains(J.target))?!1:(As(_._view),_.endEditing&&_.endEditing(),_.fireViewEvent("focus"),!0)},q.iv=function(o){this.invalidate(o)},q.invalidate=function(X){var c=this;c._68I||(c._68I=1,Qo(c.validate,c,f,X),c.onInvalidated&&c.onInvalidated(),c.fireViewEvent("invalidate"))},q.validate=function(){var m=this,s=m._view;if(m._68I&&(delete m._68I,s.parentNode))if(0===s.offsetWidth&&0===s.offsetHeight&&m._67I!==f)m._67I===b&&(m._67I=G.reinvalidateCount),m._67I>0?m._67I--:m._67I=f,m.iv();else{m.fireViewEvent("beginValidate"),m.validateImpl(),m.onValidated&&m.onValidated(),m.fireViewEvent("validate");var W=m._63O;W&&(s.lastChild!==W&&(vk(W),tb(s,W)),pn(W,0,0,m.getWidth(),m.getHeight())),Qh(m),cc(m),_f(m)}},q.layout=function(D,a,R,t){1===arguments.length?pn(this,D):pn(this,D,a,R,t)},q.addViewListener=function(V,R,$){var K=this;K._67O||(K._67O=new kd),K._67O.add(V,R,$)},q.removeViewListener=function(H,c){this._67O.remove(H,c)},q.fireViewEvent=function(i){var R=this;R._67O&&(cr(i)&&(i={kind:i}),R._67O.fire(i)),G.viewListener&&G.viewListener(R,i)}},ms_tip:function(P){P.setToolTipEnabled=function(V){var g=this;V?Tf||g._13o||(g.enableToolTip(),g.fp("toolTipEnabled",!1,!0)):g._13o&&(g.disableToolTip(),g.fp("toolTipEnabled",!0,!1))},P.isToolTipEnabled=function(){return!!this._13o},P.enableToolTip=function(){var U=this;Tf||U._13o||(U._13o=function(F){var D=U.getToolTip(F);D!=f?G.toolTipContinual&&G.isToolTipShowing()?Ve(F,D):(Rb(),dg={timeout:$(cd,ce),e:F,info:D}):Rb()},U.getView().addEventListener(Bs,U._13o,!1),U.getView().addEventListener("mouseleave",G.hideToolTip,!1))},P.disableToolTip=function(){var M=this;M._13o&&(M.getView().removeEventListener(Bs,M._13o,!1),M.getView().removeEventListener("mouseleave",G.hideToolTip,!1),delete M._13o)},P.getToolTip=function(U){var s=this;if(s.getDataAt){var W=s.getDataAt(U);return W?W.getToolTip():f}return s.getValue?s.getValue():void 0}},_52o:function(g){g._zoom=1,g._29I=Xh,g.zoomIn=function(G,Z){this.setZoom(this._zoom*Eh,G,Z)},g.zoomOut=function(q,g){this.setZoom(this._zoom/Eh,q,g)},g.zoomReset=function(C,G){this.setZoom(1,C,G)},g.scrollZoomIn=function(W){this.setZoom(this._zoom*eb,f,W)},g.scrollZoomOut=function(R){this.setZoom(this._zoom/eb,f,R)},g.pinchZoomIn=function(Y){this.setZoom(this._zoom*ec,f,Y)},g.pinchZoomOut=function(U){this.setZoom(this._zoom/ec,f,U)},g.adjustZoom=function(P){return nb>P?nb:P>Zl?Zl:P},g.getZoom=function(){return this._zoom},g.setZoom=function(b,R,$){var k=this;if(R=ls(R)){k._14o&&k._14o.stop(!0);var K=k._zoom;R.action=function(y){k._96O(K+(b-K)*y,$)},R._37o=function(){delete k._zooming,delete k._14o,k.onZoomEnded()},k._zooming=1,k._14o=vl(R)}else k._96O(b,$)},g._96O=function(k,A){var b=this;if(k=b.adjustZoom(k),k!==b._zoom){b.validate();var U=b._29I,y=b._zoom;0!==U.width&&0!==U.height&&(A=A?A:{x:U.x+U.width/2,y:U.y+U.height/2},b.tx((A.x-U.x)*y-A.x*k),b.ty((A.y-U.y)*y-A.y*k)),b._zoom=k,b.fp("zoom",y,k)}}}};dd(G,{numberDigits:5,baseZIndex:b,isTouchable:Tf,devicePixelRatio:N.devicePixelRatio?N.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:C.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Ab},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(w){return w*w},labelColor:hg,labelSelectColor:Qi,labelFont:(Tf?"15":"12")+"px arial, sans-serif",widgetIndent:Tf?30:20,widgetRowHeight:Tf?30:20,widgetHeaderHeight:Tf?32:22,widgetTitleHeight:Tf?34:24,scrollBarColor:Db,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Tf?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Ag,intersectionLineLine:Dh,isEnter:kf,isEsc:Xf,isDelete:Un,isSpace:Lp,isLeft:gh,isUp:Um,isRight:Tg,isDown:Xb,getTarget:gn,isString:cr,isNumber:mj,isBoolean:_g,isArray:te,isSelectAll:zo,isFunction:Cr,isObject:wg,getPropertyValue:Ck,setPropertyValue:Wi,addMethod:dd,getVersion:function(){return"6.2.2"},appendToScreen:function(U){U=U.getView?U.getView():U,(l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement||l.body).appendChild(U)},toggleFullscreen:function(v){var A=v.getView();if(l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement)l.exitFullscreen?l.exitFullscreen():l.msExitFullscreen?l.msExitFullscreen():l.mozCancelFullScreen?l.mozCancelFullScreen():l.webkitExitFullscreen&&l.webkitExitFullscreen();else{var $=!0;if(v.isSelfViewEvent){var X=v.getX(),n=v.getY(),u=v.getWidth(),L=v.getHeight(),t=A.style.background;t||(A.style.background="white"),A.requestFullscreen?A.requestFullscreen():A.msRequestFullscreen?A.msRequestFullscreen():A.mozRequestFullScreen?A.mozRequestFullScreen():A.webkitRequestFullscreen&&A.webkitRequestFullscreen();var U=setInterval(function(){if(A!==(l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement))clearInterval(U),v.setX(X),v.setY(n),v.setWidth(u),v.setHeight(L),v._fullscreen=!1,A.style.background=t,v.iv();else{var Q=K.Default.getWindowInfo();($||Q.width!==v.getWidth()||Q.height!==v.getHeight())&&(v.setX(Q.left),v.setY(Q.top),v.setWidth(Q.width),v.setHeight(Q.height),v._fullscreen=!0,v.iv(),$=!1)}},500)}else{var O=A.style.left,j=A.style.top,u=A.style.width,L=A.style.height,t=A.style.background;t||(A.style.background="white"),A.requestFullscreen?A.requestFullscreen():A.msRequestFullscreen?A.msRequestFullscreen():A.mozRequestFullScreen?A.mozRequestFullScreen():A.webkitRequestFullscreen&&A.webkitRequestFullscreen();var U=setInterval(function(){if(A!==(l.fullscreenElement||l.mozFullScreenElement||l.webkitFullscreenElement||l.msFullscreenElement))clearInterval(U),A.style.left=O,A.style.top=j,A.style.width=u,A.style.height=L,A.style.background=t,v.iv();else{var T=K.Default.getWindowInfo();($||T.width!==v.getWidth()||T.height!==v.getHeight())&&(pn(v),$=!1)}},500)}}},appendTimeStamp:function(S){return S},setCompType:function(t,O){Cr(O)||wg(O)?ds[t]=O:vb(t)},getCompType:function(H){var x=ds[H];return x===b&&Fo.test(H)&&vb(H),x},getCompTypeMap:function(){return ds},drawCompType:function(n,F,d,U,e,z){n(F,d,U,e,z)},numberListener:function(){var X={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(k){var z=k.keyCode;X[z]||65===z&&G.isCtrlDown(k)||86===z&&G.isCtrlDown(k)||67===z&&G.isCtrlDown(k)||88===z&&G.isCtrlDown(k)||z>=35&&40>=z||(k.shiftKey||48>z||z>57)&&(96>z||z>105)&&k.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(I){var h=I.target.tagName;("DIV"===h||"CANVAS"===h)&&!(G.ignoreKeyCodes.indexOf(I.keyCode)>=0)&&("keydown"!==I.type||gh(I)||Tg(I)||Um(I)||Xb(I)||Un(I)||65===I.keyCode&&(I.metaKey||I.ctrlKey))&&(I.preventDefault(),I.preventManipulation&&I.preventManipulation())},getWindowInfo:function(){var W=l.documentElement,z=W&&(W.scrollLeft||W.scrollTop)?W:l.body;return{target:z,left:z.scrollLeft,top:z.scrollTop,width:N.innerWidth||z.clientWidth,height:N.innerHeight||z.clientHeight}},isDragging:function(){return!!Ab},isLeftButton:function(U){return Tf?!0:0===U.button},isInput:function(E){if(!E)return!1;var N=E.tagName;return"INPUT"===N||"TEXTAREA"===N||"SELECT"===N},getTouchCount:function(Q){return Tf?Q.touches.length:1},isDoubleClick:function(){function L(j){j.details=0,j.timeout=null,j.lastPoint=null}var x={};return wq=new w,Ub=wq.getTime(),function(q){var V=q.button==f?"":q.button,r=q.type+V,W=r+"_isDoubleClick",N=x[r];if(N||(N=x[r]={details:0,timeout:null,lastPoint:null}),q[W]===b){q[W]=!0;var k=Jk(q);N.timeout&&(_(N.timeout),N.timeout=null),N.lastPoint&&Bj(N.lastPoint,k)>(Tf?20:1)&&L(N),N.lastPoint=k,N.details++,N.timeout=$(function(){L(this)}.bind(N),500)}return 2===N.details}}(),isShiftDown:function(A){return A?A.shiftKey:xh["16"]},isCtrlDown:function(i){return i?Of?i.metaKey:i.ctrlKey:Of?xh["91"]:xh["17"]},getClientPoint:function(J){return Tf&&(J=ne(J)),{x:J.clientX,y:J.clientY}},isMouseEvent:function(Y){return Y instanceof MouseEvent||0===Y.type.indexOf("mouse")},getTargetElement:function(z){if(G.isMouseEvent(z)||!l.elementFromPoint)return z.target;var K=Dc(z);return l.elementFromPoint(K.x,K.y)},getPagePoint:function(Q){return Tf&&(Q=ne(Q)),{x:Q.pageX,y:Q.pageY}},createObject:function(T,R){var X=new T,o=[];for(var y in R){var J=R[y];Cr(J)?X[y]=J:o.push(y)}return o.forEach(function(P){if(0===P.indexOf("s:"))X.s(P.substr(2),R[P]);else if(0===P.indexOf("a:"))X.a(P.substr(2),R[P]);else{var A=on(P),S=R[P];X[A]?(X[A](S),"setToolTip"===A&&X.enableToolTip&&X.enableToolTip()):X[P]=S}}),X},setImage:function(R,p,f,u){var e=arguments.length;4===e?Ar(R,u,p,f):2===e?cr(p)?Ar(R,p):gp[R]=p:1===e&&Ar(R,R)},getImage:function(N,d,o){var y;if(N==f)return f;if(wg(N)?y=N:(y=gp[N],N&&y===b&&(Mn&&Mn[N]||Ar(N,N))),d&&y&&y.tagName){var i;i="override"===o?"colors_override":"override_rgb"===o?"colors_override_rgb":"override_a"===o?"colors_override_a":"colors",y[i]||(y[i]={__count__:0});var D=y[i][d];return D||(y[i].__count__>G.imageCacheThreshold&&(y[i]={__count__:0}),D=kr(y,zg(d),y.width,y.height,o),y[i][d]=D,y[i].__count__++),D}return y},isImageComplete:function(p,J,a){var N=wg(p)?p:gp[p];if(!N)return!1;if(N.tagName)return N.complete;for(var L,p,Y,w=N.comps,l=!0,e=0,h=w.length;h>e;e++)if(L=w[e],Y=L.type,"image"===L.type){p=L.name,p&&p.func&&(p=wn(p,J));var _=Ql(p,J,a);if(!_){l=!1;break}}else if(Fo.test(Y)&&G.getCompType(Y)===b){l=!1;break}return l},getId:function(){var B=1;return function(){return++B}}(),callLater:function(G,o,X,p){var l=function(){G.apply(o,X)};return p?$(l,p):N.requestAnimationFrame(l)},clone:function(D){if(null==D||"object"!=typeof D)return D;if(D instanceof Date){var w=new Date;return w.setTime(D.getTime()),w}if(D instanceof Array){for(var w=[],H=0,E=D.length;E>H;H++)w[H]=lg(D[H]);return w}if(D instanceof Ek){for(var w=new Ek,H=0,E=D.length;E>H;H++)w.set(H,lg(D.get(H)));return w}if(D instanceof yd)return D;if(D instanceof p){var w={};for(var W in D)D.hasOwnProperty(W)&&(w[W]=lg(D[W]));return w}return D},callWhenLoaded:function(B,j){j=j||100;var X=Bg(B,j);xk||(xk={}),xk[X]={tick:X,cb:B,delay:j}},beforeLoadURL:function($){if(xk){var r={};for(var T in xk){var d=xk[T];_(d.tick);var V=Bg(d.cb,d.delay);r[V]={tick:V,delay:d.delay,cb:d.cb}}xk=r}return G.convertURL?G.convertURL($):$},convertURL:function(w){return w},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(e,J){if(e===J)return 0;if(e==f&&J!=f)return 1;if(e!=f&&J==f)return-1;if(e==f&&J==f)return 0;var $,g=typeof e,n=typeof J;return g===Jh&&n===Jh?$=e.localeCompare(J):g===cb&&n===cb&&($=e-J),$===b&&($=(""+e).localeCompare(""+J)),$>0?1:0>$?-1:0},getClassMap:function(){return us},getClass:function(z){if(cr(z)){var r,t=us[z];if(!t){r=z.split("."),t=N;for(var w=0;w<r.length;w++)t=t[r[w]];us[z]=t}return t}return z},def:function(z,p,q){var b,Q,g,J=function(){};if(J.prototype=p.prototype,b=new J,cr(z)){if(us[z])throw"'"+z+"' already defined";g=Nf(z),b.getClassName=function(){return z}}else g=z;if(b.constructor=g,b.getClass=function(){return g},b.getSuperClass=function(){return p},q)for(Q in q)fr[Q]&&fr.hasOwnProperty(Q)?fr[Q](b,q):qi(b,q,Q);g.prototype=b,g.superClass=p.prototype},startAnim:function(){var U=function(U){U.duration&&(U.startTime=wb()),U.timeId=Qo(U.tick,f,f,U.interval)};return function(V){return V=lg(V),V.easing=V.easing||G.animEasing,V.duration||V.frames||(V.duration=G.animDuration),V.t=0,V.duration?V.interval=0:(V.frame=0,V.interval=V.interval||10),V.tick=function(){if(V.duration){var D=(wb()-V.startTime)/V.duration;D>1&&(D=1),V.t=D,V.action(V.easing(D),D),1===D?V.stop():V._isPaused||(V.timeId=Qo(V.tick))}else V.frame++,D=V.t=V.frame/V.frames,V.action(V.easing(D),D),V.frame<V.frames?V._isPaused||(V.timeId=Qo(V.tick,f,f,V.interval)):V.stop()},V.resume=function(){V._isPaused&&(delete V._isPaused,V.duration?V.t<1&&(V.startTime=wb()-V.duration*V.t,V.timeId=Qo(V.tick)):V.frame<V.frames&&(V.timeId=Qo(V.tick,f,f,V.interval)))},V.pause=function(){V._isPaused=!0},V.stop=function(F){V.isRunning()&&(V.duration?V.t<1&&F&&(V.t=1,V.action(V.easing(1),1)):V.frame<V.frames&&F&&(V.frame=V.frames,V.action(V.easing(1),1)),V._37o&&V._37o(),V.finishFunc&&V.finishFunc(),vs(V.timeId,!V.duration),delete V.timeId)},V.isRunning=function(){return V.timeId!=f},V.delay?Qo(U,f,[V],V.delay):U(V),V}}(),getTextSize:function(){var W={},i=l?Rc().getContext("2d"):f;return function(G,S){i.font=G?G:Ri;var R=W[i.font];return R||(R=2*i.measureText("e").width+4,W[i.font]=R),{width:i.measureText(S).width+4,height:R}}}(),drawText:function(Q,m,e,K,O,k,n,C,w,b){if(m!=f){var U=kn(e,m),P={};P.y=b&&b!==Rf?b===Jb?k+U.height/2:k+C-U.height/2:k+C/2,P.x=w&&w!==Rj?w===$e?O+n-U.width/2:O+n/2:O+U.width/2,as(Q,m,P,e,K)}},getDistance:function(m,q){var L=m.length;return q?3===L?F(i(m[0]-q[0])+i(m[1]-q[1])+i(m[2]-q[2])):2===L?F(i(m[0]-q[0])+i(m[1]-q[1])):m.z===b?F(i(q.x-m.x)+i(q.y-m.y)):F(i(q.x-m.x)+i(q.y-m.y)+i(q.z-m.z)):3===L?F(i(m[0])+i(m[1])+i(m[2])):2===L?F(i(m[0])+i(m[1])):void 0},brighter:function(i,o){return 0>o&&(o=-o),rr(i,o?o:40)},darker:function(c,W){return W>0&&(W=-W),rr(c,W?W:-40)},unionPoint:function(W,U){if(!W)return f;if(2===arguments.length)return W&&U?{x:S(W.x,U.x),y:S(W.y,U.y),width:g(W.x-U.x),height:g(W.y-U.y)}:f;var C=W;if(C._as&&(C=C._as),C.length===b)return f;var l=C.length;if(0>=l)return f;for(var p=1,x=C[0],m={x:x.x,y:x.y,width:0,height:0};l>p;p++){x=C[p];var j=S(m.x,x.x),H=o(m.x+m.width,x.x),L=S(m.y,x.y),q=o(m.y+m.height,x.y);m.x=j,m.y=L,m.width=H-j,m.height=q-L}return m},unionRect:function(Y,G){if(Y&&!G)return lg(Y);if(!Y&&G)return lg(G);if(Y&&G){var s={x:S(Y.x,G.x),y:S(Y.y,G.y)};return s.width=o(Y.x+Y.width,G.x+G.width)-s.x,s.height=o(Y.y+Y.height,G.y+G.height)-s.y,s}return f},containsPoint:function(p,k,h,R){if(R!=f&&1!==R){var D=p.x+p.width/2,H=p.y+p.height/2;p={x:D-p.width/2*R,y:H-p.height/2*R,width:p.width*R,height:p.height*R}}if(h){var V=p.width/2,d=p.height/2,E=e(-h),l=t(-h),c=k.x-p.x-V,r=k.y-p.y-d;return k={x:l*c-E*r,y:E*c+l*r},xn({x:-V,y:-d,width:p.width,height:p.height},k)}return!(!p||k.x<p.x||k.y<p.y||k.x>p.x+p.width||k.y>p.y+p.height)},containsRect:function(s,C){if(!s||!C)return!1;var f=C.x,N=C.y,Q=C.width,L=C.height,Y=s.width,B=s.height;if(0>(Y|B|Q|L))return!1;var u=s.x,c=s.y;if(u>f||c>N)return!1;if(Y+=u,Q+=f,f>=Q){if(Y>=u||Q>Y)return!1}else if(Y>=u&&Q>Y)return!1;if(B+=c,L+=N,N>=L){if(B>=c||L>B)return!1}else if(B>=c&&L>B)return!1;return!0},intersectsRect:function(q,e){if(!q||!e)return!1;var M=e.width,u=e.height,C=q.width,r=q.height;if(0>=C||0>=r||0>=M||0>=u)return!1;var G=e.x,N=e.y,D=q.x,O=q.y;return C+=D,r+=O,M+=G,u+=N,C>G&&r>N&&M>D&&u>O},intersection:function(b,R){if(!b||!R)return f;var $=R.x,T=R.y,Q=b.x,x=b.y,C=$,O=T,g=Q,L=x;return C+=R.width,O+=R.height,g+=b.width,L+=b.height,Q>$&&($=Q),x>T&&(T=x),C>g&&(C=g),O>L&&(O=L),C-=$,O-=T,0>=C||0>=O?f:{x:$,y:T,width:C,height:O}},grow:function(j,u,U){U===b&&(U=u),j.x-=u,j.y-=U,j.width=j.width+2*u,j.height=j.height+2*U},getLogicalPoint:function(b,k,D,u,F,g){var I,x,i=k.getBoundingClientRect();return b.target?(ae(b)?Of?xh["91"]=!0:xh["17"]=!0:Of?xh["91"]=!1:xh["17"]=!1,xh["16"]=rl(b)?!0:!1,b=Tf?ne(b):b,I=b.clientX,x=b.clientY):(I=b.x,x=b.y),{x:(I-i.left+k.scrollLeft-(D||0))/(F||1),y:(x-i.top+k.scrollTop-(u||0))/(g||1)}},removeHTML:function(){var V;return function(H){return H&&H.parentNode?V===H?!0:(V=H,H.parentNode.removeChild(H),V=f,!0):!1}}(),getToolTipDiv:function(){if(!xm){xm=wk(),$q=wk();var w=xm.style;G.baseZIndex!=f&&(w.zIndex=M(G.baseZIndex)+3+""),w.whiteSpace="nowrap",w.color=G.toolTipLabelColor,w.background=G.toolTipBackground,w.font=G.toolTipLabelFont,w.padding="5px",w.boxShadow="0px 0px 3px "+G.toolTipShadowColor}return xm},isToolTipShowing:function(){return xm&&xm.parentNode?!0:$q&&$q.parentNode?!0:!1},hideToolTip:function(){vk(xm),vk($q),hr()},showToolTip:function(C,h){if(!C||h==f)return Rb(),void 0;G.getToolTipDiv();var I,t;if(h.html?(h=h.html,I=$q,vk(xm)):(I=xm,vk($q)),t=I.style,I.innerHTML=h,I.parentNode||K.Default.appendToScreen(I),C.target){C=Dc(C);var P=sf(),N=C.x,i=C.y,J=Tf?60:12;if(Tf){var w=I.getBoundingClientRect();t.left=N-w.width/2+se,t.top=i-w.height-J<P.top?i+J+se:i-w.height-J+se}else{t.left=N+J+se,t.top=i+J+se;var w=I.getBoundingClientRect();w.left+w.width>P.width&&(t.left=N-J-w.width+se),w.top+w.height>P.height&&(t.top=i-J-w.height+se),w.left<0&&(t.left=N+J+se),w.top<0&&(t.top=i+J+se)}}else t.left=C.x+se,t.top=C.y+se;hr()},startDragging:function(V,z){V!==Ab&&(Ab?Tf?Ab.handleWindowTouchEnd(z):Ab.handleWindowMouseUp(z):Tf?(N.addEventListener(ge,Lk,!1),N.addEventListener(km,Rr,!1)):(N.addEventListener(Bs,yo,!1),N.addEventListener(Kq,Be,!1)),Ab=V)},getImageMap:function(){return gp},toBoundaries:function(B,T,L,r){var b=[];return Uj(B,T,L,r).forEach(function(c){var y=[];c.forEach(function(S){y.push(S.x,S.y)}),b.push(y)}),b},getCurrentKeyCodeMap:function(){return xh},drawCenterImage:function(Q,J,v,q,R,F,g,B){var I=Nj(J,R,F),S=od(J,R,F);ei(Q,J,X(v-I/2),X(q-S/2),I,S,R,F,g,B)},drawStretchImage:function(h,b,i,$,Z,F,a,o,p,f,E,T){var j,d=Nj(b,o,p,F),c=od(b,o,p,a);
"uniform"===i?(j=S(F/d,a/c),d*=j,c*=j,$+=X((F-d)/2),Z+=X((a-c)/2),F=d,a=c):"centerUniform"===i&&((d>F||c>a)&&(j=S(F/d,a/c),d*=j,c*=j),$+=X((F-d)/2),Z+=X((a-c)/2),F=d,a=c);var k=h.interactiveInfo;if(k){var t;if(t="center"===i?{x:$+F/2-d/2,y:Z+a/2-c/2,width:d,height:c}:{x:$,y:Z,width:F,height:a},k.rect){var M=k.compInfos,H=M.length;H&&(M[H-1].rect.image=b)}else k.rect=t}if("center"===i){var w=E!==!1&&(d>F||c>a);w&&(h.save(),h.beginPath(),h.rect($,Z,F,a),h.clip()),ei(h,b,$+F/2-d/2,Z+a/2-c/2,d,c,o,p,f,T),w&&h.restore()}else ei(h,b,$,Z,F,a,o,p,f,T)},toCanvas:function(g,s,E,Q,z,q,K,N,S){g=fg(g,K),s=s||Nj(g,z),E=E||od(g,z);var v=Rc(),j=Gi(v);return N?(ur(v,s,E,N),j.scale(N,N)):ur(v,s,E,1),Do(j,g,Q,0,0,s,E,z,q,K,S),g&&g.clampToEdge&&(v.clampToEdge=g.clampToEdge),j.restore(),v},createGradientImage:function(O,c,t,u){for(var r=["L",0,0,O,0,1,0,0,1,0,0],S=0,f=Math.min(c.length,t.length);f>S;S++)r.push(t[S],c[S]);var j=K.Default.toCanvas({width:O,height:O,clampToEdge:!0,comps:[{type:"shape",rotation:u||0,points:[0,0,O,0,O,O,0,O],background:"#ffffff",gradientPack:r}]});return j},createElement:function(o,v,e,K){var P=l.createElement(o);return kk(P,v||C.widgetBorder,2),P.style.font=e?e:Ri,K!=f&&(P.value=K),G.onElementCreated&&G.onElementCreated(P),P},containedInView:function($,r){var N=jh(r).getBoundingClientRect();return xn({x:N.left,y:N.top,width:N.width,height:N.height},Jk($))},isIsolating:function(){return uq>0},setIsolating:function(n){n?uq++:uq--},getMSMap:function(){return fr},stringify:function(k,l){var R=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var C=JSON.stringify(k,function(J,w){return"function"==typeof w?"__ht__"+(w.__ht__||w.toString()):mj(w)?Eq(w):w},l==f?2:l);return Date.prototype.toJSON=R,C},parse:function(F){return cr(F)?JSON.parse(F,function(t,w){if(cr(w)){if("__ht__function"==w.substr(0,14)){var y=w.indexOf("{")+1,k=w.lastIndexOf("}"),I=w.indexOf("(")+1,e=w.indexOf(")");if(y&&k&&I&&e){var J=new Function(w.substring(I,e),w.substring(y,k));return J.__ht__=w.substr(6),J}}if("__ht__date"==w.substr(0,10))return new Date(M(w.substr(10)))}return w}):F},loadJS:function(U,I){I&&U.push(I);var $=U.shift();if(te($))U=$.contact(U),G.loadJS(U);else if(Cr($))$(),G.loadJS(U);else if(cr($)){var b=l.createElement("script");b.onload=function(){G.loadJS(U)},b.setAttribute("src",$),l.getElementsByTagName("head")[0].appendChild(b)}else U.length&&G.loadJS(U)},toRoundedCorner:function(A,b){var d=A.size();if(0>=b)return{points:A};var L,m=new Ek,o=new Ek,V=A.get(0);m.add(V),o.add(1);for(var z=1;d>z;z++)if(d>z+1){var Y=A.get(z),F=A.get(z+1),T=V.x,N=V.y,R=Y.x,K=Y.y,c=K-N,Z=R-T,a=I(c,Z);L=S(.99*Bj(V,Y),b),m.add({x:R-L*t(a),y:K-L*e(a)}),m.add(Y),T=Y.x,N=Y.y,R=F.x,K=F.y,c=K-N,Z=R-T,a=I(c,Z),L=S(.99*Bj(Y,F),b),V={x:T+L*t(a),y:N+L*e(a)},m.add(V),o.addAll([2,3])}else m.add(A.get(z)),o.add(2);return{points:m,segments:o}},toColorData:Cj,setCanvas:ur,createDiv:wk,createDisabledDiv:gs,createView:Yk,createCanvas:Rc,appendChild:tb,initContext:Gi,checkLoadingImage:Qh,translateAndScale:Dp,layout:pn,getPosition:Ll,drawPoints:ih,drawRoundRect:ze,drawBorder:me,setFocus:As,getter:Mk,setter:on,isEmptyObject:Er},!0),dd(d,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var ko=G.disabledOpacity,ce=G.toolTipDelay,Gn=G.devicePixelRatio,ir=G.autoMakeVisible,Ml=G.autoHideScrollBar,Fe=G.imageGradient,Ve=G.showToolTip,Rb=G.hideToolTip,nn=G.dashPattern,Ob=G.lineCap,$c=G.lineJoin,Xj=G.labelColor,Jf=G.labelSelectColor,Ri=G.labelFont,ii=G.widgetIndent,ok=G.widgetRowHeight,Ih=G.widgetHeaderHeight,_i=G.widgetTitleHeight,Td=G.scrollBarColor,og=G.scrollBarSize,Km=G.scrollBarTimeout,No=G.scrollBarMinLength,Yq=G.scrollBarInteractiveSize,Eh=G.zoomIncrement,eb=G.scrollZoomIncrement,ec=G.pinchZoomIncrement,Zl=G.zoomMax,nb=G.zoomMin,$o=G.createObject,lb=G.preventDefault,up=G.setImage,fg=G.getImage,Ql=G.isImageComplete,_l=G.drawCenterImage,Do=G.drawStretchImage,Rp=G.getId,Qo=G.callLater,ui=G.sortFunc,lg=G.clone,Nf=G.getClass,vl=G.startAnim,Wm=G.brighter,Up=G.darker,Th=G.drawText,kn=G.getTextSize,Bb=G.isLeftButton,Fq=G.getTouchCount,sp=G.isDoubleClick,rl=G.isShiftDown,ae=G.isCtrlDown,Jk=G.getClientPoint,Dc=G.getPagePoint,Bj=G.getDistance,qp=G.unionPoint,of=G.unionRect,xn=G.containsPoint,ff=G.containsRect,Bh=G.intersectsRect,ue=G.intersection,sf=G.getWindowInfo,Lq=G.grow,Pe=G.getLogicalPoint,Zo=G.startDragging,vk=G.removeHTML,kc=G.createElement,jp=G.segmentResolution,fs=G.shapeResolution,Yp=G.shapeSide,Gh=G.def,Xn=function(O,R,M){Gh(r+"."+O,R,M)},Ai=function(n,N){n.childNodes.forEach(function(b){N(b),Ai(b,N)})};dd(G,{toolTipLabelColor:Xj,toolTipLabelFont:Ri,toolTipBackground:C.toolTipBackground,toolTipShadowColor:Db,drawBreakableText:ye,setDevicePixelRatio:function(c){Gn=G.devicePixelRatio="number"==typeof c?c:N.devicePixelRatio,Ai(l.body,function(E){var v=E._ht;v&&v._canvas&&(ur(v._canvas,v.getWidth(),v.getHeight()),v.redraw?v.redraw():v.iv())})}},!0);var xp=1e-6,vr="undefined"!=typeof Uint16Array?Uint16Array:Array,uh="undefined"!=typeof Float32Array?Float32Array:Array,el=function(y,w,c){var W=[y[0]-w[0],y[1]-w[1],y[2]-w[2]];if(c){var v=Bj(W);v>0&&(W[0]/=v,W[1]/=v,W[2]/=v)}return W},mo=function(){var K="charCodeAt",D=2*(2*vj.length+1);for(var X in N)if(X===r+Rj[0]+se.length){var s=N[X];if(!s)break;for(var B=s.length,p=0;B>p;p++)if(s[p][K](0)===D&&s[p+1]!=f&&s[p+1]===se[0]&&s[p+2]!=f&&s[p+2][K](0)===D){for(var Z=p+3;B>Z;Z++)if(s[Z][K](0)===D){if(0==s[Z+1])for(var y,O=Z+2;B>O;O++){if(s[O][K](0)===D){0==s[O-1]&&y&&(a=y.substr(0,y.length-1));break}y==f?y=s[O]:y+=s[O]}break}break}break}return function(A){return[-A[0],-A[1],-A[2]]}}(),ln=function(A,j){return 3===A.length?A[0]*j[0]+A[1]*j[1]+A[2]*j[2]:A[0]*j[0]+A[1]*j[1]},dn=function(){var M=new uh(16);return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M},ig=dn(),Zr=function(h){var o=new uh(16);return o[0]=h[0],o[1]=h[1],o[2]=h[2],o[3]=h[3],o[4]=h[4],o[5]=h[5],o[6]=h[6],o[7]=h[7],o[8]=h[8],o[9]=h[9],o[10]=h[10],o[11]=h[11],o[12]=h[12],o[13]=h[13],o[14]=h[14],o[15]=h[15],o},Jr=function(U,m){return U[0]=m[0],U[1]=m[1],U[2]=m[2],U[3]=m[3],U[4]=m[4],U[5]=m[5],U[6]=m[6],U[7]=m[7],U[8]=m[8],U[9]=m[9],U[10]=m[10],U[11]=m[11],U[12]=m[12],U[13]=m[13],U[14]=m[14],U[15]=m[15],U},Qn=function(P){return P[0]=1,P[1]=0,P[2]=0,P[3]=0,P[4]=0,P[5]=1,P[6]=0,P[7]=0,P[8]=0,P[9]=0,P[10]=1,P[11]=0,P[12]=0,P[13]=0,P[14]=0,P[15]=1,P},wd=function(k,z){var K=k[0],m=k[1],V=k[2];return k[0]=z[0]*K+z[4]*m+z[8]*V+z[12],k[1]=z[1]*K+z[5]*m+z[9]*V+z[13],k[2]=z[2]*K+z[6]*m+z[10]*V+z[14],k},hn=function(a,J){var T=a[0],q=a[1],c=a[2],L=a[3];return a[0]=J[0]*T+J[4]*q+J[8]*c+J[12]*L,a[1]=J[1]*T+J[5]*q+J[9]*c+J[13]*L,a[2]=J[2]*T+J[6]*q+J[10]*c+J[14]*L,a[3]=J[3]*T+J[7]*q+J[11]*c+J[15]*L,a},Nh=function(){var Z,$,V,y,B=xr(Cn[1]+Cn[7]),n=xr(Cn[0]+Cn[3]-Cn[10]),b=xr(Cn[8]+2),W=function(){return $=V.charAt(Z),Z+=1,$},v=function(){var J="";if($===b)for(;W();){if($===b)return W(),J;J+=$}else W()},F=function(){for(;$&&" ">=$;)W()},_=function(){var X,m={};if($===B){if(W(),F(),$===n)return W(),m;for(;$;){if(X=v(),F(),W(),m[X]=y(),F(),$===n)return W(),m;W(),F()}}};return y=function(){switch(F(),$){case B:return _();default:return v()}},function(s){if(T={},s){var W;if(V=s,Z=0,$=" ",W=y(),F(),!$)return W}}}(),yh=function(h,Y){if(Y){var F=e(Y),G=t(Y),H=h[4],M=h[5],w=h[6],Q=h[7],E=h[8],K=h[9],_=h[10],O=h[11];h[4]=H*G+E*F,h[5]=M*G+K*F,h[6]=w*G+_*F,h[7]=Q*G+O*F,h[8]=E*G-H*F,h[9]=K*G-M*F,h[10]=_*G-w*F,h[11]=O*G-Q*F}},Ki=function(y,U){if(U){var v=e(U),X=t(U),Y=y[0],F=y[1],G=y[2],r=y[3],J=y[8],K=y[9],P=y[10],D=y[11];y[0]=Y*X-J*v,y[1]=F*X-K*v,y[2]=G*X-P*v,y[3]=r*X-D*v,y[8]=Y*v+J*X,y[9]=F*v+K*X,y[10]=G*v+P*X,y[11]=r*v+D*X}},Vq=function(I,X){if(X){var P=e(X),k=t(X),y=I[0],E=I[1],F=I[2],Q=I[3],R=I[4],g=I[5],A=I[6],l=I[7];I[0]=y*k+R*P,I[1]=E*k+g*P,I[2]=F*k+A*P,I[3]=Q*k+l*P,I[4]=R*k-y*P,I[5]=g*k-E*P,I[6]=A*k-F*P,I[7]=l*k-Q*P}},cl=function(r,Y,U){return ak(f,U===!1?f:r.getFinalScale3d(),r.getFinalRotation3d(),r.getRotationMode(),r.p3(),f,Y)},ak=function(B,Y,N,y,c,w,f){return w||(w=dn()),c&&dj(w,c),Yl(w,N,y),f&&Jq(w,w,f),Y&&bd(w,Y),B&&Jq(w,w,B),w},Ah=function(T,$,W){$=M($),W=M(W);var L=this;L.g=T,L._84O=$,L._85O=W,L._70I=!0,L.F=0,L._83O=$+W,L.pen={x:0,y:0}},Oo="lineDashOffset",kj="setLineDash",af=function($){for(var Z in $)1===Z.length&&(Oo=$[Z]);return Z?1:0},Nl=function(q,S,D){return Cm(S)?q:q[kj]?(q[kj](S),D&&(q.lineDashOffset=D),q):new Ah(q,S[0],S.length>1?S[1]:S[0])},dl=function(t,r){!Cm(r)&&t[kj]&&(t[kj](Ol),t.lineDashOffset=0)};if(Gh(Ah,p,{_69I:6,moveTo:function(s,V){var M=this,O=M.pen;O.x=s,O.y=V,M.g.moveTo(s,V),M.start||(M.start={x:s,y:V})},lineTo:function(w,s){var l=this,J=l.pen,F=w-J.x,m=s-J.y,i=I(m,F),v=t(i),G=e(i),f=l._23O(J.x,J.y,w,s),M=l._85O,Y=l._84O,c=l._83O;if(l.F){if(l.F>f)return l._70I?l._72I(w,s):l.moveTo(w,s),l.F-=f,void 0;if(l._70I?l._72I(J.x+v*l.F,J.y+G*l.F):l.moveTo(J.x+v*l.F,J.y+G*l.F),f-=l.F,l.F=0,l._70I=!l._70I,!f)return}var V=k(f/c);if(V){for(var C=v*Y,r=G*Y,X=v*M,D=G*M,R=0;V>R;R++)l._70I?(l._72I(J.x+C,J.y+r),l.moveTo(J.x+X,J.y+D)):(l.moveTo(J.x+X,J.y+D),l._72I(J.x+C,J.y+r));f-=c*V}l._70I?f>Y?(l._72I(J.x+v*Y,J.y+G*Y),l.moveTo(w,s),l.F=M-(f-Y),l._70I=!1):(l._72I(w,s),f===Y?(l.F=0,l._70I=!l._70I):(l.F=Y-f,l.moveTo(w,s))):f>M?(l.moveTo(J.x+v*M,J.y+G*M),l._72I(w,s),l.F=Y-(f-M),l._70I=!0):(l.moveTo(w,s),f===M?(l.F=0,l._70I=!l._70I):l.F=M-f)},quadraticCurveTo:function(z,Q,s,U){var N,b=this,d=b.pen,J=d.x,e=d.y,E=b._22O(J,e,z,Q,s,U),P=0,p=0,w=b._85O,q=b._84O;if(b.F){if(b.F>E)return b._70I?b._71I(z,Q,s,U):b.moveTo(s,U),b.F-=E,void 0;if(P=b.F/E,N=b._20O(J,e,z,Q,s,U,P),b._70I?b._71I(N[2],N[3],N[4],N[5]):b.moveTo(N[4],N[5]),b.F=0,b._70I=!b._70I,!E)return}var h=E-E*P,$=k(h/b._83O),v=q/E,B=w/E;if($)for(var c=0;$>c;c++)b._70I?(p=P+v,N=b._21O(J,e,z,Q,s,U,P,p),b._71I(N[2],N[3],N[4],N[5]),P=p,p=P+B,N=b._21O(J,e,z,Q,s,U,P,p),b.moveTo(N[4],N[5])):(p=P+B,N=b._21O(J,e,z,Q,s,U,P,p),b.moveTo(N[4],N[5]),P=p,p=P+v,N=b._21O(J,e,z,Q,s,U,P,p),b._71I(N[2],N[3],N[4],N[5])),P=p;h=E-E*P,b._70I?h>q?(p=P+v,N=b._21O(J,e,z,Q,s,U,P,p),b._71I(N[2],N[3],N[4],N[5]),b.moveTo(s,U),b.F=w-(h-q),b._70I=!1):(N=b._19O(J,e,z,Q,s,U,P),b._71I(N[2],N[3],N[4],N[5]),E===q?(b.F=0,b._70I=!b._70I):(b.F=q-h,b.moveTo(s,U))):h>w?(p=P+B,N=b._21O(J,e,z,Q,s,U,P,p),b.moveTo(N[4],N[5]),N=b._19O(J,e,z,Q,s,U,p),b._71I(N[2],N[3],N[4],N[5]),b.F=q-(h-w),b._70I=!0):(b.moveTo(s,U),h===w?(b.F=0,b._70I=!b._70I):b.F=w-h)},bezierCurveTo:function(){var P=arguments;this.pen={x:P[4],y:P[5]},this.g.bezierCurveTo(P[0],P[1],P[2],P[3],P[4],P[5])},arc:function(u,U,P,L,W,o){o||(L=-L,W=-W),$p(this,u,U,L,W-L,P,P,!1)},rect:function(N,g,W,A){var C=this;C.pen={x:N,y:g},C.moveTo(N,g),C.lineTo(N,g+A),C.lineTo(N+W,g+A),C.lineTo(N+W,g),C.lineTo(N,g)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(f,u,Q,J){var H=Q-f,c=J-u;return F(H*H+c*c)},_22O:function(k,n,p,L,q,r,U){for(var T,b,m,W,V,D,R,G=0,f=k,S=n,I=U>0?U:this._69I,t=1;I>=t;t++)m=t/I,W=1-m,V=W*W,D=2*m*W,R=m*m,T=V*k+D*p+R*q,b=V*n+D*L+R*r,G+=this._23O(f,S,T,b),f=T,S=b;return G},_21O:function(S,y,j,P,w,g,d,O){var I=this;if(0===d)return I._20O(S,y,j,P,w,g,O);if(1===O)return I._19O(S,y,j,P,w,g,d);var V=I._20O(S,y,j,P,w,g,O);return V.push(d/O),I._19O.apply(I,V)},_20O:function(Q,e,Y,h,s,f,T){if(1!==T){var w=Y+(s-Y)*T,D=h+(f-h)*T;Y=Q+(Y-Q)*T,h=e+(h-e)*T,s=Y+(w-Y)*T,f=h+(D-h)*T}return[Q,e,Y,h,s,f]},_19O:function(Q,F,z,j,T,D,Y){if(1!==Y){var n=Q+(z-Q)*Y,K=F+(j-F)*Y;z+=(T-z)*Y,j+=(D-j)*Y,Q=n+(z-n)*Y,F=K+(j-K)*Y}return[Q,F,z,j,T,D]},_72I:function(T,S){var z=this.pen;(T!==z.x||S!==z.y)&&(z.x=T,z.y=S,this.g.lineTo(T,S))},_71I:function(v,$,q,x){var i=this.pen;(v!==q||$!==x||q!==i.x||x!==i.y)&&(i.x=q,i.y=x,this.g.quadraticCurveTo(v,$,q,x))}}),h&&P){var yg=P.toString();Y=yg.indexOf(gd.substr(0,2))>0&&yg.indexOf(Jb+Jb.substr(1,1))>1||yg.indexOf(Ac[0]+Yj.substr(0,2)+gd.substr(2,2)+Rj[0]+gd[4])>1?!0:!1}var Aq=f,tg=f,cc=function(q){Aq&&!q._72O&&(tg||(tg={}),tg[q._72O=Rp()]=q)},vb=function(o,r){if(r||(r=o),r&&(Aq||(Aq={}),!Aq[o])){var s=new XMLHttpRequest;if(Aq[r]={request:s,url:r},s.overrideMimeType&&s.overrideMimeType("text/plain"),r=G.beforeLoadURL(r),r.data){var M=G.parse(r.data);lq(o,M),G.handleCompTypeLoaded(o,M)}else s.open("GET",encodeURI(r),!0),s.onload=function(Z){if(200===this.status||0===this.status){var i=G.parse(Z.target.response||Z.target.responseText);lq(o,i),G.handleCompTypeLoaded(o,i)}else lq(o,f)},s.onerror=function(){lq(o,f)},s.send(null)}},lq=function(D,C){if(ds[D]=C,delete Aq[D],Er(Aq)&&(Aq=f,tg)){for(var y in tg){var K=tg[y];K.invalidateAll&&K.invalidateAll(b,"compTypeLoaded",D),K.redraw&&K.redraw(),K.iv(),delete K._72O}tg=f}if(C&&tg)for(var y in tg){var K=tg[y];K.invalidateAll&&K.invalidateAll(b,"compTypeLoading",D),K.redraw&&K.redraw(),K.iv()}},$m=C.chart,de=G.compStack=[],Ik=/^style@/,Bn=/^attr@/,$r=/^field@/,Jg={x:.5,y:.5},Nj=function(w,$,E,i){if(!w)return 0;if(wn(w.fitSize,$,E)&&i)return i;var z=wn(w.width,$,E);return null==z?20:z},od=function(_,y,A,$){if(!_)return 0;if(wn(_.fitSize,y,A)&&$)return $;var I=wn(_.height,y,A);return null==I?20:I},wn=function(A,I,w){if(!A||!A.func)return A;var l,i=A.func,g=A.value;return l=Cr(i)?w&&w.vectorDataBindingDisabled&&!A.isSafeFunc?g:i(I,w):I instanceof yd?Bn.test(i)?I.a(i.slice(5)):Ik.test(i)?I.s(i.slice(6)):$r.test(i)?I[i.slice(6)]:I[i]?I[i](w):g:g,g!==b&&l==f?g:l},ei=G.drawImage=function(){var T,B,K,P,h,M,W=function(V,c){V.getValue&&V.getValue.compType===c||(V.getValue=function(k){var X=O(V,k);if(X===b&&c.properties){var i=c.properties[k];i&&(X=i.defaultValue)}return X},V.getValue.compType=c)},O=function(v,i,L){var c=v[i];return c&&c.func?(c=wn(c,B,K),L&&(c=L(c))):L&&(c=v[i]=L(c)),c},m=function(D,c){var R;if(R=c?O(D,c):D,h&&R){if("override"===M)return h;if("override_rgb"===M){var u=zg(h);return R=Cj(R),"rgba("+k(255*u[0])+","+k(255*u[1])+","+k(255*u[2])+","+R[3]/255+")"}if("override_a"===M){var u=zg(h);return R=Cj(R),"rgba("+R[0]+","+R[1]+","+R[2]+","+u[3]+")"}var u=zg(h);return R=Cj(R),"rgba("+k(R[0]*u[0])+","+k(R[1]*u[1])+","+k(R[2]*u[2])+","+R[3]/255*u[3]+")"}return R},D=function(C){if(te(C)){for(var m=new Ek,S=C.length,z=0;S>z;z+=2)m.add({x:C[z],y:C[z+1]});C=m}return C},p=function(h){var Y=O(h,"anchorX"),B=O(h,"anchorY");if(Y!==b||B!==b)return{x:Y===b?Jg.x:Y,y:B===b?Jg.y:B};var f=O(h,"type"),A=O(h,"name");if("image"!==f||!A)return Jg;var c=fg(A);return c&&c.anchorX!==b&&c.anchorY!==b?{x:c.anchorX,y:c.anchorY}:Jg},i=function(L,n){var e=O(L,Tr),K=p(L);if(te(e)){var F=e.length,f=O(L,"relative"),P=n.width,W=n.height;if(4===F)e={x:e[0],y:e[1],width:e[2],height:e[3]},f?(e.x*=P,e.y*=W,e.width*=P,e.height*=W):n.fitSize&&(e.x*=n.widthScale,e.width*=n.widthScale,e.y*=n.heightScale,e.height*=n.heightScale);else if(3===F){var b=e[0];e={width:e[1],height:e[2]},f?(e.width*=P,e.height*=W):n.fitSize&&(e.width*=n.widthScale,e.height*=n.heightScale),"object"==typeof b?b.length&&(b={x:b[0],y:b[1]}):b=Ll(b,n,e),e.x=b.x-e.width*K.x,e.y=b.y-e.height*K.y}var Y=O(L,"offsetX");Y&&(n.fitSize&&(Y*=n.widthScale),e.x+=Y),Y=O(L,"offsetY"),Y&&(n.fitSize&&(Y*=n.heightScale),e.y+=Y)}return e},Y=function(Q){return te(Q)?new Ek(Q):Q},u=function(a,f,g,U,C,P,t){var k=T.interactiveInfo,V=a.transform;if(V)return T.save(),T.setTransform(V.a,V.b,V.c,V.d,V.tx,V.ty),k&&k.compInfos.push({comp:a,rect:f,matrix:V.clone()}),!0;C===b&&(C=1),P===b&&(P=1);var N=O(a,"clipPercentage"),u=Gm(g,f);if(u&&!U&&1===C&&1===P&&!(1>N))return k&&k.compInfos.push({comp:a,rect:f,matrix:k.matrix.clone()}),!1;t=t||Jg;var q=f.x+f.width*t.x,Z=f.y+f.height*t.y,p=g.x+g.width*t.x,d=g.y+g.height*t.y,j=g.width?C*(f.width/g.width):1,n=g.height?P*(f.height/g.height):1;if(T.save(),k&&(k.matrix.appendTranslate(q,Z).appendRotate(U).appendScale(j,n).appendTranslate(-p,-d),k.compInfos.push({comp:a,rect:f,matrix:k.matrix.clone()})),_h(T,q,Z),Df(T,U||0),ts(T,j,n),_h(T,-p,-d),1>N){0>N&&(N=0);var L=go(g,O(a,"clipDirection"),N);T.beginPath(),T.rect(L.x,L.y,L.width,L.height),T.clip()}return!0},v=function(){T.restore()},z=function(J,w,$){var z=O(J,"path"),x=O(J,zs),r=O(J,"scaleX"),C=O(J,"scaleY"),e=p(J),E=f,H=tn(null,z);if($||($=J.unionRect,$||($=qp(H),J.path.func||(J.unionRect=$)),E=$),$){E||(E=J.unionRect,E||(E=qp(H),J.path.func||(J.unionRect=E)));var y=u(J,$,E,x,r,C,e),F=O(J,"borderPattern"),s=Nl(T,F),q=m(J,"background"),K=m(J,"borderColor"),V=O(J,"borderWidth"),N=O(J,"gradient"),g=m(J,"gradientColor"),k=O(J,"border3d"),l=O(J,"border3dColor"),b=O(J,"border3dAccuracy"),Q=T.lineJoin,S=T.lineCap;if(T.lineJoin=O(J,"borderJoin")||$c,T.lineCap=O(J,"borderCap")||Ob,q?(rf(T,q,N,g,E),tn(T,z),T.fill(),s!==T&&tn(T,z)):tn(T,z),V&&K){var d=O(J,"borderWidthAbsolute");d&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=V,T.strokeStyle=K,T.stroke(),d&&T.restore(),k&&Wd(T,K,l,V,P,b)}if(dl(T,F),O(J,"dash")){var h=O(J,"dashWidth")||V;if(h>0){F=O(J,"dashPattern")||nn;var s=Nl(T,F,O(J,"dashOffset")),X=m(J,"dashColor")||m(oq);s!==T&&tn(T,z),T.strokeStyle=X,T.lineWidth=h,T.stroke(),O(J,"dash3d")&&Wd(T,X,m(J,"dash3dColor"),h,P,O(J,"dash3dAccuracy")),dl(T,F)}}w===Tr&&Lb(T,q,O(J,"depth"),E),T.lineJoin=Q,T.lineCap=S,y&&v()}},C=function(y,N,s,A){var b=O(y,tm,D),r=O(y,zs),o=p(y);if(b&&A.fitSize){var Q=Math.abs(Math.cos(r))<.001,I=new Ek,X=qp(b),d=A.widthScale,g=A.heightScale,$=X.x+o.x*X.width,z=X.y+o.y*X.height,x=$*d,W=z*g;b.each(function(y){var n=y.x-$,w=y.y-z;I.add({x:x+n*(Q?g:d),y:W+w*(Q?d:g)})}),b=I,y.unionRect=null}var l=O(y,"scaleX"),k=O(y,"scaleY"),n=N===pl,_=f;if(!s&&n&&(s=y.unionRect,s||(s=qp(b),y.points.func||(y.unionRect=s)),_=s),s){n?_||(_=y.unionRect,_||(_=qp(b),y.points.func||(y.unionRect=_))):_=s;var H,c,E,q,C=u(y,s,_,r,l,k,o),e=O(y,"borderPattern"),S=Nl(T,e),R=m(y,"background"),i=fg(O(y,"repeatImage"),h,M),a=O(y,"gradientPack"),V=m(y,"borderColor"),w=O(y,"borderWidth"),G=O(y,"segments",Y),Z=O(y,"gradient"),L=m(y,"gradientColor"),t=O(y,"border3d"),U=O(y,"border3dColor"),J=O(y,"border3dAccuracy"),j=O(y,"closePath"),F=O(y,"fillRule")||"nonzero",ts=T.lineJoin,Do=T.lineCap;if(T.lineJoin=O(y,"borderJoin")||$c,T.lineCap=O(y,"borderCap")||Ob,n)if(R||i||a){var bf=O(y,"fillClipPercentage");if(1>bf){0>bf&&(bf=0);var ac=go(_,O(y,"fillClipDirection"),bf);T.save(),T.beginPath(),T.rect(ac.x,ac.y,ac.width,ac.height),T.clip()}if(ih(T,b,G,j),a)Se(T,a);else if(i){var Xg=T,qo=h,Kj=M;Vn(T,i,h,M,B,K),T=Xg,h=qo,M=Kj}else{var Xg=T;rf(T,R,Z,L,_),T=Xg}T.fill(F),1>bf&&T.restore(),a&&T.restore(),S!==T&&ih(S,b,G,j)}else ih(S,b,G,j);else if("roundRect"===N?H=O(y,"cornerRadius"):"polygon"===N?H=O(y,"polygonSide"):"arc"===N&&(H=O(y,"arcFrom"),c=O(y,"arcTo"),E=O(y,"arcClose"),q=O(y,"arcOval")),R||i||a){var bf=O(y,"fillClipPercentage");if(1>bf){0>bf&&(bf=0);var ac=go(_,O(y,"fillClipDirection"),bf);T.save(),T.beginPath(),T.rect(ac.x,ac.y,ac.width,ac.height),T.clip()}if(rm(T,N,_,H,c,E,q),a)Se(T,a);else if(i){var Xg=T,qo=h,Kj=M;Vn(T,i,h,M,B,K),T=Xg,h=qo,M=Kj}else rf(T,R,Z,L,_);T.fill(F),1>bf&&T.restore(),a&&T.restore(),T!==S&&rm(S,N,_,H,c,E,q)}else rm(S,N,_,H,c,E,q);if(w&&V){var ke=O(y,"borderWidthAbsolute");ke&&(T.save(),T.setTransform(1,0,0,1,0,0)),T.lineWidth=w,T.strokeStyle=V,T.stroke(),ke&&T.restore(),t&&Wd(T,V,U,w,P,J)}if(dl(T,e),O(y,"dash")){var tj=O(y,"dashWidth")||w;if(tj>0){e=O(y,"dashPattern")||nn;var S=Nl(T,e,O(y,"dashOffset")),Jb=m(y,"dashColor")||m(oq);S!==T&&(n?ih(S,b,G,j):rm(S,N,_,H,c,E,q)),T.strokeStyle=Jb,T.lineWidth=tj,T.stroke(),O(y,"dash3d")&&Wd(T,Jb,m(y,"dash3dColor"),tj,P,O(y,"dash3dAccuracy")),dl(T,e)}}N===Tr&&Lb(T,R,O(y,"depth"),_),T.lineJoin=ts,T.lineCap=Do,C&&v()}},R=function(e,x){var p=h,o=M,F=h||O(e,Ad),W=M||O(e,"blendMode"),k=fg(O(e,"name"),F,W);k&&(Do(T,k,O(e,"stretch"),x.x,x.y,x.width,x.height,B,K,F,null,W),h=p,M=o)},l=function(B,C){var R=O(B,"text");R!=f&&Th(T,R,O(B,"font"),m(B,Ad),C.x,C.y,C.width,C.height,O(B,"align"),O(B,"vAlign"))},j=function(p,a){me(T,m(p,Ad),a.x,a.y,a.width,a.height,O(p,"width"))},F=function(J,E){var N=O(J,eg),k=0;if(N&&(N.forEach(function(l){k+=l}),k>0)){for(var x=O(J,"colors")||$m,Y=O(J,"startAngle")||0,L=O(J,"hollow"),w=O(J,Sp),o=O(J,Xd),Q=O(J,Wb),q=w?new Ek:f,s=E.x,$=E.y,g=E.width,R=E.height,z=s+g/2,d=$+R/2,X=S(g,R)/2,b=0,j=0;j<N.length;j++){var W=N[j],Z=U*W/k,_=Y+Z;if(T.fillStyle=x[b++],b===x.length&&(b=0),T.beginPath(),L){var V=z+t(Y)*X/2,H=d+e(Y)*X/2,F=z+t(_)*X,i=d+e(_)*X;T.moveTo(V,H),T.arc(z,d,X/2,Y,_,!1),T.lineTo(F,i),T.arc(z,d,X,_,Y,!0)}else T.moveTo(z,d),T.arc(z,d,X,_,Y,!0);q&&(Z=(Y+_)/2,q.add({text:Cr(w)?w(W,j,k,B):W,x:z+.75*t(Z)*X,y:d+.75*e(Z)*X})),T.closePath(),T.fill(),Y=_}q&&q.each(function(j){Th(T,j.text,o,Q,j.x,j.y,0,0,bj)})}},r=function(K,d){var l=O(K,fl);if(l&&l.length>0){var N=l.length,t=O(K,Sp),q=O(K,Xd),u=O(K,Wb),x=t?new Ek:f,j=O(K,"minValue")||0,v=O(K,"maxValue");if(v==f&&(v=0,l.forEach(function(X){O(X,eg).forEach(function(y){v=o(v,y)})})),j===v)return;for(var b=d.height/(v-j),z=d.y+v*b,A=O(l[0],eg).length,V=d.width/(3*A+1),n=2*V/N,e=0,D=0;N>D;D++)for(var $=l[D],L=O($,Ad),y=O($,"colors"),W=O($,eg),I=0;A>I;I++){y?T.fillStyle=y[I]:L?T.fillStyle=L:(T.fillStyle=$m[e++],e===$m.length&&(e=0));var G=W[I],E=G*b,k=d.x+(1+3*I)*V+D*n;if(tj(T,k,z-E,n,E),x){var g=Cr(t)?t(G,I,$,B):G,R=kn(q,g).height;x.add({x:k,y:z-E-R,width:n,height:R,text:g})}}x&&x.each(function(A){Th(T,A.text,q,u,A.x,A.y,A.width,A.height,bj)})}},H=function(h,D){var G=O(h,fl);if(G&&G.length>0){var I=G.length,H=O(G[0],eg).length,L=D.width/(3*H+1),j=0,p=O(h,"maxValue"),K=O(h,Sp),e=O(h,Xd),b=O(h,Wb),M=K?new Ek:f;if(p==f){p=0;for(var X=0;H>X;X++){for(var d=0,y=0;I>y;y++)d+=O(G[y],eg)[X];p=o(p,d)}}if(p>0){for(var X=0;H>X;X++)for(var C=D.y+D.height,y=0;I>y;y++){var F=G[y],g=O(F,Ad),q=O(F,eg)[X],S=q/p*D.height;g?T.fillStyle=g:(T.fillStyle=$m[j++],j===$m.length&&(j=0)),C-=S;var s={x:D.x+(1+3*X)*L,y:C,width:2*L,height:S};tj(T,s.x,s.y,s.width,s.height),M&&(s.text=Cr(K)?K(q,X,F,B):q,M.add(s))}M&&M.each(function(q){Th(T,q.text,e,b,q.x,q.y,q.width,q.height,bj)})}}},d=function(F,K){var G=O(F,fl);if(G&&G.length>0){for(var s=G.length,N=O(G[0],eg).length,Q=K.width/(3*N+1),n=0,L=O(F,Sp),c=O(F,Xd),q=O(F,Wb),i=L?new Ek:f,W=0;N>W;W++){for(var g=0,Y=0;s>Y;Y++)g+=O(G[Y],eg)[W];if(g>0){var o=K.y+K.height;for(Y=0;s>Y;Y++){var H=G[Y],r=O(H,Ad),x=O(H,eg)[W],y=x/g*K.height;r?T.fillStyle=r:(T.fillStyle=$m[n++],n===$m.length&&(n=0)),o-=y;var b={x:K.x+(1+3*W)*Q,y:o,width:2*Q,height:y};tj(T,b.x,b.y,b.width,b.height),i&&(b.text=Cr(L)?L(x,W,H,B):x,i.add(b))}}}i&&i.each(function(h){Th(T,h.text,c,q,h.x,h.y,h.width,h.height,bj)})}},Z=function(H,F){var S=O(H,fl);if(S&&S.length>0){var Z=S.length,M=O(H,"minValue")||0,t=O(H,"maxValue");if(t==f&&(t=0,S.forEach(function(Q){O(Q,eg).forEach(function(b){t=o(t,b)})})),M===t)return;for(var X=F.height/(t-M),u=F.y+t*X,Q=O(S[0],eg).length,w=F.width/(3*Q+1),G=0,r=O(H,"lineWidth")||2,g=O(H,"line3d"),C=O(H,"linePoint"),s=O(H,Sp),d=O(H,Xd),p=O(H,Wb),h=0;Z>h;h++){var I=S[h],l=O(I,Ad),E=O(I,eg);l?T.strokeStyle=l:(l=T.strokeStyle=$m[G++],G===$m.length&&(G=0)),T.beginPath();for(var x=0;Q>x;x++){var b=F.x+(2+3*x)*w,e=u-E[x]*X;0===x?T.moveTo(b,e):T.lineTo(b,e)}if(T.lineWidth=r,T.stroke(),g&&Wd(T,l,f,r,P),C||s){var $,v=r/2+2;for(x=0;Q>x;x++){var _=E[x];if(b=F.x+(2+3*x)*w,e=u-_*X,Cr(C)?C(T,b,e,l,x,I,B):C&&(T.fillStyle=l,T.beginPath(),T.arc(b,e,v,0,U,!0),T.fill()),Cr(s)?$=s(_,x,I,B):s&&($=_),$){var W=kn(d,$).height,y=T.shadowBlur;if(y){var J=T.shadowOffsetX,a=T.shadowOffsetY,z=T.shadowColor;T.shadowOffsetX=0,T.shadowOffsetY=0,T.shadowBlur=0,T.shadowColor=f}Th(T,$,d,p,b,e-W-v+2,0,W,bj),y&&(T.shadowOffsetX=J,T.shadowOffsetY=a,T.shadowBlur=y,T.shadowColor=z)}}}}}},c={border:j,image:R,text:l,pieChart:F,columnChart:r,stackedColumnChart:H,percentageColumnChart:d,lineChart:Z};return function(l,L,y,s,X,d,U,x,F,J){if(L&&X&&d){T=l,B=U,K=x,P=K?K._zoom?K._zoom:1:1,h=F,M=J;var q=X,j=d;if(mk()){var H,R,t;0===T[Xo]?mk[0]&&(H=!0):H=!0,T.texureImage2D?mk[1]&&(R=!0):R=!0,T.texureImage3D?mk[2]&&(t=!0):t=!0,H&&R&&t&&(q=y,j=s)}if(L.tagName)return cr(a)&&!N[a]||T.drawImage(L,q,j,X,d),void 0;if(O(L,"visible")!==!1){h||(h=wn(L.color,B,K)),J||(M=wn(L.blendMode,B,K)),cr(a)&&!N[a]&&(X=q,d=j);var g=Nj(L,B,K,X),r=od(L,B,K,d),n={x:0,y:0,width:g,height:r,fitSize:O(L,"fitSize")},S=O(L,"clip"),o=O(L,"opacity");if(n.fitSize&&(n.widthScale=g/wn(L.width,B,K),n.heightScale=r/wn(L.height,B,K)),T.save(),T.interactiveInfo){var A=T.interactiveInfo.matrix,e=A.clone();A.appendTranslate(q,j).appendScale(X/g,d/r)}_h(T,q,j),(g!==X||r!==d)&&T.scale(X/g,d/r),S&&(Cr(S)?S(T,g,r,B,K,L):(T.beginPath(),T.rect(0,0,g,r),T.clip())),o!=f&&(T.globalAlpha*=o),O(L,"comps").forEach(function(q){if(O(q,Mb)!==!1){if(de.splice(0,0,q),T.interactiveInfo)var d=T.interactiveInfo.matrix.clone();var e=O(q,"opacity"),R=O(q,"shadow"),s=O(q,"type"),L=i(q,n);if(e!=f){var Q=T.globalAlpha;T.globalAlpha*=e}if(R){var r=T.shadowOffsetX,Z=T.shadowOffsetY,l=T.shadowBlur,F=T.shadowColor,I=O(q,"shadowOffsetX"),H=O(q,"shadowOffsetY"),t=O(q,"shadowBlur"),g=m(q,"shadowColor");T.shadowOffsetX=(I==f?3:I)*P,T.shadowOffsetY=(H==f?3:H)*P,T.shadowBlur=(t==f?6:t)*P,T.shadowColor=g||m($j)}if("save"===s)T.save();else if("endClip"===s||"restore"===s)T.restore();else if("clip"===s)T.save(),ih(T,O(q,"points",D),O(q,"segments",Y),!0),T.clip();else if(Fk[s])L=L||{x:0,y:0,width:n.width,height:n.height},C(q,s,L,n);else if(s===pl)C(q,s,L,n);else if("SVGPath"===s)z(q,s,L);else{L=L||{x:0,y:0,width:n.width,height:n.height};var N=O(q,zs),j=O(q,"scaleX"),U=O(q,"scaleY"),x=p(q),X=u(q,L,L,N,j,U,x);if(Cr(s))W(q,s),G.drawCompType(s,T,L,q,B,K);else if(G.getCompType(s)){var o=G.getCompType(s),k=o.func||o;W(q,o),G.drawCompType(k,T,L,q,B,K)}else c[s]?c[s](q,L):G.getCompType(s)===b&&Fo.test(s)&&vb(s);X&&v()}R&&(T.shadowOffsetX=r,T.shadowOffsetY=Z,T.shadowBlur=l,T.shadowColor=F),e!=f&&(T.globalAlpha=Q),T.interactiveInfo&&(T.interactiveInfo.matrix=d),de.splice(0,1)}}),T.interactiveInfo&&(T.interactiveInfo.matrix=e),T.restore()}}}}();G.getCurrentComp=function(){return de[0]},G.getParentComp=function(){return de[1]},G.getInternal=function(){return{isEnter:kf,isEsc:Xf,isSpace:Lp,isLeft:gh,isUp:Um,isRight:Tg,isDown:Xb,addMethod:dd,superCall:gm,toPointsArray:Uj,translateAndScale:Dp,appendArray:nf,createWorldMatrix:ak,vec3TransformMat4:wd,setCanvas:ur,createDiv:wk,createView:Yk,createCanvas:Rc,createImage:On,initContext:Gi,layout:pn,fillRect:tj,Mat:pd,drawBorder:me,isString:cr,setBorder:kk,getPropertyValue:Ck,setPropertyValue:Wi,drawVerticalLine:Vk,draw3DRect:Lb,getPinchDist:ul,isSameRect:Gm,getPosition:Ll,intersectionLineRect:Ag,getNodeRect:cq,getEdgeAgentPosition:nr,getImageWidth:Nj,getImageHeight:od,initItemElement:Kj,drawPoints:ih,createG2:Nl,closePopup:Pg,isH:Pk,createAnim:ls,createNormalMatrix:Fn,createNormals:$l,toFloatArray:qn,glMV:Mg,batchShape:Je,createNodeMatrix:cl,getFaceInfo:rb,transformAppend:Vh,drawFaceInfo:em,to3dPointsArray:Kc,setGLDebugMode:function(H){ql=H},cube:function(){return{vs:Xi,is:Gc,uv:Pn}},ui:function(){return{DataUI:mg,NodeUI:qf,EdgeUI:Ue,GroupUI:sk,ShapeUI:Ef,GridUI:pm,Data3dUI:Yr,Node3dUI:Nd,Shape3dUI:Tc}},getInternalVersion:function(){return"U2FsdGVkX189fsKx29eGlTiWXgMUQroTJziq2MCB0Nc="},getDragger:function(){return Ab},addMSMap:function(D){dd(fr,D)},k:R}},function(A){function m(b,g){b!=f&&(g==f&&Jh!=typeof b?this._54O(b,256):this._54O(b,g))}function L(){return new m(f)}function O(M,Z,j,J,p,S){for(;--S>=0;){var O=Z*this[M++]+j[J]+p;p=k(O/67108864),j[J++]=67108863&O}return p}function C($,f,F,B,P,u){for(var h=32767&f,s=f>>15;--u>=0;){var a=32767&this[$],M=this[$++]>>15,H=s*a+M*h;a=h*a+((32767&H)<<15)+F[B]+(1073741823&P),P=(a>>>30)+(H>>>15)+s*M+(P>>>30),F[B++]=1073741823&a}return P}function G(s,U,m,c,M,u){for(var $=16383&U,A=U>>14;--u>=0;){var L=16383&this[s],P=this[s++]>>14,E=A*L+P*$;L=$*L+((16383&E)<<14)+m[c]+M,M=(L>>28)+(E>>14)+A*P,m[c++]=268435455&L}return M}function V(y){return In.charAt(y)}function v(k,s){var l=vk[k.charCodeAt(s)];return l==f?-1:l}function $(s){for(var E=this.t-1;E>=0;--E)s[E]=this[E];s.t=this.t,s.s=this.s}function N(V){this.t=1,this.s=0>V?-1:0,V>0?this[0]=V:-1>V?this[0]=V+this.DV:this.t=0}function P(l){var K=L();return K._58O(l),K}function J(X,a){var u,D=this;if(16==a)u=4;else if(8==a)u=3;else if(256==a)u=8;else if(2==a)u=1;else if(32==a)u=5;else{if(4!=a)return D.fromRadix(X,a),void 0;u=2}D.t=0,D.s=0;for(var b=X.length,z=!1,R=0;--b>=0;){var T=8==u?255&X[b]:v(X,b);0>T?"-"==X.charAt(b)&&(z=!0):(z=!1,0==R?D[D.t++]=T:R+u>D.DB?(D[D.t-1]|=(T&(1<<D.DB-R)-1)<<R,D[D.t++]=T>>D.DB-R):D[D.t-1]|=T<<R,R+=u,R>=D.DB&&(R-=D.DB))}8==u&&0!=(128&X[0])&&(D.s=-1,R>0&&(D[D.t-1]|=(1<<D.DB-R)-1<<R)),D._57O(),z&&m.ZERO._78O(D,D)}function X(){for(var X=this,L=X.s&X.DM;X.t>0&&X[X.t-1]==L;)--X.t}function y(W){var F=this;if(F.s<0)return"-"+F._85O()[Xj](W);var v;if(16==W)v=4;else if(8==W)v=3;else if(2==W)v=1;else if(32==W)v=5;else{if(4!=W)return F.toRadix(W);v=2}var o,m=(1<<v)-1,Q=!1,e="",J=F.t,S=F.DB-J*F.DB%v;if(J-->0)for(S<F.DB&&(o=F[J]>>S)>0&&(Q=!0,e=V(o));J>=0;)v>S?(o=(F[J]&(1<<S)-1)<<v-S,o|=F[--J]>>(S+=F.DB-v)):(o=F[J]>>(S-=v)&m,0>=S&&(S+=F.DB,--J)),o>0&&(Q=!0),Q&&(e+=V(o));return Q?e:"0"}function D(){var x=L();return m.ZERO._78O(this,x),x}function n(){return this.s<0?this._85O():this}function l(f){var s=this,q=s.s-f.s;if(0!=q)return q;var z=s.t;if(q=z-f.t,0!=q)return s.s<0?-q:q;for(;--z>=0;)if(0!=(q=s[z]-f[z]))return q;return 0}function d(M){var e,u=1;return 0!=(e=M>>>16)&&(M=e,u+=16),0!=(e=M>>8)&&(M=e,u+=8),0!=(e=M>>4)&&(M=e,u+=4),0!=(e=M>>2)&&(M=e,u+=2),0!=(e=M>>1)&&(M=e,u+=1),u}function b(){var R=this;return R.t<=0?0:R.DB*(R.t-1)+d(R[R.t-1]^R.s&R.DM)}function _(k,I){var o;for(o=this.t-1;o>=0;--o)I[o+k]=this[o];for(o=k-1;o>=0;--o)I[o]=0;I.t=this.t+k,I.s=this.s}function h(X,L){for(var b=X;b<this.t;++b)L[b-X]=this[b];L.t=o(this.t-X,0),L.s=this.s}function q(V,f){var y,I=this,$=V%I.DB,G=I.DB-$,S=(1<<G)-1,x=k(V/I.DB),X=I.s<<$&I.DM;for(y=I.t-1;y>=0;--y)f[y+x+1]=I[y]>>G|X,X=(I[y]&S)<<$;for(y=x-1;y>=0;--y)f[y]=0;f[x]=X,f.t=I.t+x+1,f.s=I.s,f._57O()}function g(b,a){var t=this;a.s=t.s;var u=k(b/t.DB);if(u>=t.t)return a.t=0,void 0;var H=b%t.DB,Y=t.DB-H,D=(1<<H)-1;a[0]=t[u]>>H;for(var q=u+1;q<t.t;++q)a[q-u-1]|=(t[q]&D)<<Y,a[q-u]=t[q]>>H;H>0&&(a[t.t-u-1]|=(t.s&D)<<Y),a.t=t.t-u,a._57O()}function T(A,G){for(var B=this,f=0,m=0,t=S(A.t,B.t);t>f;)m+=B[f]-A[f],G[f++]=m&B.DM,m>>=B.DB;if(A.t<B.t){for(m-=A.s;f<B.t;)m+=B[f],G[f++]=m&B.DM,m>>=B.DB;m+=B.s}else{for(m+=B.s;f<A.t;)m-=A[f],G[f++]=m&B.DM,m>>=B.DB;m-=A.s}G.s=0>m?-1:0,-1>m?G[f++]=B.DV+m:m>0&&(G[f++]=m),G.t=f,G._57O()}function i(K,r){var D=this.abs(),y=K.abs(),g=D.t;for(r.t=g+y.t;--g>=0;)r[g]=0;for(g=0;g<y.t;++g)r[g+D.t]=D.am(0,y[g],r,g,0,D.t);r.s=0,r._57O(),this.s!=K.s&&m.ZERO._78O(r,r)}function s(s){for(var T=this.abs(),j=s.t=2*T.t;--j>=0;)s[j]=0;for(j=0;j<T.t-1;++j){var N=T.am(j,T[j],s,2*j,0,1);(s[j+T.t]+=T.am(j+1,2*T[j],s,2*j+1,N,T.t-j-1))>=T.DV&&(s[j+T.t]-=T.DV,s[j+T.t+1]=1)}s.t>0&&(s[s.t-1]+=T.am(j,T[j],s,2*j,0,1)),s.s=0,s._57O()}function I(y,c,$){var X=y.abs(),A=this;if(!(X.t<=0)){var h=A.abs();if(h.t<X.t)return c!=f&&c._58O(0),$!=f&&A._77O($),void 0;$==f&&($=L());var Y=L(),H=A.s,r=y.s,i=A.DB-d(X[X.t-1]);i>0?(X._44O(i,Y),h._44O(i,$)):(X._77O(Y),h._77O($));var x=Y.t,C=Y[x-1];if(0!=C){var p=C*(1<<A.F1)+(x>1?Y[x-2]>>A.F2:0),g=A.FV/p,o=(1<<A.F1)/p,P=1<<A.F2,G=$.t,e=G-x,N=c==f?L():c;for(Y._59O(e,N),$._52O(N)>=0&&($[$.t++]=1,$._78O(N,$)),m.ONE._59O(x,N),N._78O(Y,Y);Y.t<x;)Y[Y.t++]=0;for(;--e>=0;){var O=$[--G]==C?A.DM:k($[G]*g+($[G-1]+P)*o);if(($[G]+=Y.am(0,O,$,e,0,x))<O)for(Y._59O(e,N),$._78O(N,$);$[G]<--O;)$._78O(N,$)}c!=f&&($._45O(x,c),H!=r&&m.ZERO._78O(c,c)),$.t=x,$._57O(),i>0&&$._46O(i,$),0>H&&m.ZERO._78O($,$)}}}function a(P){var A=L();return this.abs()._49O(P,f,A),this.s<0&&A._52O(m.ZERO)>0&&P._78O(A,A),A}function x(k){this.m=k}function w(M){return M.s<0||M._52O(this.m)>=0?M.mod(this.m):M}function j(R){return R}function p(g){g._49O(this.m,f,g)}function Q(Y,I,o){Y._47O(I,o),this._74O(o)}function H(J,F){J._48O(F),this._74O(F)}function u(){if(this.t<1)return 0;var n=this[0];if(0==(1&n))return 0;var a=3&n;return a=15&a*(2-(15&n)*a),a=255&a*(2-(255&n)*a),a=65535&a*(2-(65535&(65535&n)*a)),a=a*(2-n*a%this.DV)%this.DV,a>0?this.DV-a:-a
}function K(a){var u=this;u.m=a,u.mp=a._50O(),u.mpl=32767&u.mp,u.mph=u.mp>>15,u.um=(1<<a.DB-15)-1,u.mt2=2*a.t}function z(T){var O=L();return T.abs()._59O(this.m.t,O),O._49O(this.m,f,O),T.s<0&&O._52O(m.ZERO)>0&&this.m._78O(O,O),O}function c(z){var j=L();return z._77O(j),this._74O(j),j}function Y(h){for(var I=this;h.t<=I.mt2;)h[h.t++]=0;for(var X=0;X<I.m.t;++X){var s=32767&h[X],e=s*I.mpl+((s*I.mph+(h[X]>>15)*I.mpl&I.um)<<15)&h.DM;for(s=X+I.m.t,h[s]+=I.m.am(0,e,h,X,0,I.m.t);h[s]>=h.DV;)h[s]-=h.DV,h[++s]++}h._57O(),h._45O(I.m.t,h),h._52O(I.m)>=0&&h._78O(I.m,h)}function hd($,N){$._48O(N),this._74O(N)}function Wl(G,$,N){G._47O($,N),this._74O(N)}function rc(){return 0==(this.t>0?1&this[0]:this.s)}function lq(b,s){if(b>4294967295||1>b)return m.ONE;var U=L(),t=L(),g=s._73O(this),k=d(b)-1;for(g._77O(U);--k>=0;)if(s._76O(U,t),(b&1<<k)>0)s._75O(t,g,U);else{var r=U;U=t,t=r}return s.revert(U)}function wq(y,S){var F;return F=256>y||S._51O()?new x(S):new K(S),this.exp(y,F)}function pi(){var i=this;if(i.s<0){if(1==i.t)return i[0]-i.DV;if(0==i.t)return-1}else{if(1==i.t)return i[0];if(0==i.t)return 0}return(i[1]&(1<<32-i.DB)-1)<<i.DB|i[0]}function _i(J,B){return new m(J,B)}function Vr(){var o=this;o.n=f,o.e=0,o.d=f,o.p=f,o.q=f,o.dmp1=f,o.dmq1=f,o._10A=f}function Ro(G){return G._53O(this.e,this.n)}function pg(T){var p,h,Z,e="",M=0;for(p=0;p<T.length&&T.charAt(p)!=Oi;++p)Z=yo.indexOf(T.charAt(p)),0>Z||(0==M?(e+=V(Z>>2),h=3&Z,M=1):1==M?(e+=V(h<<2|Z>>4),h=15&Z,M=2):2==M?(e+=V(h),e+=V(Z>>2),h=3&Z,M=3):(e+=V(h<<2|Z>>4),e+=V(15&Z),M=0));return 1==M&&(e+=V(h<<2)),e}function Ei(L){var y=L.split(""),E=pg(L);return y.forEach(function(u){var G=u.length;G>0&&E&&(bo+=M(u))}),E}function qd(o,j){var B=zb._4O.Util._56O(o,"ss"),A={},H=0;return A.v=B==j,A.t=1,A.s=0>H?-1:0,Oc=A.v,H>0?A[0]=H:-1>H?A[0]=H+A.DV:A.t=0,[B,A]}function Ln(w){var R=38,c=w.substring(0,R);if(c&&30==c.indexOf("05000420")){var f=["ss",w.substring(R)];return f}return[]}function yg(V,n){n=n.replace(ho,""),n=n.replace(/[ \n]+/g,"");var K=_i(n,16);if(K._55O()>this.n._55O())return 0;var l=this._37O(K),y=l[Xj](16).replace(/^1f+00/,""),g=Ln(y);if(0==g.length)return!1;for(var S,P,N,J=.5,j=Yp,X=[0,.5,.75,.875,.9375],Z=[],O=[],T=[],Q=U/j,d=g[1],R=qd(V,d)[0],$=0,q=0;$<X.length;$++){var W=0===$%2?0:.5;for(S=0;j>=S;S++)P=(S+W)*Q,N=1-X[$],Z.push(t(P)*J*N,-J+2*X[$]*J,-e(P)*J*N),O.push((S+W)/j,N)}for($=0;$<X.length-1;$++){var r=$*(j+1),F=($+1)*(j+1);for(S=0;j>S;S++)T.push(r+S,F+S+1,F+S,r+S,r+S+1,F+S+1)}return T.forEach(function(R){q+=R}),d==R&&q>10}var Cn,Jq=0xdeadbeefcafe,Aj=15715070==(16777215&Jq),Xj="toString",qj="",Ag="nat",id=function(){};B=A["D"+11182[Xj](Z(2,5))];var hh=m.prototype;xe+=Yc.substr(0,1);var Yq=A.navigator?A.navigator.appName:"";Aj&&"Microsoft Internet Explorer"==Yq?(hh.am=C,Cn=30):Aj&&"Netscape"!=Yq?(hh.am=O,Cn=26):(hh.am=G,Cn=28),hh.DB=Cn,hh.DM=(1<<Cn)-1,hh.DV=1<<Cn;var De=52;hh.FV=Z(2,De),hh.F1=De-Cn,hh.F2=2*Cn-De;var uk,Gm,In="0123456789abcdefghijklmnopqrstuvwxyz",vk=[],es=function($){return String.fromCharCode($)};for(uk="0".charCodeAt(0),Gm=0;9>=Gm;++Gm)vk[uk++]=Gm;for(uk="a".charCodeAt(0),Gm=10;36>Gm;++Gm)vk[uk++]=Gm;for(uk="A".charCodeAt(0),Gm=10;36>Gm;++Gm)vk[uk++]=Gm;var qm=x.prototype;qm._73O=w,qm.revert=j,qm._74O=p,qm._75O=Q,qm._76O=H;var Qk=K.prototype;Qk._73O=z,Qk.revert=c,Qk._74O=Y,Qk._75O=Wl,Qk._76O=hd,hh._77O=$,hh._58O=N,hh._54O=J,hh._57O=X,hh._59O=_,hh._45O=h,hh._44O=q,hh._46O=g,hh._78O=T,hh._47O=i,hh._48O=s,hh._49O=I,hh._50O=u,hh._51O=rc,hh.exp=lq,hh.toString=y,hh._85O=D,hh.abs=n,hh._52O=l,hh._55O=b,hh.mod=a,hh._53O=wq,m.ZERO=P(0),m.ONE=P(1),hh._86O=pi;var Rf=function(u,D){var z=this;z.isPublic=!0,typeof u!==Jh?(z.n=u,z.e=D):u!=f&&D!=f&&u.length>0&&D.length>0&&(z.n=_i(u,16),z.e=M(D,16))};uc=function(){var g,N,x=Ei(Oe),z=x.substr(0,4),c=x.substr(4,2),J=x.substr(6,2),v=1,M=!v,h=R,l=[],e=vi.charAt(7);if(B&&(B[Xj]().indexOf(Ag)<0||B[xe][Xj]().indexOf(Ag)<0||!x?g=Nh($n[e]):(x=new B(z-0,c-v,J-0),N=x.setHours(9),B[xe]()>N?g=Nh($n[e]):M=!0)),x&&g&&h){for(var Z in g)l.push(Z);var D,Q=0,S=g[l[Q++]],E=g[l[Q++]],I=g[l[Q++]],y=g[l[Q++]],j=g[l[Q++]],$=g[l[Q++]],q=g[l[Q++]],O=Je._27O(h);if(O&&q){D=S+E+I+y+j+$;var n=!$||$===rq;if(!n&&$)for(var U,K=0,a=$.length;a>K;K++)$[K]===jf[Q]?U===rq?n=!0:U=f:(U==f?U=$[K]:U+=$[K],K===a-1&&U===rq&&(n=!0));D&&O._31O(D,q)&&n&&(!j||B[xe]()<j)&&(M=!0)}}return M||(rm=Cm),e};var Un=Vr.prototype;Un._37O=Ro,Un._38O=Rf;var yo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Oi="=",$c=25,ln=10,Oe="IBgHAQ==",Dm=Dm||function(N,y){var t={},P=t._7A={},d=P._6A=function(){function x(){}return{_80O:function(t){x.prototype=this;var Q=new x;return t&&Q._5A(t),Q.hasOwnProperty("_82O")||(Q._82O=function(){Q.$super._82O.apply(this,arguments)}),Q._82O.prototype=Q,Q.$super=this,Q},_3A:function(){var J=this._80O();return J._82O.apply(J,arguments),J},_82O:function(){},_5A:function(g){for(var t in g)g.hasOwnProperty(t)&&(this[t]=g[t]);g.hasOwnProperty(Xj)&&(this.toString=g.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),m=P._39O=d._80O({_82O:function(I,Q){I=this._84O=I||[],this._65O=Q!=y?Q:4*I.length},toString:function(B){return(B||f).stringify(this)},_89O:function(s){var B=this._84O,c=s._84O,m=this._65O,p=s._65O;if(this._57O(),m%4)for(var S=0;p>S;S++){var i=255&c[S>>>2]>>>24-8*(S%4);B[m+S>>>2]|=i<<24-8*((m+S)%4)}else if(c.length>65535)for(var S=0;p>S;S+=4)B[m+S>>>2]=c[S>>>2];else B.push.apply(B,c);return this._65O+=p,this},_57O:function(){var d=this._84O,i=this._65O;d[i>>>2]&=4294967295<<32-8*(i%4),d.length=W(i/4)},_88O:function(){var S=d._88O.call(this);return S._84O=this._84O.slice(0),S},_87O:function(S){for(var o=[],x=0;S>x;x+=4)o.push(0|4294967296*E);return new m._82O(o,S)}}),j=t._2A={},f=j._69O={stringify:function(i){var q,h=i._84O,$=i._65O,T=[];for(q=0;$>q;q++){var X=255&h[q>>>2]>>>24-8*(q%4);T.push((X>>>4).toString(16)),T.push((15&X).toString(16))}return T.join("")},_68O:function(Y){for(var l=Y.length,j=[],Q=0;l>Q;Q+=2)j[Q>>>3]|=M(Y.substr(Q,2),16)<<24-4*(Q%8);return new m._82O(j,l/2)}},L=j._8A={stringify:function(i){var T,E=i._84O,G=i._65O,$=[];for(T=0;G>T;T++){var F=255&E[T>>>2]>>>24-8*(T%4);$.push(es(F))}return $.join("")},_68O:function(Q){var p,x=Q.length,C=[];for(p=0;x>p;p++)C[p>>>2]|=(255&Q.charCodeAt(p))<<24-8*(p%4);return new m._82O(C,x)}},n=j._9A={stringify:function(X){try{return decodeURIComponent(escape(L.stringify(X)))}catch(r){throw new Error("")}},_68O:function(J){return L._68O(unescape(encodeURIComponent(J)))}},l=P._32O=d._80O({_1A:function(){this._83O=new m._82O,this._23O=0},_33O:function(P){typeof P==Jh&&(P=n._68O(P)),this._83O._89O(P),this._23O+=P._65O},_25O:function(F){var l=this._83O,U=l._84O,c=l._65O,D=this._79O,X=4*D,E=c/X;E=F?W(E):o((0|E)-this._22O,0);var M=E*D,f=S(4*M,c);if(M){for(var w=0;M>w;w+=D)this._20O(U,w);var O=U.splice(0,M);l._65O-=f}return new m._82O(O,f)},_88O:function(){var T=d._88O.call(this);return T._83O=this._83O._88O(),T},_22O:0});P._66O=l._80O({cfg:d._80O(),_82O:function(q){this.cfg=this.cfg._80O(q),this._1A()},_1A:function(){l._1A.call(this),this._34O()},_81O:function(a){return this._33O(a),this._25O(),this},_72O:function(z){z&&this._33O(z);var E=this._21O();return E},_79O:16,_26O:function(w){return function(h,b){return new w._82O(b)._72O(h)}},_19O:function(W){return function(C,e){return new g._71O._82O(W,e)._72O(C)}}});var g=t._67O={};return t}();!function(){var X=Dm,z=X._7A,j=z._39O,n=z._66O,G=X._67O,T=[],y=[];!function(){function U(Z){for(var O=F(Z),i=2;O>=i;i++)if(!(Z%i))return!1;return!0}function n(H){return 0|4294967296*(H-(0|H))}for(var u=2,H=0;64>H;)U(u)&&(8>H&&(T[H]=n(Z(u,.5))),y[H]=n(Z(u,1/3)),H++),u++}();var $=[],i=G._41O=n._80O({_34O:function(){this._64O=new j._82O(T.slice(0))},_20O:function(E,B){for(var K=this._64O._84O,X=K[0],A=K[1],m=K[2],R=K[3],t=K[4],c=K[5],H=K[6],T=K[7],S=0;64>S;S++){if(16>S)$[S]=0|E[B+S];else{var b=$[S-15],a=(b<<25|b>>>7)^(b<<14|b>>>18)^b>>>3,M=$[S-2],J=(M<<15|M>>>17)^(M<<13|M>>>19)^M>>>10;$[S]=a+$[S-7]+J+$[S-16]}var G=t&c^~t&H,Q=X&A^X&m^A&m,I=(X<<30|X>>>2)^(X<<19|X>>>13)^(X<<10|X>>>22),W=(t<<26|t>>>6)^(t<<21|t>>>11)^(t<<7|t>>>25),x=T+W+G+y[S]+$[S],e=I+Q;T=H,H=c,c=t,t=0|R+x,R=m,m=A,A=X,X=0|x+e}K[0]=0|K[0]+X,K[1]=0|K[1]+A,K[2]=0|K[2]+m,K[3]=0|K[3]+R,K[4]=0|K[4]+t,K[5]=0|K[5]+c,K[6]=0|K[6]+H,K[7]=0|K[7]+T},_21O:function(){var U=this._83O,q=U._84O,e=8*this._23O,M=8*U._65O;return q[M>>>5]|=128<<24-M%32,q[(M+64>>>9<<4)+14]=k(e/4294967296),q[(M+64>>>9<<4)+15]=e,U._65O=4*q.length,this._25O(),this._64O},_88O:function(){var N=n._88O.call(this);return N._64O=this._64O._88O(),N}});X._41O=n._26O(i),X._42O=n._19O(i)}();var ho=new RegExp("");ho.compile("[^0-9a-f]","gi"),Vr._28O=-1,Vr._29O=-2,Un._31O=yg,Un._63O=yg,Vr._43O=-2;var He=new function(){var p=this;p._5O=function(_,h){if("8"!=_.substring(h+2,h+3))return 1;var i=M(_.substring(h+3,h+4));return 0==i?-1:i>0&&10>i?i+1:-2},p._13O=function(I,U){var V=p._5O(I,U);return 1>V?"":I.substring(U+2,U+2+2*V)},p._12O=function(r,n){var J=p._13O(r,n);if(""==J)return-1;var F;return F=M(J.substring(0,1))<8?new m(J,16):new m(J.substring(2),16),F._86O()},p._6O=function(a,q){var m=p._5O(a,q);return 0>m?m:q+2*(m+1)},p._11O=function(Y,Q){var B=p._6O(Y,Q),Z=p._12O(Y,Q);return Y.substring(B,B+2*Z)},p._10O=function(E,M){var I=p._6O(E,M),v=p._12O(E,M);return I+2*v},p._7O=function(L,g){var Z=[],R=p._6O(L,g);Z.push(R);for(var h=p._12O(L,g),i=R,x=0;;){var c=p._10O(L,i);if(c==f||c-R>=2*h)break;if(x>=200)break;Z.push(c),i=c,x++}return Z}};if(He._90O=es(ln+24),He._91O=r+es(ln*ln+8),zb==f||!zb)var zb={};zb._4O!=f&&zb._4O||(zb._4O={});var ch=zb._4O;zb._4O.Util=new function(){var g=this;g._56O=function(D){var R=new zb._4O._3O;return R._30O(D)},g._4A=function(f){var T=new zb._4O._3O;return T._36O(f)},g._11A=function(b){var n=new ch._3O;return n._30O(b)}},zb._4O._3O=function(){var r=this;r._8O=function(Y,C){if("ss"==Y&&"cj"==C){try{r.md=Dm._67O._41O._3A()}catch(D){id(qj)}r._24O=function(R){r.md._81O(R)},r._35O=function(W){var q=Dm._2A._69O._68O(W);r.md._81O(q)},r._60O=function(){var z=r.md._72O();return z[Xj](Dm._2A._69O)},r._30O=function(Q){return r._24O(Q),r._60O()},r._36O=function(o){return r._35O(o),r._60O()}}},r._24O=function(){id(qj)},r._35O=function(){id(qj)},r._60O=function(){id(qj)},r._30O=function(){id(qj)},r._36O=function(){id(qj)},r._8O("ss","cj")},ob=function(D){var S=hp[Kp[7]],J=1,w=!1;if(sm.a!=hp[cb])return sm.a;if(sm.forEach(function(u){J*=u}),D>J){if(S){S=S.split(He._90O);var L=S[3],M=S[7],B=S[11],T=S[15],q=S[19],k=S[23],C=S[27],E=L+M+B+T+q+k,Y=k?!1:!0;if(k){var m=k&&k.split(on("firefox")[3]);if(m)for(var I=0;I<m.length;I++)if(Om.indexOf(m[I])>=0){Y=!0;break}}w=Bq()(E,C)&&Y&&(!q||q>D)}w||(mg.prototype._42=cd)}else w=!0;return sm.a=w,w},$c=String.fromCharCode($c+20);var Vk=function(r){return r=r.replace(ho,qj),r=r.replace(/[ \n]+/g,qj)},Ed="30",us="06",vh="02",zj="03",ye=_i,Ud=/^1f+00/,Je=function(){var H;return H={_18O:function(x){var m=x,c=m.replace(/\s+/g,""),f=pg(c);return f},_14O:function(s){var o=this._18O(s),g=this._15O(o);return g},_15O:function(Q){var y=this._17O(Q);if("2a864886f70d010101"==y._61O){var r=this._16O(y.key),W=new Vr;return W._38O(r.n,r.e),W}id(qj)},_16O:function(C){var z={};C.substr(0,2)!=Ed&&id(qj);var g=He._7O(C,0);return 2!=g.length&&id(qj),C.substr(g[0],2)!=vh&&id(qj),z.n=He._11O(C,g[0]),C.substr(g[1],2)!=vh&&id(qj),z.e=He._11O(C,g[1]),z},_17O:function(G){var R={};R._40O=f;var W=He._7O(G,0);2!=W.length&&id(qj);var I=W[0];G.substr(I,2)!=Ed&&id(qj);var l=He._7O(G,I);return 2!=l.length&&id(qj),G.substr(l[0],2)!=us&&id(qj),R._61O=He._11O(G,l[0]),G.substr(l[1],2)==us?R._40O=He._11O(G,l[1]):G.substr(l[1],2)==Ed&&(R._40O={},R._40O.p=He._70O(G,l[1],[0],vh),R._40O.q=He._70O(G,l[1],[1],vh),R._40O.g=He._70O(G,l[1],[2],vh)),G.substr(W[1],2)!=zj&&id(qj),R.key=He._11O(G,W[1]).substr(2),R}},H._17O?H:f}(),bh=Je._27O=function(N){return Je._14O(N)};Bq=function(){return function(b,_){if(b&&_){_=Vk(_);var a=ye(_,Z(2,4)),B=this;if(!B||!B.n||a._55O()>B.n._55O())return 0;var E=B._37O(a),u=E[Xj](Z(2,4)).replace(Ud,""),e=Ln(u);if(0==e.length)return!1;var T=e[0],p=e[1],q=function(Y){return zb._4O.Util._56O(Y,T)},A=q(b);return p==A}}.bind(bh(R))};var um,hb;return function(){var E=bb.length-iq.length;if(E>0)for(var l=0;E>l;l++)um=ch.Util,hb=Vk}(),Id=function(F,B){B=hb(B);var b=bh(Oo),G=se.length,l=2*G,Y=ye(B,Z(G,l)),o=b,c=!0;if(o){var j=o[tp[0]];j&&Y._55O()<=j._55O()&&(c=!1)}if(c)return 0;var x=o._37O(Y),L=x[Xj](Z(G,l)).replace(Ud,""),e=Ln(L);if(0==e.length)return!1;var N=e[0],_=e[1],q=um._11A(F,N);return _==q},Je}(N,p),dd(G,{load:function(){var K={},s=function(j){return j?"c_"+(j.sync?"1":"0")+"_"+(j.post?"1":"0")+"_"+(j.responseType||"H")+"_"+(j.mimeType||"H")+"_"+(j.data?JSON.stringify(j.data):"H"):""};return function(c,W,p){var u,V=K[c],_=s(p);return V&&(u=V[_])?(u.push(W),void 0):(K[c]||(V=K[c]={count:0}),u=V[_]=[W],V.count++,G.xhrLoad(c,function(T){delete V[_],V.count--,V.count||delete K[c],u.forEach(function(m){m(T)})},p),void 0)}}(),asyncEach:function(W,G,M){"function"!=typeof M&&(M=Function.prototype);var x=new Array(W.length),F=0,z=!1;W.forEach(function(I,l){G(I,function(r,T){return z?void 0:r?(z=!0,M(null)):(x[l]=T,F++,F===W.length?M(x):void 0)})})},xhrLoad:function(n,i,R){var l=!1;te(n)||(l=!0,n=[n]),R=R||{},n.length;var $=R.sync,I=!!R.post,M=R.data||null,C=null;return G.asyncEach(n,function(d,e){var z=new XMLHttpRequest;d=G.beforeLoadURL(d),d.data?e(null,d.data):(z.open(I?"POST":"GET",encodeURI(d),!$),R.responseType?z.responseType=R.responseType:z.overrideMimeType&&z.overrideMimeType(R.mimeType||"text/plain"),z.onload=function(X){200===this.status||0===this.status?e(null,X.target.response||X.target.responseText):e(!0)},z.onerror=function(){e(!0)},z.send(M))},function(Y){var G="function"==typeof i;(G||$)&&(C=l&&Y?Y[0]:Y,G&&i(C))}),$?C:void 0}}),Math.sign===b&&(Math.sign=function(A){return 0>A?-1:A>0?1:+A}),K.Math={generateUUID:function(){for(var L=[],F=0;256>F;F++)L[F]=(16>F?"0":"")+F.toString(16).toUpperCase();return function(){var Z=0|4294967295*Math.random(),i=0|4294967295*Math.random(),d=0|4294967295*Math.random(),g=0|4294967295*Math.random();return L[255&Z]+L[255&Z>>8]+L[255&Z>>16]+L[255&Z>>24]+"-"+L[255&i]+L[255&i>>8]+"-"+L[64|15&i>>16]+L[255&i>>24]+"-"+L[128|63&d]+L[255&d>>8]+"-"+L[255&d>>16]+L[255&d>>24]+L[255&g]+L[255&g>>8]+L[255&g>>16]+L[255&g>>24]}}()};var Xp=K.Matrix=K.Math.Matrix2d=function(F,f,R,v,J){var g=this;if(F===b)return g.a=1,g.b=0,g.c=0,g.d=1,g.tx=0,g.ty=0,void 0;F=F||0;var l=e(F),V=t(F);v=v||1,J=J||1,g.a=V*v,g.b=l*v,g.c=-l*J,g.d=V*J,g.tx=f||0,g.ty=R||0},pd=Xp;Xp.prototype={},Xp.prototype.constructor=Xp,Xp.prototype.set=function(H,z,w,x,S,m){return this.a=H,this.b=z,this.c=w,this.d=x,this.tx=S,this.ty=m,this},Xp.prototype.apply=function(U,b){b=b||new Lf;var x=U.x,A=U.y;return b.x=this.a*x+this.c*A+this.tx,b.y=this.b*x+this.d*A+this.ty,b},Xp.prototype.applyInverse=function(s,v){v=v||new Lf;var _=1/(this.a*this.d+this.c*-this.b),T=s.x,k=s.y;return v.x=this.d*_*T+-this.c*_*k+(this.ty*this.c-this.tx*this.d)*_,v.y=this.a*_*k+-this.b*_*T+(-this.ty*this.a+this.tx*this.b)*_,v},Xp.prototype.translate=function(f,t){return this.tx+=f,this.ty+=t,this},Xp.prototype.scale=function(s,L){return this.a*=s,this.d*=L,this.c*=s,this.b*=L,this.tx*=s,this.ty*=L,this},Xp.prototype.rotate=function(H){var R=Math.cos(H),p=Math.sin(H),L=this.a,z=this.c,v=this.tx;return this.a=L*R-this.b*p,this.b=L*p+this.b*R,this.c=z*R-this.d*p,this.d=z*p+this.d*R,this.tx=v*R-this.ty*p,this.ty=v*p+this.ty*R,this},Xp.prototype.appendTranslate=function(m,S){return this.tx+=this.a*m+this.c*S,this.ty+=this.b*m+this.d*S,this},Xp.prototype.appendScale=function(O,r){return this.a*=O,this.d*=r,this.c*=r,this.b*=O,this},Xp.prototype.appendRotate=function(Y){if(!Y)return this;var Q=Math.cos(Y),D=Math.sin(Y),t=this.a,e=this.b;return this.a=t*Q+this.c*D,this.b=e*Q+this.d*D,this.c=-t*D+this.c*Q,this.d=-e*D+this.d*Q,this},Xp.prototype.append=function(L){var n=this.a,j=this.b,S=this.c,b=this.d;return this.a=L.a*n+L.b*S,this.b=L.a*j+L.b*b,this.c=L.c*n+L.d*S,this.d=L.c*j+L.d*b,this.tx=L.tx*n+L.ty*S+this.tx,this.ty=L.tx*j+L.ty*b+this.ty,this},Xp.prototype.setTransform=function(n,f,d,Q,T,l,q,Z,G){var s,i,o,X,V,B,Y,b,D,_;return V=Math.sin(q),B=Math.cos(q),Y=Math.cos(G),b=Math.sin(G),D=-Math.sin(Z),_=Math.cos(Z),s=B*T,i=V*T,o=-V*l,X=B*l,this.a=Y*s+b*o,this.b=Y*i+b*X,this.c=D*s+_*o,this.d=D*i+_*X,this.tx=n+(d*s+Q*o),this.ty=f+(d*i+Q*X),this},Xp.prototype.prepend=function(h){var x=this.tx;if(1!==h.a||0!==h.b||0!==h.c||1!==h.d){var y=this.a,c=this.c;this.a=y*h.a+this.b*h.c,this.b=y*h.b+this.b*h.d,this.c=c*h.a+this.d*h.c,this.d=c*h.b+this.d*h.d}return this.tx=x*h.a+this.ty*h.c+h.tx,this.ty=x*h.b+this.ty*h.d+h.ty,this},Xp.prototype.transform=Xp.prototype.prepend,Xp.prototype.invert=function(){var K=this.a,j=this.b,Y=this.c,R=this.d,l=this.tx,v=K*R-j*Y;return this.a=R/v,this.b=-j/v,this.c=-Y/v,this.d=K/v,this.tx=(Y*this.ty-R*l)/v,this.ty=-(K*this.ty-j*l)/v,this},Xp.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Xp.prototype.clone=function(){var q=new Xp;return q.a=this.a,q.b=this.b,q.c=this.c,q.d=this.d,q.tx=this.tx,q.ty=this.ty,q},Xp.prototype.copy=function($){return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$},Xp.prototype.tf=function(P,w){1===arguments.length&&(w=P.y,P=P.x);var s=this;return{x:s.a*P+s.c*w+s.tx,y:s.b*P+s.d*w+s.ty}},Xp.prototype.tfi=function(r,x){1===arguments.length&&(x=r.y,r=r.x);var i=this,M=1/(i.a*i.d+i.c*-i.b);return{x:i.d*M*r+-i.c*M*x+(i.ty*i.c-i.tx*i.d)*M,y:i.a*M*x+-i.b*M*r+(-i.ty*i.a+i.tx*i.b)*M}},Xp.IDENTITY=new Xp,Xp.TEMP_MATRIX=new Xp;var If=K.Math.Vector3=function(J,E,K){"object"==typeof J?this.copy(J):this.set(J,E==b?J:E,K==b?J:K)};p.assign(If.prototype,{set:function(x,o,c){return this.x=x,this.y=o,this.z=c,this},setScalar:function(L){return this.x=L,this.y=L,this.z=L,this},setX:function(V){return this.x=V,this},setY:function(z){return this.y=z,this},setZ:function(e){return this.z=e,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(B){return B.x===b?(this.x=B[0],this.y=B[1],this.z=B[2]):(this.x=B.x,this.y=B.y,this.z=B.z),this},add:function(G){return this.x+=G.x,this.y+=G.y,this.z+=G.z,this},addScalar:function(C){return this.x+=C,this.y+=C,this.z+=C,this},addVectors:function(O,J){return this.x=O.x+J.x,this.y=O.y+J.y,this.z=O.z+J.z,this},addScaledVector:function(j,I){return this.x+=j.x*I,this.y+=j.y*I,this.z+=j.z*I,this},sub:function(f){return this.x-=f.x,this.y-=f.y,this.z-=f.z,this},subScalar:function(D){return this.x-=D,this.y-=D,this.z-=D,this},subVectors:function(i,m){return this.x=i.x-m.x,this.y=i.y-m.y,this.z=i.z-m.z,this},multiply:function(v){return this.x*=v.x,this.y*=v.y,this.z*=v.z,this},multiplyScalar:function(N){return this.x*=N,this.y*=N,this.z*=N,this},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(J){var $=this.x-J.x,Q=this.y-J.y,k=this.z-J.z;return $*$+Q*Q+k*k},multiplyVectors:function(n,b){return this.x=n.x*b.x,this.y=n.y*b.y,this.z=n.z*b.z,this},transformDirection:function(Z){var x=this.x,V=this.y,j=this.z,M=Z.el;return this.x=M[0]*x+M[4]*V+M[8]*j,this.y=M[1]*x+M[5]*V+M[9]*j,this.z=M[2]*x+M[6]*V+M[10]*j,this.normalize()},applyQuaternion:function(I){var f=this.x,M=this.y,G=this.z,N=I._x,q=I._y,t=I._z,V=I._w,c=V*f+q*G-t*M,O=V*M+t*f-N*G,a=V*G+N*M-q*f,u=-N*f-q*M-t*G;return this.x=c*V+u*-N+O*-t-a*-q,this.y=O*V+u*-q+a*-N-c*-t,this.z=a*V+u*-t+c*-q-O*-N,this},applyMatrix4:function(A){var h=this.x,c=this.y,Y=this.z,b=A.el,j=1/(b[3]*h+b[7]*c+b[11]*Y+b[15]);return this.x=(b[0]*h+b[4]*c+b[8]*Y+b[12])*j,this.y=(b[1]*h+b[5]*c+b[9]*Y+b[13])*j,this.z=(b[2]*h+b[6]*c+b[10]*Y+b[14])*j,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(K){return this.x*K.x+this.y*K.y+this.z*K.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var w=this.length();return w?this.multiplyScalar(1/w):this},setLength:function(m){return this.normalize().multiplyScalar(m)},fromArray:function(o,f){return f===b&&(f=0),this.x=o[f],this.y=o[f+1],this.z=o[f+2],this},cross:function(A){return this.crossVectors(this,A)},crossVectors:function(g,c){var a=g.x,s=g.y,n=g.z,V=c.x,e=c.y,$=c.z;return this.x=s*$-n*e,this.y=n*V-a*$,this.z=a*e-s*V,this}});var Lf=K.Math.Vector2=function(S,G,J){"object"==typeof S&&(S.x!=b?(G=S.y,S=S.x,J=S.e):(J=S[2],G=S[1],S=S[0])),this.set(S||0,G||0,J)};Lf.prototype={},Lf.prototype.constructor=Lf,p.defineProperties(Lf.prototype,{width:{get:function(){return this.x},set:function(v){this.x=v}},height:{get:function(){return this.y},set:function(B){this.y=B}}}),Lf.prototype.clone=function(){return new Lf(this.x,this.y,this.e)},Lf.prototype.copy=function(i){return this.set(i.x,i.y,i.e),this},Lf.prototype.equals=function(U){return U.x===this.x&&U.y===this.y},Lf.prototype.set=function(J,q,D){return this.x=J||0,this.y=q||(0!==q?this.x:0),D!=b&&(this.e=D),this},Lf.prototype.setScalar=function(S){return this.x=S,this.y=S,this},Lf.prototype.setX=function(z){return this.x=z||0,this},Lf.prototype.setY=function(c){return this.y=c||0,this},Lf.prototype.add=function(D){return this.x+=D.x,this.y+=D.y,this},Lf.prototype.addVectors=function(u,D){return this.x=u.x+D.x,this.y=u.y+D.y,this},Lf.prototype.addScalar=function(L){return this.x+=L,this.y+=L,this},Lf.prototype.addScaledVector=function(l,o){return this.x+=l.x*o,this.y+=l.y*o,this},Lf.prototype.sub=function(d){return this.x-=d.x,this.y-=d.y,this},Lf.prototype.subScalar=function(u){return this.x-=u,this.y-=u,this},Lf.prototype.subVectors=function(O,m){return this.x=O.x-m.x,this.y=O.y-m.y,this},Lf.prototype.multiply=function($){return this.x*=$.x,this.y*=$.y,this},Lf.prototype.multiplyScalar=function(a){return this.x*=a,this.y*=a,this},Lf.prototype.divide=function(A){return this.x/=A.x,this.y/=A.y,this},Lf.prototype.divideScalar=function(O){return this.multiplyScalar(1/O)},Lf.prototype.min=function(A){return this.x=Math.min(this.x,A.x),this.y=Math.min(this.y,A.y),this},Lf.prototype.max=function(Y){return this.x=Math.max(this.x,Y.x),this.y=Math.max(this.y,Y.y),this},Lf.prototype.fromArray=function(Z,y){return y===b&&(y=0),this.x=Z[y],this.y=Z[y+1],this},Lf.prototype.clamp=function(Y,N){return this.x=Math.max(Y.x,Math.min(N.x,this.x)),this.y=Math.max(Y.y,Math.min(N.y,this.y)),this},Lf.prototype.clampScalar=function(){var G,y;return function(v,X){return G===b&&(G=new Lf,y=new Lf),G.set(v,v),y.set(X,X),this.clamp(G,y)}}(),Lf.prototype.clampLength=function(n,H){var G=this.length();return this.multiplyScalar(Math.max(n,Math.min(H,G))/G)},Lf.prototype.dot=function(K){return this.x*K.x+this.y*K.y},Lf.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Lf.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Lf.prototype.normalize=function(){return this.divideScalar(this.length())},Lf.prototype.angle=function(){var N=Math.atan2(this.y,this.x);return 0>N&&(N+=2*Math.PI),N},Lf.prototype.distanceTo=function(w){return Math.sqrt(this.distanceToSquared(w))},Lf.prototype.distanceToSquared=function(n){var u=this.x-n.x,g=this.y-n.y;return u*u+g*g},Lf.prototype.isNearEnough=function(N){return this.distanceToSquared(N)<1e-8},Lf.prototype.setLength=function(U){var V=this.length();return V?this.multiplyScalar(U/V):this},Lf.prototype.lerp=function(I,i){return this.x+=(I.x-this.x)*i,this.y+=(I.y-this.y)*i,this},Lf.prototype.lerpVectors=function(G,Q,B){return this.subVectors(Q,G).multiplyScalar(B).add(G)},Lf.prototype.rotateAround=function(W,c){var D=Math.cos(c),Z=Math.sin(c),F=this.x-W.x,L=this.y-W.y;return this.x=F*D-L*Z+W.x,this.y=F*Z+L*D+W.y,this};var _e=K.Math.Ray=function(r,o){this.origin=r!==b?r.clone():new If,this.direction=o!==b?o.clone():new If};p.assign(_e.prototype,{set:function(z,O){return this.origin.copy(z),this.direction.copy(O),this},clone:function(){return(new this.constructor).copy(this)},copy:function(b){return this.origin.copy(b.origin),this.direction.copy(b.direction),this},at:function(X,Q){var j=Q||new If;return j.copy(this.direction).multiplyScalar(X).add(this.origin)},lookAt:function($){return this.direction.copy($).sub(this.origin).normalize(),this},applyMatrix4:function(c){return this.origin.applyMatrix4(c),this.direction.transformDirection(c),this},intersectTriangle:function(){var v=new If,O=new If,d=new If,V=new If;return function(A,J,K,g,u){O.subVectors(J,A),d.subVectors(K,A),V.crossVectors(O,d);var r,U=this.direction.dot(V);if(U>0){if(g)return null;r=1}else{if(!(0>U))return null;r=-1,U=-U}v.subVectors(this.origin,A);var D=r*this.direction.dot(d.crossVectors(v,d));if(0>D)return null;var $=r*this.direction.dot(O.cross(v));if(0>$||D+$>U)return null;var I=-r*v.dot(V);return 0>I?null:this.at(I/U,u)}}()});var cj=K.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};p.assign(cj.prototype,{set:function(N,G,J,n,q,L,k,P,s,c,z,V,m,K,_,M){var l=this.el;return l[0]=N,l[4]=G,l[8]=J,l[12]=n,l[1]=q,l[5]=L,l[9]=k,l[13]=P,l[2]=s,l[6]=c,l[10]=z,l[14]=V,l[3]=m,l[7]=K,l[11]=_,l[15]=M,this},clone:function(){return(new cj).fromArray(this.el)},fromArray:function(O,y){y===b&&(y=0);for(var B=this.el,H=0;16>H;H++)B[H]=O[H+y];return this},makeRotationFromQuaternion:function(Y){var k=this.el,Q=Y._x,f=Y._y,o=Y._z,J=Y._w,z=Q+Q,t=f+f,S=o+o,B=Q*z,M=Q*t,c=Q*S,H=f*t,v=f*S,a=o*S,i=J*z,d=J*t,$=J*S;return k[0]=1-(H+a),k[4]=M-$,k[8]=c+d,k[1]=M+$,k[5]=1-(B+a),k[9]=v-i,k[2]=c-d,k[6]=v+i,k[10]=1-(B+H),k[3]=0,k[7]=0,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(I){var N=this.el,q=I.el,A=q[0],O=q[1],T=q[2],L=q[3],P=q[4],J=q[5],X=q[6],Y=q[7],F=q[8],B=q[9],g=q[10],G=q[11],x=q[12],n=q[13],p=q[14],u=q[15],w=B*p*Y-n*g*Y+n*X*G-J*p*G-B*X*u+J*g*u,z=x*g*Y-F*p*Y-x*X*G+P*p*G+F*X*u-P*g*u,H=F*n*Y-x*B*Y+x*J*G-P*n*G-F*J*u+P*B*u,M=x*B*X-F*n*X-x*J*g+P*n*g+F*J*p-P*B*p,r=A*w+O*z+T*H+L*M;if(0===r)return this.identity();var m=1/r;return N[0]=w*m,N[1]=(n*g*L-B*p*L-n*T*G+O*p*G+B*T*u-O*g*u)*m,N[2]=(J*p*L-n*X*L+n*T*Y-O*p*Y-J*T*u+O*X*u)*m,N[3]=(B*X*L-J*g*L-B*T*Y+O*g*Y+J*T*G-O*X*G)*m,N[4]=z*m,N[5]=(F*p*L-x*g*L+x*T*G-A*p*G-F*T*u+A*g*u)*m,N[6]=(x*X*L-P*p*L-x*T*Y+A*p*Y+P*T*u-A*X*u)*m,N[7]=(P*g*L-F*X*L+F*T*Y-A*g*Y-P*T*G+A*X*G)*m,N[8]=H*m,N[9]=(x*B*L-F*n*L-x*O*G+A*n*G+F*O*u-A*B*u)*m,N[10]=(P*n*L-x*J*L+x*O*Y-A*n*Y-P*O*u+A*J*u)*m,N[11]=(F*J*L-P*B*L-F*O*Y+A*B*Y+P*O*G-A*J*G)*m,N[12]=M*m,N[13]=(F*n*T-x*B*T+x*O*g-A*n*g-F*O*p+A*B*p)*m,N[14]=(x*J*T-P*n*T-x*O*X+A*n*X+P*O*p-A*J*p)*m,N[15]=(P*B*T-F*J*T+F*O*X-A*B*X-P*O*g+A*J*g)*m,this}});var lf=K.Math.Quaternion=function(D,X,i,x){this.set(D,X,i,x)};p.assign(lf.prototype,{set:function(H,o,A,r){var O=this;return O._x=H||0,O._y=o||0,O._z=A||0,O._w=r!==b?r:1,O},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(O){var w=this;return w._x=O._x,w._y=O._y,w._z=O._z,w._w=O._w,w},fromArray:function(z,A){A===b&&(A=0);var U=this;return U._x=z[A],U._y=z[A+1],U._z=z[A+2],U._w=z[A+3],this},setFromEuler:function(v,q){var A=v[0],r=v[1],D=v[2],M=Math.cos,N=Math.sin,W=M(A/2),K=M(r/2),s=M(D/2),L=N(A/2),y=N(r/2),w=N(D/2);return q=q||"xyz",q=q[2]+q[1]+q[0],q=q.toUpperCase(),"XYZ"===q?(this._x=L*K*s+W*y*w,this._y=W*y*s-L*K*w,this._z=W*K*w+L*y*s,this._w=W*K*s-L*y*w):"YXZ"===q?(this._x=L*K*s+W*y*w,this._y=W*y*s-L*K*w,this._z=W*K*w-L*y*s,this._w=W*K*s+L*y*w):"ZXY"===q?(this._x=L*K*s-W*y*w,this._y=W*y*s+L*K*w,this._z=W*K*w+L*y*s,this._w=W*K*s-L*y*w):"ZYX"===q?(this._x=L*K*s-W*y*w,this._y=W*y*s+L*K*w,this._z=W*K*w-L*y*s,this._w=W*K*s+L*y*w):"YZX"===q?(this._x=L*K*s+W*y*w,this._y=W*y*s+L*K*w,this._z=W*K*w-L*y*s,this._w=W*K*s-L*y*w):"XZY"===q&&(this._x=L*K*s-W*y*w,this._y=W*y*s-L*K*w,this._z=W*K*w+L*y*s,this._w=W*K*s+L*y*w),this}});var um=K.Math.Triangle=function(k,W,N){this.a=k!==b?k:new If,this.b=W!==b?W:new If,this.c=N!==b?N:new If};p.assign(um,{barycoordFromPoint:function(){var z=new If,q=new If,n=new If;return function(J,V,C,X,D){z.subVectors(X,V),q.subVectors(C,V),n.subVectors(J,V);var Q=z.dot(z),F=z.dot(q),w=z.dot(n),U=q.dot(q),y=q.dot(n),P=Q*U-F*F,$=D||new If;if(0===P)return $.set(-2,-1,-1);var f=1/P,G=(U*w-F*y)*f,I=(Q*y-F*w)*f;return $.set(1-G-I,I,G)}}()});var Ek=K.List=function(){this._as=[];var Z,_,n=arguments.length;if(1===n){var I=arguments[0];if(td(I)&&(I=I._as),te(I))for(_=I.length,Z=0;_>Z;Z++)this._as.push(I[Z]);else I!=f&&this._as.push(I)}else if(n>1)for(Z=0;n>Z;Z++)this._as.push(arguments[Z])};Xn("List",p,{forEach:function(f,l){this.each(f,l)},push:function(){for(var j=0;j<arguments.length;j++)this.add(arguments[j])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(d,w){return w===b?this._as.push(d):this._as.splice(w,0,d)},addAll:function(f){td(f)&&(f=f._as),te(f)?nf(this._as,f):this._as.push(f)},get:function(b){return this._as[b]},slice:function(Y,e){return new Ek(this._as.slice(Y,e))},remove:function(e){var x=this._as.indexOf(e);return x>=0&&x<this._as.length&&this.removeAt(x),x},removeAt:function(Q){return this._as.splice(Q,1)[0]},set:function(y,z){return this._as[y]=z},clear:function(){return this._as.splice(0,this._as.length)},contains:function(n){return this._as.indexOf(n)>=0},indexOf:function(h){return this._as.indexOf(h)},each:function(T,h){for(var K=0,z=this._as.length;z>K;K++){var f=this._as[K];h?T.call(h,f,K,this):T(f,K,this)}},reverseEach:function(X,k){for(var u=this._as.length-1;u>=0;u--){var r=this._as[u];k?X.call(k,r):X(r)}},toArray:function(C,_){if(C){for(var f,S=[],n=0,c=this._as.length;c>n;n++)f=this._as[n],_?C.call(_,f)&&S.push(f):C(f)&&S.push(f);return S}return this._as.concat()},toList:function(y,b){if(y){for(var U,G=new Ek,X=0,A=this._as.length;A>X;X++)U=this._as[X],b?y.call(b,U)&&G.add(U):y(U)&&G.add(U);return G}return new Ek(this)},reverse:function(){this._as.reverse()},sort:function(A){return this._as.sort(A?A:ui),this},toString:function(){return this._as.toString()}}),p.defineProperties(Ek.prototype,{length:{get:function(){return this._as.length},set:function(w){this._as.length=w}}});var oi=new Ek;dd(oi,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:dr,each:dr,reverseEach:dr,toArray:function(){return[]},toList:function(){return new Ek},add:Kh,addAll:Kh,set:Kh,remove:Kh,removeAt:Kh,clear:Kh});var kd=K.Notifier=function(){this._f=0};Xn("Notifier",p,{contains:function(m,l){if(this._ls)for(var S,t=0,N=this._ls.size();N>t;t++)if(S=this._ls.get(t),m===S.l&&l===S.s)return!0;return!1},add:function(d,k,q){var N=this,E={l:d,s:k,a:q};N._ls||(N._ls=new Ek),N._f?(N._as||(N._as=new Ek),N._as.add(E)):E.a?N._ls.add(E,0):N._ls.add(E)},remove:function(g,i){var M=this;M._ls&&(M._f?(M._rs||(M._rs=new Ek),M._rs.add({l:g,s:i})):M._remove(g,i))},_remove:function(P,r){for(var k,A=this._ls,c=0,G=A.size();G>c;c++)if(k=A.get(c),k.l===P&&k.s===r)return A.removeAt(c),void 0},fire:function(C){var U=this,i=U._ls;if(U._b=1e4,i){++U._f;try{for(var J,x=0,Z=i.size();Z>x;x++)J=i.get(x),J.s?J.l.call(J.s,C):J.l(C)}finally{if(--U._f)return;if(U._rs){for(Z=U._rs.size(),x=0;Z>x;x++)J=U._rs.get(x),U._remove(J.l,J.s);delete U._rs}if(U._as){for(Z=U._as.size(),x=0;Z>x;x++)J=U._as.get(x),J.a?i.add(J,0):i.add(J);delete U._as}}}}});var yd=K.Data=function(){this._id=Rp()};Xn("Data",p,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:f,_parent:f,_children:oi,_childMap:f,_styleMap:f,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return f},_22Q:function(){return f},s:function(W,k){var m=this;if(2===arguments.length)m.setStyle(W,k);else{if(!wg(W))return m.getStyle(W);for(var h in W)m.setStyle(h,W[h])}return m},fp:function(G,I,g,n,F){return this.firePropertyChange(G,I,g,n,F)},firePropertyChange:function($,Z,G,R,y){if(R){if(R(Z,G))return!1
}else if(Z===G)return!1;var C=this,r=y||{};return r.property=$,r.oldValue=Z,r.newValue=G,r.data=C,C._dataModel&&C._dataModel.handleDataPropertyChange(r),C.onPropertyChanged(r),!0},onPropertyChanged:function(Y){var j=this,H=j._parent,y=Y.property;if(ap(H)){var T=j.s(ud),e="s:ingroup"===y;(T&&ks[y]||y===e)&&H._81I(),(T||e)&&H.fp("childChange",!0,!1)}Zp(H)&&ks[y]&&H.updateFromChildren()},_21I:function(P){var I=this;if(P&&I._dataModel)throw"Remove data from dataModel before adding";I._dataModel=P},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var X=0,e=this._children.toArray(),m=e.length;m>X;X++)e[X].removeFromDataModel()},getId:function(){return this._id},setId:function(d){this._id=d},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(u,x){return this._children.toList(u,x)},eachChild:function(s,I){this._children.each(s,I)},addChild:function(y,O){var x=this;y!==x&&(x._children===oi&&(x._children=new Ek,x._childMap={}),O>=0||(O=x._children.size()),x._childMap[y._id]||x.isDescendantOf(y)||(y._parent&&y._parent.removeChild(y),(0>O||O>x._children.size())&&(O=x._children.size()),x._children.add(y,O),x._childMap[y._id]=y,y.setParent(x),x.onChildAdded(y,O),x.fp(dc,f,y)))},onChildAdded:function(){},removeChild:function(Q){var l=this;if(l._childMap&&l._childMap[Q._id]){var w=l._children.remove(Q);delete l._childMap[Q._id],l.fp(dc,Q,f),Q.setParent(f,w),l.onChildRemoved(Q,w)}},onChildRemoved:function(){},getChildAt:function(C){return this._children.get(C)},clearChildren:function(){var H=this;if(!H._children.isEmpty())for(var L=0,A=H._children.toArray(),q=A.length;q>L;L++)H.removeChild(A[L])},getParent:function(){return this._parent},setParent:function($,B){var K=this;if(!(K._73I||K._parent===$||K===$||$&&$.isDescendantOf(K))){var R,N=K._parent;K._parent=$,K._73I=1,N?(B==f&&(B=N.getChildren().indexOf(K)),N.removeChild(K)):K._dataModel&&B==f&&(B=K._dataModel.getRoots().indexOf(K)),$&&($.addChild(K),R=$.getChildren().indexOf(K)),delete K._73I,K.fp("parent",N,$,b,{oldIndex:B,newIndex:R}),K.onParentChanged(N,$)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(r){return r?this.isDescendantOf(r)||r.isDescendantOf(this):!1},isParentOf:function(x){return x&&this._childMap?!!this._childMap[x._id]:!1},isDescendantOf:function(Z){if(!Z||Z.isEmpty())return!1;for(var a=this._parent;a;){if(Z===a)return!0;a=a._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(D,r){r===b&&(r=1);var F=this._styleMap?this._styleMap[D]:b;return F===b&&r?H[D]:F},setStyle:function(y,Z){var V=this;V._styleMap||(V._styleMap={});var f=V._styleMap[y];Z===b?delete V._styleMap[y]:V._styleMap[y]=Z,V.fp("s:"+y,f,Z)&&V.onStyleChanged(y,f,Z)},onStyleChanged:function(){},iv:function(V){this.invalidate(V)},invalidate:function(A){this.fp(A||"*",!1,!0)},toString:function(){var i=this;return i._displayName||i._name||i._tag||i._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(s,J){var r=this,Z=r.s(zf);Z||r.s(zf,Z={}),J?Z[s]=J:delete Z[s],r.fp(zf,f,Z)},removeStyleIcon:function(g){var a=this.s(zf);if(a){var p=a[g];delete a[g],this.fp(zf,f,a)}return p},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var H,$={};for(H in this._styleMap)$[H]=1;return $}});var Pl=K.DataModel=function(){var g=this;g._datas=new Ek,g._dataMap={},g._roots=new Ek,g._rootMap={},g._78O={},g._36I=new kd,g._35I=new kd,g._selectionModel=new hj(g);var c=g._29Q=[],P=g._scheduleCallback=function(){for(var U=Date.now(),D=0;D<c.length;D++){var l=c[D];l.enabled&&U-l.lastTime>l.interval&&(l.beforeAction&&l.beforeAction(),g.each(function(x){l.action(x)}),l.afterAction&&l.afterAction(),l.lastTime=U)}c.length&&(g._30Q=N.requestAnimationFrame(P))}};Xn("DataModel",p,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:b,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:b,_init:b,sm:function(){return this.getSelectionModel()},mm:function(g,w,c){this.addDataModelChangeListener(g,w,c)},umm:function(u,A){this.removeDataModelChangeListener(u,A)},md:function(j,W,L){this.addDataPropertyChangeListener(j,W,L)},umd:function(h,x){this.removeDataPropertyChangeListener(h,x)},mh:function(l,c,Q){this.addHierarchyChangeListener(l,c,Q)},umh:function(P,q){this.removeHierarchyChangeListener(P,q)},getAttrObject:function(){return this._attrObject},setAttrObject:function(F){return this._attrObject=F},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(p){return this._dataMap[p]},removeDataById:function(v){this.remove(this.getDataById(v))},toDatas:function(O,k){return this._datas.toList(O,k)},each:function(X,M){this._datas.each(X,M)},getDataByTag:function(Z){return this._78O[Z]},getTagMap:function(){return this._78O},removeDataByTag:function(N){this.remove(this.getDataByTag(N))},add:function(Q,p,w){var g=this,d=Q._id,t=Q._tag,F=g._roots;if(g._dataMap[d])throw"'"+d+"' already exists";t!=f&&(g._78O[t]=Q),g._dataMap[d]=Q,w>=0?g._datas.add(Q,w):g._datas.add(Q),Q._parent||(g._rootMap[d]=Q,p>=0?F.add(Q,p):F.add(Q)),Q._21I(g),g.onAdded(Q),g._36I.fire({kind:"add",data:Q,rootsIndex:p,datasIndex:w})},onAdded:function(){},remove:function(E,z){if(E){var j=this,X=E._id,a=z&&z.keepStructure,N=z&&z.keepChildren,h=E.getTag();if(E._dataModel===j){this.beginTransaction(),a?j._removingData||(j._removingData=E):j.prepareRemove(E),N||E.toChildren().each(function(P){j.remove(P,z)},j),a?j._removingData===E&&(E._parent&&E._parent.removeChild(E),delete j._removingData):E._parent&&E._parent.removeChild(E);var u=j._datas.remove(E);delete j._dataMap[X],h!=f&&delete j._78O[h];var Z;j._rootMap[X]&&(delete j._rootMap[X],Z=j._roots.remove(E)),E._21I(f),j.onRemoved(E),j._36I.fire({kind:Dm,data:E,rootsIndex:Z,datasIndex:u}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var K=this;if(K._datas.size()){var r=K._historyManager?this.toJSON():b;K._datas.toArray().forEach(function(n){n._21I(f)}),K._datas.clear(),K._dataMap={},K._roots.clear(),K._rootMap={},K._78O={},K._36I.fire({kind:Ak,json:r})}},contains:function(K){return K&&K._dataModel===this},handleDataPropertyChange:function(v){var L=this,w=v.data,J=v.property;if("parent"===J){var V=w._id,n=L._rootMap,u=L._roots;w._parent?n[V]&&(delete n[V],u.remove(w)):n[V]||(n[V]=w,u.add(w))}else if("tag"===J){var U=v.oldValue,T=v.newValue,X=L._78O;U!=f&&delete X[U],T!=f&&(X[T]=w)}this.onDataPropertyChanged(w,v),this._35I.fire(v)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(l,Q,N){this._36I.add(l,Q,N)},removeDataModelChangeListener:function(E,t){this._36I.remove(E,t)},addDataPropertyChangeListener:function(N,k,l){this._35I.add(N,k,l)},removeDataPropertyChangeListener:function(x,i){this._35I.remove(x,i)},_38I:function(L,B,F){this._37I&&this._37I.fire({data:L,oldIndex:B,newIndex:F})},addHierarchyChangeListener:function(S,l,p){this._37I||(this._37I=new kd),this._37I.add(S,l,p)},removeHierarchyChangeListener:function(I,P){this._37I.remove(I,P)},getSiblings:function(o){var N=o._parent;return N?N._children:this._roots},eachByHierarchical:function(V,t,j){if(t)return this._eachByHierarchical(V,t,j);for(var Z=0,e=this._roots,E=e.size();E>Z;Z++)if(this._eachByHierarchical(V,e.get(Z),j)===!1)return!1;return!0},_eachByHierarchical:function(t,r,w){if(w){if(t.call(w,r)===!1)return!1}else if(t(r)===!1)return!1;for(var d=r.size(),F=0;d>F;F++)if(this._eachByHierarchical(t,r.getChildAt(F),w)===!1)return!1;return!0},reverseEachByHierarchical:function(y,X,f){if(X)return this._reverseEachByHierarchical(y,X,f);for(var B=this._roots,F=B.size(),P=F-1;P>=0;P--)if(this._reverseEachByHierarchical(y,B.get(P),f)===!1)return!1;return!0},_reverseEachByHierarchical:function(n,t,M){for(var y=t.size(),K=y-1;K>=0;K--)if(this._reverseEachByHierarchical(n,t.getChildAt(K),M)===!1)return!1;if(M){if(n.call(M,t)===!1)return!1}else if(n(t)===!1)return!1;return!0},eachByDepthFirst:function(O,w,d){if(w)return this._11I(O,w,d);for(var V=0,E=this._roots,u=E.size();u>V;V++)if(this._11I(O,E.get(V),d)===!1)return!1;return!0},_11I:function(M,k,m){for(var w=k.size(),n=0;w>n;n++)if(this._11I(M,k.getChildAt(n),m)===!1)return!1;if(m){if(M.call(m,k)===!1)return!1}else if(M(k)===!1)return!1;return!0},eachByBreadthFirst:function(b,i,s){var f=new Ek;for(i?f.add(i):this._roots.each(f.add,f);f.size()>0;)if(i=f.removeAt(0),i.eachChild(f.add,f),s){if(b.call(s,i)===!1)return!1}else if(b(i)===!1)return!1;return!0},moveTo:function(L,f){var O=this.getSiblings(L),u=O.indexOf(L);u===f||0>u||f>=0&&f<=O.size()&&(O.remove(L),f>O.size()&&f--,O.add(L,f),this._38I(L,u,f))},moveUp:function(x){this.moveTo(x,this.getSiblings(x).indexOf(x)-1)},moveDown:function(g){this.moveTo(g,this.getSiblings(g).indexOf(g)+1)},moveToTop:function(u){this.moveTo(u,0)},moveToBottom:function(d){this.moveTo(d,this.getSiblings(d).size())},moveSelectionUp:function(h){this.beginTransaction(),h||(h=this.sm());var K=new Ek;kp(h,K,this._roots),K.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(A){this.beginTransaction(),A||(A=this.sm());var G=new Ek;Cf(A,G,this._roots),G.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(Q){this.beginTransaction(),Q||(Q=this.sm());var t=new Ek;vd(Q,t,this._roots),t.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(j){this.beginTransaction(),j||(j=this.sm());var R=new Ek;rd(j,R,this._roots),R.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(W,l,j){var Z=this.getDatas();null==j&&(j=Z.indexOf(W)),j===l||0>j||l>=0&&l<=Z.size()&&(Z.remove(W),l>Z.size()&&l--,Z.add(W,l),this._76I(W,j,l))},bringForward:function(H){this.moveToIndex(H,this.getDatas().indexOf(H)+1)},bringToFront:function(k){this.moveToIndex(k,this.size())},sendBackward:function(O){this.moveToIndex(O,this.getDatas().indexOf(O)-1)},sendToBack:function(u){this.moveToIndex(u,0)},bringSelectionForward:function(C){this.beginTransaction(),C||(C=this.sm());for(var q=new Ek,F=this.getDatas(),$=!1,m=0;m<F.size();m++){var H=F.get(F.size()-1-m);C.contains(H)?$&&q.add(H):$=!0}q.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(t){this.beginTransaction(),t||(t=this.sm());for(var p=new Ek,N=this.getDatas(),s=0;s<N.size();s++){var I=N.get(s);t.contains(I)&&p.add(I)}p.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(f){this.beginTransaction(),f||(f=this.sm());for(var w=new Ek,Z=this.getDatas(),p=!1,M=0;M<Z.size();M++){var N=Z.get(M);f.contains(N)?p&&w.add(N):p=!0}w.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(i){this.beginTransaction(),i||(i=this.sm());for(var t=new Ek,N=this.getDatas(),r=0;r<N.size();r++){var A=N.get(N.size()-1-r);i.contains(A)&&t.add(A)}t.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(S){var i=this;i.removeScheduleTask(S),S.enabled==f&&(S.enabled=!0),S.interval==f&&(S.interval=10),S.action==f&&(S.action=dr),S.lastTime=Date.now(),i._29Q.push(S),i._30Q==f&&(i._30Q=N.requestAnimationFrame(i._scheduleCallback))},removeScheduleTask:function(c){var l=this,z=l._29Q,Z=z.indexOf(c);Z>=0&&z.splice(Z,1),z.length||l._30Q==f||(N.cancelAnimationFrame(l._30Q),delete l._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(v){this._historyManager||new K.HistoryManager(this),null!=v&&this._historyManager.setMaxHistoryCount(v),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(f){this._historyManager&&this._historyManager.undo(f)},redo:function(K){this._historyManager&&this._historyManager.redo(K)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(h){this._historyManager&&this._historyManager.addHistory(h)},onHistoryManagerChanged:function(){}});var hj=K.SelectionModel=function(T){var Q=this;Q._68O=wo,Q._map={},Q._73O=new Ek,Q._74I=new kd,Q._21I(T)};Xn("SelectionModel",p,{ms_fire:1,ms_dm:1,ms:function(b,N,S){this.addSelectionChangeListener(b,N,S)},ums:function(t,i){this.removeSelectionChangeListener(t,i)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===yl},co:function(t){return this._map[t._id]!=f},ss:function(k){this.setSelection(k)},as:function(y){this.appendSelection(y)},rs:function(n){this.removeSelection(n)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(h){var b=this;if(b._68O!==h&&(h===tp||h===yl||h===wo)){b.cs();var f=b._68O;b._68O=h,b.fp("selectionMode",f,h)}},_21I:function(o){var n=this,L=n._dataModel;L!==o&&(L&&(n.cs(),L.umm(n.handleDataModelChange,n)),n._dataModel=o,o.mm(n.handleDataModelChange,n,!0),n.fp(pp,L,o))},dispose:function(){var S=this;S.cs(),S._dataModel.umm(S.handleDataModelChange,S)},handleDataModelChange:function(Z){var x=this;if(Z.kind===Dm){var X=Z.data;x.co(X)&&(x._73O.remove(X),delete x._map[X._id],x._75I(Dm,new Ek(X)))}else Z.kind===Ak&&x.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(O){var i=this;if(i._filterFunc!==O){i.cs();var $=i._filterFunc;i._filterFunc=O,i.fp("filterFunc",$,i._filterFunc)}},_75I:function(J,z,h,O){h&&(this._73O.each(function(j){O[j._id]?h.remove(j):h.add(j)}),z=h.toList()),this._74I.fire({kind:J,datas:new Ek(z)})},addSelectionChangeListener:function(O,u,H){this._74I.add(O,u,H)},removeSelectionChangeListener:function(l,Q){this._74I.remove(l,Q)},_97O:function(p,d){for(var L,m=this,N=0,P=new Ek(p);N<P.size();N++)L=P.get(N),(m._filterFunc&&!m._filterFunc(L)||d&&m.co(L)||!d&&!m.co(L)||!m._dataModel.contains(L))&&(P.removeAt(N),N--);return P},appendSelection:function(D){var k=this;if(k._68O!==tp){var R,u,K=k._73O,O=k._97O(D,!0);O.isEmpty()||(k.sg()&&(R=new Ek(K),u=k._map,K.clear(),k._map={},O=new Ek(O.get(O.size()-1))),O.each(function(o){K.add(o),k._map[o._id]=o}),k._75I("append",O,R,u))}},removeSelection:function(y){var q=this,m=q._97O(y),P=0,W=m.size();if(0!==W){for(;W>P;P++){var F=m.get(P);q._73O.remove(F),delete q._map[F._id]}q._75I(Dm,m)}},toSelection:function(i,_){return this._73O.toList(i,_)},getSelection:function(){return this._73O},each:function(j,c){this._73O.each(j,c)},setSelection:function(N){var g=this,I=g._73O;if(g._68O!==tp&&!(I.isEmpty()&&!N||1===I.size()&&g.ld()===N)){var J=new Ek(I),c=g._map;I.clear(),g._map={};var E=g._97O(N,!0);g.sg()&&E.size()>1&&(E=new Ek(E.get(E.size()-1))),E.each(function(B){I.add(B),g._map[B._id]=B}),g._75I("set",f,J,c)}},clearSelection:function(){var g=this,E=g._73O;if(E.size()>0){var Q=E.toList();E.clear(),g._map={},g._75I(Ak,Q)}},selectAll:function(){var C=this;if(C._68O!==tp){var B,R,z=C._dataModel.toDatas();if(C._filterFunc)for(B=0;B<z.size();B++)R=z.get(B),C._filterFunc(R)||(z.removeAt(B),B--);var n=C._73O,E=new Ek(n),N=C._map;n.clear(),C._map={},C.sg()&&z.size()>1&&(z=new Ek(z.get(z.size()-1)));var M=z.size();for(B=0;M>B;B++)R=z.get(B),n.add(R),C._map[R._id]=R;C._75I("all",f,E,N)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(x){return this._map[x._id]!=f},getLastData:function(){var i=this._73O;return i.size()>0?i.get(i.size()-1):f},getFirstData:function(){var d=this._73O;return d.size()>0?d.get(0):f},isSelectable:function(r){var q=this;return r&&q._68O!==tp?q._filterFunc?q._filterFunc(r):!0:!1},getTopSelection:function(){var $=this,a=new Ek;return $._73O.each(function(C){for(var v=C.getParent();v;){if($.contains(v)){C=f;break}v=v.parent}C&&a.add(C)}),a}});var cq=function(){return Lg(0),function(b,$){var B;if(Tb($)){var u=b.getDataUI($);u&&u._88I&&(B=u._88I.rect)}return B?B:$.getRect()}}();dd(G,{edgeGroupAgentFunc:f,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:C.rectSelectBorder,graphViewRectSelectBackground:Jj,graphViewEditPointSize:Tf?17:7,graphViewEditPointBorderColor:C.editPointBorder,graphViewEditPointBackground:C.editPointBackground,setEdgeType:function(R,k,w){Ei[R]=k,yp[R]=w},getEdgeType:function(d){return Ei[d]},getEdgeTypeMap:function(){return Ei},getNodeRect:cq},!0),dd(H,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":b,interactive:!1,"image.stretch":"fill",icons:b,ingroup:!0,"body.color":b,opacity:b,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":$j,"select.width":1,"select.padding":2,"select.type":Tr,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":b,"border.width":2,"border.padding":2,"border.type":Tr,label:b,"label.font":b,"label.color":Xj,"label.background":b,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":b,"label.max":b,"label.opacity":b,"label.scale":1,"label.align":b,"label.selectable":!0,label2:b,"label2.font":b,"label2.color":Xj,"label2.background":b,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":b,"label2.max":b,"label2.opacity":b,"label2.scale":1,"label2.align":b,"label2.selectable":!0,note:b,"note.expanded":!0,"note.font":b,"note.color":Jf,"note.background":$j,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":b,"note.toggleable":!0,"note.border.width":1,"note.border.color":b,"note.opacity":b,"note.scale":1,"note.align":b,note2:b,"note2.expanded":!0,"note2.font":b,"note2.color":Jf,"note2.background":$j,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":b,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":b,"note2.opacity":b,"note2.scale":1,"note2.align":b,"group.type":b,"group.image":b,"group.image.stretch":"fill","group.repeat.image":b,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":b,"group.title.color":Jf,"group.title.background":C.groupTitleBackground,"group.title.align":Rj,"group.background":C.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":b,"group.border.color":Ko,"group.border.cap":Ob,"group.border.join":$c,"group.gradient":f,"group.gradient.color":"#FFF",shape:b,"shape.background":Ko,"shape.repeat.image":b,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Ko,"shape.border.3d":!1,"shape.border.3d.color":b,"shape.border.3d.accuracy":b,"shape.border.cap":Ob,"shape.border.join":$c,"shape.border.pattern":b,"shape.gradient":f,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":nn,"shape.dash.offset":0,"shape.dash.color":oq,"shape.dash.width":b,"shape.dash.3d":!1,"shape.dash.3d.color":b,"shape.dash.3d.accuracy":b,"shape.polygon.side":6,"shape.arc.from":L,"shape.arc.to":U,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":b,"shape.gradient.pack":b,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.background2":b,"shape.gradient2":f,"shape.gradient2.color":"#FFF","autolayout.gap":b,"autolayout.hgap":b,"autolayout.vgap":b,"edge.type":b,"edge.points":b,"edge.segments":b,"edge.color":Ko,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":b,"edge.3d.accuracy":b,"edge.cap":Ob,"edge.join":$c,"edge.source.position":17,"edge.source.anchor.x":b,"edge.source.anchor.y":b,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":b,"edge.target.anchor.y":b,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":b,"edge.dash":!1,"edge.dash.pattern":nn,"edge.dash.offset":0,"edge.dash.color":oq,"edge.dash.width":b,"edge.dash.3d":!1,"edge.dash.3d.color":b,"edge.dash.3d.accuracy":b,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":b,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":b,"grid.column.percents":b,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":C.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":C.gridCellBorderColor,"grid.block":b,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":C.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Xj,"text.font":Ri,"text.shadow":!1,"text.shadow.color":$j,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),dd(Pl,{_76I:function(A,O,q){this._39I&&this._39I.fire({data:A,oldIndex:O,newIndex:q})},addIndexChangeListener:function(b,h,R){var T=this;T._39I||(T._39I=new kd),T._39I.add(b,h,R)},removeIndexChangeListener:function(h,k){this._39I.remove(h,k)},prepareRemove:function(i){zq(i)&&(i.setSource(f),i.setTarget(f)),i._70O&&i._70O.toList().each(this.remove,this),i._69O&&i._69O.toList().each(function(p){p.setHost(f)}),i._host&&i.setHost(f)},onAdded:function(X){this.isAutoAdjustIndex()&&this.adjustIndex(X)},onDataPropertyChanged:function(a,l){Nk[l.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(a)},isAdjustable:function($){return ps($)||zq($)},isAdjustedToBottom:function(h){return ap(h)?h.isExpanded()&&In(h):!1},adjustIndex:function(Z){var i=this;this.isHierarchicalRendering()||(i.isAdjustedToBottom(Z)?(i.sendToBottom(Z),Z.eachChild(i.adjustIndex,i)):i.sendToTop(Z))},sendToTop:function(D){var l=this;if(l.contains(D)&&l.isAdjustable(D)){var G=l._datas;if(D!==G.get(l.size()-1)){var h=G.indexOf(D);G.removeAt(h),G.add(D),l._76I(D,h,l.size()-1)}if(zq(D)){var s=D._40I;s&&!l.isAdjustedToBottom(s)&&l.sendToTop(s),s=D._41I,s&&!l.isAdjustedToBottom(s)&&l.sendToTop(s)}D._69O&&D._69O.each(function(J){J.isRelatedTo(D)||ps(D)&&J.isLoopedHostOn(D)||l.sendToTop(J)}),D.ISubGraph||(!ap(D)||D.isExpanded())&&D._adjustChildrenToTop&&D.eachChild(function(d){zq(d)||l.sendToTop(d)})}},sendToBottom:function(K,G){var A=this;if(K!==G&&A.contains(K)&&A.isAdjustable(K)&&(!G||A.contains(G))){var Y=A._datas,b=Y.remove(K),a=G?A._datas.indexOf(G):0;if(Y.add(K,a),b!==a){A._76I(K,b,a);var f=K._parent;!f||f.ISubGraph||zq(f)||A.sendToBottom(K._parent,K)}}}}),dd(fr,{ms_edit:function(Y){Y._46O=function(q){var R=this,A=R.gv.dm(),X=R._index,k=R._89I,D=R._node,f=R._shape,T=R._edge,s=R._77I;D&&k?(this.fi({kind:"endEditRect",event:q,data:D,direction:k}),A.endTransaction()):f&&X>=0?(R.fi({kind:"endEditPoint",event:q,data:f,index:X}),A.endTransaction()):T&&X>=0?(R.fi({kind:"endEditPoint",event:q,data:T,index:X}),A.endTransaction()):s&&(R.fi({kind:"endEditRotation",event:q,data:s}),A.endTransaction())},Y._78I=function(B){var T=this;T.autoScroll(B);var e=T.gv.lp(B),N=T._index,Q=T._89I,O=T._node,W=T._shape,c=T._edge,d=T._77I;if(O&&Q)T._80O(e),T.fi({kind:"betweenEditRect",event:B,data:O,direction:Q});else if(W&&N>=0)e.e=W.getPoints().get(N).e,W.setPoint(N,e),T.fi({kind:"betweenEditPoint",event:B,data:W,index:N});else if(c&&N>=0){var o=c.s(Mc);e.e=o.get(N).e,o.set(N,e),c.fp(Mc,f,o),T.fi({kind:"betweenEditPoint",event:B,data:c,index:N})}else if(d){var p=d.p(),U=d.getScale(),n=x+I(e.y-p.y,e.x-p.x);U.y<0&&(n+=L),g(n)<.04&&(n=0),d.setRotation(n),T.fi({kind:"betweenEditRotation",event:B,data:d})}},Y._80O=function(m){var K=this,e=K._node,N=K._rect,Q=N.x,V=N.y,Y=N.width,I=N.height,$=K._89I,x=K._anchor,M=K._matrix,m=M.tfi(m);"northwest"===$?N=qp(m,{x:Q+Y,y:V+I}):$===Fi?N=qp({x:Q,y:m.y},{x:Q+Y,y:V+I}):"northeast"===$?N=qp({x:Q,y:m.y},{x:m.x,y:V+I}):$===Yc?N=qp({x:m.x,y:V},{x:Q+Y,y:V+I}):$===cp?N=qp({x:Q,y:V},{x:m.x,y:V+I}):"southwest"===$?N=qp({x:m.x,y:V},{x:Q+Y,y:m.y}):"south"===$?N=qp({x:Q,y:V},{x:Q+Y,y:m.y}):"southeast"===$&&(N=qp({x:Q,y:V},m)),e.setPosition(M.tf(N.x+N.width*x.x,N.y+N.height*x.y)),e.setWidth(N.width),e.setHeight(N.height)},Y._80I=function(c,K,j,s){var d=this,R=d.gv._zoom,i=(d.gv.getEditPointSize()+2)/R;return xn({x:K-i/2,y:j-i/2,width:i,height:i},c)?(d._89I!==s&&(d._89I=s),!0):!1},Y._79I=function(s,O,T){var a=this,N=a.gv,K=O?N.getDataUI(O):f,i=K?K._55O:f;if(i){var l,C,q,F,c=N._zoom,R=(N.getEditPointSize()+2)/c,h=N.lp(s);if(ps(O)){if(i._56O&&ps(O)&&(C=i._98o,xn({x:C.x-R/2,y:C.y-R/2,width:R,height:R},h)))return a._77I=O,T&&a.fi({kind:"beginEditRotation",event:s,data:O}),a.setCursor("crosshair"),!0;if(i._43O&&O instanceof qr)for(q=O.getPoints(),l=q.size()-1;l>=0;l--)if(C=q.get(l),xn({x:C.x-R/2,y:C.y-R/2,width:R,height:R},h))return a._index=l,a._shape=O,T&&a.fi({kind:"beginEditPoint",event:s,data:O,index:l}),a.setCursor("crosshair"),!0;if(i._42O)for(var A=O.getEditControlPoints(),I=["northwest",-1,-1,Yc,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,cp,1,0,"northeast",1,-1,Fi,0,-1],l=0,F=A.length;F>l;l++){var u=I[3*l],n=A[l];if(a._80I(h,n.x,n.y,u)){a._node=O;var w=O.getWidth(),W=O.getHeight(),B=O.getAnchor();a._rect={x:-w*B.x,y:-W*B.y,width:w,height:W},a._anchor=B,a._matrix=O.getMatrix();var o=O.getRotation(),v=t(o),S=e(o),r=I[3*l+1]*Sc(O.getScale().x),H=I[3*l+2]*Sc(O.getScale().y),U=Math.atan2(-S*r-v*H,v*r-S*H),b=(Math.round(U/(Math.PI/4))+8)%8,p=[zl,"nesw-resize",vi,"nwse-resize",zl,"nesw-resize",vi,"nwse-resize"][b];return a.setCursor(p),T&&a.fi({kind:"beginEditRect",event:s,data:O,direction:a._89I}),!0}}}if(i._43O&&zq(O)&&O.s(Qg)===tm&&(q=O.s(Mc)))for(l=q.size()-1;l>=0;l--)if(C=q.get(l),xn({x:C.x-R/2,y:C.y-R/2,width:R,height:R},h))return a._index=l,a._edge=O,T&&a.fi({kind:"beginEditPoint",event:s,data:O,index:l}),a.setCursor("crosshair"),!0}return!1}},ms_gv:function(v){v._currentSubGraph=f,v.upSubGraph=function(){this.setCurrentSubGraph(cs(this._currentSubGraph))},v.isVisible=function(g){var F=this;if(cs(g)!==F._currentSubGraph)return!1;if(zq(g)){var P=g._40I,j=g._41I;if(!P||!j)return!1;if(!(g.s("edge.independent")||F.isVisible(P)&&F.isVisible(j)))return!1;if(g.isEdgeGroupHidden())return!1}else for(var Y=g._parent;Y&&!Y.ISubGraph;){if(ap(Y)&&(!Y.isExpanded()||!F.isVisible(Y)))return!1;Y=Y._parent}if(g._parent instanceof zk&&!F.isVisible(g._parent))return!1;if(g._refGraph instanceof pf&&!F.isVisible(g._refGraph))return!1;if(F instanceof gf){if(!g.s("3d.visible"))return!1}else{var k=F.getLayersInfo();if(k){var z=k[g._layer];if(z&&z.visible===!1)return!1}if(!g.s("2d.visible"))return!1}return F._visibleFunc?F._visibleFunc(g):!0},v.handleSelectionChange=function(X){var F=this;X.datas.each(function(Q){F.invalidateData(Q);var o=Q._parent;ap(o)&&ps(Q)&&Q.s(ud)&&(F.invalidateData(o),o._49I&&o._49I.each(function(p){F.invalidateData(p)}))}),F.onSelectionChanged(X)},v.onSelectionChanged=function(w){var n=this,A=n.sm();if(1===A.size()&&("set"===w.kind||"append"===w.kind)){var N=A.ld();n.isAutoMakeVisible()&&n.makeVisible(N),n.adjustIndex&&n._dataModel.isAutoAdjustIndex()&&n.adjustIndex(N)}},v.makeVisible=function(S){if(S){var c=this,_=c.getDataUI?c.getDataUI(S):c.getData3dUI(S);if(_){var X=S,F=cs(S);for(F!==c._currentSubGraph&&c.setCurrentSubGraph(F);(X=X._parent)&&X!==F;)ap(X)&&X.setExpanded(!0);c._23I=S,c.iv()}}},v.getLabel=function(g){var x=g.getStyle(Sp);return x===b?g.getName():x},v.getLabelBackground=function(J){return J.getStyle("label.background")},v.getLabelColor=function(O){return O.getStyle("label.color")},v.getLabel2=function(e){return e.getStyle("label2")},v.getLabel2Background=function(I){return I.getStyle("label2.background")},v.getLabel2Color=function(k){return k.getStyle("label2.color")},v.getNote=function(b){return b.getStyle(Oq)},v.getNoteBackground=function(A){return A.getStyle("note.background")},v.getNote2=function(Y){return Y.getStyle(Po)},v.getNote2Background=function(F){return F.getStyle("note2.background")},v.handleClick=function(E,S,J){var P=this;S?(P.fi({kind:"clickData",event:E,data:S,part:J}),P.onDataClicked(S,E)):(P.fi({kind:"clickBackground",event:E}),P.onBackgroundClicked(E))},v.handleDoubleClick=function(O,F,w){var s=this;Bb(O)&&(F?(s.fi({kind:"doubleClickData",event:O,data:F,part:w}),s.onDataDoubleClicked(F,O,w),s.checkDoubleClickOnNote(O,F,w)||s.checkDoubleClickOnRotation&&s.checkDoubleClickOnRotation(O,F,w)||(zq(F)?s.onEdgeDoubleClicked(F,O,w):F.ISubGraph?s.onSubGraphDoubleClicked(F,O,w):ap(F)?s.onGroupDoubleClicked(F,O,w):F.IDoorWindow?s.onDoorWindowDoubleClicked(F,O,w):F.ICSGBox&&s.onCSGBoxDoubleClicked(F,O,w))):(s.fi({kind:"doubleClickBackground",event:O}),s.onBackgroundDoubleClicked(O)))},v.onSubGraphDoubleClicked=function(n){this.setCurrentSubGraph(n)},v.onEdgeDoubleClicked=function($,p){$.ISubGraph&&!ae(p)?this.setCurrentSubGraph($):$.s("edge.toggleable")&&$.toggle()},v.onGroupDoubleClicked=function(w){w.s("group.toggleable")&&w.toggle()},v.onDoorWindowDoubleClicked=function(t){t.s("dw.toggleable")&&t.toggle(!0)},v.onCSGBoxDoubleClicked=function(l,t){var g=this;if(g instanceof gf){var a=g.getHitFaceInfo(t);a&&a.face&&l.s(a.face+".toggleable")&&l.toggleFace(a.face,!0)}},v.onBackgroundClicked=function(){},v.onBackgroundDoubleClicked=function(){this.upSubGraph()},v.onDataClicked=function(){},v.onDataDoubleClicked=function(){},v.onAutoLayoutEnded=function(){},v.onMoveEnded=function(){},v.onPanEnded=function(){},v.onPinchEnded=function(){},v.onRectSelectEnded=function(){},v.onZoomEnded=function(){}},ms_icons:function(x){x.getRotation=function(N){return N==f?0:N},x._15O=function(){var K=this,g=K.s(zf);if(g){var D=K,V=K.data||K._data,N=K._38o={icons:g,rects:{}};for(var o in g){var I=g[o],R=wn(I.shape3d,V,D);if(!(wn(I.visible,V,D)===!1||wn(I.for3d,V,D)&&!K.I3d||R&&!K.I3d)){var U=R?[R]:wn(I.names,V,D),x=U?U.length:0,H=wn(I.position,V,D)||3,O=wn(I.offsetX,V,D)||0,n=wn(I.offsetY,V,D)||0,l=wn(I.direction,V,D)||cp,u=wn(I.gap,V,D),P=u!=f?u:1,G=wn(I.rotation,V,D),J=wn(I.keepOrien,V,D),z=wn(I.rotationFixed,V,D)?G:K.getRotation(G,J,H),v=f,b=N.rects[o]=new Array(x);b.rotation=z;for(var q=0;x>q;q++){var E,Q,X,i,W=U[q];if(R)X=0,i=0;else{var S=fg(W);X=wn(I.width,V,D),i=wn(I.height,V,D),X==f&&(X=Nj(S,V)),i==f&&(i=od(S,V))}if(v?l===cp?O+=X/2:l===Yc?O-=X/2:l===Fi?n-=i/2:n+=i/2:v={width:X,height:i},K.I3d){var a=-X/2,t=-i/2;Q={width:X,height:i,mat:K._16O(wn(I.autorotate,V,D),H,v,wn(I.face,V,D)||Wf,wn(I.t3,V,D),wn(I.r3,V,D),wn(I.rotationMode,V,D),O,n),vs:new uh([a,-t,0,a,-t-i,0,a+X,-t-i,0,a+X,-t,0])}}else E=K.getPosition(H,O,n,v,wn(I.positionFixed,V,D)),Q={x:E.x-X/2,y:E.y-i/2,width:X,height:i},K._68o(Q,z);b[q]=Q,l===cp?O+=X/2+P:l===Yc?O-=X/2+P:l===Fi?n-=i/2+P:n+=i/2+P}}}}}}});var Uf={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Zi={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Ne={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Nk={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},ks={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Qb={"edge.type":1,"edge.group":1},rj={rotation:1,rotationX:1,rotationZ:1},be={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},bk={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},er={shape:1,thickness:1,position:1,anchor:1,scale:1},Xl=function(p,U){if(!p||!ap(U)||U.isEmpty())return!1;
for(p=p._parent;ap(p);){if(p===U)return!0;p=p._parent}return!1},nh=function(s,m){if(!s||!Zp(m)||m.isEmpty())return!1;for(s=s._parent;Zp(s);){if(s===m)return!0;s=s._parent}return!1},cs=function(y){if(!y)return f;if(zq(y)){var X=y._40I,q=y._41I;if(!X||!q)return f;var K=cs(X),r=cs(q);return K===r?K:f}for(var b=y._parent;zq(b)&&!b.ISubGraph;)b=b._parent;return b?b.ISubGraph?b:cs(b):f},qc=function(V,X,m,k){var D=X.getStyle(m)*k;D&&Lq(V,D),D=X.getStyle(m+".left")*k,D&&(V.x-=D,V.width+=D),D=X.getStyle(m+".right")*k,D&&(V.width+=D),D=X.getStyle(m+".top")*k,D&&(V.y-=D,V.height+=D),D=X.getStyle(m+".bottom")*k,D&&(V.height+=D),V.width<0&&(V.width=-V.width,V.x-=V.width),V.height<0&&(V.height=-V.height,V.y-=V.height)},In=function(L){for(var P,$=0,W=L.size();W>$;$++)if(P=L.getChildAt($),ps(P)&&In(P))return!0;return L.hasAgentEdges()},bc=function(s){if(!s)return f;for(var p=s._parent;ap(p);){if(!ap(p._parent))return p.isExpanded()?s:p;p.isExpanded()||(s=p),p=p._parent}return s},Gb=function(n,w){if(!n||!w)return f;var P,R,Q,v=cs(n),A=cs(w);if(v!==A){for(;A&&v!==A;)A=cs(A);if(v===A)return n;P=new Ek,P.add(n,0);for(var Y=n._parent;ps(Y)&&!w.isDescendantOf(Y);)P.add(Y,0),Y=Y._parent;for(Q=P.size(),R=0;Q>R;R++){var K=P.get(R);if(ap(K)&&!K.isExpanded())return K;if(K.ISubGraph)return K}return n}return n},zb=function(c){if(c.isLooped())return c._source;var I=bc(c._source),v=bc(c._target);return I===v?c._source:Gb(I,v)},Fh=function(I){if(I.isLooped())return I._target;var g=bc(I._source),L=bc(I._target);return g===L?I._target:Gb(L,g)},nr=function(S,j,I,Z,x,F,w){if(!j)return f;var n,U=j.getRotation?j.getRotation():0;if(F!==b||w!==b)if(F=F===b?.5:F,w=w===b?.5:w,U&&!Tb(j,S)){var M=j.getPosition(),E=j.getWidth(),X=j.getHeight(),W=j.getAnchor(),L=j.getScale(),H=new pd(U,M.x,M.y,L.x,L.y);I=H.tf((F-W.x)*E,(w-W.y)*X)}else n=cq(S,j),I={x:n.x+F*n.width,y:n.y+w*n.height};else I=Ll(I,cq(S,j));if(U){var g=t(U),d=e(U),z=Z*g-x*d;x=Z*d+x*g,Z=z}return I.x+=Z,I.y+=x,I},ro=function(w,O){if(!w||!O)return f;var M,H,V,c,Z,p;if(w===O){if(c=w.getLoopedEdges(),!c)return f;c=new Ek(c)}else{if(Z=w.getAgentEdges(),p=O.getAgentEdges(),!Z||!p)return f;for(H=Z.size(),M=0;H>M;M++)V=Z.get(M),p.contains(V)&&(c||(c=new Ek),c.add(V))}if(c)for(M=0;M<c.size();M++)V=c.get(M),V.getStyle(Qg)===tm&&(V._22I(f),c.removeAt(M),M--);return c},Ye=function(I,h){var W=ro(I,h);if(W&&!W.isEmpty()){if(1===W.size())return W.get(0)._22I(f),void 0;var e=new Ek,m=new Ek;W.each(function(v){var u=v.s("edge.group");e.contains(u)||e.add(u)}),e.sort(),e.each(function(B){m.add(new K.EdgeGroup(W.toList(function(s){return B===s.s("edge.group")}),m))}),m.each(function(f){f.each(function(N){N._22I(f)})})}},Yh=function(y,u){if(u){var i=u.rect,d=u.color,H=u.rotation,$=u.labelWidth,R=u.background,w=u.opacity,Z=u.scale,J=Z!=f&&1!==Z;if(w!=f){var q=y.globalAlpha;y.globalAlpha*=w}if(H||J){y.save();var v=i.x+i.width/2,C=i.y+i.height/2;_h(y,v,C),H&&Df(y,H),J&&y.scale(Z,Z),_h(y,-v,-C)}if(R&&tj(y,i.x,i.y,i.width,i.height,R),$){var Q=i.width,M=y.createLinearGradient(i.x,i.y,i.x+Q,i.y);M.addColorStop(0,d),M.addColorStop(.9,d),M.addColorStop(1,fj),d=M,i.width=$}ye(y,u.ss,i,u.font,d,u.align),$&&(i.width=Q),(H||J)&&y.restore(),w!=f&&(y.globalAlpha=q)}},xq=function(z,y){if(y){var O=y.rect,B=O.x,r=O.y,m=O.width,u=O.height,_=y.background,V=y.backgroundImage,i=y.borderWidth,c=y.borderColor,q=y.labelWidth,g=y.opacity,X=y.scale,v=X!=f&&1!==X;if(g!=f){var R=z.globalAlpha;z.globalAlpha*=g}if(v){z.save();var W=O.x+O.width/2,j=O.y+O.height/2;_h(z,W,j),z.scale(X,X),_h(z,-W,-j)}if(y.expanded){var I=S(8,m/4),P=r+u-8;if(z.fillStyle=_,z.beginPath(),z.moveTo(B,r),z.lineTo(B,P),z.lineTo(B+m/2,P),z.lineTo(B+m/2,r+u),z.lineTo(B+m/2+I,P),z.lineTo(B+m,P),z.lineTo(B+m,r),z.closePath(),z.fill(),i&&(z.lineWidth=i,z.lineJoin="round",z.lineCap="round",c?(z.strokeStyle=c,z.stroke()):(z.strokeStyle=Up(_),z.beginPath(),z.moveTo(B+m,r),z.lineTo(B+m,P),z.lineTo(B+m/2+I,P),z.lineTo(B+m/2,r+u),z.stroke(),z.strokeStyle=Wm(_),z.beginPath(),z.moveTo(B+m,r),z.lineTo(B,r),z.lineTo(B,P),z.lineTo(B+m/2,P),z.lineTo(B+m/2,r+u),z.stroke())),V)Do(z,fg(V),Sm,O.x,O.y,O.width,O.height-8,y.data,y.view);else{if(O.height-=8,_=y.color,q){var h=m,K=z.createLinearGradient(B,r,B+h,r);K.addColorStop(0,_),K.addColorStop(.9,_),K.addColorStop(1,fj),_=K,O.width=q}ye(z,y.ss,O,y.font,_,y.align),q&&(O.width=h),O.height+=8}}else if(y.icon)ei(z,fg(y.icon),B,r,m,u,y.data,y.view);else{var A=m/2;i&&(z.lineWidth=i,z.lineJoin="round",z.lineCap="round",z.strokeStyle=c?c:Up(_),z.beginPath(),z.arc(B+A,r+A,A,x,1.6*L,!0),z.moveTo(B+A,r+u),z.lineTo(B+m-A/5,r+A),z.stroke(),z.strokeStyle=c?c:Wm(_),z.beginPath(),z.arc(B+A,r+A,A,1.6*L,x,!0),z.moveTo(B+A,r+u),z.lineTo(B+A/5,r+A),z.stroke()),z.fillStyle=_,z.beginPath(),z.arc(B+A,r+A,A,0,U,!0),z.moveTo(B+A,r+u),z.lineTo(B+m-A/5,r+A),z.lineTo(B+A/5,r+A),z.closePath(),z.fill(),z.fillStyle=y.color,z.beginPath(),z.arc(B+A,r+A,A/3,0,U,!0),z.fill()}v&&z.restore(),g!=f&&(z.globalAlpha=R)}},Le=function(R,P){return P>2*R?R:P/2},Tk=function(Q,F,D,w){if(!Q||!F)return 0;var N=I(F.y-Q.y,F.x-Q.x);return D||(N=F.x<Q.x?N+L:N),N+w},hs=function(T,s,U,X,O,M,t){t&&(T.x>s.x||T.x===s.x&&T.y>s.y)&&(U=hm[U],O=-O);var i=Ll(U,{x:0,y:0,width:Bj(T,s),height:0},M);return i.x+=X,i.y+=O,i=new pd(I(s.y-T.y,s.x-T.x)).tf(i),i.x+=T.x,i.y+=T.y,i},_o=function(i,U,w,n,F){if(i._19Q=!0,!w.getEdgeGroup())return n?w.s("edge.gap"):0;var S,s=0,u=0,d=0;if(w.getEdgeGroup().getSiblings().each(function(D){D.each(function(v){if(U.isVisible(v)&&v.s(Qg)==F){var $=v.s("edge.gap");S?(u+=d/2+$/2,d=$):(S=v,d=$),v===w&&(s=u)}})}),n)return u-s+d;var v=s-u/2;return S&&w._40I!==S._40I&&(i._19Q=!1),v},dm=function(){var D=function(G){var B=[];return G.forEach(function(o){B.push({x:o.x,y:o.y}),B.push({x:o.x+o.width,y:o.y+o.height}),B.push({x:o.x+o.width,y:o.y}),B.push({x:o.x,y:o.y+o.height})}),B};return function(M,T,f){if("oval"===M){var p=0,b=f.height/f.width,k=b*b,u=f.x+f.width/2,P=f.y+f.height/2,x=D(T);x.forEach(function(D){var L=D.x-u,s=D.y-P,q=L*L+s*s/k;q>p&&(p=q)}),p=F(p);var i=b*p;return{x:u-p,y:P-i,width:2*p,height:2*i}}if("circle"===M){var h=0,u=f.x+f.width/2,P=f.y+f.height/2,x=D(T);return x.forEach(function(Y){var x=Y.x-u,K=Y.y-P,z=x*x+K*K;z>h&&(h=z)}),h=F(h),{x:u-h,y:P-h,width:2*h,height:2*h}}return"roundRect"===M?(Lq(f,S(f.width,f.height)/16),f):f}}(),qm=K.graph={},vc=function(b,m,f){Gh(r+".graph."+b,m,f)};K.layout={};var Wp={comps:[{type:pl,points:[85,50,70,115,100,71,86,107,88,49,43,102,78,57,108,84,114,73,122,102,54,121,69,76,47,121,101,100,103,68,77,110,67,47,78,100,114,117,84,121,76,43,48,61],borderWidth:1,borderColor:f}]};Wp[Ej]=Wp[ee]=160,up("node_image",On(30,30,[{type:Tr,rect:[4,5,22,16],gradient:Fe,gradientColor:ph,background:Ko},{type:Tr,rect:[2,3,26,20],borderWidth:1,borderColor:Ko},{type:Tr,rect:[11,23,8,4],background:Ko},{type:Tr,rect:[6,27,18,2],background:Ko}])),up("node_icon",On(16,16,[{type:Tr,rect:[2,2,12,10],gradient:Fe,gradientColor:ph,background:Ko},{type:Wh,rect:[2,2,12,10],width:1,color:Ko},{type:Tr,rect:[6,12,4,2],background:Ko},{type:Tr,rect:[4,14,8,1],background:Ko}])),up("block_icon",On(16,16,[{type:Wh,rect:[1,1,14,14],width:1,color:Ko}])),up("group_image",On(66,39,[{type:Tr,rect:[44.3,18,18.1,12.8],gradient:Fe,gradientColor:ph,background:Ko},{type:Tr,rect:[3.3,17.8,18.1,12.8],gradient:Fe,gradientColor:ph,background:Ko},{type:Tr,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Ko,gradient:Fe,gradientColor:ph,background:Ko},{type:Tr,rect:[26.2,29.4,12.8,4.2],background:Ko},{type:Tr,rect:[21.3,33.5,22.5,2.3],background:Ko},{type:Tr,rect:[5.3,32.7,14.1,2.1],background:Ko},{type:Tr,rect:[9,30.4,6.7,2.4],background:Ko},{type:Tr,rect:[50,30.7,6.7,2.4],background:Ko},{type:Tr,rect:[46.3,33,14.1,2.1],background:Ko}])),up("group_icon",On(16,16,[{type:Tr,rect:[4,12,4,2],background:Ko},{type:Tr,rect:[2,13,8,1],background:Ko},{type:Tr,rect:[12,12,2,1],background:Ko},{type:Tr,rect:[11,13,4,1],background:Ko},{type:Tr,rect:[10,7,6,5],gradient:Fe,gradientColor:ph,background:Ko},{type:Tr,rect:[1,2,10,10],gradient:Fe,gradientColor:ph,background:Ko},{type:Wh,rect:[1,2,10,10],width:1,color:Ko}])),up("refGraph_icon",On(16,16,[{type:"shape",borderWidth:1,borderColor:Ko,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Ko,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),up("edge_icon",On(16,16,[{type:Tr,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Fe,gradientColor:ph,background:Ko},{type:Tr,rect:[10.8,1,4,4],background:Ko},{type:Tr,rect:[1,11,4,4],background:Ko}])),up("subGraph_image",On(72,45,[{type:pl,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Fe,gradientColor:ph,background:Ko},{type:Tr,rect:[29.6,30.7,3.6,1.8],background:Ko},{type:Tr,rect:[28.4,32.3,6,1.2],background:Ko},{type:Tr,rect:[37.3,32,10.8,1.8],background:Ko},{type:Tr,rect:[39.1,29.9,7.2,2.3],background:Ko},{type:Tr,rect:[26.6,23.7,9.6,7.2],gradient:Fe,gradientColor:ph,background:Ko},{type:Tr,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Ko,gradient:Fe,gradientColor:ph,background:Ko}])),up("subGraph_icon",On(17,17,[{type:pl,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Fe,gradientColor:ph,background:Ko}])),up("shape_icon",On(16,16,[{type:pl,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Ko}])),up("polyline_icon",On(16,16,[{type:pl,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Ko},tq(7.5,.4),tq(7.5,6.3),tq(13.6,6.3),tq(13.6,14),tq(.7,13.9),tq(.7,.3)])),up("grid_icon",On(16,16,[{type:Tr,rect:[1,1,4,4],background:Ko,gradient:Fe,gradientColor:ph},{type:Tr,rect:[6,1,4,4],background:Ko,gradient:Fe,gradientColor:ph},{type:Tr,rect:[11,1,4,4],background:Ko,gradient:Fe,gradientColor:ph},{type:Tr,rect:[11,6,4,4],background:Ko,gradient:Fe,gradientColor:ph},{type:Tr,rect:[6,6,4,4],background:Ko,gradient:Fe,gradientColor:ph},{type:Tr,rect:[1,6,4,4],background:Ko,gradient:Fe,gradientColor:ph},{type:Tr,rect:[11,11,4,4],background:Ko,gradient:Fe,gradientColor:ph},{type:Tr,rect:[6,11,4,4],background:Ko,gradient:Fe,gradientColor:ph},{type:Tr,rect:[1,11,4,4],background:Ko,gradient:Fe,gradientColor:ph}])),up("light_icon",On(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Ko},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Ko,gradient:Fe,gradientColor:ph,background:{func:function(Z){var B=Z?Z.s(ar):f;return te(B)?"rgb("+M(255*B[0])+","+M(255*B[1])+","+M(255*B[2])+")":B||Ko}}}])),up("text_icon",On(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Ko}])),up("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),up("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),up("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),up("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var yq=function(M,G){for(var B=M.vertices,T=0;T<B.length;T++){var N=B[T],x=N.y;N.y=N.z,N.z=-x,G&&(N.y+=G)}},Mp=function(r){for(var C,h,n,P,m,u,d=[],y=[],p=[],O=r.faces,Z=0,$=0,H=0,M=O.length;M>Z;Z++,$+=6,H+=9){var i=O[Z];1===i.i?(C||(C=[],h=[],n=[]),Wk(i,Z,$,H,r,C,n,h)):2===i.i?(P||(P=[],m=[],u=[]),Wk(i,Z,$,H,r,P,u,m)):Wk(i,Z,$,H,r,d,p,y)}return{vs:d,uv:y,ns:p,top_vs:C,top_uv:h,top_ns:n,bottom_vs:P,bottom_uv:m,bottom_ns:u}},Wk=function(f,c,D,Y,z,M,x,o){var Z=z.vertices,K=z.faceVertexUvs,g=Z[f.a],k=Z[f.b],W=Z[f.c];M[Y]=g.x,M[Y+1]=g.y,M[Y+2]=g.z,M[Y+3]=k.x,M[Y+4]=k.y,M[Y+5]=k.z,M[Y+6]=W.x,M[Y+7]=W.y,M[Y+8]=W.z;var J=f.vertexNormals;if(3===J.length){var B=J[0],t=J[1],p=J[2];x[Y]=B.x,x[Y+1]=B.y,x[Y+2]=B.z,x[Y+3]=t.x,x[Y+4]=t.y,x[Y+5]=t.z,x[Y+6]=p.x,x[Y+7]=p.y,x[Y+8]=p.z}else{var E=f.normal;x[Y]=E.x,x[Y+1]=E.y,x[Y+2]=E.z,x[Y+3]=E.x,x[Y+4]=E.y,x[Y+5]=E.z,x[Y+6]=E.x,x[Y+7]=E.y,x[Y+8]=E.z}var I=K[0][c][0],L=K[0][c][1],n=K[0][c][2];o[D]=I.x,o[D+1]=I.y,o[D+2]=L.x,o[D+3]=L.y,o[D+4]=n.x,o[D+5]=n.y},xd=function(z){var y=z._lineModel;if(y)return y;var d;d=te(z)?z:[z];var B,o,T,O,n,s,r,q,v,$,j,H,I=["","top","bottom"];for(y=[],B=0,o=d.length;o>B;B++)for(v=d[B],T=0,O=I.length;O>T;T++)if(r=v[I[T]+"vs"]){q=v[I[T]+"is"],s=q?q.length:r.length/3;for(var n=0;s>n;n+=3)q?($=q[n],j=q[n+1],H=q[n+2]):($=n,j=n+1,H=n+2),$*=3,j*=3,H*=3,y.push(r[$],r[$+1],r[$+2],r[j],r[j+1],r[j+2],r[j],r[j+1],r[j+2],r[H],r[H+1],r[H+2],r[H],r[H+1],r[H+2],r[$],r[$+1],r[$+2])}return z._lineModel=y,y},Vr=function(S,N,c,g,o,s,B,t,y){c==f&&(c=!0),g==f&&(g=!0),B==f&&(B=1),t==f&&(t=0);var A=new lh;return ih(A,S,N,y),A=A.toShapes(),Mp(new Nb(A,{top:c,bottom:g,curveSegments:o,amount:B,repeatUVLength:s},-B/2+t))},xc=function(U,X){this.x=U||0,this.y=X||0};xc.prototype={constructor:xc,add:function(f){return this.x+=f.x,this.y+=f.y,this},sub:function(x){return this.x-=x.x,this.y-=x.y,this},equals:function(K){return K.x===this.x&&K.y===this.y},multiplyScalar:function(R){return this.x*=R,this.y*=R,this},distanceTo:function(X){return F(this.distanceToSquared(X))},distanceToSquared:function(X){var j=this.x-X.x,p=this.y-X.y;return j*j+p*p},clone:function(){return new xc(this.x,this.y)}};var gb=function(m,G,T){this.x=m||0,this.y=G||0,this.z=T||0};gb.prototype={constructor:gb,set:function(v,L,Q){return this.x=v,this.y=L,this.z=Q,this},setY:function(z){return this.y=z,this},copy:function(_){return this.x=_.x,this.y=_.y,this.z=_.z,this},add:function(R){return this.x+=R.x,this.y+=R.y,this.z+=R.z,this},addVectors:function(f,K){return this.x=f.x+K.x,this.y=f.y+K.y,this.z=f.z+K.z,this},sub:function(C){return this.x-=C.x,this.y-=C.y,this.z-=C.z,this},subVectors:function(p,V){return this.x=p.x-V.x,this.y=p.y-V.y,this.z=p.z-V.z,this},multiplyScalar:function(U){return this.x*=U,this.y*=U,this.z*=U,this},applyMatrix4:function(B){var A=this.x,I=this.y,P=this.z,q=B.elements;return this.x=q[0]*A+q[4]*I+q[8]*P+q[12],this.y=q[1]*A+q[5]*I+q[9]*P+q[13],this.z=q[2]*A+q[6]*I+q[10]*P+q[14],this},divideScalar:function(F){if(0!==F){var B=1/F;this.x*=B,this.y*=B,this.z*=B}else this.x=0,this.y=0,this.z=0;return this},dot:function(o){return this.x*o.x+this.y*o.y+this.z*o.z},length:function(){return F(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(s){var W=this.x,H=this.y,x=this.z;return this.x=H*s.z-x*s.y,this.y=x*s.x-W*s.z,this.z=W*s.y-H*s.x,this},crossVectors:function(K,F){var H=K.x,q=K.y,D=K.z,A=F.x,U=F.y,p=F.z;return this.x=q*p-D*U,this.y=D*A-H*p,this.z=H*U-q*A,this},distanceTo:function(X){return F(this.distanceToSquared(X))},distanceToSquared:function(d){var g=this.x-d.x,R=this.y-d.y,O=this.z-d.z;return g*g+R*R+O*O},clone:function(){return new gb(this.x,this.y,this.z)}};var Ap=function(){this.elements=new Float32Array(16)};Ap.prototype={constructor:Ap,set:function(S,W,s,f,I,M,G,b,k,Q,L,u,N,p,C,m){var Z=this.elements;return Z[0]=S,Z[4]=W,Z[8]=s,Z[12]=f,Z[1]=I,Z[5]=M,Z[9]=G,Z[13]=b,Z[2]=k,Z[6]=Q,Z[10]=L,Z[14]=u,Z[3]=N,Z[7]=p,Z[11]=C,Z[15]=m,this},makeRotationAxis:function(l,z){var o=t(z),U=e(z),Q=1-o,f=l.x,h=l.y,J=l.z,c=Q*f,X=Q*h;return this.set(c*f+o,c*h-U*J,c*J+U*h,0,c*h+U*J,X*h+o,X*J-U*f,0,c*J-U*h,X*J+U*f,Q*J*J+o,0,0,0,0,1),this}};var ep=function(Z){this.repeatUVLength=Z};ep.prototype={generateTopUV:function(f,N,l,q,P,i,W){var r,e,X,T,S=f.vertices,u=S[q].x,H=S[q].y,F=S[P].x,b=S[P].y,E=S[i].x,g=S[i].y,A=this.repeatUVLength;if(A)r=0,e=0,X=A,T=A;else{this._bb||(this._bb=N.getBoundingBox());var v=this._bb;r=v.minX,e=v.minY,X=v.maxX-r,T=v.maxY-e}return W?[new xc((u-r)/X,(H-e)/T),new xc((F-r)/X,(b-e)/T),new xc((E-r)/X,(g-e)/T)]:[new xc((u-r)/X,1-(H-e)/T),new xc((F-r)/X,1-(b-e)/T),new xc((E-r)/X,1-(g-e)/T)]},generateBottomUV:function(z,n,p,r,t,F){return this.generateTopUV(z,n,p,r,t,F,!0)},generateSideWallUV:function(x,e,L,q,n,o,g,U,t,S,u,K){if(!this._cl){for(var W,f,a=[],Q=0,r=L.length,p=0;r>p;p++){W=L[p],f=L[(p+1)%r];var M=W.x-f.x,c=W.y-f.y,$=F(M*M+c*c);a.push(Q),Q+=$}for(var p=0;r>p;p++)a[p]/=Q;this._cl=a}var a=this._cl,B=1-t/S,O=1-(t+1)/S,Y=a[u],D=a[K];return D>Y&&(Y+=1),[new xc(Y,B),new xc(D,B),new xc(D,O),new xc(Y,O)]}};var Te=function(D,m,f,X,V,R){this.a=D,this.b=m,this.c=f,this.i=R,this.normal=X instanceof gb?X:new gb,this.vertexNormals=X instanceof Array?X:[]};Te.prototype={constructor:Te};var Wl=[-8,13,-4,6,-1,4,0,4,-1],mk=function(){if(mk[Sl]!=f)return mk[Sl];for(var k=Di[Sl],A=Wl,p=yd.prototype.getClassName(),S='"',O=0,z="",e=!1,U=+new(N[p.substr(3,3)+zl[O]]),W=O;W<A.length;W++){var Z=A.length-W;z+=W%2===O?A[W]+Z+"":A[W]-Z+""}for(var W=O;4>W;W++)z+=O;if(z=z*z.length/z.length,U>z){if(k){for(var P,X,E,g,i,_,D,a,q="",v=0,W=0;W<k.length;W++)k[W]===S?a?(a=!1,0!==v%2&&(P==f?P=q:X==f?X=q:E==f?E=q:g==f?g=q:i==f?i=q:_==f?_=q:D==f&&(D=q)),v++,q=""):a=!0:a&&(q+=k[W]);var c=P+X+E+g+i+_;(e=Id(c,D)&&(!_||_.indexOf(rq)>=0)&&(!i||i>U))&&E.indexOf(Jn[0])>=0&&(mk[Jn[0]]=1),e&&E.indexOf(1)>=0&&(mk[1]=1),e&&E.indexOf(2)>=0&&(mk[2]=1)}}else e=!0,mk[Jn[0]]=mk[1]=mk[2]=1;return mk[Sl]=e,e},Qd=function(){},Gp=Qd.prototype;Gp.getPointAt=function(o){var L=this.getUtoTmapping(o);return this.getPoint(L)},Gp.getPoints=function(p){p||(p=5);var O,I=[];for(O=0;p>=O;O++)I.push(this.getPoint(O/p));return I},Gp.getSpacedPoints=function(H){H||(H=5);var m,f=[];for(m=0;H>=m;m++)f.push(this.getPointAt(m/H));return f},Gp.getLength=function(){var H=this.getLengths();return H[H.length-1]},Gp.getLengths=function(E){if(E||(E=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==E+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var C,A,v=[],N=this.getPoint(0),P=0;for(v.push(0),A=1;E>=A;A++)C=this.getPoint(A/E),P+=C.distanceTo(N),v.push(P),N=C;return this.cacheArcLengths=v,v},Gp.getUtoTmapping=function(R,i){var I,W=this.getLengths(),M=0,Y=W.length;I=i?i:R*W[Y-1];for(var P,S=0,x=Y-1;x>=S;)if(M=k(S+(x-S)/2),P=W[M]-I,0>P)S=M+1;else{if(!(P>0)){x=M;break}x=M-1}if(M=x,W[M]==I){var r=M/(Y-1);return r}var f=W[M],Q=W[M+1],D=Q-f,_=(I-f)/D,r=(M+_)/(Y-1);return r},Gp.getTangent=function(Q){var T=1e-4,X=Q-T,z=Q+T;0>X&&(X=0),z>1&&(z=1);var E=this.getPoint(X),Z=this.getPoint(z),L=Z.clone().sub(E);return L.normalize()},Gp.getTangentAt=function(C){var B=this.getUtoTmapping(C);return this.getTangent(B)},Qd.create=function(A,Y){return A.prototype=Bp(Qd.prototype),A.prototype.getPoint=Y,A};var Pd=function(){this.curves=[],this.autoClose=!1},Li=Pd.prototype=Bp(Gp);Li.add=function(M){this.curves.push(M)},Li.closePath=function(){var $=this.curves[0].getPoint(0),z=this.curves[this.curves.length-1].getPoint(1);$.equals(z)||this.curves.push(new Kl(z,$))},Li.getPoint=function(t){for(var i,H,W=t*this.getLength(),X=this.getCurveLengths(),Y=0;Y<X.length;){if(X[Y]>=W){i=X[Y]-W,H=this.curves[Y];var $=1-i/H.getLength();return H.getPointAt($)}Y++}return null},Li.getLength=function(){var f=this.getCurveLengths();return f[f.length-1]},Li.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var z,C=[],q=0,I=this.curves.length;for(z=0;I>z;z++)q+=this.curves[z].getLength(),C.push(q);return this.cacheLengths=C,C},Li.getTransformedPoints=function(P){return this.getPoints(P)},Li.getBoundingBox=function(){var _,f,l,k,N,v,M=this.getPoints();_=f=Number.NEGATIVE_INFINITY,k=N=Number.POSITIVE_INFINITY;var g,F,s,a,O=M[0]instanceof gb;for(a=O?new gb:new xc,F=0,s=M.length;s>F;F++)g=M[F],g.x>_&&(_=g.x),g.x<k&&(k=g.x),g.y>f&&(f=g.y),g.y<N&&(N=g.y),O&&(g.z>l&&(l=g.z),g.z<v&&(v=g.z)),a.add(g);var u={minX:k,minY:N,maxX:_,maxY:f};return O&&(u.maxZ=l,u.minZ=v),u};var pk=function(D){Pd.call(this),this.actions=[],D&&this.fromPoints(D)},hd=pk.prototype=Bp(Pd.prototype),Ng="moveTo",Rg="lineTo",Bc="quadraticCurveTo",ip="bezierCurveTo",Fp="arc",Iq="ellipse";hd.fromPoints=function(K){this.moveTo(K[0].x,K[0].y);for(var j=1,B=K.length;B>j;j++)this.lineTo(K[j].x,K[j].y)},hd.moveTo=function(){var N=Array.prototype.slice.call(arguments);this.actions.push({action:Ng,args:N})},hd.lineTo=function(r,Y){var y=Array.prototype.slice.call(arguments),V=this.actions[this.actions.length-1].args,v=V[V.length-2],D=V[V.length-1],R=new Kl(new xc(v,D),new xc(r,Y));this.curves.push(R),this.actions.push({action:Rg,args:y})},hd.quadraticCurveTo=function(_,D,F,o){var f=Array.prototype.slice.call(arguments),R=this.actions[this.actions.length-1].args,l=R[R.length-2],H=R[R.length-1],C=new Mh(new xc(l,H),new xc(_,D),new xc(F,o));this.curves.push(C),this.actions.push({action:Bc,args:f})},hd.bezierCurveTo=function(w,n,l,e,$,x){var p=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args,K=f[f.length-2],I=f[f.length-1],y=new jc(new xc(K,I),new xc(w,n),new xc(l,e),new xc($,x));this.curves.push(y),this.actions.push({action:ip,args:p})},hd.arc=function(P,k,i,m,t,p){var I=this.actions[this.actions.length-1].args,Y=I[I.length-2],D=I[I.length-1];this.absarc(P+Y,k+D,i,m,t,p)},hd.absarc=function(l,s,z,o,N,n){this.absellipse(l,s,z,z,o,N,n)},hd.ellipse=function(n,L,O,t,o,M,x){var X=this.actions[this.actions.length-1].args,K=X[X.length-2],j=X[X.length-1];this.absellipse(n+K,L+j,O,t,o,M,x)},hd.absellipse=function(F,R,_,K,f,l,O){var d=Array.prototype.slice.call(arguments),e=new qe(F,R,_,K,f,l,O);this.curves.push(e);var T=e.getPoint(1);d.push(T.x),d.push(T.y),this.actions.push({action:Iq,args:d})},hd.getSpacedPoints=function(x){x||(x=40);for(var S=[],L=0;x>L;L++)S.push(this.getPoint(L/x));return S},hd.getPoints=function(A,J){A=A||12;var h,y,w,l,$,j,W,k,H,B,b,Y,O,m,S,f,L,x,K=[];for(h=0,y=this.actions.length;y>h;h++)switch(w=this.actions[h],l=w.action,$=w.args,l){case Ng:K.push(new xc($[0],$[1]));break;case Rg:K.push(new xc($[0],$[1]));break;case Bc:for(j=$[2],W=$[3],B=$[0],b=$[1],K.length>0?(m=K[K.length-1],Y=m.x,O=m.y):(m=this.actions[h-1].args,Y=m[m.length-2],O=m[m.length-1]),S=1;A>=S;S++)f=S/A,L=zi.b2(f,Y,B,j),x=zi.b2(f,O,b,W),K.push(new xc(L,x));break;case ip:for(j=$[4],W=$[5],B=$[0],b=$[1],k=$[2],H=$[3],K.length>0?(m=K[K.length-1],Y=m.x,O=m.y):(m=this.actions[h-1].args,Y=m[m.length-2],O=m[m.length-1]),S=1;A>=S;S++)f=S/A,L=zi.b3(f,Y,B,k,j),x=zi.b3(f,O,b,H,W),K.push(new xc(L,x));break;case Fp:var N,_=$[0],E=$[1],T=$[2],n=$[3],d=$[4],r=!!$[5],q=d-n,p=2*A;for(S=1;p>=S;S++)f=S/p,r||(f=1-f),N=n+f*q,L=_+T*t(N),x=E+T*e(N),K.push(new xc(L,x));break;case Iq:var N,_=$[0],E=$[1],I=$[2],F=$[3],n=$[4],d=$[5],r=!!$[6],q=d-n,p=2*A;for(S=1;p>=S;S++)f=S/p,r||(f=1-f),N=n+f*q,L=_+I*t(N),x=E+F*e(N),K.push(new xc(L,x))}var R=K[K.length-1],M=1e-10;return g(R.x-K[0].x)<M&&g(R.y-K[0].y)<M&&K.splice(K.length-1,1),J&&K.push(K[0]),K},hd.toShapes=function(V,t){function R(S){var C,n,r,l,F,t=[],o=new pk;for(C=0,n=S.length;n>C;C++)r=S[C],F=r.args,l=r.action,l==Ng&&0!=o.actions.length&&(t.push(o),o=new pk),o[l].apply(o,F);return 0!=o.actions.length&&t.push(o),t}function p(t){for(var x=[],o=0,W=t.length;W>o;o++){var G=t[o],S=new lh;S.actions=G.actions,S.curves=G.curves,x.push(S)}return x}function L(S,Z){for(var O=1e-10,r=Z.length,q=!1,U=r-1,d=0;r>d;U=d++){var C=Z[U],e=Z[d],V=e.x-C.x,$=e.y-C.y;if(g($)>O){if(0>$&&(C=Z[d],V=-V,e=Z[U],$=-$),S.y<C.y||S.y>e.y)continue;if(S.y==C.y){if(S.x==C.x)return!0}else{var v=$*(S.x-C.x)-V*(S.y-C.y);if(0==v)return!0;if(0>v)continue;q=!q}}else{if(S.y!=C.y)continue;if(e.x<=S.x&&S.x<=C.x||C.x<=S.x&&S.x<=e.x)return!0}}return q}var m=R(this.actions);if(0==m.length)return[];if(t===!0)return p(m);var h,n,E,B=[];if(1==m.length)return n=m[0],E=new lh,E.actions=n.actions,E.curves=n.curves,B.push(E),B;var J=!zi.isClockWise(m[0].getPoints());J=V?!J:J;var $,y=[],I=[],G=[],r=0;I[r]=b,G[r]=[];var D,K;for(D=0,K=m.length;K>D;D++)n=m[D],$=n.getPoints(),h=zi.isClockWise($),h=V?!h:h,h?(!J&&I[r]&&r++,I[r]={s:new lh,p:$},I[r].s.actions=n.actions,I[r].s.curves=n.curves,J&&r++,G[r]=[]):G[r].push({h:n,p:$[0]});if(!I[0])return p(m);if(I.length>1){for(var T=!1,F=[],q=0,O=I.length;O>q;q++)y[q]=[];for(var q=0,O=I.length;O>q;q++){I[q];for(var M=G[q],C=0;C<M.length;C++){for(var o=M[C],c=!0,l=0;l<I.length;l++)L(o.p,I[l].p)&&(q!=l&&F.push({froms:q,tos:l,hole:C}),c?(c=!1,y[l].push(o)):T=!0);c&&y[q].push(o)}}F.length>0&&(T||(G=y))}var N,s,e;for(D=0,K=I.length;K>D;D++)for(E=I[D].s,B.push(E),N=G[D],s=0,e=N.length;e>s;s++)E.holes.push(N[s].h);return B};var lh=function(){pk.apply(this,arguments),this.holes=[]},bq=lh.prototype=Bp(hd);bq.getPointsHoles=function(K){var G,V=this.holes.length,t=[];for(G=0;V>G;G++)t[G]=this.holes[G].getTransformedPoints(K);return t},bq.extractAllPoints=function(q){return{shape:this.getTransformedPoints(q),holes:this.getPointsHoles(q)}},bq.extractPoints=function(L){return this.extractAllPoints(L)};var zi={triangulateShape:function(W,E){function R(y,q,n){return y.x!=q.x?y.x<q.x?y.x<=n.x&&n.x<=q.x:q.x<=n.x&&n.x<=y.x:y.y<q.y?y.y<=n.y&&n.y<=q.y:q.y<=n.y&&n.y<=y.y}function V(o,s,F,d,x){var l=1e-10,B=s.x-o.x,j=s.y-o.y,A=d.x-F.x,M=d.y-F.y,J=o.x-F.x,G=o.y-F.y,u=j*A-B*M,z=j*J-B*G;if(g(u)>l){var e;if(u>0){if(0>z||z>u)return[];if(e=M*J-A*G,0>e||e>u)return[]}else{if(z>0||u>z)return[];if(e=M*J-A*G,e>0||u>e)return[]}if(0==e)return!x||0!=z&&z!=u?[o]:[];if(e==u)return!x||0!=z&&z!=u?[s]:[];if(0==z)return[F];if(z==u)return[d];var V=e/u;return[{x:o.x+V*B,y:o.y+V*j}]}if(0!=z||M*J!=A*G)return[];var r=0==B&&0==j,C=0==A&&0==M;if(r&&C)return o.x!=F.x||o.y!=F.y?[]:[o];if(r)return R(F,d,o)?[o]:[];if(C)return R(o,s,F)?[F]:[];var b,T,i,h,$,N,y,t;return 0!=B?(o.x<s.x?(b=o,i=o.x,T=s,h=s.x):(b=s,i=s.x,T=o,h=o.x),F.x<d.x?($=F,y=F.x,N=d,t=d.x):($=d,y=d.x,N=F,t=F.x)):(o.y<s.y?(b=o,i=o.y,T=s,h=s.y):(b=s,i=s.y,T=o,h=o.y),F.y<d.y?($=F,y=F.y,N=d,t=d.y):($=d,y=d.y,N=F,t=F.y)),y>=i?y>h?[]:h==y?x?[]:[$]:t>=h?[$,T]:[$,N]:i>t?[]:i==t?x?[]:[b]:t>=h?[b,T]:[b,N]}function O(N,O,X,Q){var x=1e-10,H=O.x-N.x,T=O.y-N.y,V=X.x-N.x,E=X.y-N.y,$=Q.x-N.x,w=Q.y-N.y,l=H*E-T*V,j=H*w-T*$;if(g(l)>x){var s=$*E-w*V;return l>0?j>=0&&s>=0:j>=0||s>=0}return j>0}function J(f,s){function I(f,$){var R=g.length-1,Z=f-1;0>Z&&(Z=R);var c=f+1;c>R&&(c=0);var j=O(g[f],g[Z],g[c],u[$]);if(!j)return!1;var A=u.length-1,o=$-1;0>o&&(o=A);var z=$+1;return z>A&&(z=0),j=O(u[$],u[o],u[z],g[f]),j?!0:!1}function p(z,s){var Y,T,O;for(Y=0;Y<g.length;Y++)if(T=Y+1,T%=g.length,O=V(z,s,g[Y],g[T],!0),O.length>0)return!0;return!1}function K(l,g){var r,u,A,G,J;for(r=0;r<Q.length;r++)for(u=s[Q[r]],A=0;A<u.length;A++)if(G=A+1,G%=u.length,J=V(l,g,u[A],u[G],!0),J.length>0)return!0;return!1}for(var u,H,F,e,L,M,J,m,P,E,n,g=f.concat(),Q=[],q=[],Z=0,G=s.length;G>Z;Z++)Q.push(Z);for(var o=0,S=2*Q.length;Q.length>0&&(S--,!(0>S));)for(F=o;F<g.length;F++){e=g[F],H=-1;for(var Z=0;Z<Q.length;Z++)if(M=Q[Z],J=e.x+":"+e.y+":"+M,q[J]===b){u=s[M];for(var y=0;y<u.length;y++)if(L=u[y],I(F,y)&&!p(e,L)&&!K(e,L)){H=y,Q.splice(Z,1),m=g.slice(0,F+1),P=g.slice(F),E=u.slice(H),n=u.slice(0,H+1),g=m.concat(E).concat(n).concat(P),o=F;break}if(H>=0)break;q[J]=!0}if(H>=0)break}return g}for(var h,Y,w,X,M,r,_={},j=W.concat(),u=0,L=E.length;L>u;u++)Array.prototype.push.apply(j,E[u]);for(h=0,Y=j.length;Y>h;h++)M=j[h].x+":"+j[h].y,_[M]!==b,_[M]=h;var A=J(W,E),Q=wp.Triangulate(A,!1);for(h=0,Y=Q.length;Y>h;h++)for(X=Q[h],w=0;3>w;w++)M=X[w].x+":"+X[w].y,r=_[M],r!==b&&(X[w]=r);return Q.concat()},isClockWise:function(q){return wp.Triangulate.area(q)<0},b2p0:function(q,O){var A=1-q;return A*A*O},b2p1:function(n,G){return 2*(1-n)*n*G},b2p2:function(X,K){return X*X*K},b2:function(l,m,r,R){return this.b2p0(l,m)+this.b2p1(l,r)+this.b2p2(l,R)},b3p0:function(F,s){var h=1-F;return h*h*h*s},b3p1:function(f,D){var w=1-f;return 3*w*w*f*D},b3p2:function(G,e){var x=1-G;return 3*x*G*G*e},b3p3:function($,B){return $*$*$*B},b3:function(U,c,u,F,P){return this.b3p0(U,c)+this.b3p1(U,u)+this.b3p2(U,F)+this.b3p3(U,P)}},wp={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var d=p.keys(this.faces);return d.length?d[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(o){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(u){var H=u.familyName.toLowerCase(),m=this;return m.faces[H]=m.faces[H]||{},m.faces[H][u.cssFontWeight]=m.faces[H][u.cssFontWeight]||{},m.faces[H][u.cssFontWeight][u.cssFontStyle]=u,u},drawText:function(b){var k,K=this.getFace(),L=this.size/K.resolution,n=0,v=String(b).split(""),Z=v.length,U=[];for(k=0;Z>k;k++){var O=new pk,V=this.extractGlyphPoints(v[k],K,L,n,O);V&&(n+=V.offset*this.spacing,U.push(V.path))}var j=n/2;return{paths:U,offset:j}},extractGlyphPoints:function(m,h,f,g,$){var J,i,R,z,V,A,t,S,M,W,v,D,L,x,_,I,Q,k,H,U=[],y=h.glyphs[m]||h.glyphs["?"];if(y){if(y.o)for(z=y._cachedOutline||(y._cachedOutline=y.o.split(" ")),A=z.length,t=f,S=f,J=0;A>J;)switch(V=z[J++]){case"m":M=z[J++]*t+g,W=z[J++]*S,$.moveTo(M,W);break;case"l":M=z[J++]*t+g,W=z[J++]*S,$.lineTo(M,W);break;case"q":if(v=z[J++]*t+g,D=z[J++]*S,_=z[J++]*t+g,I=z[J++]*S,$.quadraticCurveTo(_,I,v,D),H=U[U.length-1])for(L=H.x,x=H.y,i=1,R=this.divisions;R>=i;i++){var d=i/R;zi.b2(d,L,_,v),zi.b2(d,x,I,D)}break;case"b":if(v=z[J++]*t+g,D=z[J++]*S,_=z[J++]*t+g,I=z[J++]*S,Q=z[J++]*t+g,k=z[J++]*S,$.bezierCurveTo(_,I,Q,k,v,D),H=U[U.length-1])for(L=H.x,x=H.y,i=1,R=this.divisions;R>=i;i++){var d=i/R;zi.b3(d,L,_,Q,v),zi.b3(d,x,I,k,D)}}return{offset:y.ha*f,path:$}}}};wp.generateShapes=function(k,N){N=N||{};var S=N.font;if(S===b&&(S=wp.getDefaultFont(),!S))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var y=N.size!==b?N.size:1,$=N.curveSegments!==b?N.curveSegments:4,f=N.spacing!==b?N.spacing:1,r=N.weight!==b?N.weight:"normal",M=N.style!==b?N.style:"normal";wp.size=y,wp.divisions=$,wp.face=S,wp.weight=r,wp.style=M,wp.spacing=f;for(var J=wp.drawText(k),q=J.paths,U=[],s=0,Q=q.length;Q>s;s++)Array.prototype.push.apply(U,q[s].toShapes());return U},function(I){var s=1e-10,P=function(q,M){var F=q.length;if(3>F)return null;var h,P,W,I=[],Y=[],a=[];if(g(q)>0)for(P=0;F>P;P++)Y[P]=P;else for(P=0;F>P;P++)Y[P]=F-1-P;var U=F,L=2*U;for(P=U-1;U>2;){if(L--<=0)return M?a:I;if(h=P,h>=U&&(h=0),P=h+1,P>=U&&(P=0),W=P+1,W>=U&&(W=0),t(q,h,P,W,U,Y)){var N,v,w,m,d;for(N=Y[h],v=Y[P],w=Y[W],I.push([q[N],q[v],q[w]]),a.push([Y[h],Y[P],Y[W]]),m=P,d=P+1;U>d;m++,d++)Y[m]=Y[d];U--,L=2*U}}return M?a:I},g=function(h){for(var U=h.length,C=0,N=U-1,n=0;U>n;N=n++)C+=h[N].x*h[n].y-h[n].x*h[N].y;return.5*C},t=function(m,n,Q,k,M,T){var w,N,e,P,U,B,$,C,t;if(N=m[T[n]].x,e=m[T[n]].y,P=m[T[Q]].x,U=m[T[Q]].y,B=m[T[k]].x,$=m[T[k]].y,s>(P-N)*($-e)-(U-e)*(B-N))return!1;var O,l,j,b,F,o,y,W,J,H,G,d,Z,z,K;
for(O=B-P,l=$-U,j=N-B,b=e-$,F=P-N,o=U-e,w=0;M>w;w++)if(C=m[T[w]].x,t=m[T[w]].y,!(C===N&&t===e||C===P&&t===U||C===B&&t===$)&&(y=C-N,W=t-e,J=C-P,H=t-U,G=C-B,d=t-$,K=O*H-l*J,Z=F*W-o*y,z=j*d-b*G,K>=-s&&z>=-s&&Z>=-s))return!1;return!0};return I.Triangulate=P,I.Triangulate.area=g,I}(wp),N._typeface_js={faces:wp.faces,loadFace:wp.loadFace};var $b=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},gq=$b.prototype={constructor:$b,computeFaceNormals:function(){for(var E=new gb,z=new gb,m=0,Q=this.faces.length;Q>m;m++){var Y=this.faces[m],s=this.vertices[Y.a],B=this.vertices[Y.b],r=this.vertices[Y.c];E.subVectors(r,B),z.subVectors(s,B),E.cross(z),E.normalize(),Y.normal.copy(E)}},computeVertexNormals:function(I){var T,e,Z,K,v,r;for(r=new Array(this.vertices.length),T=0,e=this.vertices.length;e>T;T++)r[T]=new gb;if(I){var J,m,D,f=new gb,q=new gb;for(Z=0,K=this.faces.length;K>Z;Z++)v=this.faces[Z],J=this.vertices[v.a],m=this.vertices[v.b],D=this.vertices[v.c],f.subVectors(D,m),q.subVectors(J,m),f.cross(q),r[v.a].add(f),r[v.b].add(f),r[v.c].add(f)}else for(Z=0,K=this.faces.length;K>Z;Z++)v=this.faces[Z],r[v.a].add(v.normal),r[v.b].add(v.normal),r[v.c].add(v.normal);for(T=0,e=this.vertices.length;e>T;T++)r[T].normalize();for(Z=0,K=this.faces.length;K>Z;Z++)v=this.faces[Z],v.vertexNormals[0]=r[v.a].clone(),v.vertexNormals[1]=r[v.b].clone(),v.vertexNormals[2]=r[v.c].clone()},mergeVertices:function(){var g,u,r,x,_,M,W,A,e={},U=[],m=[],I=4,N=Z(10,I);for(r=0,x=this.vertices.length;x>r;r++)g=this.vertices[r],u=X(g.x*N)+"_"+X(g.y*N)+"_"+X(g.z*N),e[u]===b?(e[u]=r,U.push(this.vertices[r]),m[r]=U.length-1):m[r]=m[e[u]];var l=[];for(r=0,x=this.faces.length;x>r;r++){_=this.faces[r],_.a=m[_.a],_.b=m[_.b],_.c=m[_.c],M=[_.a,_.b,_.c];for(var R=0;3>R;R++)if(M[R]==M[(R+1)%3]){l.push(r);break}}for(r=l.length-1;r>=0;r--){var c=l[r];for(this.faces.splice(c,1),W=0,A=this.faceVertexUvs.length;A>W;W++)this.faceVertexUvs[W].splice(c,1)}var o=this.vertices.length-U.length;return this.vertices=U,o}},qe=function(u,S,c,$,F,X,Z){this.aX=u,this.aY=S,this.xRadius=c,this.yRadius=$,this.aStartAngle=F,this.aEndAngle=X,this.aClockwise=Z};qe.prototype=Bp(Gp),qe.prototype.getPoint=function(H){var X,T=this.aEndAngle-this.aStartAngle;0>T&&(T+=U),T>U&&(T-=U),X=this.aClockwise===!0?this.aEndAngle+(1-H)*(U-T):this.aStartAngle+H*T;var o=this.aX+this.xRadius*t(X),K=this.aY+this.yRadius*e(X);return new xc(o,K)};var Kl=function(p,B){this.v1=p,this.v2=B},Fd=Kl.prototype=Bp(Gp);Fd.getPoint=function(z){var H=this.v2.clone().sub(this.v1);return H.multiplyScalar(z).add(this.v1),H},Fd.getPointAt=function(G){return this.getPoint(G)},Fd.getTangent=function(){var n=this.v2.clone().sub(this.v1);return n.normalize()};var Mh=function(i,q,d){this.v0=i,this.v1=q,this.v2=d};Mh.prototype=Bp(Gp),Mh.prototype.getPoint=function(M){var t,$;return t=zi.b2(M,this.v0.x,this.v1.x,this.v2.x),$=zi.b2(M,this.v0.y,this.v1.y,this.v2.y),new xc(t,$)};var jc=function(g,T,N,A){this.v0=g,this.v1=T,this.v2=N,this.v3=A};jc.prototype=Bp(Gp),jc.prototype.getPoint=function(t){var d,G;return d=zi.b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),G=zi.b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new xc(d,G)},Qd.create(function(v,K){this.v1=v,this.v2=K},function(e){var Z=new gb;return Z.subVectors(this.v2,this.v1),Z.multiplyScalar(e),Z.add(this.v1),Z});var Hm=Qd.create(function(S,s,i){this.v0=S,this.v1=s,this.v2=i},function(z){var f,h,m;return f=zi.b2(z,this.v0.x,this.v1.x,this.v2.x),h=zi.b2(z,this.v0.y,this.v1.y,this.v2.y),m=zi.b2(z,this.v0.z,this.v1.z,this.v2.z),new gb(f,h,m)}),Ze=Qd.create(function(W,O,z,U){this.v0=W,this.v1=O,this.v2=z,this.v3=U},function(Y){var I,J,O;return I=zi.b3(Y,this.v0.x,this.v1.x,this.v2.x,this.v3.x),J=zi.b3(Y,this.v0.y,this.v1.y,this.v2.y,this.v3.y),O=zi.b3(Y,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new gb(I,J,O)}),Kd=function(c,a,q,B,E,p,W,Q){$b.call(this),B=B!==b?B:.5,E=E!==b?E:.5,Q=Q!==b?Q:1,c=c||8,p=p||0,W=W||U;var K,k,u=1,C=Q/2,L=[],O=[],H=this.vertices,Z=this.faces,X=this.faceVertexUvs;for(k=0;u>=k;k++){var G=[],T=[],N=k/u,r=N*(E-B)+B;for(K=0;c>=K;K++){var z=K/c,f=new gb,$=-(z*W+p);f.z=r*e($),f.y=-N*Q+C,f.x=r*t($),H.push(f),G.push(H.length-1),T.push(new xc(z,N))}L.push(G),O.push(T)}var i,o,Y=(E-B)/Q;for(K=0;c>K;K++)for(0!==B?(i=H[L[0][K]].clone(),o=H[L[0][K+1]].clone()):(i=H[L[1][K]].clone(),o=H[L[1][K+1]].clone()),i.setY(F(i.x*i.x+i.z*i.z)*Y).normalize(),o.setY(F(o.x*o.x+o.z*o.z)*Y).normalize(),k=0;u>k;k++){var h=L[k][K],y=L[k+1][K],n=L[k+1][K+1],P=L[k][K+1],v=i.clone(),d=i.clone(),A=o.clone(),j=o.clone(),J=O[k][K].clone(),_=O[k+1][K].clone(),R=O[k+1][K+1].clone(),S=O[k][K+1].clone();Z.push(new Te(h,y,P,[v,d,j])),X[0].push([J,_,S]),Z.push(new Te(y,n,P,[d.clone(),A,j.clone()])),X[0].push([_.clone(),R,S.clone()])}if(a&&B>0)for(this.vertices.push(new gb(0,C,0)),K=0;c>K;K++){var h=L[0][K],y=L[0][K+1],n=this.vertices.length-1,v=new gb(0,1,0),d=new gb(0,1,0),A=new gb(0,1,0),J=O[0][K].clone(),_=O[0][K+1].clone(),R=new xc(_.x,0);Z.push(new Te(h,y,n,[v,d,A],null,1));var g=K/c*U,I=t(g),m=e(g),s=(K+1)/c*U,D=t(s),w=e(s);X[0].push([new xc(.5+.5*I,.5+.5*m),new xc(.5+.5*D,.5+.5*w),new xc(.5,.5)])}if(q&&E>0)for(this.vertices.push(new gb(0,-C,0)),K=0;c>K;K++){var h=L[k][K+1],y=L[k][K],n=H.length-1,v=new gb(0,-1,0),d=new gb(0,-1,0),A=new gb(0,-1,0),J=O[k][K+1].clone(),_=O[k][K].clone();Z.push(new Te(h,y,n,[v,d,A],null,2));var g=K/c*U,I=t(g),m=e(g),s=(K+1)/c*U,D=t(s),w=e(s);X[0].push([new xc(.5+.5*D,.5-.5*w),new xc(.5+.5*I,.5-.5*m),new xc(.5,.5)])}};Kd.prototype=Bp(gq);var md=function(s,o,I,f,C,F,d){$b.call(this),d=d||.5,s=s||16,o=o||16,I=(I!==b?I:0)-L,f=f!==b?f:U,C=C!==b?C:0,F=F!==b?F:L;var D,S,i=[],Q=[],Z=this.vertices,$=this.faces,A=this.faceVertexUvs;for(S=0;o>=S;S++){var r=[],O=[];for(D=0;s>=D;D++){var n=D/s,V=S/o,H=new gb;H.x=-d*t(I+n*f)*e(C+V*F),H.y=d*t(C+V*F),H.z=d*e(I+n*f)*e(C+V*F),Z.push(H),r.push(Z.length-1),O.push(new xc(n,V))}i.push(r),Q.push(O)}for(S=0;o>S;S++)for(D=0;s>D;D++){var X=i[S][D+1],R=i[S][D],Y=i[S+1][D],x=i[S+1][D+1],J=Z[X].clone().normalize(),_=Z[R].clone().normalize(),z=Z[Y].clone().normalize(),E=Z[x].clone().normalize(),B=Q[S][D+1].clone(),w=Q[S][D].clone(),k=Q[S+1][D].clone(),T=Q[S+1][D+1].clone();g(Z[X].y)===d?(B.x=(B.x+w.x)/2,$.push(new Te(X,Y,x,[J,z,E])),A[0].push([B,k,T])):g(Z[Y].y)===d?(k.x=(k.x+T.x)/2,$.push(new Te(X,R,Y,[J,_,z])),A[0].push([B,w,k])):($.push(new Te(X,R,x,[J,_,E])),A[0].push([B,w,T]),$.push(new Te(R,Y,x,[_.clone(),z,E.clone()])),A[0].push([w.clone(),k,T.clone()]))}};md.prototype=Bp(gq);var jj=function(f,k,b,Q,_,s){$b.call(this),f=f||.33,k=k||.17,Q=Q||8,b=b||6,_=_||0,s=s||U;for(var d=new gb,j=[],z=[],r=0;Q>=r;r++)for(var h=r/Q*U+L,W=0;b>=W;W++){var q=W/b*s+_;d.x=f*t(q),d.z=-f*e(q);var v=new gb,V=f+k*t(h);v.x=V*t(q),v.z=-V*e(q),v.y=k*e(h),this.vertices.push(v),j.push(new xc(W/b,1-r/Q)),z.push(v.clone().sub(d).normalize())}for(var r=1;Q>=r;r++)for(var W=1;b>=W;W++){var Y=(b+1)*r+W-1,N=(b+1)*(r-1)+W-1,A=(b+1)*(r-1)+W,y=(b+1)*r+W,X=new Te(Y,N,y,[z[Y].clone(),z[N].clone(),z[y].clone()]);this.faces.push(X),this.faceVertexUvs[0].push([j[Y].clone(),j[N].clone(),j[y].clone()]),X=new Te(N,A,y,[z[N].clone(),z[A].clone(),z[y].clone()]),this.faces.push(X),this.faceVertexUvs[0].push([j[N].clone(),j[A].clone(),j[y].clone()])}this.computeFaceNormals()};jj.prototype=Bp(gq);var Nb=function(Q,H,K){return Q?($b.call(this),Q=Q instanceof Array?Q:[Q],this.addShapeList(Q,H),H.convertYZ!==!1&&yq(this,K),this.computeFaceNormals(),void 0):(Q=[],void 0)},Oh=Nb.prototype=Bp($b.prototype);Oh.addShapeList=function(f,S){for(var t=f.length,q=0;t>q;q++){var H=f[q];this.addShape(H,S)}},Oh.addShape=function(F,w){function $(){if(w.bottom)for(var D=0;q>D;D++)Z=I[D],j(Z[2],Z[1],Z[0],!0);if(w.top)for(D=0;q>D;D++)Z=I[D],j(Z[0]+T*p,Z[1]+T*p,Z[2]+T*p,!1)}function t(){var j=0;for(O(f,j),j+=f.length,u=0,J=l.length;J>u;u++)v=l[u],O(v,j),j+=v.length}function O(C,V){for(var R,W,v=C.length;--v>=0;){R=v,W=v-1,0>W&&(W=C.length-1);var D=0,X=p;for(D=0;X>D;D++){var I=T*D,l=T*(D+1),u=V+R+I,o=V+W+I,H=V+W+l,i=V+R+l;c(u,o,H,i,C,D,X,R,W)}}}function y(r,m,M){S.vertices.push(new gb(r,m,M))}function j(z,G,B,_){z+=M,G+=M,B+=M,S.faces.push(new Te(z,G,B,null,null,_?2:1));var A=_?i.generateBottomUV(S,F,w,z,G,B):i.generateTopUV(S,F,w,z,G,B);S.faceVertexUvs[0].push(A)}function c(m,$,Q,k,D,b,c,T,q){m+=M,$+=M,Q+=M,k+=M,S.faces.push(new Te(m,$,k)),S.faces.push(new Te($,Q,k));var d=i.generateSideWallUV(S,F,D,w,m,$,Q,k,b,c,T,q);S.faceVertexUvs[0].push([d[0],d[1],d[3]]),S.faceVertexUvs[0].push([d[1],d[2],d[3]])}var N,h,x,L,m,Y=w.amount,A=w.curveSegments||fs,p=w.steps||1,U=w.extrudePath,a=!1,i=new ep(w.repeatUVLength);U&&(N=U.getSpacedPoints(p),a=!0,h=w.frames!==b?w.frames:new sj.FrenetFrames(U,p,!1),x=new gb,L=new gb,m=new gb);var v,u,J,S=this,M=this.vertices.length,R=F.extractPoints(A),H=R.shape,l=R.holes,z=!zi.isClockWise(H);if(z){for(H=H.reverse(),u=0,J=l.length;J>u;u++)v=l[u],zi.isClockWise(v)&&(l[u]=v.reverse());z=!1}var I=zi.triangulateShape(H,l),f=H;for(u=0,J=l.length;J>u;u++)v=l[u],H=H.concat(v);for(var G,Z,T=H.length,q=I.length,e=0;T>e;e++)G=H[e],a?(L.copy(h.normals[0]).multiplyScalar(G.x),x.copy(h.binormals[0]).multiplyScalar(G.y),m.copy(N[0]).add(L).add(x),y(m.x,m.y,m.z)):y(G.x,G.y,0);var g;for(g=1;p>=g;g++)for(e=0;T>e;e++)G=H[e],a?(L.copy(h.normals[g]).multiplyScalar(G.x),x.copy(h.binormals[g]).multiplyScalar(G.y),m.copy(N[g]).add(L).add(x),y(m.x,m.y,m.z)):y(G.x,G.y,Y/p*g);$(),t()};var sj=function(Q,O,v,x,P){function j(l,v,O){return G.vertices.push(new gb(l,v,O))-1}$b.call(this),O=O||64,v=v||1,x=x||8,P=P||!1;var W,L,V,y,E,Z,B,Y,F,J,i,s,k,b,D,n,$,N,w,d,m=[],G=this,o=O+1,c=new gb,h=new sj.FrenetFrames(Q,O,P),K=h.tangents,q=h.normals,r=h.binormals;for(this.tangents=K,this.normals=q,this.binormals=r,F=0;o>F;F++)for(m[F]=[],y=F/(o-1),Y=Q.getPointAt(y),W=K[F],L=q[F],V=r[F],J=0;x>J;J++)E=J/x*U,Z=-v*t(E),B=v*e(E),c.copy(Y),c.x+=Z*L.x+B*V.x,c.y+=Z*L.y+B*V.y,c.z+=Z*L.z+B*V.z,m[F][J]=j(c.x,c.y,c.z);for(F=0;O>F;F++)for(J=0;x>J;J++)i=P?(F+1)%O:F+1,s=(J+1)%x,k=m[F][J],b=m[i][J],D=m[i][s],n=m[F][s],$=new xc(F/O,J/x),N=new xc((F+1)/O,J/x),w=new xc((F+1)/O,(J+1)/x),d=new xc(F/O,(J+1)/x),this.faces.push(new Te(k,b,n)),this.faceVertexUvs[0].push([$,N,d]),this.faces.push(new Te(b,D,n)),this.faceVertexUvs[0].push([N.clone(),w,d.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};sj.prototype=Bp(gq),sj.FrenetFrames=function(n,W,N){function l(){w[0]=new gb,O[0]=new gb,x=Number.MAX_VALUE,L=g(r[0].x),$=g(r[0].y),i=g(r[0].z),x>=L&&(x=L,k.set(1,0,0)),x>=$&&(x=$,k.set(0,1,0)),x>=i&&k.set(0,0,1),p.crossVectors(r[0],k).normalize(),w[0].crossVectors(r[0],p),O[0].crossVectors(r[0],w[0])}var J,x,L,$,i,D,t,k=new gb,r=[],w=[],O=[],p=new gb,E=new Ap,T=W+1,K=1e-4;for(this.tangents=r,this.normals=w,this.binormals=O,D=0;T>D;D++)t=D/(T-1),r[D]=n.getTangentAt(t),r[D].normalize();for(l(),D=1;T>D;D++)w[D]=w[D-1].clone(),O[D]=O[D-1].clone(),p.crossVectors(r[D-1],r[D]),p.length()>K&&(p.normalize(),J=v(Gl(r[D-1].dot(r[D]),-1,1)),w[D].applyMatrix4(E.makeRotationAxis(p,J))),O[D].crossVectors(r[D],w[D]);if(N)for(J=v(Gl(w[0].dot(w[T-1]),-1,1)),J/=T-1,r[0].dot(p.crossVectors(w[0],w[T-1]))>0&&(J=-J),D=1;T>D;D++)w[D].applyMatrix4(E.makeRotationAxis(r[D],J*D)),O[D].crossVectors(r[D],w[D])};var to=function(m,H,A,T){$b.call(this),H=H||18,A=A||0,T=T==f?U:T;for(var y=1/(m.length-1),l=1/H,$=0,I=H;I>=$;$++)for(var k=A+$*l*T,z=t(k),q=e(k),i=0,V=m.length;V>i;i++){var W=m[i],Y=new gb;Y.x=z*W.x-q*W.y,Y.y=q*W.x+z*W.y,Y.z=W.z,this.vertices.push(Y)}for(var B=m.length,$=0,I=H;I>$;$++)for(var i=0,V=m.length-1;V>i;i++){var u=i+B*$,E=u,s=u+B,z=u+1+B,P=u+1,C=$*l,n=i*y,S=C+l,N=n+y;this.faces.push(new Te(E,P,s)),this.faceVertexUvs[0].push([new xc(C,n),new xc(C,N),new xc(S,n)]),this.faces.push(new Te(s,P,z)),this.faceVertexUvs[0].push([new xc(S,n),new xc(C,N),new xc(S,N)])}this.mergeVertices(),yq(this),this.computeFaceNormals(),this.computeVertexNormals()};to.prototype=Bp(gq);var Ig=function(M,U){U=U||{};var I=wp.generateShapes(M,U);U.amount=U.amount!==b?U.amount:.5,U.convertYZ=!1,U.fill!==!1&&(U.bottom=!0,U.top=!0),Nb.call(this,I,U)};Ig.prototype=Bp(Oh);var Gk=K.Node=function(){gm(Gk,this)},Mm={X:yh,Y:Ki,Z:Vq},Zh={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},ug="xzy",Yl=function(A,q,o){if(q){var B=q[0],p=q[1],Z=q[2];"xzy"===o?(Ki(A,p),Vq(A,Z),yh(A,B)):"xyz"===o?(Vq(A,Z),Ki(A,p),yh(A,B)):"yxz"===o?(Vq(A,Z),yh(A,B),Ki(A,p)):"yzx"===o?(yh(A,B),Vq(A,Z),Ki(A,p)):"zxy"===o?(Ki(A,p),yh(A,B),Vq(A,Z)):"zyx"===o?(yh(A,B),Ki(A,p),Vq(A,Z)):(Ki(A,p),Vq(A,Z),yh(A,B))}};Xn("Node",yd,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:ug,_64O:0,_rotationX:0,_53O:0,_host:f,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return qf},_22Q:function(){return Nd},getX:function(){return this.p().x},setX:function(w){this.p(w,this.p().y)},getY:function(){return this.p().y},setY:function(w){this.p(this.p().x,w)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function($){this.setAnchor($,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(f){this.setAnchor(this.getAnchor().x,f)},getScaleX:function(){return this.getScale().x},setScaleX:function(T){this.setScale(T,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(k){this.setScale(this.getScale().x,k)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(H,J){wd(H,ak(f,f,this.r3(),this.getRotationMode())),this.translate3d(H[0]*J,H[1]*J,H[2]*J)},translateFront:function(i){this.translate3dBy([0,0,1],i)},translateBack:function($){this.translate3dBy([0,0,-1],$)},translateLeft:function(V){this.translate3dBy([-1,0,0],V)},translateRight:function(q){this.translate3dBy([1,0,0],q)},translateTop:function(Z){this.translate3dBy([0,1,0],Z)},translateBottom:function(V){this.translate3dBy([0,-1,0],V)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(p,K,h){1===arguments.length&&(K=p[1],h=p[2],p=p[0]),this.p(p,h),this.setElevation(K)},translate3d:function(s,U,o){1===arguments.length&&(U=s[1],o=s[2],s=s[0]),this.translate(s,o),this.setElevation(this._54O+U)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(I,i,R){1===arguments.length&&(i=I[1],R=I[2],I=I[0]),this.setSize(I,R),this.setTall(i)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(q,x,d){1===arguments.length&&(x=q[1],d=q[2],q=q[0]),this.setRotationX(q),this.setRotation(-x),this.setRotationZ(d)},setRotationY:function(T){this.setRotation(-T)},getRotationY:function(){return-this._64O},lookAtDirection:function(b,r){r=r||Wf;var h=this,f=Bj(b);r===Wf?(h.r3([-q(b[1]/f),-I(b[2],b[0])+x,0]),h.setRotationMode("xzy")):r===$e?(h.r3(0,-I(b[2],b[0]),q(b[1]/f)),h.setRotationMode("zyx")):r===Rj?(h.r3(0,-I(b[2],b[0])+L,-q(b[1]/f)),h.setRotationMode("zyx")):r===Jb?(h.r3([-q(b[1]/f)+x,-I(b[2],b[0])+x,0]),h.setRotationMode("xzy")):r===De&&(h.r3([-q(b[1]/f)-x,-I(b[2],b[0])+x,0]),h.setRotationMode("xzy")),r===mb&&(h.r3([-q(b[1]/f)+L,-I(b[2],b[0])+x,L]),h.setRotationMode("zxy"))},lookAt:function(P,t){return this.lookAtDirection(el(P,this.p3()),t)},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(h){var q=this;if(q!==h&&q._host!==h){var M=q._host;M&&M._removeAttach(q),q._host=h,q._host&&q._host._addAttach(q),q.fp("host",M,h),q.onHostChanged(M,h)}},getAttaches:function(){return this._69O},_addAttach:function(G){var E=this;E._69O||(E._69O=new Ek),E._69O.add(G),E.fp("attaches",f,G)},_removeAttach:function(z){var D=this;D._69O.remove(z),D._69O.isEmpty()&&delete D._69O,D.fp("attaches",z,f)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(i){var k=this;k._44I||(k._44I=new Ek),k._42I||(k._42I=new Ek),k._44I.add(i),k._42I.add(i),k._20I()},_4I:function(G){var Z=this;Z._44I||(Z._44I=new Ek),Z._43I||(Z._43I=new Ek),Z._44I.add(G),Z._43I.add(G),Z._20I()},_16I:function(o){var F=this;F._44I.remove(o),F._42I.remove(o),F._44I.isEmpty()&&delete F._44I,F._42I.isEmpty()&&delete F._42I,F._20I()},_18I:function(K){var $=this;$._44I.remove(K),$._43I.remove(K),$._44I.isEmpty()&&delete $._44I,$._43I.isEmpty()&&delete $._43I,$._20I()},_20I:function(){var m=this;if(delete m._45I,!m._44I||m._44I.isEmpty())return delete m._70O,void 0;var y;m._44I.each(function(e){e.isLooped()&&(y||(y={}),y[e._id]||(m._45I||(m._45I=new Ek),m._45I.add(e),y[e._id]=e))}),y?(m._70O=new Ek,m._44I.each(function(M){y[M._id]?"A"===y[M._id]||(y[M._id]="A",m._70O.add(M)):m._70O.add(M)})):m._70O=m._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(i){var u=this;u._46I||(u._46I=new Ek),u._48I||(u._48I=new Ek),u._46I.add(i),u._48I.add(i),u._19I()},_3I:function(r){var e=this;e._47I||(e._47I=new Ek),e._48I||(e._48I=new Ek),e._47I.add(r),e._48I.add(r),e._19I()},_15I:function(f){var Z=this;Z._46I.remove(f),Z._48I.remove(f),Z._46I.isEmpty()&&delete Z._46I,Z._48I.isEmpty()&&delete Z._48I,Z._19I()},_17I:function(i){var y=this;y._47I.remove(i),y._48I.remove(i),y._47I.isEmpty()&&delete y._47I,y._48I.isEmpty()&&delete y._48I,y._19I()},_19I:function(){var s=this;delete s._49I;var C=s._48I;if(C&&!C.isEmpty()){var N={};C.each(function(o){N[o._id]?s._49I||(s._49I=new Ek):N[o._id]=o}),s._49I?C.each(function($){N[$._id]&&(s._49I.add($),delete N[$._id])}):s._49I=C}},getImage:function(){if(this._pendingCheckImageJSON){var H=G.getImage(this._image);H&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof pf&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(d){var o=this,X=o._image,v=o.getWidth(),Q=o.getHeight();o._image=d,o.fp("image",X,d)&&(null!=d&&(wg(d)||cr(d)&&/\.json$/i.test(d))&&(this._pendingCheckImageJSON=!0),o.fp(Ej,v,o.getWidth()),o.fp(ee,Q,o.getHeight()))},getElevation:function(){return this._54O},setElevation:function(j){var K=this;if(!K._50O){K._50O=1;var P=K._54O;K._54O=j,K.fp(_d,P,j),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(K){var d=this;if(!d._49O){d._49O=1;var B=d._64O;d._64O=K,d.fp(zs,B,K),delete d._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(L){var E=this;if(!E._51O){E._51O=1;var x=E._rotationX;E._rotationX=L,E.fp("rotationX",x,L),delete E._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(J){var d=this;if(!d._52O){d._52O=1;var s=d._53O;d._53O=J,d.fp("rotationZ",s,J),delete d._52O}},getPosition:function(){return this._position},setPosition:function(M,Y){var L=this;if(!L._50I){L._50I=1;var s;if(s=2===arguments.length?{x:M,y:Y}:M,s.x!==L._position.x||s.y!==L._position.y){var n=L._position;L._position=s,L.fp(Zd,n,s)}delete L._50I}},translate:function(y,T){var F=this._position;this.p(F.x+y,F.y+T)},getWidth:function(){var P=this;if(P._width>=0)return P._width;var O=P.getStyle("shape3d");if(O){var Z=So(O);if(Z&&Z.rawS3)return Z.rawS3[0];if("billboard"===O||"plane"===O){var K=fg(P.getStyle("shape3d.image"));return K?Nj(K,P):20}}var K=fg(P._image);return K?Nj(K,P):20},setWidth:function(S){var t=this,F=t._width;t._width=S,t.fp(Ej,F,S)},getHeight:function(){var N=this;if(N._height>=0)return N._height;var P=N.getStyle("shape3d");if(P){var j=So(P);if(j&&j.rawS3)return j.rawS3[2];if("plane"===P){var t=fg(N.getStyle("shape3d.image"));return t?od(t,N):20}if("billboard"===P)return 2}var t=fg(N._image);return t?od(t,N):20},setHeight:function($){var x=this,z=x._height;x._height=$,x.fp(ee,z,$)},getTall:function(){var Y=this;if(Y._tall>=0)return Y._tall;var f=Y.getStyle("shape3d");if(f){var c=So(f);if(c&&c.rawS3)return c.rawS3[1];if("billboard"===f){var m=fg(Y.getStyle("shape3d.image"));return m?od(m,Y):20}if("plane"===f)return 2}return 20},setTall:function(j){var K=this,x=K._tall;K._tall=j,K.fp("tall",x,j)},setSize:function(R,r){var N=this;2===arguments.length?(N.setWidth(R),N.setHeight(r)):(N.setWidth(R.width),N.setHeight(R.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(X,k,g,p,c){var o=this,M=o.getAnchor(),m=o.getScale();arguments.length<=2&&(c=k,k=X.y,g=X.width,p=X.height,X=X.x);var Z=c&&m.x<0?1-M.x:M.x,L=c&&m.y<0?1-M.y:M.y;o.p(X+g*Z,k+p*L),c&&(g/=Math.abs(m.x),p/=Math.abs(m.y)),o.setWidth(g),o.setHeight(p)},getMatrix:function(){var u=this,l=u._64O,S=u._position,Z=u.getScale();return new pd(l,S.x,S.y,Z.x,Z.y)},getAnchorRect:function(){var V=this,S=V.getWidth(),z=V.getHeight(),j=V.getAnchor();return{x:-S*j.x,y:-z*j.y,width:S,height:z}},toLocal:function(G){return this.getMatrix().tfi(G)},toGlobal:function(h){return this.getMatrix().tf(h)},isInRect:function(J){J=this.toLocal(J);var K=this.getWidth(),a=this.getHeight();return J.x+=K*this.getAnchorX(),J.y+=a*this.getAnchorY(),!(J.x<0||J.y<0||J.x>K||J.y>a)},getRect:function(){var b=this,t=b.getWidth(),U=b.getHeight(),d=b.getAnchor(),V={x:-t*d.x,y:-U*d.y,width:t,height:U},z=b.getMatrix();return V=qp([z.tf(V.x,V.y),z.tf(V.x+V.width,V.y),z.tf(V.x+V.width,V.y+V.height),z.tf(V.x,V.y+V.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var c=this,z=c.getAnchor(),M=c._anchorElevation;return{x:z.x,y:M,z:z.y}},setAnchorElevation:function(p){var l=this,t=l._anchorElevation;return t!==p?(l._anchorElevation=p,l.fp("anchorElevation",t,p),!0):!1},setAnchor3d:function(L,Y,F,e){var B,j=this;"number"==typeof L?B={x:L,y:Y,z:F}:(B=L.length?{x:L[0],y:L[1],z:L[2]}:L,e=Y);var V=j.getDataModel();V&&V.beginTransaction();var u=j.getAnchor3d(),g=j.setAnchor(B.x,B.z);if(j.setAnchorElevation(B.y)&&(g=!0),g&&e&&!uq){j.getAnchor3d();var r=cl(j),A=wd([B.x-u.x,B.y-u.y,B.z-u.z],r);j.p3(A)}return V&&V.endTransaction(),g},getAnchor:function(){var K=this;if(K.hasOwnProperty("_anchor"))return K._anchor;var E=fg(K._image);return E&&E.anchorX!==b?{x:E.anchorX,y:E.anchorY}:K._anchor},setAnchor:function(O,Q,L){var o,g=this;"number"==typeof O?o={x:O,y:Q}:(o=O.length?{x:O[0],y:O[1]}:O,L=Q);var w=g.getAnchor();if(w.x!==o.x||w.y!==o.y){var V=g.getDataModel();if(V&&V.beginTransaction(),g._anchor=o,g.fp("anchor",w,o),L&&!uq){var z=g.getPosition(),y=g.getSize(),c=g.getRotation(),X=g.getScale(),x=-y.width*(w.x-o.x)*X.x,G=-y.height*(w.y-o.y)*X.y,h=e(c),S=t(c);g.setPosition(z.x+S*x-h*G,z.y+h*x+S*G)}return V&&V.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(y,Y){var J,l=this;J=2===arguments.length?{x:y,y:Y}:y;var O=l.getScale();(O.x!==J.x||O.y!==J.y)&&(l._scale=J,l.fp("scale",O,J))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var k=this,L=k._scaleTall,d=k.getScale();return[d.x,L,d.y]},getFinalScale3d:function(){var Y=this,H=Y.s3(),g=Y._dynamicScale3d,t=Y.getScale3d();return H&&(t[0]*=H[0],t[1]*=H[1],t[2]*=H[2]),g&&(t[0]*=g[0],t[1]*=g[1],t[2]*=g[2]),t},getFinalRotation3d:function(){var p=this;return p._dynamicRotation||p.r3()},setScaleTall:function(a){var V=this,N=V._scaleTall;N!==a&&(V._scaleTall=a,V.fp("scaleTall",N,a))},setScale3d:function(i,h,m){var H,P=this;H="number"==typeof i?{x:i,y:h,z:m}:i.length?{x:i[0],y:i[1],z:i[2]}:i,P.setScaleTall(H.y),P.setScale(H.x,H.z)},getCorners:function(s,r){s==f&&(s=0),r==f&&(r=s);var D=this,R=D.getAnchor(),o=D.getWidth(),H=D.getHeight(),c=-o*R.x-s,x=-H*R.y-r,b=o+2*s,d=H+2*r,T=D.getMatrix();return[T.tf(c,x),T.tf(c,x+d),T.tf(c+b,x+d),T.tf(c+b,x)]},getEditControlPoints:function(U,z,Z){z==f&&(z=0),Z==f&&(Z=z);var n=this,Q=n.getAnchor(),j=n.getWidth(),h=n.getHeight(),_=-j*Q.x-z,T=-h*Q.y-Z,l=j+2*z,g=h+2*Z;if(U)return[{x:_,y:T},{x:_,y:0},{x:_,y:T+g},{x:0,y:T+g},{x:_+l,y:T+g},{x:_+l,y:0},{x:_+l,y:T},{x:0,y:T}];var N=n.getMatrix();return[N.tf(_,T),N.tf(_,0),N.tf(_,T+g),N.tf(0,T+g),N.tf(_+l,T+g),N.tf(_+l,0),N.tf(_+l,T),N.tf(0,T)]},rotateAt:function(Z,_,m){var r=this,N=r._position,R=r._64O,z=new pd(R,N.x,N.y).tf(Z,_),i=F(Z*Z+_*_),g=I(N.y-z.y,N.x-z.x)+m;r.setRotation(R+m),r.p(z.x+i*t(g),z.y+i*e(g))},onParentChanged:function(){Gk.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(G){G._7I()})},onPropertyChanged:function(E){var J=this;Gk.superClass.onPropertyChanged.call(J,E),J._69O&&J._69O.each(function(D){D.handleHostPropertyChange(E)}),J._49I&&J._49I.each(function(c){c.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(v){this.updateAttach(v)},onStyleChanged:function(S){Gk.superClass.onStyleChanged.apply(this,arguments),bk[S]&&this.updateAttach()},updateAttach:function(e){var G=this;G._51I||uq||(G._51I=1,G._71O(e),delete G._51I)},_71O:function(r){var c,B,i,q,Q,n,L=this,z=L._host,l=r?r.property:f,o=r?r.oldValue:f,E=r?r.newValue:f;if(z instanceof K.Grid){if(l===_d)L.setElevation(L._54O+E-o);else if(!r||be[l]){if(c=L.s("attach.row.index"),B=L.s("attach.column.index"),i=z.getCellRect(c,B),!i)return;q=L.s("attach.row.span"),Q=L.s("attach.column.span"),(1!==q||1!==Q)&&(i=of(i,z.getCellRect(c+q-1,B+Q-1))),qc(i,L,"attach.padding",1),L.setRect(i)}}else if(z instanceof qr&&(n=L.s("attach.index"))>=0&&(!r||er[l])){var _=L.s("attach.thickness");_!=f&&L.setHeight(z.getThickness()*_);var e=L.s("attach.offset"),t=z.getPoints(),V=t.size();if(V>n){var y=t.get(n),v=V===n+1?t.get(0):t.get(n+1),w=[v.x-y.x,v.y-y.y],d=Bj(w);if(d){L.s("attach.offset.relative")&&(e*=d),L.s("attach.offset.opposite")&&(e=d-e);var m={x:y.x+w[0]/d*e,y:y.y+w[1]/d*e},O=L.s("attach.gap");O&&(L.s("attach.gap.relative")&&(O*=z.getThickness()),m=Qm(f,m,v,O)),L.p(m),L.setRotation(I(w[1],w[0]))}}}else r&&(l===Zd?L.translate(E.x-o.x,E.y-o.y):l===_d?L.setElevation(L._54O+E-o):rj[l]&&L._11Q(z,l,E-o))},_11Q:function($,J,t){var K=this,v=$.p3(),o=el(K.p3(),v),c=dn(),f=Zh[K.getRotationMode()],Z=f[0],p=f[1],B=f[2],m=Mm[Z],U=Mm[p],w=Mm[B];J===zs&&(J="rotationY",t=-t),J===zs+Z?(w(c,$[th+B]()),U(c,$[th+p]()),m(c,t),U(c,-$[th+p]()),w(c,-$[th+B]()),K[mn+Z](K[th+Z]()+t)):J===zs+p?(w(c,$[th+B]()),U(c,t),w(c,-$[th+B]()),K[mn+p](K[th+p]()+t)):J===zs+B&&(w(c,t),K[mn+B](K[th+B]()+t)),wd(o,c),K.p3(v[0]+o[0],v[1]+o[1],v[2]+o[2])},isHostOn:function(y){var O=this;if(O._host&&y&&y._69O)for(var P={},D=O._host;D&&D!==O&&!P[D._id];){if(D===y)return!0;P[D._id]=D,D=D._host}return!1},isLoopedHostOn:function(V){return this.isHostOn(V)&&V.isHostOn(this)},getSerializableProperties:function(){var l=Gk.superClass.getSerializableProperties.call(this);return dd(l,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),l}});var Or=K.Edge=function(R,A){var O=this;gm(Or,O),O.setSource(R),O.setTarget(A)};Xn("Edge",yd,{_icon:"edge_icon",getUIClass:function(){return Ue},_22Q:function(){return yf},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(y){var W=this;if(W._source!==y){var p=W._source;W._source=y,p&&p._16I(W),y&&y._2I(W),W._7I(),W.fp("source",p,y)}},setTarget:function(J){var r=this;if(r._target!==J){var c=r._target;r._target=J,c&&c._18I(r),J&&J._4I(r),r._7I(),r.fp("target",c,J)}},isLooped:function(){var X=this;return X._source===X._target&&!!X._source&&!!X._target},_7I:function(){var S,n=this,a=zb(n);n._40I!==a&&(S=this._40I,S&&S._15I(n),n._40I=a,a&&a._1I(n),n.fp("sourceAgent",S,a),Ye(S,n._41I),Ye(a,n._41I));var y=Fh(n);n._41I!==y&&(S=n._41I,S&&S._17I(n),n._41I=y,y&&y._3I(n),n.fp("targetAgent",S,y),Ye(S,n._40I),Ye(y,n._40I))},_22I:function(U){this._52I=U,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var L=this;return L._52I&&L._52I.get(0)!==L&&!L.getStyle(yi)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var A=this,L=A._52I;return L&&!A.getStyle(yi)&&L.size()>1&&A===L.get(0)},toggle:function(){var e=this._52I,T=!this.s(yi);e&&e.size()>1&&(e.each(function(h){h.s(yi,T)}),e.getSiblings().each(function(x){x!==e&&x.each(function(y){y.fp("edgeGroup",f,x)})}))},setStyle:function(R,s){(R===Mc||"edge.segments"===R)&&(s=Mq(s)),Or.superClass.setStyle.call(this,R,s)},onStyleChanged:function(P){Or.superClass.onStyleChanged.apply(this,arguments),Qb[P]&&Ye(this._41I,this._40I)},getSerializableProperties:function(){var G=Or.superClass.getSerializableProperties.call(this);return dd(G,{source:1,target:1}),G}});var ol=K.Group=function(){gm(ol,this)};Xn("Group",Gk,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return sk},onChildAdded:function(){ol.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){ol.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var l=this;if(!l._54I&&!uq){var o=l.getChildrenRect();o&&(l._53I=1,l.p(Ll(l.s("group.position"),o,l.getSize())),delete l._53I)}},getChildrenRect:function(){var z,s=this;return s.eachChild(function(N){z=of(z,s.getChildRect(N))}),z},getChildRect:function(G){var n;return ps(G)&&G.s(ud)&&(ap(G)&&G.isExpanded()&&G.eachChild(function(l){n=of(n,G.getChildRect(l))}),!n&&G.getRect&&(n=G.getRect())),n},setPosition:function(U,Y){var G=this;if(!G._54I){var X;X=2===arguments.length?{x:U,y:Y}:U,uq||G._53I||(G._54I=1,hq(G._children,X.x-G._position.x,X.y-G._position.y),delete G._54I),ol.superClass.setPosition.call(this,X)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(c){var K=this;if(K._57O!==c){var W=K._57O;K._57O=c,K.fp("expanded",W,K._57O),K._8I()}},_8I:function(){ol.superClass._8I.call(this),this.eachChild(function(e){ps(e)&&e._8I()})},onStyleChanged:function(F){ol.superClass.onStyleChanged.apply(this,arguments),"group.position"===F&&this._81I()},getSerializableProperties:function(){var R=ol.superClass.getSerializableProperties.call(this);return R.expanded=1,R}});var zk=K.Block=function(){gm(zk,this)};Xn("Block",Gk,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Ee},onChildAdded:function(){zk.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){zk.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var T=this;if(!uq&&!T._updatingToChildren&&T._syncSize){var K,R,Q,f,m,Z=[],x=T.getRotation();if(T.eachChild(function(I){ps(I)&&Z.push.apply(Z,I.getCorners())}),Z.length){T._updatingFromChildren=1;var C=t(-x),v=e(-x),F=1/0,B=-1/0,a=1/0,H=-1/0;for(f=0,m=Z.length;m>f;f++)Q=Z[f],K=Q.x,R=Q.y,Q.x=C*K-v*R,Q.y=v*K+C*R,F=S(F,Q.x),B=o(B,Q.x),a=S(a,Q.y),H=o(H,Q.y);var r=T.getScale();T.setSize(g((B-F)/r.x),g((H-a)/r.y));var D;r.x<0&&(D=F,F=B,B=D),r.y<0&&(D=a,a=H,H=D),C=t(x),v=e(x);var k=T.getAnchor();K=F+(B-F)*k.x,R=a+(H-a)*k.y,T.setPosition(C*K-v*R,v*K+C*R),delete T._updatingFromChildren}}},setPosition:function(y,b){var c=this;if(!c._updatingToChildren){var H;H=2===arguments.length?{x:y,y:b}:y,uq||c._updatingFromChildren||(c._updatingToChildren=1,hq(c._children,H.x-c._position.x,H.y-c._position.y),delete c._updatingToChildren),zk.superClass.setPosition.call(this,H)}},setWidth:function(r){return this.setSize(r,this.getHeight())},setHeight:function(C){return this.setSize(this.getWidth(),C)},setSize:function(c,j){1>c&&(c=1),1>j&&(j=1);var d=this;
if(!d._updatingToChildren){2!==arguments.length&&(j=c.height,c=c.width);var t=d.getWidth(),f=d.getHeight();if(c!==t&&zk.superClass.setWidth.call(d,c),j!==f&&zk.superClass.setHeight.call(d,j),!uq&&!d._updatingFromChildren){d._updatingToChildren=1;var _=c/t,p=j/f;d._adjustChildScaleOrSize(_,p,"size"),delete d._updatingToChildren,d.updateFromChildren()}}},_adjustChildScaleOrSize:function(n,r,w){var H=this;if(H._syncSize){var q=H.getPosition(),y=H.getRotation();H.getScale(),H.eachChild(function(z){if(ps(z)){var G=z.getPosition(),$=z.getRotation(),H=z.getWidth(),o=z.getHeight(),P=z.getScale(),s=P.x*H,W=P.y*o,O=new pd($,G.x,G.y,s,W);O.translate(-q.x,-q.y),O.rotate(-y),$=I(O.b*Math.sign(s),O.a*Math.sign(s)),O.scale(n,r);var R,V,p,N=t($);if(Math.abs(N)<.001?(R=e($),V=O.b/R,p=-O.c/R):(V=O.a/N,p=O.d/N),"scale"===w)z.setScale(V/H,p/o);else if("size"===w){var a=V/P.x,A=p/P.y;z.setScale(Sc(V)*Math.abs(P.x),Sc(p)*Math.abs(P.y)),z.setSize(Math.max(.1,Math.abs(a)),Math.max(.1,Math.abs(A)))}O.rotate(y),O.translate(q.x,q.y),z.setPosition(O.tx,O.ty)}})}},_calcChangeFactor:function(X,G,M,W){var O,k,D,T;return O=g(X),k=g(M),D=O>k?O/k:k/O,O=g(G),k=g(W),T=O>k?O/k:k/O,o(D,T)},setAnchor:function(){var A=this;if(!A._updatingToChildren){var s=A.getAnchor();if(zk.superClass.setAnchor.apply(A,arguments),!uq&&!A._updatingFromChildren&&A._syncSize){A._updatingToChildren=1;var T=A.getAnchor();A.getPosition();var I=A.getSize(),M=A.getScale(),i=A.getRotation(),j=-I.width*M.x*(s.x-T.x),m=-I.height*M.y*(s.y-T.y),K=e(i),S=t(i),J=S*j-K*m,n=K*j+S*m;A.eachChild(function(L){if(ps(L)){var a=L.getPosition();L.setPosition(a.x-J,a.y-n)}}),delete A._updatingToChildren}}},setRotation:function(J){var Z=this;if(!Z._updatingToChildren){var c=Z.getRotation();if(zk.superClass.setRotation.apply(Z,arguments),!uq&&!Z._updatingFromChildren){Z._updatingToChildren=1;var M=Z.getPosition(),w=J-c;Z.eachChild(function(Y){if(ps(Y)){var x=Y.getMatrix();x.translate(-M.x,-M.y),x.rotate(w),x.translate(M.x,M.y);var E=Math.sign(Y.getScale().x);Y.setRotation(I(x.b*E,x.a*E)),Y.setPosition(x.tx,x.ty)}}),delete Z._updatingToChildren}}},setScale:function(M,h){var Y=this;if(!Y._updatingToChildren){null==h&&(h=M.y,M=M.x);var q=Y.getScale();if(g(M)<.01&&(M=.01*(Sc(M)||Sc(q.x))),g(h)<.01&&(h=.01*(Sc(h)||Sc(q.y))),zk.superClass.setScale.call(Y,M,h),!uq&&!Y._updatingFromChildren){Y._updatingToChildren=1;var J=M/q.x,H=h/q.y;Y._adjustChildScaleOrSize(J,H,"size"),delete Y._updatingToChildren,Y.updateFromChildren()}}},getSerializableProperties:function(){var t=zk.superClass.getSerializableProperties.call(this);return t.clickThroughEnabled=1,t.syncSize=1,t}});var _q=K.Grid=function(){gm(K.Grid,this)};Xn("Grid",Gk,{IRotatable:!1,_icon:"grid_icon",_image:f,getUIClass:function(){return pm},setRotation:function(){},getCellRect:function(j,R){var E=this,N=E.s("grid.row.count"),p=E.s("grid.column.count");if(0>=N||0>=p||0>j||j>=N||0>R||R>=p)return f;var B,F,$,G=E.getRect(),m=E.s("grid.row.percents"),u=E.s("grid.column.percents");if(qc(G,E,"grid.border",-1),m&&m._as&&(m=m._as),u&&u._as&&(u=u._as),m&&m.length===N){for($=0,B=0;j>B;B++)$+=G.height*m[B];G.y+=$,G.height=G.height*m[j]}else G.height=G.height/N,G.y+=G.height*j;if(u&&u.length===p){for(F=0,B=0;R>B;B++)F+=G.width*u[B];G.x+=F,G.width=G.width*u[R]}else G.width=G.width/p,G.x+=G.width*R;return Lq(G,-E.s("grid.gap")),G}});var gi=K.Text=function(){gm(gi,this),this.setSize(100,50),this.s("text","TEXT")};Xn("Text",Gk,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Pb},setWidth:function(r){r||(r=.001),gi.superClass.setWidth.call(this,r)},setHeight:function(u){u||(u=.001),gi.superClass.setHeight.call(this,u)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),up("__text__",{width:{value:100,isSafeFunc:!0,func:function(M){return M._width}},height:{value:50,isSafeFunc:!0,func:function(U){return U._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var qr=K.Shape=function(){gm(qr,this),this._59O=new Ek};qr.__de__=Wp,Xn("Shape",Gk,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Ef},_22Q:function(){return Tc},getLength:function(L){return pg(Uj(this._59O,this._58O,L,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var U=this._58O;return U?new Ek(U._as.slice(0)):U},setSegments:function(t){var N=this._58O;t=t?te(t)?new Ek(t.slice(0)):new Ek(t._as.slice(0)):null,(N&&t&&N._as.join(",")!==t._as.join(",")||N!==t)&&(this._58O=t,this.fp("segments",N,t))},getPoints:function(){return this._59O},toPoints:function(){var S=this._59O;return new Ek(S._as.slice(0))},setPoints:function(U,_){var a=this,X=a._59O;U=U?te(U)?new Ek(U.slice(0)):new Ek(U._as.slice(0)):new Ek;var B,w,k,t,G,g;_&&(B=a.getPosition(),g=new pd(a.getRotation(),0,0,a.getScale().x,a.getScale().y)),(X&&U&&X._as.join(",")!==U._as.join(",")||X!==U)&&(a._59O=U,a.fs(),a.fp("points",X,U)),_&&(w=a.getPosition(),k=w.x-B.x,t=w.y-B.y,G=g.tf(k,t),a.setPosition(w.x-k+G.x,w.y-t+G.y))},addPoint:function(k,P,R){var w=this.toPoints();w.add(k,P),this.setPoints(w,R)},setPoint:function(n,N,W){var T=this.toPoints();T.set(n,N),this.setPoints(T,W)},removePointAt:function(L){var M=this.toPoints();M.removeAt(L),this.setPoints(M)},setWidth:function(f){var X=this;if(1>f&&(f=1),!X._55I&&!uq&&X.getWidth()){X._55I=1;var x=X._position.x,G=f/X.getWidth(),M=X.toPoints(),V=new Ek;M.each(function(f){V.add({x:(f.x-x)*G+x,y:f.y,e:f.e})}),X.setPoints(V),$n(X,[G,0,0,1,x*(1-G),0]),X.fs(),delete X._55I}qr.superClass.setWidth.call(X,f)},setHeight:function(j){var Q=this;if(1>j&&(j=1),!Q._55I&&!uq&&Q.getHeight()){Q._55I=1;var S=Q._position.y,Z=j/Q.getHeight(),k=Q.toPoints(),N=new Ek;k.each(function(t){N.add({x:t.x,y:(t.y-S)*Z+S,e:t.e})}),Q.setPoints(N),$n(Q,[1,0,0,Z,0,S*(1-Z)]),Q.fs(),delete Q._55I}qr.superClass.setHeight.call(Q,j)},setAnchorElevation:function(Y){var _=this;_._55I=!0;var r=_._updatingAnchor3d,q=!uq&&!r;if(q){var B,S=Y,k=_.getAnchorElevation(),H=_.getTall();B=H*(k-S),_.shiftPointsElevation(B)}var M=qr.superClass.setAnchorElevation.apply(_,arguments);return r||delete _._55I,M},getShapeElevation:function(){var F=this,T=F._54O;return T-(F.getTall()||0)*(F._anchorElevation-.5)},setAnchor3d:function(u,Z,z,j){var M,P=this;"number"==typeof u?M={x:u,y:Z,z:z}:(M=u.length?{x:u[0],y:u[1],z:u[2]}:u,j=Z),P._55I=!0,P._updatingAnchor3d=!0;var W=P.getDataModel();if(W&&W.beginTransaction(),!uq){var F=P.getAnchor3d(),t=P.getSize(),D=P.getTall(),K=t.width*(F.x-M.x),p=t.height*(F.z-M.z),v=D*(F.y-M.y);j||P.shiftPoints(K,p,v);var i=P.p3()}var _=qr.superClass.setAnchor3d.apply(P,arguments);if(!uq&&j){var x=P.p3();P.shiftPoints(x[0]-i[0]+K,x[2]-i[2]+p,x[1]-i[1]+v)}return W&&W.endTransaction(),delete P._updatingAnchor3d,delete P._55I,_},setAnchor:function(p,V,N){var E=this;E._55I=!0;var y=E._updatingAnchor3d,t=!uq&&!y;if(t){var k,s,G;"number"==typeof p?G={x:p,y:V}:(G=p.length?{x:p[0],y:p[1]}:p,N=V);var Z=E.getAnchor(),o=E.getSize();k=o.width*(Z.x-G.x),s=o.height*(Z.y-G.y),N||E.shiftPoints(k,s);var m=E.getPosition()}var g=qr.superClass.setAnchor.apply(E,arguments);if(t){var Q=E.getPosition();N&&E.shiftPoints(Q.x-m.x+k,Q.y-m.y+s)}return y||delete E._55I,g},shiftPoints:function(M,T,N){var C=this,n=C.getElevation()||0,l=C.toPoints(),s=new Ek;l.each(function(F){var m=F.e;N&&(m=(m==f?n:m)+N),s.add({x:F.x+M,y:F.y+T,e:m})}),C.setPoints(s),C.fs()},shiftPointsElevation:function(g){return this.shiftPoints(0,0,g)},setPosition:function(n,a){var Q,V=this;if(!V._28Q){if(V._28Q=1,!V._55I&&!uq){Q=2===arguments.length?{x:n,y:a}:n;var B=Q.x-V._position.x,N=Q.y-V._position.y;if(0===B&&0===N)return delete V._28Q,void 0;V._55I=1,V.shiftPoints(B,N),$n(V,[1,0,0,1,B,N]),delete V._55I}qr.superClass.setPosition.apply(V,arguments),delete V._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var s=this;if(2!==s._59O.size())return!1;var Q=s._58O;return Q?2===Q.size()&&1===Q.get(0)&&2===Q.get(1)?!0:!1:!0},fireShapeChange:function(){var s=this;if(!s._55I&&!uq){var l=qp(s._59O);l&&(s._55I=1,s.setRect(l),delete s._55I)}s.fp(pl,!1,!0)},getSerializableProperties:function(){var p=qr.superClass.getSerializableProperties.call(this);return p.segments=1,p.points=1,p.thickness=1,p.closePath=1,p}});var ed=K.Polyline=function(){gm(ed,this),this.s({"shape.background":null,"shape.border.width":2})};Xn("Polyline",qr,{_icon:"polyline_icon",_22Q:function(){return Ok},getUIClass:function(){return Dr},setClosePath:function(){},setTall:function(B){var i=this;if(!i._55I&&!i._24Q&&!uq&&i.getTall()){i._24Q=1;var O=i._54O,h=B/i.getTall();i._59O.each(function(d){d.e=d.e==f?O:(d.e-O)*h+O}),i.fs(),delete i._24Q}ed.superClass.setTall.call(i,B)},setElevation:function(Z){var z=this;if(!z._55I&&!z._24Q&&!uq){z._24Q=1;var L=Z-z._54O;z._59O.each(function(X){X.e==f?X.e=Z:X.e+=L}),z.fs(),delete z._24Q}ed.superClass.setElevation.apply(z,arguments)},fireShapeChange:function(){var b=this,B=b._59O;if(!b._55I&&!b._24Q&&!uq){var M=B.size();if(M){var i=1,l=B.get(0),p=b._54O;l.e==f&&(l.e=p);for(var R=l.e,v=0;M>i;i++){l=B.get(i),l.e==f&&(l.e=p);var C=S(R,l.e),n=o(R+v,l.e);R=C,v=n-C}b._24Q=1,b.setTall(v),b.setElevation(R+v*b._anchorElevation),delete b._24Q}}ed.superClass.fireShapeChange.apply(b,arguments)}});var we=K.SubGraph=function(){gm(we,this)};Xn("SubGraph",Gk,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){we.superClass._8I.call(this),this.eachChild(function(F){ps(F)&&F._8I()})}}),G.loadingRefGraph=0;var pf=K.RefGraph=function(){gm(pf,this)};Xn("RefGraph",zk,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(E){var I=this._ref;this._ref=E,this.fp("ref",I,E),this.updateRef()},_21I:function(){pf.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var L=this;if(G.loadingRefGraph++,L.clearChildrenFromDataModel(),G.loadingRefGraph--,L._ref&&L._dataModel){L._xhrLoadHandler&&(L._xhrLoadHandler.cancel=!0);var U=uq,j=L._xhrLoadHandler=function(H){if(H&&L._dataModel){G.loadingRefGraph++;var z=L._pendingUpdateInfo={needToRestore:U};U&&(z.position=L.p(),z.width=L.getWidth(),z.height=L.getHeight(),z.rotation=L.getRotation(),z.anchor=L.getAnchor(),z.scale=L.getScale()),L.p(0,0),L.setAnchor(.5,.5),L.setRotation(0),L.setScale(1,1);var Z=G.parse(H),A=L._dataModel.deserialize(Z,L,{justDatas:!0});A.each(function(S){S._refGraph=L}),L.checkPendingUpdateInfo(),G.loadingRefGraph--,G.handleRefGraphLoaded(L,A,Z)}};j.xhrLoadCalled=!1,G.load(L._ref,function(D){j.cancel||(j.xhrLoadCalled?j(D):Qo(function(){j(D)}))}),j.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var p=this,B=p._pendingUpdateInfo;if(!B)return p.onPendingUpdated&&(G.loadingRefGraph++,p.onPendingUpdated(),G.loadingRefGraph--),void 0;var F=!0;this.eachChild(function(a){(a._pendingCheckImageJSON||a._pendingUpdateInfo)&&(F=!1)}),F&&(G.loadingRefGraph++,p._pendingUpdateInfo=null,p.updateFromChildren(),B.needToRestore&&(p.setSize(B.width,B.height),p.setAnchor(B.anchor),p.setRotation(B.rotation),p.setScale(B.scale),p.p(B.position)),this.getParent()instanceof pf&&this.getParent().checkPendingUpdateInfo(),p.onPendingUpdated&&p.onPendingUpdated(),G.loadingRefGraph--)},getSerializableProperties:function(){var c=pf.superClass.getSerializableProperties.call(this);return c.ref=1,c}}),K.EdgeGroup=function(W,e){this._70O=W,this._siblings=e;for(var B,r,t=0,c=W.size(),d=H[yi];c>t;t++)if(B=W.get(t).getStyle(yi,!1),B!=f){d=B;break}d==f&&(d=!0);var P=G.edgeGroupAgentFunc;for(P&&(r=P(W),r&&r!==W.get(0)&&(W.remove(r),W.add(r,0))),t=0;c>t;t++)W.get(t).s(yi,d)},Xn("EdgeGroup",p,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(U){return this._70O.get(U)},indexOf:function(z){return this._70O.indexOf(z)},each:function(f,g){this._70O.each(f,g)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(s,c){this._siblings.each(function(A){A._70O.each(s,c)})}});var an=function(g,k,t){var V=jq[g]={type:g,action:k};if(t)for(var $ in t)V[$]=t[$]};an("host",function($,h,P){P&&h.setHost(P)},{"delete":{visible:function(O,o){return o.getHost()},action:function(w,R){R.setHost(null)}}}),an("parent",function(U,E,x){x&&E.setParent(x)},{"delete":{visible:function(C,X){return X.getParent()},action:function(c,Q){Q.setParent(null)}}}),an("copySize",function(n,V,d){if(d){var Y=d.getSize();V.setSize(Y)}}),an("copyRotation",function(L,q,c){if(c){var O=c.getRotation();q.setRotation(O)}}),an("edge",function(f,i,U){if(U){var k=new K.Edge(i,U);i.dm().add(k)}}),dd(G,{setConnectAction:an,getConnectAction:function(F,Y){return Y=Y||F.getCurrentConnectActionType(),jq[Y]},doConnectAction:function(j,P,l,M){M=M||j.getCurrentConnectActionType();var p=jq[M];if(!p)return!1;var r=p.action;return r?(r.call(null,j,P,l),!0):!1},doDeleteConnectionAction:function(s,R,o){o=o||s.getCurrentConnectActionType();var P=jq[o];if(!P||!P.delete)return!1;var Q=P.delete.action;return Q?(Q.call(null,s,R),!0):!1}});var ti=K.JSONSerializer=function(W,h){this.dm=this._dataModel=W,this._hierarchical=G.forceHierarchicalSerialization?!0:h==f?W.isHierarchicalRendering():h};Xn("JSONSerializer",p,{ms_ac:["hierarchical"],serialize:function(u){return G.stringify(this.toJSON(),u)},toJSON:function(){var C=this,p=C.dm,F=p.getRoots(),w=C.json={v:G.getVersion(),p:{},a:{},d:[]},E=p.getSerializableAttrs();p.getInit()&&(w.init=p.getInit()),p.getName()&&(w.p.name=p.getName()),p.getBackground()&&(w.p.background=p.getBackground()),p.getLayers()&&(w.p.layers=p.getLayers()),w.p.autoAdjustIndex=p.isAutoAdjustIndex(),w.p.hierarchicalRendering=p.isHierarchicalRendering();for(var J in E){var K=p.a(J);K!==b&&C[Kp](J,K,w.a)}return Er(w.a)&&delete w.a,C._hierarchical?F.each(C.serializeData,this):p.each(function(N){C.serializeData(N)}),w},isSerializable:function(){return!0},getProperties:function(V){return V.getSerializableProperties()},getStyles:function(n){return n.getSerializableStyles()},getAttrs:function(M){return M.getSerializableAttrs()},serializeData:function(R){var V=this;if(V.isSerializable(R)&&!R._refGraph){var X,G,N,d,i=Nf(R.getClassName())||R.getClass(),m=new i,I={c:R.getClassName(),i:R.getId(),p:{},s:{},a:{}};V.json.d.push(I),X=V.getProperties(R);for(G in X)/^_/.test(G)?(N=R[G],N!==m[G]&&V[Kp](G.substr(1),N,I.p)):(d=Mk(G),R[d]&&(N=R[d](),N!==m[d]()&&V[Kp](G,N,I.p)));X=V.getStyles(R);for(G in X)N=R.s(G),N!==m.s(G)&&V[Kp](G,N,I.s);X=V.getAttrs(R);for(G in X)N=R.a(G),N!==m.a(G)&&V[Kp](G,N,I.a);Er(I.p)&&delete I.p,Er(I.s)&&delete I.s,Er(I.a)&&delete I.a}V._hierarchical&&R.getChildren().each(V.serializeData,V)},serializeValue:function(n,T,J){td(T)?T={__a:T._as}:T instanceof yd&&(T={__i:T.getId()}),J[n]=T},deserialize:function(R,N,I){var g=this,w=g.dm;w.beginTransaction(),uq++,I=_g(I)?{setId:I}:I||{},R=g.json=cr(R)?G.parse(R):R,g._82I={};var m=new Ek,l=new Ek,P=0,U=R.d.length;if(I.justDatas||(Cr(R.init)&&R.init(w),w.setInit(R.init)),!I.justDatas){for(var n in R.a)w.a(n,g[Ul](R.a[n]));for(var i in R.p)w[on(i)](R.p[i])}for(;U>P;P++){var z=R.d[P],B=Nf(z.c),t=new B,V=z.i;I.setId&&V!=f&&(t._id=V),g._82I[V]=t,m.add(t),l.add(z)}for(P=0;U>P;P++)g.deserializeData(m.get(P),l.get(P));return m.each(function(Y){N&&!Y.getParent()&&Y.setParent(N),w.add(Y)}),uq--,w.endTransaction(),m},deserializeData:function(z,A){for(var y in A.p)z[on(y)](this[Ul](A.p[y]));for(y in A.s)z.s(y,this[Ul](A.s[y]));for(y in A.a)z.a(y,this[Ul](A.a[y]))},deserializeValue:function(t){if(wg(t)){var $=t.__i;if($!=f)return this._82I[$];if($=t.__a,te($))return new Ek($)}return t}}),dd(Pl,{serialize:function(c,n){return new ti(this,n).serialize(c)},toJSON:function(R){return new ti(this,R).toJSON()},deserialize:function(Z,t,g){return new ti(this).deserialize(Z,t,g)}});var id=K.OverlappingBox=function(R){this.gv=R,this.boxes={}};Xn("OverlappingBox",p,{clear:function(){var Y,E,c=this.boxes;for(Y in c)E=c[Y],E.length=0},isOverlapping:function($,j){var N,p,E=this,L=E.boxes,k=L[$];k?(N=k.rects,p=k.length):k=L[$]={rects:N=[],length:p=0};var x,g,j;for(x=0;p>x;x++)if(g=N[x],g.x<j.x+j.w&&g.x+g.w>j.x&&g.y<j.y+j.h&&g.h+g.y>j.y)return!0;return N.length<=p?(N.push(j),k.length++):N[k.length++]=j,!1}}),qm.GraphView=function($){var L=this;L._24I={},L._34I=new Ek,L._25I={},L._56I={},L._view=Yk(1,L),L._canvas=Rc(L._view),L.dm($?$:new Pl),this._coreInteractor=new Ir(this),L.setEditable(!1),L.setScrollBarVisible(G.graphViewScrollBarVisible)},vc("GraphView",p,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[mr,$f,Tq,Mr,"resettable","editInteractor",qk,"pannable","rectSelectable","autoScrollZone",jf,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:G.graphViewResettable,_pannable:G.graphViewPannable,_rectSelectable:G.graphViewRectSelectable,_autoScrollZone:G.graphViewAutoScrollZone,_rectSelectBackground:G.graphViewRectSelectBackground,_rectSelectBorderColor:G.graphViewRectSelectBorderColor,_editPointSize:G.graphViewEditPointSize,_editPointBorderColor:G.graphViewEditPointBorderColor,_editPointBackground:G.graphViewEditPointBackground,_scrollBarColor:Td,_scrollBarSize:og,_autoHideScrollBar:Ml,_autoMakeVisible:ir,_currentActionType:"host",getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(S){this._dataModel.setLayers(S)},setEditable:function(q){var M=this,l=M.__interactorMap__;if(!l){var r=qm.XEditInteractor;l=M.__interactorMap__={scrollBar:new ni(M),select:new Vb(M),edit:r?new r(M):new ws(M),move:new Sr(M),"default":new dh(M),touch:new Yf(M,{editable:!1})}}q?(M._uieditable=!0,M.setInteractors([l.scrollBar,l.select,l.edit,l.move,l.default,l.touch])):(M._uieditable=!1,M.setInteractors([l.scrollBar,l.select,l.move,l.default,l.touch]))},getCanvas:function(){return this._canvas},_33I:function(v){var O=v.getUIClass();return O?new O(this,v):f},getDataUI:function(w){var g=this,W=g._25I[w._id];return W===b&&(W=g._33I(w),g._25I[w._id]=W),W},getNodeRect:function(A){return G.getNodeRect(this,A)},getEdgeInfo:function(U){var R=this.getDataUI(U);return R?(R._79o(),R._78o):null},getEdgeSourcePosition:function(A){var T=this,K=T.getDataUI(A),c=K.s,I=K._data._40I;return nr(T,I,c("edge.source.position"),c("edge.source.offset.x"),c("edge.source.offset.y"),c("edge.source.anchor.x"),c("edge.source.anchor.y"))},getEdgeTargetPosition:function(v){var Y=this,E=Y.getDataUI(v),o=E.s,S=E._data._41I;return nr(Y,S,o("edge.target.position"),o("edge.target.offset.x"),o("edge.target.offset.y"),o("edge.target.anchor.x"),o("edge.target.anchor.y"))},invalidateAll:function(g){var c=this;if(g){for(var s in c._25I){var $=c._25I[s];$&&$.dispose()}c._25I={},c._56I={},c._24I={},c._34I.clear(),c.redraw()}else c.dm().each(function(O){c.invalidateData(O)})},invalidateSelection:function(){var U=this;U.sm().each(function(n){U.invalidateData(n)})},invalidateData:function(s){var g=this;g._24I[s._id]=s,g._21Q(s),g.iv()},_21Q:function(z){var d=this,T=d._24I;if(zq(z)&&yp[z.s(Qg)]){var U=z.getSourceAgent();U&&U.getAgentEdges().each(function(B){T[B._id]=B}),U=z.getTargetAgent(),U&&U.getAgentEdges().each(function(I){T[I._id]=I}),d.iv()}},redraw:function(g){var A=this;A._32I||(g?A._34I.add(g):(A._32I=1,A._34I.clear()),A.iv())},each:function(y,f){var N,A,b,L=0,l=this.getLayers(),c=this._dataModel,C=c._datas._as,o=C.length;if(l){for(var Z=l.length;Z>L;L++)if(b=l[L],wg(b)&&(b=b.name),c.isHierarchicalRendering()){var u=function(P){return P._layer===b?f?y.call(f,P):y(P):void 0};if(this._dataModel.eachByHierarchical(u)===!1)return}else for(var e=0;o>e;e++)if(N=C[e],N._layer===b&&(A=f?y.call(f,N):y(N),A===!1))return}else if(c.isHierarchicalRendering())this._dataModel.eachByHierarchical(y,null,f);else for(;o>L;L++)if(N=C[L],A=f?y.call(f,N):y(N),A===!1)return},reverseEach:function(e,o){var J,X,N,C,W=this._dataModel,v=W._layers,q=W._datas._as,A=q.length;if(v){for(J=v.length-1;J>=0;J--)if(C=v[J],wg(C)&&(C=C.name),W.isHierarchicalRendering()){var i=function(G){return G._layer===C?o?e.call(o,G):e(G):void 0};if(W.reverseEachByHierarchical(i)===!1)return}else for(var l=A-1;l>=0;l--)if(X=q[l],X._layer===C&&(N=o?e.call(o,X):e(X),N===!1))return}else if(W.isHierarchicalRendering())W.reverseEachByHierarchical(e,null,o);else for(J=A-1;J>=0;J--)if(X=q[J],N=o?e.call(o,X):e(X),N===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var g=this,B=g._84I;if(!B){var o=this.dm().a("width"),t=this.dm().a("height");o>0&&t>0?g._84I={x:0,y:0,width:o,height:t}:(g.each(function(y){g.isVisible(y)&&(B=of(B,g.getDataUIBounds(y)))}),g._84I=B?B:Xh)}return g._84I},getScrollRect:function(){return of(this.getContentRect(),this._29I)},makeCenter:function(P,g,U){var N=this;if(!N.getWidth()||!N.getHeight())return U||Qo(N.centerData,N,[P,g,!0],500),void 0;N.makeVisible(P),N.validate();var l=N.getDataUIBounds(P);if(l){var h=N.getWidth(),I=N.getHeight(),F=l.x+l.width/2,Q=l.y+l.height/2,z=-F*N._zoom+h/2,k=-Q*N._zoom+I/2;N.setTranslate(z,k,g)}},fitData:function(B,l,b,c,w){var F=this;if(!F.getWidth()||!F.getHeight())return w||Qo(F.fitData,F,[B,l,b,c,!0],500),void 0;var L=function(){F.makeVisible(B),F.validate();var n=F.getDataUIBounds(B);n&&(n=lg(n),Lq(n,b==f?20:b),F.fitRect(n,l,c))};l?G.callWhenLoaded(L):L()},fitContent:function(R,W,T,N){var D=this;if(!D.getWidth()||!D.getHeight())return N||Qo(D.fitContent,D,[R,W,T,!0],500),void 0;var B=function(){D.validate();var J=lg(D.getContentRect());Lq(J,W==f?20:W),D.fitRect(J,R,T)};R?G.callWhenLoaded(B):B()},fitRect:function(L,W,p){var m=this,E=m.getWidth(),e=m.getHeight(),v=L.x+L.width/2,Y=L.y+L.height/2,b=S(E/L.width,e/L.height),G=m._zoom,i=-v*G+E/2,z=-Y*G+e/2;0===b||isNaN(b)||(p&&(b=S(1,b)),W?m.setTranslate(i,z,{finishFunc:function(){m.setZoom(b,W)}}):(m.setTranslate(i,z),m.setZoom(b)))},toCanvas:function(g,I){I=I||this._zoom,this.validateImpl();var t=this,G=t.getContentRect();G.width||(G.width=10),G.height||(G.height=10);var n=Rc(),B=G.x*I,H=G.y*I,j=G.width*I,k=G.height*I;ur(n,j,k,1);var X=Gi(n);return g=g||this._dataModel.getBackground(),g&&tj(X,0,0,j,k,g),_h(X,-B,-H),X.scale(I,I),t._42(X),X.restore(),n},toDataURL:function(K,m,k){return this.toCanvas(K,k).toDataURL(m||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(B,V){var M,o,W=this;W._93db(B,V),W.each(function(F){W._56I[F._id]&&(M=W.getDataUI(F),M&&(o=M._79o(),K.HtmlNode&&F instanceof K.HtmlNode?M._42(B):(!V||Bh(V,o))&&M._42(B)))}),W._92db(B,V)},validateImpl:function(){var O,a,q,S,Q,$=this,R=$.tx(),r=$.ty(),E=$._zoom,c=$._canvas,D=this.getWidth(),X=this.getHeight(),s=$._29I,j={x:-R/E,y:-r/E,width:D/E,height:X/E},y={},w=$._34I,v=$._24I,p=$._32I,x=$._23I;$._24I={},(D!==c.clientWidth||X!==c.clientHeight)&&(ur(c,D,X),p=1),p||Gm(j,s)||(p=1),$._29I=j,$.each(function(b){a=b._id;var _=y[a]=$.isVisible(b);_!==$._56I[a]&&(v[a]=b,q=$.getDataUI(v[a]),q&&q._84o(_),$._84o(b,_))},$);for(a in v)q=$.getDataUI(v[a]),q&&(!p&&$._56I[a]&&(Q=q._79o(),Q&&w.add(Q)),q.invalidate()),$._83I=1;if($._56I=y,!p)for(a in v)y[a]&&(q=$.getDataUI(v[a]),q&&(Q=q._79o(),Q&&w.add(Q)));if(p?S=j:(w.each(function(e){Bh(j,e)&&(S=of(S,e))}),S&&(Lq(S,o(1,1/E)),S.x=k(S.x*E)/E,S.y=k(S.y*E)/E,S.width=W(S.width*E)/E,S.height=W(S.height*E)/E,S=ue(j,S))),$._74O=S,S){O=Gi(c);var t=S.x,M=S.y,I=S.width,Z=S.height;t=Math.floor((t*E+R)*Gn),M=Math.floor((M*E+r)*Gn),I=Math.ceil(I*E*Gn)+1,Z=Math.ceil(Z*E*Gn)+1,O.beginPath(),O.rect(t,M,I,Z),O.clip(),O.clearRect(t,M,I,Z),Dp(O,R,r,E),$._42(O,S),O.restore(),delete $._74O}if(w.clear(),delete $._32I,x&&D>0&&X>0){var q=$.getDataUI(x);if(q){var Q=q._79o(),g=$._29I,l=g.x,m=g.y,Y=g.width,z=g.height,E=$._zoom;Q&&!Bh(Q,g)&&(Q.x+Q.width<l&&$.tx(-Q.x*E),Q.x>l+Y&&$.tx(-(Q.x+Q.width-Y)*E),Q.y+Q.height<m&&$.ty(-Q.y*E),Q.y>m+z&&$.ty(-(Q.y+Q.height-z)*E))}delete $._23I}$._83I&&(delete $._83I,delete $._84I),$._98O(),Er($._24I)||Qo($.iv,$)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(x){var t=this;x!==t.isScrollBarVisible()&&(x?(tb(t._view,t._79O=wk()),tb(t._79O,t._27I=wk()),tb(t._79O,t._28I=wk())):(vk(t._79O),delete t._79O,delete t._27I,delete t._28I),t.fp("scrollBarVisible",!x,x))},showScrollBar:function(){var z=this;z._79O&&(z._85I||($(function(){z._86I()},Km),z.iv()),z._85I=new Date)},_86I:function(){var G=this;if(G._85I){var J=new Date,r=J.getTime();r-G._85I.getTime()>=Km?(delete G._85I,G.iv()):$(function(){G._86I()},Km)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var t=this,s=this._27I,O=this._28I;if(t._79O){if(t._autoHideScrollBar&&!t._85I)return s.style.visibility=gd,O.style.visibility=gd,void 0;var p=t.getScrollBarColor(),b=t._zoom,G=t.getScrollBarSize(),h=t.getViewRect(),V=t.getScrollRect(),o=h.height*b,P=V.height*b,z=h.width*b-G-2,i=o*((h.y-V.y)*b/P),w=o*(o/P),N=s.style;P-.5>o?(No>w&&(i=i+w/2-No/2,0>i&&(i=0),i+No>o&&(i=o-No),w=No),pn(s,z,i,G,w),N.visibility=Mb,N.background=p,N.borderRadius=G/2+se):N.visibility=gd;var r=h.width*b,$=V.width*b,i=h.height*b-G-2,z=r*((h.x-V.x)*b/$),W=r*(r/$),N=O.style;$-.5>r?(No>W&&(z=z+W/2-No/2,0>z&&(z=0),z+No>r&&(z=r-No),W=No),pn(O,z,i,W,G),N.visibility=Mb,N.background=p,N.borderRadius=G/2+se):N.visibility=gd}},setDataModel:function(X){var U=this,n=U._dataModel,k=U._selectionModel;n!==X&&(n&&(n.ump(U.handleDataModelPropertyChange,U),n.umm(U.handleDataModelChange,U),n.umd(U.handleDataPropertyChange,U),n.removeIndexChangeListener(U._75O,U),n.removeHierarchyChangeListener(U.handleHierarchyChange,U),k||n.sm().ums(U.handleSelectionChange,U)),U._dataModel=X,X.mp(U.handleDataModelPropertyChange,U),X.mm(U.handleDataModelChange,U),X.md(U.handleDataPropertyChange,U),X.addIndexChangeListener(U._75O,U),X.addHierarchyChangeListener(U.handleHierarchyChange,U),k?k._21I(X):X.sm().ms(U.handleSelectionChange,U),U.invalidateAll(!0),U.fp(pp,n,X),U._canvas.style.background=X.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===b){var m=this.getLayers();m?(this._layersInfo={},m.forEach(function(C){var F=wg(C)?C.name:C;this._layersInfo[F]=C},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=b,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(y){if("background"===y.property){var g=this._canvas.style.background,m=y.newValue||"";this._canvas.style.background=m,this.fp("canvasBackground",g,m)}else"a:width"===y.property||"a:height"===y.property?(this._83I=1,this.redraw()):"layers"===y.property?this.updateLayers():"hierarchicalRendering"===y.property&&this.redraw()},handleDataPropertyChange:function(W){this.dm().isHierarchicalRendering()&&"parent"===W.property&&W.data.hasChildren()&&this.redraw(),this.invalidateData(W.data)},onPropertyChanged:function(G){var c=this,v=G.property;if(c.redraw(),"zoom"===v){var I=c.sm().getSelection();I.size()&&I.each(function(m){m.invalidate()})}Ne[v]?c.showScrollBar():v===qk&&c.onCurrentSubGraphChanged(G)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(U){var a=this,q=U.kind,x=U.data;if(a._83I=1,"add"===q)a.invalidateData(x),zq(x)&&x.getEdgeGroup()&&x.getEdgeGroup().eachSiblingEdge(a.invalidateData,a);else if(q===Dm){a._21Q(x);var j=x._id,k=a._25I[j];if(k){if(a._56I[j]){var n=k._79o();n&&a.redraw(n)}k.dispose(),delete a._25I[j],delete a._24I[j],delete a._56I[j]}x===a._currentSubGraph&&a.setCurrentSubGraph(f)}else q===Ak&&(a.invalidateAll(!0),a.setCurrentSubGraph(f))},_75O:function(D){this.invalidateData(D.data)},handleHierarchyChange:function(X){this.dm().isHierarchicalRendering()&&X.data.hasChildren()&&this.redraw(),this.invalidateData(X.data)},adjustIndex:function(x){var M=this;if(M.isVisible(x)){M.dm().beginTransaction();for(var D=x;D._parent&&M.isVisible(D._parent);)D=D._parent;D&&D!==x&&M._dataModel.adjustIndex(D),M._dataModel.adjustIndex(x),M.dm().endTransaction()}},getImage:function(P){return P.getImage?P.getImage():b},getSelectWidth:function(H){var o=fg(this.getImage(H));return o&&wn(o.disableSelectedBorder,H,this)?0:H.s("select.width")},getSelectColor:function(U){return U.s("select.color")},isSelectable:function(q){if(!this._clickThroughChecking&&q.getParent()instanceof zk&&q.getParent().isSyncSize())return!1;var _=this.getLayersInfo();if(_){var g=_[q._layer];if(g&&g.selectable===!1)return!1}return q.s("2d.selectable")&&this.sm().isSelectable(q)},isMovable:function(h){var G=this;if(zq(h)&&h.getStyle(Qg)!==tm)return!1;var L=this.getLayersInfo();if(L){var $=L[h._layer];if($&&$.movable===!1)return!1}return h.s("2d.movable")?G._movableFunc?G._movableFunc(h):!0:!1},isEditable:function(V){var X=this;if(K._uiSerializing)return X._uieditable;if(!X._editInteractor||!X.isSelected(V))return!1;if(ap(V)){var e=X.getDataUI(V);if(!e||e._88I)return!1}if(zq(V)&&V.getStyle(Qg)!==tm)return!1;var u=this.getLayersInfo();if(u){var W=u[V._layer];if(W&&W.editable===!1)return!1}return V.s("2d.editable")?X._editableFunc?X._editableFunc(V):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(x){return ps(x)&&0!==x.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(x):!0},isRectEditable:function($){return this._rectEditableFunc?this._rectEditableFunc($):!0},isAnchorEditable:function(Q){return this._anchorEditableFunc?this._anchorEditableFunc(Q):!0},isRotationEditable:function(R){return R.setRotation&&R.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(R):!0:!1},getRotationPoint:function(j){var s=j.getAnchor(),c=j.getScale(),f=this._zoom,N=Bm(j.getRotation(),0,-j.getHeight()*c.y*s.y-(c.y<0?-1:1)*(Tf?32:16)/f),n=j.p();return N.x+=n.x,N.y+=n.y,N},getLogicalPoint:function(P){var N=this;return Pe(P,N._canvas,N.tx(),N.ty(),N._zoom,N._zoom)},getSelectedDataAt:function(p){var w=this;return this.getDataAt(p,function(f){return w.isSelected(f)})},getDataInfoAt:function(G,r,n){var M,A=this.lp(G),t=this.getDataAt(A,r,n);if(t){var B=this.getDataUI(t);M={data:t,ui:B,point:A};var d=B._38o;if(d){var T=d.icons;for(var C in T){var y=T[C],D=d.rects[C];if(D)for(var g=wn(y.names,t,this),o=g?g.length:0,i=D.rotation,c=o-1;c>=0;c--){var S=g[c],O=D[c];if(xn(O,A,i))return M.part="icons",M.name=C,M.icon=S,M.rect=O,M.index=c,M.rotation=i,M}}}if(this.isNoteVisible(t)){if(B.note2Info&&xn(B.note2Info.clickRect,A,f,B.note2Info.scale))return M.part="note2",M;if(B.noteInfo&&xn(B.noteInfo.clickRect,A,f,B.noteInfo.scale))return M.part="note",M}if(this.isLabelVisible(t)){if(B.label2Info&&xn(B.label2Info.rect,A,B.label2Info.rotation,B.label2Info.scale))return M.part="label2",M;if(B.labelInfo&&xn(B.labelInfo.rect,A,B.labelInfo.rotation,B.labelInfo.scale))return M.part="label",M}if(t.isInRect&&t.isInRect(A))return M.part="body",M}return M},getDataAt:function(r,w,e){r.target&&(r=this.lp(r));var G,b=this._zoom;return this.reverseEach(function(Q){return(w?w(Q):this.isSelectable(Q))&&this.rectIntersects(Q,Ce(r.x,r.y,e,b))?(G=Q,!1):void 0},this),G},getIconInfoAt:function(l,p){var J=this;if(l.target&&(l=J.lp(l)),p||(p=J.getDataAt(l)),p){var q=J.getDataUI(p);if(q&&q._38o){var j,S=q._38o,i=new Ek;for(j in S.icons)i.add(j);for(var h=i.size()-1;h>=0;h--){j=i.get(h);for(var $=S.rects[j],D=$.rotation,F=$.length-1;F>=0;F--){var M=$[F],U=M.width,O=M.height,_={x:l.x-M.x-U/2,y:l.y-M.y-O/2};D!=f&&(_=Bm(-D,_.x,_.y));var M={x:-U/2,y:-O/2,width:U,height:O};if(xn(M,_))return{key:j,index:F,name:S.icons[j].names[F],rect:$[F],point:l,rotation:D,relativeRect:M,relativePoint:_,data:p}}}}}return f},getDatasInRect:function(E,f,H){H===b&&(H=1);var A=this,h=new Ek;return A.reverseEach(function(J){H&&!A.isSelectable(J)||(f?A.rectIntersects(J,E):A.rectContains(J,E))&&h.add(J)
}),h},moveSelection:function(f,n){var A=this;A.dm().beginTransaction(),hq(A.sm().toSelection(A.isMovable,A),f,n),A.dm().endTransaction()},moveDatas:function(h,t,v){var F=this;F.dm().beginTransaction(),h instanceof Ek||(h=new Ek(h)),hq(h,t,v),F.dm().endTransaction()},getDataUIBounds:function(S){var u=this.getDataUI(S);return u?u._79o():f},drawData:function(S,a){var U=this.getDataUI(a);U&&(U._79o(),U._42(S)),a instanceof K.Block&&a.eachChild(function(v){this.drawData(S,v)},this)},getBoundsForGroup:function(R){return R.s(ud)?this.getDataUIBounds(R):f},rectIntersects:function(I,_){this.validate();var x=f;if(this._56I[I._id]){var Z=this._25I[I._id];if(Z){var N=Z._79o();if(ff(_,N))x=!0;else if((_=ue(_,N))&&(Z.rectIntersects&&(x=Z.rectIntersects(_)),x==f)){if(!I.s("pixelPerfect"))return!0;var F=_.x,t=_.y,z=_.width,l=_.height,Y=this._zoom,u=G.hitMaxArea,K=z*l*Y*Y;if(K>u){var E=Math.sqrt(u/K);Y*=E}z*=Y,l*=Y,2>z&&(z=2),2>l&&(l=2),F*=Y,t*=Y;var p=ml(z,l);_h(p,-F,-t),p.scale(Y,Y),this._drawForChecking=!0,this.drawData(p,I),this._drawForChecking=!1;try{for(var r=0,D=p.getImageData(0,0,z,l).data;r<D.length;r+=4)if(0!==D[r+3]){x=!0;break}p.restore()}catch(g){Pp=f,x=!1}}}}return x?!0:!1},rectContains:function(j,Z){if(this._56I[j._id]){var e=this._25I[j._id];if(e)return ff(Z,e._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(j){if(!G.isInput(j.target)){var r=this,e=r._focusData,p=e&&r._25I[e._id],W=0,h=r._dataModel._datas;if(!(e&&e._enabled&&e._editable&&p&&p.onKeyDown&&p.onKeyDown(j)===!0))if(9===j.keyCode&&(e&&(W=h.indexOf(e),rl(j)?-1===--W&&(W=0):++W===h.size()&&(W=0)),r._focusData=e=h.get(W),r.sm().setSelection(e)),zo(j)?r.selectAll():Lp(j)&&r.isResettable()&&r.reset(),r.sm().isEmpty()){if(r._editing)return;var S=r.tx(),X=r.ty(),C=!1,z=rl()?100:10;gh(j)&&(S-=z,C=!0),Um(j)&&(X-=z,C=!0),Tg(j)&&(S+=z,C=!0),Xb(j)&&(X+=z,C=!0),C&&r.setTranslate(S,X)}else{Un(j)&&r.handleDelete(j);var D=rl()?10:1;gh(j)&&(r.moveSelection(-D,0),r.fi({kind:"moveLeft"})),Um(j)&&(r.moveSelection(0,-D),r.fi({kind:"moveUp"})),Tg(j)&&(r.moveSelection(D,0),r.fi({kind:"moveRight"})),Xb(j)&&(r.moveSelection(0,D),r.fi({kind:"moveDown"}))}}},handleScroll:function(T,s){lb(T);var K=this.lp(T);s>0?this.scrollZoomIn(K):0>s&&this.scrollZoomOut(K)},handlePinch:function(G,s,K){this._68I||(s>K?this.pinchZoomIn(G):this.pinchZoomOut(G))},checkDoubleClickOnNote:function(D,P){var N=this,r=N.lp(D),X=N.getDataUI(P),W=X.note2Info;return W&&P.s("note2.toggleable")&&xn(W.clickRect,r)?(P.s(cm,!P.s(cm)),N.fi({kind:"toggleNote2",event:D,data:P}),!0):(W=X.noteInfo,W&&P.s("note.toggleable")&&xn(W.clickRect,r)?(P.s(si,!P.s(si)),N.fi({kind:"toggleNote",event:D,data:P}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(x,G){var L=this,N=L.getAutoScrollZone(),o=N/L.getZoom(),h=N/4,w=L._29I,r=L.lp(x),X={x:L.tx(),y:L.ty()};return r&&N>0&&w&&(r.x-w.x<o?L.translate(h,0):w.x+w.width-r.x<o&&L.translate(-h,0),r.y-w.y<o?L.translate(0,h):w.y+w.height-r.y<o&&L.translate(0,-h)),X.x=L.tx()-X.x,X.y=L.ty()-X.y,G&&(G.x+=X.x,G.y+=X.y),X},getMoveMode:function(D,q){var W=q.s("2d.move.mode");return W?W:xh["88"]?"x":xh["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(c,B,G){var N=this;return"currentSubGraph"===B?{__i:c.getId()}:G.serializeProperty(c,B,N)},deserializeProperty:function(W,B,U){var L=this;if("currentSubGraph"===B){var c=L.dm(),l=c.__idMap;return l[W.__i]}return U.deserializeProperty(W,B,L)},setDefaultCursor:function(x,Q){this._defaultCursor=x,Q!==!1&&this.setCursor(x)},setCursor:function(K){"default"===K&&(K=this._defaultCursor||K);var t=this.getView().style;t.cursor=K,t.cursor="-webkit-"+K,t.cursor="-moz-"+K},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(k){return G.getConnectAction(null,k)?(this._currentActionType=k,!0):!1},isInteractive:function(X){return X.s("interactive")}});var mg=function(I,r){var z=this;z.gv=I,z.s=function(F){return r.getStyle(F)},z._data=r,z._87I=new Ek};Gh(mg,p,{_6I:f,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var m=this,g=m.gv.isSelected(m._data);return!g||m.isShadowed()?0:m.gv.getSelectWidth(m._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(x){var Z=this._data,o=this.gv.getBodyColor(Z);return o?o:x?Z.getStyle(x):f},_2Q:function(s){return this.s(s)},_1Q:function(P,h,D,H){var E=this.s,g=E(h+".dash.color");P.strokeStyle=g,P.lineWidth=D,P.stroke(),E(h+".dash.3d")&&Wd(P,g,E(h+".dash.3d.color"),D,this.gv._zoom,E(h+".dash.3d.accuracy")),dl(P,H)},invalidate:function(){this._6I=f},_79o:function(){var z=this;if(!z._6I){var n=z._data,x=z.gv;z.labelInfo=z.label2Info=z.noteInfo=z.note2Info=z._38o=f,z._87I.clear(),z.interactiveInfo=x.isInteractive(n)?{}:f,z._3O(),z._55O=x.isEditable(n)?{_42O:x.isRectEditable(n),_43O:x.isPointEditable(n),_56O:x.isRotationEditable(n)}:f,z._6I=z._81o()}return z._6I},_3O:function(){},getPosition:function(){return Xh},_68o:function(H,C){H&&this._87I.add(gc(H,C))},_81o:function(){var P=this,E=P.s;P._24O(Sp,"getLabel"),P._24O(xf,"getLabel2"),P._26O(Oq,"getNote"),P._26O(Po,"getNote2"),P._15O(),P._55O&&P._48O();var i;if(P._87I.each(function(O){i=of(i,O)}),i&&P.isShadowed()){var F=lg(i);F.x+=E("shadow.offset.x"),F.y+=E("shadow.offset.y"),Lq(F,E("shadow.blur")),i=of(i,F)}return P._87I.clear(),i},_42:function(M){var A=this,L=A._data,$=A.gv,X=A.s,J=X("opacity"),w=this.isShadowed();if(w){var o=M.shadowOffsetX,F=M.shadowOffsetY,S=M.shadowBlur,C=M.shadowColor,x=$.getZoom();M.shadowOffsetX=X("shadow.offset.x")*x,M.shadowOffsetY=X("shadow.offset.y")*x,M.shadowBlur=X("shadow.blur")*x,M.shadowColor=A.getSelectColor()}if(J!=f){var z=M.globalAlpha;M.globalAlpha=J}A._80o(M),$.isLabelVisible(L)&&((!$._drawForChecking||X("label.selectable"))&&Yh(M,A.labelInfo),(!$._drawForChecking||X("label2.selectable"))&&Yh(M,A.label2Info)),$.isNoteVisible(L)&&(xq(M,A.noteInfo),xq(M,A.note2Info)),A._99O(M),J!=f&&(M.globalAlpha=z),w&&(M.shadowOffsetX=o,M.shadowOffsetY=F,M.shadowBlur=S,M.shadowColor=C)},_80o:function(){},_47O:function(){},_24O:function(U,v){var T=this,N=T._data,J=T.gv,K=T.s,d=J[v](N);if(d!=f){var x=K(U+".scale"),A=K(U+".max"),r=K(U+".position"),B=T[U+"Info"]={label:d,scale:x,color:J[v+"Color"](N),font:K(U+".font"),opacity:K(U+".opacity"),align:K(U+".align"),rotation:T.getRotation(K(U+".rotation"),!1,r),background:J[v+"Background"](N)},F=Sg(B,d);A>0&&A<F.width&&(B.labelWidth=F.width,F.width=A),1!==x&&(F.width*=x,F.height*=x);var X=T.getPosition(r,K(U+".offset.x"),K(U+".offset.y"),F,K(U+".position.fixed"));if(F.x=X.x-F.width/2,F.y=X.y-F.height/2,T._68o(B.rect=F,B.rotation),1!==x){var i=F.width/x,H=F.height/x;B.rect={x:X.x-i/2,y:X.y-H/2,width:i,height:H}}}},_26O:function(N,V){var Y=this,L=Y.gv,v=Y._data,o=Y.s,r=L[V](v);if(r!=f){var x,X,j=o(N+".scale"),u=Y[N+"Info"]={note:r,scale:j,data:v,view:L,expanded:o(N+".expanded"),font:o(N+".font"),color:o(N+".color"),opacity:o(N+".opacity"),align:o(N+".align"),icon:o(N+".icon"),backgroundImage:o(N+".backgroundImage"),borderWidth:o(N+".border.width"),borderColor:o(N+".border.color"),background:L[V+"Background"](v)},D=Y.getPosition(o(N+".position"),o(N+".offset.x"),o(N+".offset.y")),Q=D.x,n=D.y;if(u.expanded){var s,A=o(N+".max"),c=o(N+".backgroundImage");c?(c=fg(c),s={width:Nj(c,v),height:od(c,v)}):s=Sg(u,r),s.width+=6,s.height+=2,A>0&&A<s.width&&(u.labelWidth=s.width,s.width=A),x=s.width,X=s.height+8,u.clickRect={x:Q-x*j/2,y:n-X*j,width:x*j,height:X*j*s.height/X}}else{var m=o(N+".icon");m?(m=fg(m),x=Nj(m,v),X=od(m,v)):(x=12,X=18),u.clickRect={x:Q-x*j/2,y:n-X*j,width:x*j,height:X*j}}u.rect={x:Q-x/2,y:n-X*j/2-X/2,width:x,height:X};var b=W(u.borderWidth/2)*j;Y._68o({x:Q-x*j/2-b,y:n-X*j-b,width:x*j+2*b,height:X*j+2*b})}},_48O:function(){},_99O:function(O){var e=this,w=e._38o;if(w){var H=e.gv,u=e._data,J=w.icons,A=e.interactiveInfo;A&&(A._38o={});for(var z in J){var l=J[z],M=w.rects[z];if(M){A&&(A._38o[z]=[]);var B=wn(l.opacity,u,H),P=wn(l.names,u,H),q=P?P.length:0,n=M.rotation;if(B!=f){var Z=O.globalAlpha;O.globalAlpha*=B}for(var C=0;q>C;C++){var m=P[C],V=fg(m),N=M[C];if(n){var p=N.x+N.width/2,o=N.y+N.height/2;O.save(),_h(O,p,o),Df(O,n),_h(O,-p,-o)}A&&A._38o[z].push(O.interactiveInfo={compInfos:[],matrix:n?new Xp(n,p,o).appendTranslate(-p,-o):new Xp}),Do(O,V,wn(l.stretch,u,H),N.x,N.y,N.width,N.height,e._data,e.gv),O.interactiveInfo=f,n&&O.restore()}B!=f&&(O.globalAlpha=Z)}}}}});var qf=function(U,j){gm(qf,this,[U,j])};Gh(qf,mg,{_checkEmptyRect:!0,_40O:function(p,K){var s=this,j=s.s,x=p.rect;(p.borderColor=s.gv.getBorderColor(s._data))&&(p.borderType=j("border.type"),p.borderWidth=j("border.width"),p.borderPadding=j("border.padding"),K=o(K,p.borderPadding+p.borderWidth/2));var N=s._data.getScale(),M=o(1,o(g(N.x),g(N.y)));if(p.selectWidth=s.getSelectWidth()){var u=s.gv._zoom;p.selectType=j("select.type"),p._97o=s.getSelectColor(),p.selectPadding=j("select.padding"),K=o(K,(p.selectPadding+p.selectWidth/2/u)/M)}K>0&&(K*=M,x=lg(x),Lq(x,K)),s._68o(x)},_39O:function(F,m){var b,S=this,Q=m.rect;if(m.borderWidth>0&&(b=m.borderPadding,F.strokeStyle=m.borderColor,F.lineWidth=m.borderWidth,rm(F,m.borderType,{x:Q.x-b,y:Q.y-b,width:Q.width+2*b,height:Q.height+2*b}),F.stroke()),m.selectWidth>0){var C=S.gv._zoom;if(b=m.selectPadding,F.strokeStyle=m._97o,F.lineWidth=m.selectWidth/C,m.rotation!=f){F.save(),F.translate(m.position.x,m.position.y),F.rotate(m.rotation);var x=S._data,H=x.getWidth(),A=x.getHeight(),N=m.scale,c=m.anchor;Q={x:N.x*-H*c.x,y:N.y*-A*c.y,width:N.x*H,height:N.y*A}}rm(F,m.selectType,{x:Q.x-b,y:Q.y-b,width:Q.width+2*b,height:Q.height+2*b}),m.rotation!=f&&F.restore(),F.stroke()}},_3O:function(){var Z=this,p=Z.s,l=Z._data,n=l.getStyle(pl),E=Z.getBodyColor(),S=Z._83o=n?{shape:n,_53o:Z.getBodyColor("shape.background"),_27Q:fg(p("shape.repeat.image"),E),shapeGradientPack:p("shape.gradient.pack"),_54o:p("shape.border.width"),_55o:p("shape.border.color"),_56o:p("shape.border.3d"),_57o:p("shape.border.3d.color"),_58o:p("shape.border.3d.accuracy"),shapeGradient:p("shape.gradient"),_59o:p("shape.gradient.color"),_60o:p("shape.border.pattern"),_61o:p("shape.border.cap"),_62o:p("shape.border.join"),bodyColor:E}:{img:fg(Z.gv.getImage(l),E),bodyColor:E,stretch:p("image.stretch")};if(h&&!Y);else{S.rect=l.getRect(),S.position=l.p(),S.scale=l.getScale(),S.anchor=l.getAnchor(),S.rotation=l.getRotation(),n===Tr&&(S._63o=p("shape.depth"));var J=0;if(n)J=Di(f,S._54o/2,S._62o),Z.s("shape.dash")&&(J=o(J,(Z.s("shape.dash.width")||S._54o)/2));else if(S.img&&S.img.boundExtend)if(J=wn(S.img.boundExtend,l,Z.gv),S.img.boundExtendAbsolute){var P=l.getScale();J/=Z.gv._zoom*o(1,o(g(P.x),g(P.y)))}else if(!wn(S.img.fitSize,l,Z.gv)){var W=wn(S.img.width,l,Z.gv),s=wn(S.img.height,l,Z.gv);J*=o(l.getWidth()/W,l.getHeight()/s)}Z._40O(S,J);var K=p("clip.percentage");if(1>K&&(0>K&&(K=0),S.clipRect=go(l.getAnchorRect(),p("clip.direction"),K)),n){var D=p("shape.fill.clip.percentage");1>D&&(0>D&&(D=0),S.shapeClipRect=go(l.getAnchorRect(),p("shape.fill.clip.direction"),D))}}},getPosition:function(u,K,_,n){var Q=Ll(u,this._83o.rect,n);return Q.x+=K,Q.y+=_,Q},_80o:function(v){var y=this,K=y.s,i=y.gv,O=y._data,x=y._83o,q=x.rect,u=x.position,H=x.rotation,U=x.anchor,o=x.scale,M=x.shape,Z=x.clipRect;if(!y._checkEmptyRect||q.width>0&&q.height>0){var B=O.getSize();if(B.x=-B.width*U.x,B.y=-B.height*U.y,v.save(),_h(v,u.x,u.y),Df(v,H),ts(v,o.x,o.y),Z&&(v.beginPath(),v.rect(Z.x,Z.y,Z.width,Z.height),v.clip()),y.freeDraw)y.freeDraw(v,B,x);else if(M){var _,D,p,z,k=x._60o,h=Nl(v,k),P=x._53o,b=x._27Q,e=x._54o,R=x._55o,A=x.shapeGradientPack,E=v.lineJoin,c=v.lineCap;if("roundRect"===M?_=K("shape.corner.radius"):"polygon"===M?_=K("shape.polygon.side"):"arc"===M&&(_=K("shape.arc.from"),D=K("shape.arc.to"),p=K("shape.arc.close"),z=K("shape.arc.oval")),v.lineJoin=x._62o,v.lineCap=x._61o,K("shape.background2")&&(rm(v,M,B,_,D,p,z),rf(v,K("shape.background2"),K("shape.gradient2"),K("shape.gradient2.color"),B),v.fill()),P||b||A){var Y=x.shapeClipRect;Y&&(v.save(),v.beginPath(),v.rect(Y.x,Y.y,Y.width,Y.height),v.clip()),rm(v,M,B,_,D,p,z),A?Se(v,A):b?Vn(v,b,x.bodyColor,null,O,i):rf(v,P,x.shapeGradient,x._59o,B),v.fill(),Y&&v.restore(),A&&v.restore(),v!==h&&rm(h,M,B,_,D,p,z)}else rm(h,M,B,_,D,p,z);if(e>0){var g=K("shape.border.width.absolute");g&&(v.save(),v.setTransform(1,0,0,1,0,0)),v.lineWidth=e,v.strokeStyle=R,v.stroke(),g&&v.restore(),x._56o&&Wd(v,R,x._57o,e,i._zoom,x._58o)}if(dl(v,k),K("shape.dash")){var s=K("shape.dash.width")||e;if(s>0){k=K("shape.dash.pattern");var h=Nl(v,k,y._2Q("shape.dash.offset"));h!==v&&rm(h,M,B,_,D,p,z),y._1Q(v,"shape",s,k)}}Lb(v,P,x._63o,B),v.lineJoin=E,v.lineCap=c}else{var F=y.interactiveInfo;F&&(v.interactiveInfo=F.bodyInfo={compInfos:[],matrix:new Xp(H,u.x,u.y,o.x,o.y)}),Do(v,x.img,x.stretch,B.x,B.y,B.width,B.height,O,i,x.bodyColor),v.interactiveInfo=f}v.restore()}y._39O(v,x)},_48O:function(){},_47O:function(){}});var Ue=function(C,s){gm(Ue,this,[C,s])},Ji=function(e,V,E,D){var a=Bj(e,V);return E=D?S(E,a):Le(E,a),a?E/=a:E=0,{x:e.x+(V.x-e.x)*E,y:e.y+(V.y-e.y)*E}};Gh(Ue,mg,{_3O:function(){var j,S=this,O=S._data,P=S.gv,Z=S.s,d=Z(Qg),Q=O.isLooped(),s=Z("edge.width"),W=Z("edge.center"),w=Z("edge.offset"),v=P.getBorderColor(O),H=v?Z("border.width"):0,C=S.getSelectWidth(),J=O._40I,c=O._41I,m=S._78o=J&&c?{looped:Q,type:d,width:s,center:W,color:S.getBodyColor("edge.color"),borderColor:v,borderWidth:H,_97o:C?S.getSelectColor():f,selectWidth:C,pattern:Z("edge.pattern"),cap:Z("edge.cap"),join:Z("edge.join"),is3d:Z("edge.3d"),_67o:Z("edge.3d.color"),_66o:Z("edge.3d.accuracy")}:f;if(m){var g=G.getEdgeType(d);if(g){var q=g(O,_o(S,P,O,Q,d),P,S._19Q);q.points&&q.points.size()>1?(m.edgeTypeInfo=q,j=qp(m.edgeTypeInfo.points)):q[Sq]&&q.rect&&(m.edgeTypeInfo=q,j=q.rect)}else{var Y=Z("edge.source.anchor.x"),$=Z("edge.source.anchor.y"),U=Z("edge.target.anchor.x"),K=Z("edge.target.anchor.y"),X=nr(P,J,Z("edge.source.position"),Z("edge.source.offset.x"),Z("edge.source.offset.y"),Y,$),B=nr(P,c,Z("edge.target.position"),Z("edge.target.offset.x"),Z("edge.target.offset.y"),U,K);if(d===tm){var E=m.points=Z(Mc)||oi,T=E.size();m.segments=Z("edge.segments");var R=Y!==b||$!==b,n=U!==b||K!==b;if(!W)if(w)R||(X=Ji(X,T?E.get(0):B,w,T)),n||(B=Ji(B,T?E.get(T-1):X,w,T));else{var p;R||(p=Ag(X,T?E.get(0):B,cq(P,J)),p&&(X={x:p[0],y:p[1]})),n||(p=Ag(T?E.get(T-1):X,B,cq(P,c)),p&&(B={x:p[0],y:p[1]}))}j=of(qp(m.points),qp(X,B))}else{var M=_o(S,P,O,Q,d);if(S._19Q||(M=-M),Q)X=lg(X),X.x=P.getNodeRect(J).x,m.radius=M,j={x:X.x-M,y:X.y-M,width:2*M,height:2*M};else{var e=Bj(X,B),y=Le(w,e),z={x:y,y:M},l={x:e-y,y:M},D=I(B.y-X.y,B.x-X.x),r=m.mat=new pd(D);if(m.orienAngle=D,m.angle=B.x<X.x?D+L:D,m.rect={x:z.x,y:z.y,width:l.x-z.x,height:0},m.origin=X,z=r.tf(z),z.x+=X.x,z.y+=X.y,l=r.tf(l),l.x+=X.x,l.y+=X.y,W){var x={x:e,y:0};x=r.tf(x),x.x+=X.x,x.y+=X.y,j=qp([X,z,l,x]),m.c1=X,m.c2=x}else j=qp(z,l);X=z,B=l}}m.sourcePoint=X,m.targetPoint=B,O._lastSourcePoint=X,O._lastTargetPoint=B}var t=0;Z("edge.dash")&&(t=Z("edge.dash.width")||s);var i="square"===m.cap?.71:.5;Di(j,o(t*i,s*i+H+C),m.join),S._68o(j)}},getRotation:function(Y,U,$){Y=Y||0;var A=this._78o;if(A){var K,z=A.angle,s=A.points,T=A.edgeTypeInfo;if(z!=f)return U?A.orienAngle+Y:z+Y;if(T&&T[Sq])return T.getRotation?T.getRotation(this,Y,U,$):0;if(T&&T.points){var q=T.points;return K=q.size(),Zi[$]?K&&0===K%2?Tk(q.get(K/2-1),q.get(K/2),U,Y):Y:Uf[$]?Tk(q.get(0),q.get(1),U,Y):Tk(q.get(K-2),q.get(K-1),U,Y)}if(s)return K=s.size(),Zi[$]?K&&0===K%2?Tk(s.get(K/2-1),s.get(K/2),U,Y):Y:Uf[$]?Tk(A.sourcePoint,K?s.get(0):A.targetPoint,U,Y):Tk(K?s.get(K-1):A.sourcePoint,A.targetPoint,U,Y)}return Y},getPosition:function(Q,Y,A,f,T){var I=this._78o;if(I){var n,q=I.type,G=I.points,K=I.edgeTypeInfo,V=I.sourcePoint,M=I.targetPoint;if(!q)return I.looped?{x:V.x-I.radius+Y,y:V.y+A}:(T&&V&&M&&(V.x>M.x||V.x===M.x&&V.y>M.y)&&(Q=hm[Q],A=-A),n=Ll(Q,I.rect,f),n.x+=Y,n.y+=A,n=I.mat.tf(n),n.x+=I.origin.x,n.y+=I.origin.y,n);if(K&&K[Sq])return K.getPosition?K.getPosition(this,Q,Y,A,f,T):{x:(V.x+M.x)/2,y:(V.y+M.y)/2};if(G){var n,h=G.size();if(Zi[Q]){if(h){var g=h%2;if(0===g)return hs(G.get(h/2-1),G.get(h/2),Q,Y,A,f,T);n=G.get((h-g)/2)}else n={x:(V.x+M.x)/2,y:(V.y+M.y)/2};return n=Ll(Q,{x:n.x,y:n.y,width:0,height:0},f),n.x+=Y,n.y+=A,n}return Uf[Q]?hs(V,h?G.get(0):M,Q,Y,A,f,T):hs(h?G.get(h-1):V,M,Q,Y,A,f,T)}if(K){var i=K.points,h=i.size();if(Zi[Q]){var g=h%2;return 0===g?hs(i.get(h/2-1),i.get(h/2),Q,Y,A,f,T):(n=i.get((h-g)/2),n=Ll(Q,{x:n.x,y:n.y,width:0,height:0},f),n.x+=Y,n.y+=A,n)}return Uf[Q]?hs(i.get(0),i.get(1),Q,Y,A,f,T):hs(i.get(h-2),i.get(h-1),Q,Y,A,f,T)}}return Xh},_42:function(L){this._78o&&Ue.superClass._42.call(this,L)},drawPath:function(M,o){M.beginPath();var O=o.type,j=o.points,V=o.segments,G=o.edgeTypeInfo;if(!O||j){var _=o.sourcePoint,i=_.x,u=_.y,I=o.targetPoint,d=I.x,H=I.y;if(O)if(V){var x=new Ek({x:i,y:u});x.addAll(j),x.add({x:d,y:H}),ih(M,x,V)}else M.moveTo(i,u),j.each(function(m){M.lineTo(m.x,m.y)}),M.lineTo(d,H);else o.looped?M.arc(i,u,o.radius,0,U,!0):o.center?(M.moveTo(o.c1.x,o.c1.y),M.lineTo(i,u),M.lineTo(d,H),M.lineTo(o.c2.x,o.c2.y)):(M.moveTo(i,u),M.lineTo(d,H))}else G&&(G.points?ih(M,G.points,G.segments):G[Sq]&&G[Sq](M,G))},_80o:function(J){var I=this,q=I.s,p=I._78o,B=p.width,f=p.selectWidth,W=p.borderWidth,N=p.color,x=J.lineJoin,g=J.lineCap,i=p.pattern;J.lineJoin=p.join,J.lineCap=p.cap,I.drawPath(Nl(J,i),p);var V=q("edge.width.absolute");if(V&&(J.save(),J.setTransform(1,0,0,1,0,0)),f&&(J.strokeStyle=p._97o,J.lineWidth=B+2*(W+f),J.stroke()),W&&(J.strokeStyle=p.borderColor,J.lineWidth=B+2*W,J.stroke()),J.strokeStyle=N,J.lineWidth=B,J.stroke(),p.is3d&&Wd(J,N,p._67o,B,I.gv._zoom,p._66o),V&&J.restore(),dl(J,i),q("edge.dash")){i=q("edge.dash.pattern");var O=Nl(J,i,I._2Q("edge.dash.offset"));O!==J&&I.drawPath(O,p),I._1Q(J,"edge",q("edge.dash.width")||B,i)}J.lineJoin=x,J.lineCap=g},_48O:function(){},_47O:function(){},_71o:function(u,o){var V=this,A=V._data;if(V._19Q=!0,!A.getEdgeGroup())return u?A.s("edge.gap"):0;var r,Q=0,f=0,y=0;if(A.getEdgeGroup().getSiblings().each(function(G){G.each(function(x){if(V.gv.isVisible(x)&&x.s(Qg)==o){var O=x.s("edge.gap");r?(f+=y/2+O/2,y=O):(r=x,y=O),x===A&&(Q=f)}})}),u)return f-Q+y;var R=Q-f/2;return r&&A._40I!==r._40I&&(V._19Q=!1),R}});var sk=function(D,Y){gm(sk,this,[D,Y])};Gh(sk,qf,{_3O:function(){var n,L,b=this,U=b.s,O=b._data,v=b.gv;if(b._88I=f,O.isExpanded()&&O.eachChild(function(i){var q=v.getBoundsForGroup(i);q&&(L||(L=[]),L.push(q),n=of(n,q))}),n){var Z=v.getLabel(O),y=U("group.type");n=dm(y,L,n),qc(n,O,"group.padding",1);var s=b._88I={type:y,rect:n,_64o:n};if(!y&&Z!=f){var X,o=b.labelInfo={label:Z,color:U("group.title.color"),font:U("group.title.font"),align:U("group.title.align")},I=Sg(o,Z),q=I.width,Q=I.height,B=U("group.title.align");q>n.width&&(n.width=q),o.rect={y:n.y-Q,width:I.width,height:Q},X=B===Rj?n.x:B===$e?n.x+n.width-q:n.x+n.width/2-q/2,o.rect.x=X,s.titleRect={x:n.x,y:n.y-Q,width:n.width,height:Q+1},s.rect={x:n.x,y:n.y-Q,width:n.width,height:n.height+Q}}b._40O(s,U("group.border.width")/2)}else sk.superClass._3O.call(b)},getPosition:function(e,i,F,j){var H=this._88I;if(H){var W=Ll(e,H.rect,j);return W.x+=i,W.y+=F,W}return sk.superClass.getPosition.apply(this,arguments)},_24O:function(G,t){var v=this._88I;(!v||v.type||"label2"===G)&&sk.superClass._24O.call(this,G,t)},_80o:function(p){var b=this,z=b._88I;if(z){var s=b._data,W=b.s,Z=b.gv,k=z.type,o=z.rect,c=z._64o,x=z.titleRect,O=b.getBodyColor(),j=fg(W("group.image"),O),d=W("group.image.stretch"),e=b.getBodyColor("group.background"),X=fg(W("group.repeat.image"),O),u=W("group.gradient.pack"),v=W("group.gradient"),E=W("group.gradient.color"),R=W("group.depth");if(k){var L=W("group.border.pattern"),q=W("group.border.width"),$=p.lineJoin,C=p.lineCap;if(p.lineJoin=W("group.border.join"),p.lineCap=W("group.border.cap"),j){if(p.save(),rm(p,k,o),p.clip(),Do(p,j,d,o.x,o.y,o.width,o.height,s,Z,O),p.restore(),q>0){var t=Nl(p,L);rm(t,k,o),p.lineWidth=q,p.strokeStyle=W("group.border.color"),p.stroke(),dl(p,L)}}else{var t=Nl(p,L);e||X||u?(rm(p,k,o),u?Se(p,u):X?Vn(p,X,O,null,s,Z):rf(p,e,v,E,o),p.fill(),u&&p.restore(),p!==t&&rm(t,k,o)):rm(t,k,o),q>0&&(p.lineWidth=q,p.strokeStyle=W("group.border.color"),p.stroke()),dl(p,L),k===Tr&&Lb(p,e,R,o)}p.lineJoin=$,p.lineCap=C}else if(j?Do(p,j,d,c.x,c.y,c.width,c.height,s,Z,b.getBodyColor()):(e||X)&&(X?Vn(p,X,O,null,s,Z):rf(p,e,v,E,c),rm(p,Tr,c),p.fill(),Lb(p,e,R,c)),x){var V=W("group.title.background");tj(p,x.x,x.y,x.width,x.height,V),Lb(p,V,R,x)}b._39O(p,z)}else sk.superClass._80o.call(b,p)}});var Ee=function(v,G){gm(Ee,this,[v,G])};Gh(Ee,qf,{_80o:function(f){this._39O(f,this._83o)}});var Ef=function(e,E){gm(Ef,this,[e,E])};Gh(Ef,qf,{_3O:function(){var D=this,N=D._data,W=D.s,T=D.gv,Q=N.getPoints(),V=T.getBorderColor(N),a=V?W("border.width"):0,w=D.getSelectWidth(),k=W("shape.border.width"),p=N.getRect(),F=T.getBodyColor(N),B=D._99o=Q.isEmpty()?f:{rect:p,rotation:N.getRotation(),fillRule:W("shape.fill.rule"),scale:N.getScale(),position:N.p(),points:Q,segments:N.getSegments(),bodyColor:F,borderColor:V,borderWidth:a,_94o:W("shape.border.3d"),_95o:W("shape.border.3d.color"),_96o:W("shape.border.3d.accuracy"),_97o:w?D.getSelectColor():f,selectWidth:w,_53o:W("shape.background"),_27Q:fg(W("shape.repeat.image"),F),shapeGradientPack:W("shape.gradient.pack"),_54o:k,_55o:W("shape.border.color"),shapeGradient:W("shape.gradient"),_59o:W("shape.gradient.color"),_60o:W("shape.border.pattern"),_61o:W("shape.border.cap"),_62o:W("shape.border.join")};if(B){var x=N.getScale(),d=o(1,o(g(x.x),g(x.y)));W("shape.dash")&&W("shape.dash.width")>k&&(k=W("shape.dash.width"));var v=k*("square"===B._61o?.71:.5)+a+w/D.gv._zoom/d;v&&(v*=d,p=lg(p),Di(p,v,B._62o)),D._68o(p);var e=W("clip.percentage");1>e&&(0>e&&(e=0),B.clipRect=go(N.getAnchorRect(),W("clip.direction"),e));var $=W("shape.fill.clip.percentage");1>$&&(0>$&&($=0),B.shapeClipRect=go(N.getAnchorRect(),W("shape.fill.clip.direction"),$))}},getPosition:function(y,P,w,q){var C=this._99o;if(C){var V=Ll(y,C.rect,q);return V.x+=P,V.y+=w,V}return Xh},_42:function(R){this._99o&&Ef.superClass._42.call(this,R)},_80o:function(u){var f,J=this,W=J.s,r=J._99o,o=r.position,t=r.scale,n=r.rotation,B=r.bodyColor,h=r.borderWidth,M=r.selectWidth,$=r._53o,Y=r._27Q,y=r.shapeGradientPack,T=r._54o,K=r.clipRect,Z=r.shapeClipRect,O=r.points,s=r.segments,Q=J._data.isClosePath(),R=r.fillRule,c=$||Y||y;u.save(),_h(u,o.x,o.y),Df(u,n),ts(u,t.x,t.y),W("shape.background2")&&(_h(u,-o.x,-o.y),ih(u,O,s,Q),rf(u,W("shape.background2"),W("shape.gradient2"),W("shape.gradient2.color"),r.rect),u.fill(),_h(u,o.x,o.y)),K&&(u.beginPath(),u.rect(K.x,K.y,K.width,K.height),u.clip()),c&&Z&&(u.save(),u.beginPath(),u.rect(Z.x,Z.y,Z.width,Z.height),u.clip()),_h(u,-o.x,-o.y);var j=r._60o,z=Nl(u,j),m=u.lineJoin,S=u.lineCap;u.lineJoin=r._62o,u.lineCap=r._61o,c?(ih(u,O,s,Q),y?Se(u,y):Y?Vn(u,Y,B,null,J._data,J.gv):(f=B?B:$,rf(u,f,r.shapeGradient,r._59o,r.rect)),u.fill(R),Z&&(u.restore(),_h(u,-o.x,-o.y)),y&&u.restore(),z!==u&&ih(z,O,s,Q)):ih(z,O,s,Q);var U=W("shape.border.width.absolute");if(U&&(u.save(),u.setTransform(1,0,0,1,0,0)),M&&(u.strokeStyle=r._97o,u.lineWidth=T+2*(h+M),u.stroke()),h&&(u.strokeStyle=r.borderColor,u.lineWidth=T+2*h,u.stroke()),T&&(f=r._55o,!$&&B&&(f=B),u.strokeStyle=f,u.lineWidth=T,u.stroke(),r._94o&&Wd(u,f,r._95o,T,J.gv._zoom,r._96o)),U&&u.restore(),dl(u,j),W("shape.dash")){var F=W("shape.dash.width")||T;if(F>0){j=W("shape.dash.pattern");var z=Nl(u,j,J._2Q("shape.dash.offset"));z!==u&&ih(z,O,s,Q),J._1Q(u,"shape",F,j)}}u.lineJoin=m,u.lineCap=S,u.restore()},_48O:function(){},_47O:function(){}});var Dr=function(x,g){gm(Dr,this,[x,g])};Gh(Dr,Ef,{getRotation:function(r,d,H){r=r||0;var D=this._data.getPoints(),y=D.size();return y>1?Zi[H]?y&&0===y%2?Tk(D.get(y/2-1),D.get(y/2),d,r):r:Uf[H]?Tk(D.get(0),D.get(1),d,r):Tk(D.get(y-2),D.get(y-1),d,r):r},getPosition:function(S,a,s,w,O){var c=this._data.getPoints(),G=c.size();if(G>1){if(Zi[S]){var M=G%2;if(0===M)return hs(c.get(G/2-1),c.get(G/2),S,a,s,w,O);var $=c.get((G-M)/2),i={x:$.x,y:$.y,width:0,height:0};return $=Ll(S,i,w),$.x+=a,$.y+=s,$}return Uf[S]?hs(c.get(0),c.get(1),S,a,s,w,O):hs(c.get(G-2),c.get(G-1),S,a,s,w,O)}return Xh}});var pm=function(A,s){gm(pm,this,[A,s])};Gh(pm,qf,{_3O:function(){var L=this;pm.superClass._3O.call(L);var V=L.s,B=L._83o;L._82o=B.img||B.shape?f:{background:L.getBodyColor("grid.background"),depth:V("grid.depth"),rect:B.rect,_88o:V("grid.cell.depth"),cellBorderColor:V("grid.cell.border.color"),_89o:V("grid.row.count"),_90o:V("grid.column.count"),block:V("grid.block"),_91o:V("grid.block.color"),_92o:V("grid.block.padding"),_93o:V("grid.block.width")}},_80o:function(o){var n=this,s=n._82o;if(!s)return pm.superClass._80o.call(n,o),void 0;var V,y,R=n._data,T=s.background,H=s.rect,S=s.block,d=s._91o,v=s._92o,e=s._93o,A=s._88o,Q=s.cellBorderColor,p=s._89o,w=s._90o;if(T)if(tj(o,H.x,H.y,H.width,H.height,T),Lb(o,T,s.depth,H),A)for(V=0;p>V;V++)for(y=0;w>y;y++)H=R.getCellRect(V,y),H&&Lb(o,T,A,H);else if(Q){for(o.beginPath(),V=0;p>V;V++)for(y=0;w>y;y++)H=R.getCellRect(V,y),H&&o.rect(H.x,H.y,H.width,H.height);o.strokeStyle=Q,o.lineWidth=1,o.stroke()}if("h"===S)for(V=0;p>V;V++)H=of(R.getCellRect(V,0),R.getCellRect(V,w-1)),Lq(H,v),me(o,d,H.x,H.y,H.width,H.height,e);else if("v"===S)for(y=0;w>y;y++)H=of(R.getCellRect(0,y),R.getCellRect(p-1,y)),Lq(H,v),me(o,d,H.x,H.y,H.width,H.height,e);n._39O(o,n._83o)}});var Pb=function(M,B){gm(Pb,this,[M,B])};Gh(Pb,qf,{_checkEmptyRect:!1,_81o:function(){var N=this._data,O=Pb.superClass._81o.call(this),B=N.s("text");if(B!=f){var G,X,I=N.s("text.font"),E=N.s("text.align"),y=N.s("text.vAlign"),i=kn(I,B),Y=i.width,g=i.height,q=N.getAnchor(),D=N.getWidth(),w=N.getHeight();"left"===E?G=-D*q.x:"center"===E?G=-D*q.x+(D-Y)/2:"right"===E&&(G=D*(1-q.x)-i.width),"top"===y?X=-w*q.y:"middle"===y?X=-w*q.y+(w-g)/2:"bottom"===y&&(X=w*(1-q.y)-i.height);var k,$=N.getMatrix();if(k=qp([$.tf(G,X),$.tf(G+Y,X),$.tf(G+Y,X+g),$.tf(G,X+g)]),O=of(O,k),O&&N.s("text.shadow")){var Q=lg(O);Q.x+=N.s("text.shadow.offset.x"),Q.y+=N.s("text.shadow.offset.y"),Lq(Q,N.s("text.shadow.blur")),O=of(O,Q)}}return O}});var Hb=qm.Interactor=function(q){this.gv=this._graphView=q};vc("Interactor",p,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(o){this.gv.fi(o)},setCursor:function(a){Tf||this.gv.setCursor(a)},startDragging:function(X){var s=this;s._lastClientPoint=Jk(X),s._lastLogicalPoint=s.gv.lp(X),Zo(s,X)},clearDragging:function(){var z=this;z._lastClientPoint=z._lastLogicalPoint=z._logicalPoint=f},autoScroll:function(J){return this.gv.autoScroll(J,this._lastClientPoint)}});var Ir=function(P){var D=this;D.gv=P,D._is2d=P instanceof qm.GraphView,D._is2d&&(D.filter=function(D){return P.isSelectable(D)&&P.isInteractive(D)}),P.getView(),["mousedown","mousemove","touchstart","touchmove"].forEach(function(M){D.addListener(M)}),N.addEventListener(ge,function(h){Bb(h)&&D.handleWindowMove(h)},!1),N.addEventListener(km,function(O){Bb(O)&&D.handleWindowUp(O)},!1),N.addEventListener(Bs,function(n){Bb(n)&&D.handleWindowMove(n)},!1),N.addEventListener(Kq,function(s){Bb(s)&&D.handleWindowUp(s)},!1)};Gh(Ir,Hb,{addListener:function(c){var j=this;j.gv.getView().addEventListener(c,function(o){G.preventDefault(o),Bb(o)&&!j.disabled&&j["handle_"+c](o)},!1)},handle_touchstart:function(j){this.handle_mousedown(j)},handle_touchmove:function(y){this.handle("onMove",y)},handleWindowMove:function(z){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",z):(this.handleDownInfo("onBeginDrag",z),this.isDragging=!0))},handleWindowUp:function(u){if(this.isDragging&&(this.handleDownInfo("onEndDrag",u),this.isDragging=!1),this.downInfo){var o=this.handle("onUp",u);o&&o.data===this.downInfo.data?this.handleMissingUp(u):this.handleDownInfo("onUp",u),this.downInfo=f}},handle_mousedown:function(e){this.isDragging&&(this.handleDownInfo("onEndDrag",e),this.isDragging=!1),this.downInfo=this.handle("onDown",e)},handle_mousemove:function(e){var h=this,J=h.gv;h._hoverTimer&&(_(h._hoverTimer),delete h._hoverTimer);var c,K,T,D=h.handle("onMove",e),t=this.currentInfo?this.currentInfo.data:f,Q=this.currentInfo?this.currentInfo.hits:f;if(D&&(K=D.data,T=D.hits,h._hoverTimer=$(function(){_(h._hoverTimer),delete h._hoverTimer,h.handle("onHover",e,D)},J.getHoverDelay()||G.hoverDelay)),K!==t){if(K&&K.s("onEnter")&&K.s("onEnter")(e,K,J),t&&t.s("onLeave")&&t.s("onLeave")(e,t,J),Q)for(c in Q)Q[c].target.onLeave&&this.handleLeave(e,c);if(T)for(c in T)T[c].target.onEnter&&T[c].target.onEnter(e,K,J,T[c].point,T[c].width,T[c].height)}else{if(Q)for(c in Q)T&&T[c]||Q[c].target.onLeave&&this.handleLeave(e,c);if(T)for(c in T)Q&&Q[c]||T[c].target.onEnter&&T[c].target.onEnter(e,K,J,T[c].point,T[c].width,T[c].height)}this.currentInfo=D},handle:function(C,r,m){var W,X=this,o=X.gv;if(X._is2d){if(m=m||o.getDataInfoAt(r,this.filter),!m)return;if(W=m.ui.interactiveInfo){var G,Q=m.data;if(Q.s(C)&&Q.s(C)(r,Q,o),"body"===m.part&&W.bodyInfo)G="body",m.hits=this.handleImage(G,o.getImage(Q),C,r,Q,m.point,W.bodyInfo);else if("icons"===m.part&&W._38o){var k=W._38o[m.name];k&&k[m.index]&&(G="icons|"+m.name+"|"+m.index,m.hits=this.handleImage(G,m.icon,C,r,Q,m.point,k[m.index]))}}return m}if(!m){if(m=o.getDataInfoAt(r),!m)return;m&&(m={data:m.data,part:m.part})}var Q=m.data,h=o.getData3dUI(Q);if(m.ui=h,W=h.interactiveInfo,!W)return m;var J=o.intersectObject(r,Q);if(J){Q.s(C)&&Q.s(C)(r,Q,o);var V,t=J.part;if("body"!==t&&(V=Q.s(t+".image")||Q.s("shape3d."+t+".image")),V||(V=Q.s("all.image")||Q.s("shape3d.image")),W=W[V])return m.part="body",m.interactiveInfo=W,m.point=J.uv.multiply({x:W.bodyInfo.rect.width,y:W.bodyInfo.rect.height}),m.image=V,m.hits=this.handleImage("body",V,C,r,Q,m.point,W.bodyInfo),m}},_handleLeaveOrMissing:function(E,Q,m){var G="leave"===E?this.currentInfo:this.downInfo;if(G){var T=G.interactiveInfo||G.ui.interactiveInfo;if(T){var $,u,K=G.data;if(this._is2d){if(u=this.gv.lp(Q),"body"===G.part&&T.bodyInfo)$="body","leave"===E?this.handleLeaveImage(m,$,this.gv.getImage(K),Q,K,u,T.bodyInfo):this.handleMissingUpImage($,this.gv.getImage(K),Q,K,u,T.bodyInfo);else if("icons"===G.part&&T._38o){var s=T._38o[G.name];s&&s[G.index]&&($="icons|"+G.name+"|"+G.index,"leave"===E?this.handleLeaveImage(m,$,G.icon,Q,K,u,s[G.index]):this.handleMissingUpImage($,G.icon,Q,K,u,s[G.index]))}}else{var j=this.gv.intersectObject(Q,K);u=j?j.uv.multiply({x:T.bodyInfo.rect.width,y:T.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===E?this.handleLeaveImage(m,"body",G.image,Q,K,u,T.bodyInfo):this.handleMissingUpImage("body",G.image,Q,K,u,T.bodyInfo)}}}},handleDownInfo:function(f,P){if(this.downInfo){var M=this.downInfo,J=M.interactiveInfo||M.ui.interactiveInfo;if(J){var q,C=M.data;if(C.s(f)&&C.s(f)(P,C,this.gv),this._is2d){var Z=this.gv.lp(P);if("body"===M.part&&J.bodyInfo)q="body",this.handleDownInfoImage(q,this.gv.getImage(C),f,P,C,Z,J.bodyInfo);else if("icons"===M.part&&J._38o){var x=J._38o[M.name];x&&x[M.index]&&(q="icons|"+M.name+"|"+M.index,this.handleDownInfoImage(q,M.icon,f,P,C,Z,x[M.index]))}}else{var w=this.gv.intersectObject(P,C);if(!w)return;Z=w.uv.multiply({x:J.bodyInfo.rect.width,y:J.bodyInfo.rect.height}),this.handleDownInfoImage("body",M.image,f,P,C,Z,J.bodyInfo)
}}}},handleImage:function(L,y,k,d,D,s,l){var H={};if(y&&(y=fg(y))){var j=this.gv,S=l.rect,u=this.convertPoint(s,l);u.inRect&&(y[k]&&y[k](d,D,j,u,S.width,S.height),H[L+"|image"]={target:y,point:u,width:S.width,height:S.height});for(var E=l.compInfos,W=y,t=E.length-1;t>=0;t--){var N=E[t],_=N.comp;u=this.convertPoint(s,N,W,_,j,D),u.inRect&&(S=N.rect,_[k]&&_[k](d,D,j,u,S.width,S.height),(y=S.image)&&y[k]&&y[k](d,D,j,u,S.width,S.height),H[L+"|"+t]={target:_,point:u,width:S.width,height:S.height},y&&(H[L+"|"+t+"|image"]={target:y,point:u,width:S.width,height:S.height}))}}return H},handleLeave:function(g,c){return this._handleLeaveOrMissing("leave",g,c)},handleMissingUp:function(D){return this._handleLeaveOrMissing("missing",D)},handleLeaveImage:function(m,N,b,W,X,d,e){if(b&&(b=fg(b))){var Q=this.gv,v=e.rect,h=this.convertPoint(d,e);m===N+"|image"&&b.onLeave&&b.onLeave(W,X,Q,h,v.width,v.height);for(var P=e.compInfos,D=b,A=P.length-1;A>=0;A--){var T=P[A],G=T.comp;h=this.convertPoint(d,T,D,G,Q,X),v=T.rect,G.onLeave&&m===N+"|"+A&&G.onLeave(W,X,Q,h,v.width,v.height),(b=v.image)&&b.onLeave&&m===N+"|"+A+"|image"&&b.onLeave(W,X,Q,h,v.width,v.height)}}},handleMissingUpImage:function(v,V,H,k,_,r){var M="onUp",A=this.downInfo.hits;if(A&&V&&(V=fg(V))){var f=r.rect,Q=this.convertPoint(_,r);!Q.inRect&&A[v+"|image"]&&V[M]&&V[M](H,k,this.gv,Q,f.width,f.height);for(var R=r.compInfos,z=V,n=R.length-1;n>=0;n--){var t=R[n],s=t.comp;Q=this.convertPoint(_,t,z,s,this.gv,k),Q.inRect||(f=t.rect,s[M]&&A[v+"|"+n]&&s[M](H,k,this.gv,Q,f.width,f.height),(V=f.image)&&V[M]&&A[v+"|"+n+"|image"]&&V[M](H,k,this.gv,Q,f.width,f.height))}}},handleDownInfoImage:function(y,r,h,D,b,n,X){var p=this.downInfo.hits;if(p&&r&&(r=fg(r))){var o=this.gv,d=X.rect,s=this.convertPoint(n,X);p[y+"|image"]&&r[h]&&r[h](D,b,o,s,d.width,d.height);for(var t=X.compInfos,F=r,L=t.length-1;L>=0;L--){var M=t[L],J=M.comp;s=this.convertPoint(n,M,F,J,o,b),d=M.rect,J[h]&&p[y+"|"+L]&&J[h](D,b,o,s,d.width,d.height),(r=d.image)&&r[h]&&p[y+"|"+L+"|image"]&&r[h](D,b,o,s,d.width,d.height)}}},convertPoint:function(y,_,p,r,v,e){var m=_.rect,A=_.matrix.applyInverse(y).sub(m),K=A.x>=0&&A.y>=0&&A.x<=m.width&&A.y<=m.height;if(!K)return A;if(r&&r.pixelPerfect){var m,Q=1;this._is2d?(Q=v.getZoom(),m=Ce(y.x,y.y,b,Q)):m=Ce(y.x,y.y);var l=!1,M=m.x,z=m.y,S=m.width,J=m.height,E=G.hitMaxArea,s=S*J*Q*Q;if(s>E){var F=Math.sqrt(E/s);Q*=F}S*=Q,J*=Q,2>S&&(S=2),2>J&&(J=2),M*=Q,z*=Q;var V=ml(S,J),n=new Xp(0,-M,-z,Q,Q);n.append(_.matrix),v._drawForChecking=!0,r.transform=n;var U=p.comps;p.comps=[r],ei(V,p,0,0,S,J,e,self),p.comps=U,delete r.transform,v._drawForChecking=!1;try{for(var i=0,Y=V.getImageData(0,0,S,J).data;i<Y.length;i+=4)if(0!==Y[i+3]){l=!0;break}V.restore()}catch(o){Pp=f,l=!1}A.inRect=l}else A.inRect=!0;return A}});var dh=qm.DefaultInteractor=function(X){gm(dh,this,[X])};vc("DefaultInteractor",Hb,{handle_mousedown:function(w){lb(w);var v=this,W=v.gv,r=W.getDataAt(w);!W.setFocus(w)||W._editing||W._scrolling||(sp(w)?W.handleDoubleClick(w,r):W.handleClick(w,r),!Lp()&&r&&(W.isMovable(r)||W.isInteractive(r))||!W.isPannable()||!Bb(w)||ae(w)||(v._tx=W.tx(),v._ty=W.ty(),v.startDragging(w)))},handleWindowMouseUp:function(p){var q=this,L=q.gv;L._panning&&(delete L._panning,L.onPanEnded(),q.fi({kind:"endPan",event:p})),delete q._tx,delete q._ty,q.clearDragging()},handle_mousemove:function(t){var e=this,c=e.gv;e._hoverTimer&&(_(e._hoverTimer),delete e._hoverTimer),e._hoverTimer=$(function(){e.fi({kind:"hover",event:t}),_(e._hoverTimer),delete e._hoverTimer},c.getHoverDelay()||G.hoverDelay)},handle_touchmove:function(s){this.handle_mousemove(s)},handleWindowMouseMove:function(a){var d=this,G=d.gv,_=d._lastClientPoint;d.fi({kind:G._panning?"betweenPan":"beginPan",event:a}),G._panning=1,G.setTranslate(d._tx+a.clientX-_.x,d._ty+a.clientY-_.y)},handle_mousewheel:function(g){this.gv.handleScroll(g,g.wheelDelta)},handle_DOMMouseScroll:function(r){2===r.axis&&this.gv.handleScroll(r,-r.detail)},handle_keydown:function(S){this.gv.handleKeyDown(S)}});var Vb=qm.SelectInteractor=function(p){gm(Vb,this,[p])};vc("SelectInteractor",Hb,{_42:function(){var m=this,Q=m.gv,W=Q.getZoom(),J=m.mark,u=m.div;u||(u=m.div=wk(),tb(m.getView(),u));var f={};f.x=J.x*W+Q.tx(),f.y=J.y*W+Q.ty(),f.width=J.width*W,f.height=J.height*W,pn(u,f),this.intersects()?(u.style.border="",u.style.background=Q.getRectSelectBackground()):(u.style.background="",u.style.border="1px solid "+Q.getRectSelectBorderColor())},handle_mousedown:function(P){var v=this,l=v.gv;if(v._57I=f,!(l._editing||l._scrolling||Lp())){var $=l.getDataAt(P),u=l.sm();if($)if(ae(P))u.co($)?u.rs($):u.as($);else if(u.co($)){if(sp(P)&&$ instanceof zk&&$.isClickThroughEnabled()){var Q=l.getDataAt(P,function(N){l._clickThroughChecking=!0;var p=N.getParent()===$&&l.isSelectable(N);return delete l._clickThroughChecking,p});Q&&(P.clickThrough=!0,u.ss(Q))}}else u.ss($);else ae(P)||!l.isPannable()?Bb(P)&&(ae(P)||u.cs(),l.isRectSelectable()&&(v.startDragging(P),l._77O=1)):Bb(P)&&(v._57I=Jk(P))}},handle_mouseup:function(x){var r=this,J=r._57I;J&&(Bj(J,Jk(x))<=1&&r.gv.sm().cs(),r._57I=f)},handleWindowMouseUp:function(v){this.clear(v)},handleWindowMouseMove:function(N){var i=this,U=i.gv;i._logicalPoint=U.lp(N),i.mark?(i.fi({kind:"betweenRectSelect",event:N}),U.isPannable()&&i.autoScroll(N),i.redraw()):i.fi({kind:"beginRectSelect",event:N}),i.mark=qp(i._lastLogicalPoint,i._logicalPoint),i.redraw()},intersects:function(){var I=this,F=I._lastLogicalPoint,y=I._logicalPoint;return F.x>y.x||F.y>y.y},clear:function(s){var p=this,A=p.gv,Q=p.mark;if(p._57I=f,p._lastLogicalPoint){if(Q){if(0!==Q.width&&0!==Q.height){var W=A.getDatasInRect(Q,p.intersects());if(!W.isEmpty()){var T=A.sm(),G=T.toSelection();W.each(function(J){T.co(J)?G.remove(J):G.add(J)}),T.ss(G)}}vk(p.div),delete p.div,delete p.mark,p.redraw(),p.fi({kind:"endRectSelect",event:s}),A.onRectSelectEnded()}p.clearDragging(),delete A._77O}},redraw:function(){var E=this;E._draw||(E._draw=1,$(function(){E.mark&&E._42(),delete E._draw},16))}});var Sr=qm.MoveInteractor=function(z){gm(Sr,this,[z])};vc("MoveInteractor",Hb,{handle_mousedown:function(L){var z=this,V=z.gv;if(Bb(L)&&!V._editing&&!V._scrolling&&!Lp()){var p=V.getSelectedDataAt(L);p?(z._data=p,V.handleMouseDown&&V.handleMouseDown(L,p),z.startDragging(L),V.isMovable(p)&&(V._moving=1)):V._focusData=f}},handleWindowMouseUp:function(O){var s=this,$=s.gv;$.handleMouseUp&&$.handleMouseUp(O,s._data),s.clear(O)},handleWindowMouseMove:function(h){var j=this,o=j._data,v=j.gv;if((!v._93O||!v._93O(h,o))&&v._moving){j._logicalPoint||j.fi({kind:"prepareMove",event:h});var s=j._logicalPoint?"betweenMove":"beginMove",B={kind:s,event:h},m=j._logicalPoint=v.lp(h);"beginMove"!==s||j._alreadyBeginTransaction||(j._alreadyBeginTransaction=!0,v.getDataModel().beginTransaction());var _=j._calcShift(s,h),z=_.x,w=_.y,n=j.gv.getMoveMode(h,o);n&&("x"===n?w=0:"y"===n?z=0:"xy"!==n&&(z=w=0)),v.moveSelection(z,w),j._lastLogicalPoint=m,j.autoScroll(h),j.fi(B)}},_calcShift:function(){var W=this,$=W._logicalPoint,S=W._lastLogicalPoint,a=$.x-S.x,K=$.y-S.y;return{x:a,y:K}},clear:function(E){var U=this,Z=U.gv;U._lastLogicalPoint&&(U._lastLogicalPoint=U._data=Z._moving=f,U._logicalPoint&&(U.fi({kind:"endMove",event:E}),Z.onMoveEnded()),U.clearDragging()),U._alreadyBeginTransaction&&(U._alreadyBeginTransaction=!1,Z.getDataModel().endTransaction())}});var ni=qm.ScrollBarInteractor=function(t){gm(ni,this,[t])};vc("ScrollBarInteractor",Hb,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(q){var j=this.gv.getViewRect();return this._41o()&&(j.x+j.width-this.gv.lp(q).x)*this.gv.getZoom()<Yq},isH:function(_){var V=this.gv.getViewRect();return this._40o()&&(V.y+V.height-this.gv.lp(_).y)*this.gv.getZoom()<Yq},handle_mousemove:function(V){this.handle_touchmove(V)},handle_touchmove:function(f){if(!Ab&&Bb(f)&&this.gv.isScrollBarVisible()){var X=this,k=X.isV(f),Z=X.isH(f);(k||Z)&&X.gv.showScrollBar(),X.gv._scrolling=k||Z}},handleWindowMouseUp:function(J){this.handleWindowTouchEnd(J)},handleWindowTouchEnd:function(U){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=f,this.fi({kind:"endScroll",event:U})},handle_mousedown:function(t){this.handle_touchstart(t)},handle_touchstart:function(l){var G=this;if(G.gv.setFocus(l),lb(l),G.handle_touchmove(l),!(Fq(l)>1)&&G.gv._scrolling&&G.gv.isScrollBarVisible()){G._cp=Jk(l),G._tx=G.gv.tx(),G._ty=G.gv.ty();var B=G.isV(l);G._state=B?"vScroll":"hScroll",Zo(G,l),G.fi({kind:"beginScroll",event:l})}},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(g){var j=Jk(g),k=this.gv.getViewRect(),Z=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-j.y)*Z.height/k.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-j.x)*Z.width/k.width),this.fi({kind:"betweenScroll",event:g})}});var Yf=qm.TouchInteractor=function(t,$){$=$||{},$.selectable===b&&($.selectable=!0),$.movable===b&&($.movable=!0),$.pannable===b&&($.pannable=!0),$.pinchable===b&&($.pinchable=!0),$.editable===b&&($.editable=!0),this.params=$,gm(Yf,this,[t])};vc("TouchInteractor",Hb,{ms_edit:1,setUp:function(){var G=this;Yf.superClass.setUp.call(G),Tf&&G.params.editable&&G.gv.setEditInteractor(G)},tearDown:function(){var V=this;Yf.superClass.tearDown.call(V),Tf&&V.params.editable&&V.gv.setEditInteractor(f)},clear:function(I){var Z=this,D=Z.gv;D._moving&&(Z.fi({kind:"endMove",event:I}),delete D._moving,D.onMoveEnded(),D.dm().endTransaction()),D._panning&&(Z.fi({kind:"endPan",event:I}),delete D._panning,D.onPanEnded()),D._pinching&&(Z.fi({kind:"endPinch",event:I}),delete D._pinching,D.onPinchEnded()),D._editing&&(Z._46O(I),Z._77I=Z._node=Z._edge=Z._shape=Z._rect=Z._89I=Z._index=D._editing=f),Z._moving=Z._panning=Z._pinching=Z._editing=Z._57I=Z._data=Z._beginHistory=f,Z.clearDragging()},handle_touchstart:function(Y){var Z=this;if(!Z.gv._editing){lb(Y),Z._57I=f;var A=Z.params,z=Z.gv,c=z.sm(),N=z.getDataAt(Y),M=Fq(Y);if(1===M){if(sp(Y))return z.handleDoubleClick(Y,N),void 0;z.handleClick(Y,N),N&&(z.handleMouseDown&&z.handleMouseDown(Y,N),Z._data=N),A.selectable||(N=f),N?(c.co(N)||c.ss(N),A.editable&&z.isEditable(N)&&Z._79I(Y,N,!0)?(Z._editing=1,Z.startDragging(Y)):A.movable&&z.isMovable(N)&&(Z._moving=1,Z.startDragging(Y))):(Z._57I=Jk(Y),A.pannable&&z.isPannable()&&(Z._panning=1,Z.startDragging(Y),Z._translate={x:z.tx(),y:z.ty()}))}else if(A.pinchable&&2===M){Z._pinching=1,Z.startDragging(Y);var j=z.getView(),p=z.getZoom(),b=j.getBoundingClientRect(),i=Y.touches[0],V=Y.touches[1],P={x:(i.clientX+V.clientX)/2-b.left,y:(i.clientY+V.clientY)/2-b.top};P.x-=z.tx(),P.y-=z.ty(),P.x/=p,P.y/=p,Z._p=P,Z._d=ul(Y)}}},handle_touchend:function(H){var I=this,m=I.gv,_=I._57I,F=I._data;_&&(Bj(_,Jk(H))<=1&&m.sm().cs(),I._57I=f),F&&m.handleMouseUp&&m.handleMouseUp(H,F)},handleWindowTouchEnd:function(d){this.clear(d)},handleWindowTouchMove:function(i){var T=this,W=T.gv,n=Fq(i);if(1===n){if(T._editing&&(T._beginHistory||(T._beginHistory=1,W.dm().beginTransaction()),W._editing=1,T._78I(i)),T._moving)T._beginHistory||(T._beginHistory=1,W.dm().beginTransaction()),T.handleMove(i);else if(T._panning){var w=Jk(i);W.setTranslate(T._translate.x+w.x-T._lastClientPoint.x,T._translate.y+w.y-T._lastClientPoint.y),T.fi({kind:W._panning?"betweenPan":"beginPan",event:i}),W._panning=1}}else if(2===n&&T._pinching){var Y=ul(i);W.handlePinch(T._p,Y,T._d),T._d=Y,T.fi({kind:W._pinching?"betweenPinch":"beginPinch",event:i}),W._pinching=1}},handleMove:function(v){var c=this,i=c.gv,_=i.lp(v);i._93O&&i._93O(v,c._data)||(i.moveSelection(_.x-c._lastLogicalPoint.x,_.y-c._lastLogicalPoint.y),c._lastLogicalPoint=_,c.autoScroll(v),c.fi({kind:i._moving?"betweenMove":"beginMove",event:v}),i._moving=1)}});var K=N.ht,Vl=K.graph._editor={Math:K.Math,Guide:{}};Vl.getStyle=function(j){var $,S=Vl.StyleMap;return S&&($=S[j],$!==b)?$:Vl.DefaultStyleMap[j]},Vl.setStyle=function(J,C){var t=Vl.StyleMap;t||(t=Vl.StyleMap={}),t[J]=C},Vl.inEdit=function(Z){return Z._inXEdit===!0},Vl.startEdit=function(J){J._inXEdit=!0,Vl.Inject.doInject(J)},Vl._46O=function(z){z._inXEdit=!1,Vl.Inject.undoInject(z)},Vl.toScreenPosition=function(H,Y){var M=H.tx(),m=H.ty(),e=H._zoom;return new Vl.Math.Vector2(Y.x*e+M,Y.y*e+m)},Vl.checkHit=function(h,v,E){return h.distanceTo(v)<E?!0:!1},Vl.toWorldPosition=function(e,V){var x=e.tx(),p=e.ty(),W=e._zoom;return{x:(V.x-x)/W,y:(V.y-p)/W}},Vl.setAntialias=function(q,U){for(var w,v=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],x=0,c=v.length;c>x&&(w=v[x],!(w in q));x++);q[w],q[w]=U},Vl.getTargetCornersOnScreen=function(i,C){if(!C)return null;var l,t=[];if(Tb(C,i)){var H=cq(i,C);l=[{x:H.x,y:H.y},{x:H.x+H.width,y:H.y},{x:H.x+H.width,y:H.y+H.height},{x:H.x,y:H.y+H.height}]}else{if(!C.getCorners)return null;l=C.getCorners()}return l.forEach(function(T){var R=Vl.toScreenPosition(i,T);t.push(R.x,R.y)}),t},Vl.log=function(){};var Kn=Vl.Inject={_modules:[]};Kn.registAsModule=function(f,M){var Q={},U={};for(var H in f){var c=M.prototype[H];Q[H]=c}f.getBackup=function(M){return Q[M]},f.getBackups=function(){return Q},U.doInject=function(){for(var p in f)"getBackup"!==p&&(M.prototype[p]=f[p])},U.undoInject=function(){for(var F in f)"getBackup"!==F&&(M.prototype[F]=Q[F])},Kn._modules.push(U)},Kn.doInject=function(b){for(var w,o=Kn._modules,l=0,G=o.length;G>l;l++)w=o[l],w.doInject(b)},Kn.undoInject=function(V){for(var N,B=Kn._modules,d=0,S=B.length;S>d;d++)N=B[d],N.undoInject(V)};var Hb=K.graph.EditInteractor=function(Y){var K=this,o=l.createElement("canvas");o.className="editCanvas",o.style.position="absolute",K._styleMap={},K._canvas=o,K._context=o.getContext("2d"),Hb.superClass.constructor.call(K,Y),Vl.setAntialias(K._context,!1),K._subModules=[new Vl.Anchor(K),new Vl.Rect(K),new Vl.Curve(K),new Vl.MoveHelper(K)],K._gridGuide=new Vl.Guide.Grid(K),K._rectGuide=new Vl.Guide.Rect(K)},ws=Hb;K.Default.def(Hb,K.graph.Interactor,{ms_edit:1,ms_fire:1}),p.defineProperties(Hb.prototype,{editDetail:{get:function(){var $=!!this._editDetail;return $},set:function(R){var i=this,P=i._editDetail;P!==R&&(i._editDetail=R,i.gv._editing=R,i.fp("editDetail",P,R),i.fp("pointsEditingMode",P,R),i.fi({kind:R?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(D){(!this._editDetail||D)&&(this.gv._editing=D,D||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(y){this._editing=y,this.gvEditing=y}},pointsEditingMode:{get:function(){return this.editDetail},set:function(f){var $=this;$.editDetail!==f&&(f?$._tryEnterEditDetailMode():$._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var A=this._gridEnabled;if(!A)return!1;var V=this.gv;return V?!0:!0},set:function(U){U!==this._gridEnabled&&(this._gridEnabled=U,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function($){$!==this._agEnabled&&(this._agEnabled=$,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Hb.prototype.getSubModule=function(U){var Z,t,K,D=this._subModules;for(t=0,K=D.length;K>t;t++)if(Z=D[t],Z.catalog===U)return Z},Hb.prototype.invokeSubModule=function(H,E){var $=this,Y=$._subModules;if(Y)for(var D,C,V,A=Array.prototype.slice.call(arguments,2),a=0,i=Y.length;i>a;a++)if(D=Y[a],C=D[H],C&&(V=C.apply(D,A),V!=b&&E))return D},Hb.prototype.invokeSubModuleInverse=function(r,c){var y=this,C=y._subModules;if(C)for(var R,U,l,I=Array.prototype.slice.call(arguments,2),i=C.length-1;i>=0;i--)if(R=C[i],U=R[r],U&&(l=U.apply(R,I),l!=b&&c))return R},Hb.prototype.setUp=function(){Vl.log("setUp");var B=this,O=B.gv,f=O.getView(),x=B._canvas;Hb.superClass.setUp.call(B),O.setEditInteractor(B),O._79O?f.insertBefore(x,O._79O):f.appendChild(x),Vl.startEdit(O),B.invokeSubModule("setUp"),O.dm().mm(B._onDataModelChanged,B),O.dm().md(B._onDataPropertyChanged,B)},Hb.prototype.tearDown=function(){Vl.log("tearDown");var x=this,z=x.gv,G=z.getView();x._resetCustomCursorStyle(),Hb.superClass.tearDown.call(x),z.dm().umm(x._onDataModelChanged,x),z.dm().umd(x._onDataPropertyChanged,x),z.setEditInteractor(null),G.removeChild(x._canvas),x._drawTimer&&(_(x._drawTimer),x._drawTimer=null),Vl._46O(z),x.invokeSubModule("tearDown")},Hb.prototype._onDataModelChanged=function(C){var g=this;("clear"===C.kind||"remove"===C.kind&&g.editDetail&&C.data===g.getSubModule("Curve").target)&&(g.editDetail=!1,g._42())},Hb.prototype._onDataPropertyChanged=function(L){var $=this;if($.editDetail){var e=$.getSubModule("Curve"),d=L.data;d===e.target&&(d._writing||e._handleDataChanged())}},Hb.prototype.clear=function(){Vl.log("clear")},Hb.prototype.redraw=function(){this._42()},Hb.prototype._42=function(){var o=this;o._drawTimer||(o._drawTimer=$(function(){o._drawTimer=null,o.drawImpl()},0))},Hb.prototype.drawImpl=function(){var R;for(R in{_42:!0})break;return function(){var Z=this,j=Z._canvas,O=Z.gv,M=O.getWidth(),e=O.getHeight(),D=Z._context,U=K.Default.getInternal();(j.width!==M||j.height!==e)&&U.setCanvas(j,M,e),D.clearRect(0,0,j.width,j.height);var f=Z._getValidSelection();D.save();var g=K.Default.devicePixelRatio;D.scale(g,g),Z._gridGuide._42(),Z.invokeSubModuleInverse(R,!1,D,O,f),Z._rectGuide._42(),D.restore()}}(),Hb.prototype._getValidSelection=function(){var P=this,y=P.gv,e=y.sm().getSelection(),U=[];return e.each(function(R){y.isVisible(R)&&y.isEditable(R)&&U.push(R)}),U},Hb.prototype.handle_touchmove=function(P){return this.handle_mousemove(P)},Hb.prototype.handle_mousemove=function(R){if(!K.Default.isDragging()){var E=this;(E.editDetail||!Lp())&&(E.gvEditing=!1,E._checkEdit(R)&&(E.gvEditing=!0))}},Hb.prototype.handle_touchstart=function(s){return this.handle_mousedown(s)},Hb.prototype.handle_mousedown=function(Y){lb(Y);var t=this;if(t.editDetail||!Lp()){if(sp(Y)&&!Y.clickThrough){if(t.editDetail){if(t._tryQuitEditDetailMode(Y))return}else if(t._tryEnterEditDetailMode())return;t.gv.dm().beginTransaction();var n=t.invokeSubModule("handleDoubleClick",!0,Y);if(t.gv.dm().endTransaction(),n)return}var p=t._checkEdit(Y);p&&(t._downPosition=t._getLogicalPoint(Y),t.gv.dm().beginTransaction(),p.startEdit(t,Y),t.editing=!0)}},Hb.prototype._checkEdit=function(P){var G=this,c=G.gv,J=G._getLogicalPoint(P),a=G.invokeSubModule("check",!0,c,P,J)||null;return G._editMod=a,a},Hb.prototype.handleWindowTouchMove=function(t){return this.handleWindowMouseMove(t)},Hb.prototype.handleWindowMouseMove=function(i){var d=this,U=d._downPosition;if(U){var C=d._getLogicalPoint(i);if(C.distanceTo(U)<d.getStyle("moveSensitivity"))return;delete d._downPosition}var I=d._editMod;I&&I.handleEdit(d.gv,i)},Hb.prototype._getLogicalPoint=function(H){var d=this,o=K.Default.getLogicalPoint(H,d._canvas);return new Vl.Math.Vector2(o)},Hb.prototype.handleWindowTouchEnd=function(w){return this.handleWindowMouseUp(w)},Hb.prototype.handleWindowMouseUp=function(){var H;for(H in{_46O:!0})break;return function(D){var S=this;S.editing=!1,S.setCursor("default"),S.invokeSubModule(H,!1,D),S._42(),S.gv.dm().endTransaction()}}(),Hb.prototype.handle_mousewheel=function(C){var F=this;lb(C),F.invokeSubModule("preHandleScroll",!0)||F.gv.handleScroll(C,C.wheelDelta)},Hb.prototype.handleDelete=function(){var i=this;if(!i.editDetail){i.gv.dm().beginTransaction();var W=i.invokeSubModule("handleNormalStateDelete",!0);return i.gv.dm().endTransaction(),W||i.gv.removeSelection(),void 0}i.gv.dm().beginTransaction(),i.invokeSubModule("handleDelete",!0),i.gv.dm().endTransaction(),i._42()},Hb.prototype.handle_keydown=function(z){var L=this;if((z.metaKey||z.ctrlKey)&&L._42(),Lp(z)&&!L.editing)return L.gvEditing=!1,L.setCursor("default"),L._42(),void 0;var m=kf(z);return L.editDetail?((m||Xf(z))&&(L.editDetail=!1,L._42()),L.gv.dm().beginTransaction(),L.invokeSubModule("handle_keydown",!0,z),L.gv.dm().endTransaction(),void 0):(L.gv.dm().beginTransaction(),L.invokeSubModule("handleNormalStateKeyDown",!0,z),L.gv.dm().endTransaction(),m&&L._tryEnterEditDetailMode(),void 0)},Hb.prototype.handle_keyup=function(U){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,U),this.gv.dm().endTransaction()},Hb.prototype._tryEnterEditDetailMode=function(){var R=this;return!R.editDetail&&R.invokeSubModule("canEnterEditDetailMode",!0)&&1===R._getValidSelection().length?(R.editDetail=!0,R._42(),!0):void 0},Hb.prototype._tryQuitEditDetailMode=function(u){var y=this;if(y.editDetail){var X=y.gv,g=y.getSubModule("Curve").target;return u&&X.getDataAt(u)===g?void 0:(y.editDetail=!1,y._42(),!0)}},Hb.prototype.setStyle=function(W,J,M){var U=this;M?Vl.setStyle(W,J):U._styleMap[W]=J,U.fp("styleChanged",null,{key:W,value:J,base:M}),U._42()},Hb.prototype.getStyle=function(S){var g=this,K=g._styleMap[S];return K!==b?K:Vl.getStyle(S)},Hb.prototype.setCursor=function(q){this._resetCustomCursorStyle(),K.graph.EditInteractor.superClass.setCursor.call(this,q)},Hb.prototype._resetCustomCursorStyle=function(){var B=this;if(B._customStyle){var V=this.gv.getView();V.classList&&V.classList.remove&&V.classList.remove(B._customStyle),B._customStyle=null}},Hb.prototype._setRotateCursor=function(s){var r=this,k=r._cursorFactory;k||(k=r._cursorFactory=new Vl.CursorFactory(r));var n=k.getRotateCursor(s),W=r.gv.getView();r._resetCustomCursorStyle(),r._customStyle=n,W.classList&&W.classList.add&&W.classList.add(n)};var Lm=Vl.Group=function(E){var P=this;P._entities=E,P._64O=0,P._position={x:0,y:0},P._scale={x:1,y:1},P._anchor={x:.5,y:.5},P._anchor2={x:.5,y:.5}};Lm.prototype={},Lm.prototype.constructor=Lm;var ah=null;Lm.findOrCreateGroup=function(N){if(ah&&ah.checkIsMe(N))return ah;var e=new Vl.Group(N);return e.getKeyOb()?(ah=e,e):void 0},Lm.prototype.checkIsMe=function(i){var k=this._entities;if(k.length!==i.length)return!1;var P,L={},A=i.length;for(P=0;A>P;P++)L[i[P]._id]=!0;for(P=0;A>P;P++)if(!L[k[P]._id])return!1;return!0},Lm.prototype.getRotation=function(){return this._64O},Lm.prototype.getPosition=function(){return this._position},Lm.prototype.getAnchor=function(){return this._anchor},Lm.prototype.getWidth=function(){return this._width},Lm.prototype.getScale=function(){return this._scale},Lm.prototype.getSize=function(){return{width:this._width,height:this._height}},Lm.prototype.getHeight=function(){return this._height},Lm.prototype.getKeyOb=function(){for(var v=this._entities,O=v.length-1;O>=0;O--){var h=v[O];if(this.isNode(h))return h}},Lm.prototype.getAnchor2=function(){var A=this,B=A.rotateCenter;if(B)return B;var M=A.getKeyOb();if(!M)return A._anchor;var V=A._anchor2,q=M.getMatrix();return q.tf({x:M.getWidth()*(V.x-M.getAnchor().x),y:M.getHeight()*(V.y-M.getAnchor().y)})},Lm.prototype.setAnchor2=function(c,g){var i=this,u=i.getKeyOb();if(u){var q,b=u.getMatrix();q="number"==typeof c?{x:c,y:g}:c;var t=b.tfi(q);i._anchor2={x:u.getAnchor().x+t.x/u.getWidth(),y:u.getAnchor().y+t.y/u.getHeight()}}},Lm.prototype.setRotation=function(){},Lm.prototype.beginRotate=function(u){this.rotateCenter=u.pos,this.rotateMode=u.groupRotateMode},Lm.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Lm.prototype.addRotation=function(G,$){return"batch"===$?this._addRotationInBatchMode(G):"block"===$?this._addRotationInBlockMode(G):void 0},Lm.prototype._addRotationInBlockMode=function(J){var g=this,y=g.rotateCenter||g.getPosition();g._entities.forEach(function(k){if(g.isNode(k)){var e=k.getMatrix();e.translate(-y.x,-y.y),e.rotate(J),e.translate(y.x,y.y);var Y=Math.sign(k.getScale().x);k.setRotation(I(e.b*Y,e.a*Y)),k.setPosition(e.tx,e.ty)}})},Lm.prototype._addRotationInBatchMode=function(R){var X=this,z=X._anchor2;X._entities.forEach(function(T){if(X.isNode(T)){var Q=T.getAnchor(),W=T.getMatrix(),B=W.tf({x:T.getWidth()*(z.x-Q.x),y:T.getHeight()*(z.y-Q.y)}),i=new Vl.Math.Matrix2d;i.set(W.a,W.b,W.c,W.d,W.tx,W.ty),i.translate(-B.x,-B.y),i.rotate(R),i.translate(B.x,B.y);var E=Math.sign(T.getScale().x);T.setRotation(I(i.b*E,i.a*E)),T.setPosition(i.tx,i.ty)}})},Lm.prototype.setPosition=function(p){var t,W,b,j,g=this,D=g._position,w=p.x-D.x,m=p.y-D.y,h=g._entities;for(W=0,b=h.length;b>W;W++)t=h[W],ps(t)&&(j=t.getPosition(),t.setPosition(j.x+w,j.y+m));g._position=p},Lm.prototype.setScale=function(T,C){var a=this,q=T/a._scale.x,v=C/a._scale.y;a._adjustChildScaleOrSize(q,v,"size"),a._scale={x:T,y:C}},Lm.prototype.getRect=function(){var p=this,o=p._position,M=p._width,J=p._height;return{x:o.x-M/2,y:o.y-J/2,width:M,height:J}},Lm.prototype.setSize=function(e,P){var N=this,e=Math.max(1,e),P=Math.max(1,P),A=e/N._width,f=P/N._height;N._adjustChildScaleOrSize(A,f,"size"),N._width=e,N._height=P},Lm.prototype._adjustChildScaleOrSize=function(C,L,d){var D,Q,M,q,O,w,f,z,x,V,v,W,N,A,h=this,l=h._position,b=h._entities,y=new Vl.Math.Matrix2d;for(Q=0,M=b.length;M>Q;Q++)if(D=b[Q],h.isNode(D)){if(q=D.getPosition(),O=D.getRotation(),w=D.getWidth(),f=D.getHeight(),z=D.getScale(),v=z.x*w,W=z.y*f,y.identity().scale(v,W).rotate(O).translate(q.x,q.y).translate(-l.x,-l.y).rotate(-h._64O),O=I(y.b*Math.sign(v),y.a*Math.sign(v)),y.scale(C,L),x=Math.cos(O),V=Math.sin(O),Math.abs(x)<.001?(N=y.b/V,A=-y.c/V):(N=y.a/x,A=y.d/x),"scale"===d)D.setScale(N/w,A/f);else if("size"===d){var t=N/z.x,r=A/z.y;D.setScale(Sc(N)*Math.abs(z.x),Sc(A)*Math.abs(z.y)),D.setSize(Math.max(.1,Math.abs(t)),Math.max(.1,Math.abs(r)))}y.rotate(h._64O).translate(l.x,l.y),D.setPosition(y.tx,y.ty)}},Lm.prototype.getMatrix=function(){var d=this,$=d._position,R=K.Default.getInternal(),b=d._scale;return new R.Mat(d._64O,$.x,$.y,b.x,b.y)},Lm.prototype.getCorners=function(){var N=this,j=N._width,Q=N._height,K=N._anchor,m=-j*K.x,E=-Q*K.y,f=N.getMatrix();return[f.tf(m,E),f.tf(m,E+Q),f.tf(m+j,E+Q),f.tf(m+j,E)]},Lm.prototype.calcInfo=function(){var q,P,J,Y,N,F,x=this,R=[],c=x._entities,A=x._64O;for(Y=0,N=c.length;N>Y;Y++)F=c[Y],x.isNode(F)&&F.getCorners&&R.push.apply(R,F.getCorners());if(R.length){var n=Math.cos(-A),G=Math.sin(-A),Q=1/0,T=-1/0,U=1/0,r=-1/0;for(Y=0,N=R.length;N>Y;Y++)J=R[Y],q=J.x,P=J.y,J.x=n*q-G*P,J.y=G*q+n*P,Q=Math.min(Q,J.x),T=Math.max(T,J.x),U=Math.min(U,J.y),r=Math.max(r,J.y);x._width=(T-Q)/x._scale.x,x._height=(r-U)/x._scale.y,n=Math.cos(A),G=Math.sin(A);var u=x._anchor;q=Q+(T-Q)*u.x,P=U+(r-U)*u.y,x._position={x:n*q-G*P,y:G*q+n*P}}},Lm.prototype.isNode=function(B){return ps(B)?Tb(B)?!1:!0:!1},Lm.prototype._42=function(a,V,F){var G,j,B,R,p,d,r,c,N=this,$=N._entities,x=N.rotateMode;for("batch"===x&&(c=N.getKeyOb()),G=0,j=$.length;j>G;G++)B=$[G],N.isNode(B)&&(d=B.getRect(),R=Vl.toScreenPosition(F,{x:d.x,y:d.y}),p=Vl.toScreenPosition(F,{x:d.x+d.width,y:d.y+d.height}),r={min:R,max:p},B===c&&(r.isKeyOb=!0),Vl.Icons.DrawIcon(a,V,Vl.Icons.GroupSubEntityRect,r))};var Mf=Vl.CurveActiving=function(f,j){this._curve=f,this._interactor=f._interactor;for(var d in j)this[d]=j[d]};Mf.prototype={},Mf.prototype.constructor=Mf,p.defineProperties(Mf.prototype,{point:{get:function(){return this._point},set:function(D){var L=this;L._point=D,L.editingCtrl||L._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(T){var f=this;f._pairs=T,f.editingCtrl&&f._firePointChange()}}}),Mf.prototype._firePointChange=function(){var P=this,O=P.getCurrentEditingPoint();if(!O)return S.fi({kind:"selectPoint"}),void 0;var S=P._interactor,T=this._curve.target;if(T){var e=Vl.getDataMatrix(T).invert(),_=O.e;O=e.apply(Vl.toWorldPosition(S.gv,O)),O.e=_;var C=P._lastFirePoint;C&&Math.abs(O.x-C.x)<1e-5&&Math.abs(O.y-C.y)<1e-5&&(O.e==b&&C.e==b||Math.abs(O.e-C.e)<1e-5)||(P._lastFirePoint=O,S.fi({kind:"selectPoint",x:O.x,y:O.y,e:O.e}))}},Mf.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Mf.prototype.getCurrentEditingPoint=function(){var i=this,a=i.editingCtrl;if(a){var Q=i.pairs;if(Q){var V=Q[a.pairId],K=V[a.type];if(K)return K}}return i._point};var Gg=Vl.CursorFactory=function(A){var x=this;x._interactor=A,x._rotateCursorStyles={}};Gg.prototype={},Gg.prototype.constructor=Gg,Gg.prototype.getRotateCursor=function(p){var k=this;0>p&&(p+=2*Math.PI);var e=k._interactor,O=e.getStyle("rotateCursorSize"),T=e.getStyle("rotateCursorRound"),H=Math.round(180*(p/Math.PI)/T);H*T>=360&&(H=0);var i=k._rotateCursorStyles,t="htCustomRotateStyle_"+O+"_"+T+"_"+H;return i[t]||(k._produceRotateCursor(t,O,T,H),i[t]=!0),t},Gg.prototype._produceRotateCursor=function(q,V,k,J){var u=this;u._interactor;var v=u._canvas;v||(v=u._canvas=l.createElement("canvas")),v.width=v.height=V*devicePixelRatio,v.style.width=v.style.height=V+" px";var o=v.getContext("2d");Vl.setAntialias(o,!1),o.scale(devicePixelRatio,devicePixelRatio);var d,x,Q,X,U,O=Math.round(V/2),H=""+O+" "+O+",auto !important;";d=Math.PI/180*J*k,o.clearRect(0,0,V,V),o.save(),o.scale(V/32,V/32),o.translate(16,16),o.rotate(d+Math.PI/2),o.beginPath(),o.moveTo(-8,0),o.lineTo(-8,3),o.lineTo(-5,3),o.moveTo(8,0),o.lineTo(8,3),o.lineTo(5,3),o.moveTo(-8,3),o.quadraticCurveTo(0,-6,8,3),o.restore(),o.strokeStyle="white",o.lineWidth=4,o.stroke(),o.strokeStyle="black",o.lineWidth=2,o.stroke(),x=JSON.stringify(v.toDataURL()),X="cursor:url("+x+")"+H,1!==devicePixelRatio&&(Q='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+V+'px" height="'+V+'px"><image xlink:href='+x+' width="'+V+'" height="'+V+'"/></svg>',X+="cursor:url(data:image/svg+xml;base64,"+btoa(Q)+")"+H,X+="cursor:-webkit-image-set(url("+x+")"+devicePixelRatio+"x,url("+x+")1x)"+H),U=l.createElement("style"),U.textContent="body."+q+" *, ."+q+"{"+X+"}",l.head.appendChild(U)};var _q=Vl.Guide.Grid=function(h){var z=this;z._interactor=h,z._alignmentGuideId=0,z._xAlignmentGuide=[],z._yAlignmentGuide=[]};_q.prototype={},_q.prototype.constructor=_q,p.defineProperties(_q.prototype,{gridBlockSize:{get:function(){var V=this;return V._gridBlockSize||V._interactor.getStyle("gridBlockSize")},set:function(W){this._gridBlockSize=W,this._interactor._42()}},gridThickLinesEvery:{get:function(){var H=this;return H._gridThickLinesEvery||H._interactor.getStyle("gridThickLinesEvery")},set:function(J){this._gridThickLinesEvery=J,this._interactor._42()}},gridEnabled:{get:function(){var L=this,d=L._interactor;return d.gridEnabled&&L.isValidGrid()}}}),_q.prototype._42=function(){var t=this,C=t._interactor;t.gridEnabled&&t.drawGrid(),C.alignmentGuideEnabled&&t.drawAlignmentGuide()},_q.prototype.makeMatrix=function(){var Z=this,f=Z._interactor.getStyle("gridAngle"),x=Z._interactor.getStyle("gridRotation"),G=new Vl.Math.Matrix2d,I=Math.sin(f),r=Math.cos(f);return G.set(1,0,r,I,0,0),G.rotate(x),G},_q.prototype.isValidGrid=function(){var l=this,k=Math.PI,z=l._interactor,T=z.gv;if(T._zoom<z.getStyle("gridZoomThreshold"))return!1;var t=z.getStyle("gridAngle"),Z=Math.abs(180*(t%k/k)),U=1-1e-8;return U>Z||Z>180-U?!1:!0},_q.prototype.drawAlignmentGuide=function(){var E=this,Z=E._interactor,k=Z.gv,G=Z._canvas,W=Z._context,F=G.width,d=G.height,l=k.tx(),D=k.ty(),J=k._zoom;W.beginPath(),W.strokeStyle=Z.getStyle("gridAlignmentGuideColor"),W.lineWidth=1,E._xAlignmentGuide.forEach(function(b){var Q=b.p*J+l;W.moveTo(Q,0),W.lineTo(Q,d)}),E._yAlignmentGuide.forEach(function(s){var C=s.p*J+D;W.moveTo(0,C),W.lineTo(F,C)}),W.stroke()},_q.prototype.drawGrid=function(){function k(m,C,T,s){var k=Vl.toScreenPosition(w,u.apply({x:m,y:C})),B=Vl.toScreenPosition(w,u.apply({x:T,y:s}));y.moveTo(k.x,k.y),y.lineTo(B.x,B.y)}var z=this,$=z._interactor,l=z.gridBlockSize,v=z.gridThickLinesEvery,K=$.getStyle("gridThickColor"),i=$.getStyle("gridLightColor"),w=$.gv,g=$._canvas,y=$._context,N=g.width,Q=g.height,u=z.makeMatrix(),f=u.applyInverse(Vl.toWorldPosition(w,{x:0,y:0})),O=u.applyInverse(Vl.toWorldPosition(w,{x:N,y:0})),d=u.applyInverse(Vl.toWorldPosition(w,{x:0,y:Q})),n=u.applyInverse(Vl.toWorldPosition(w,{x:N,y:Q})),A=Math.min(f.x,O.x,d.x,n.x),X=Math.max(f.x,O.x,d.x,n.x),F=Math.min(f.y,O.y,d.y,n.y),o=Math.max(f.y,O.y,d.y,n.y);N=X-A,Q=o-F;var T=Math.ceil(A/l),r=Math.floor(X/l),U=Math.ceil(F/l),h=Math.floor(o/l);w.tx(),w.ty(),w._zoom;
var I,M,P;for(y.save(),y.lineWidth=1,y.beginPath(),y.strokeStyle=K,P=Math.ceil(T/v)*v;r>=P;P+=v)I=P*l,k(I,F,I,o);for(P=Math.ceil(U/v)*v;h>=P;P+=v)M=P*l,k(A,M,X,M);for(y.stroke(),y.beginPath(),y.strokeStyle=i,P=T;r>=P;P++)0!==P%v&&(I=P*l,k(I,F,I,o));for(P=U;h>=P;P++)0!==P%v&&(M=P*l,k(A,M,X,M));y.stroke(),y.restore()},_q.prototype.getAlignmentGuides=function(){var d=this;return{x:d._xAlignmentGuide,y:d._yAlignmentGuide}},_q.prototype.addAlignmentGuide=function(k,O,Y){var M=this,g="x"===k?M._xAlignmentGuide:M._yAlignmentGuide,Y=Y?Y:++M._alignmentGuideId,$={p:O,id:Y};if(g.length){var T=M._findClosestAlignmentGuide($.p,g);T.dis<0?g.splice(T.index+1,0,$):g.splice(T.index,0,$)}else g.push($);return M._interactor._42(),Y},_q.prototype.findClosest=function(H,W,y){var Y=this,b=Y._interactor,_=b.gv;y&&(H=Vl.toWorldPosition(_,H));var r,f,Z,m=1/0,i=1/0,j=H.x,p=H.y;if(Y.gridEnabled){var a=Y.gridBlockSize,d=Y.makeMatrix(),I=d.applyInverse(H);I=d.apply({x:Math.round(I.x/a)*a,y:Math.round(I.y/a)*a}),m=I.x-j,i=I.y-p,Z=!0}if(b.alignmentGuideEnabled&&(r=Y._findClosestAlignmentGuide(j,Y._xAlignmentGuide).dis,f=Y._findClosestAlignmentGuide(p,Y._yAlignmentGuide).dis,Math.abs(r)<Math.abs(m)&&(m=r,Z=!0),Math.abs(f)<Math.abs(i)&&(i=f,Z=!0)),Z){Z=!1;var N=_._zoom,R=b.getStyle("smartGuideSensitivity")/N,L={};if(Math.abs(m)<R&&"y"!==W&&(L.x=y?m*N:m,Z=!0),Math.abs(i)<R&&"x"!==W&&(L.y=y?i*N:i,Z=!0),Z)return L}},_q.prototype._findClosestAlignmentGuide=function(f,o){if(!o.length)return{dis:1/0};for(var W,l=0,x=o.length-1;x-l>1;)W=Math.floor((l+x)/2),o[W].p<f?l=W:x=W;var z=o[l].p-f,Q=o[x].p-f;return Math.abs(z)<=Math.abs(Q)?{line:o[l],dis:z,index:l}:{line:o[x],dis:Q,index:x}},_q.prototype.removeAllAlignmentGuide=function(w){var A=this;"y"!==w&&(A._xAlignmentGuide=[]),"x"!==w&&(A._yAlignmentGuide=[]),A._interactor._42()},_q.prototype.removeAlignmentGuide=function(v){for(var k,h,u,B=this,U=B._xAlignmentGuide,Y=0;2>Y;Y++)for(U=0===Y?B._xAlignmentGuide:B._yAlignmentGuide,k=0,h=U.length;h>k;k++)if(u=U[k],u.id===v)return U.splice(k,1),B._interactor._42(),{axis:0===Y?"x":"y",position:u.p};return!1},_q.prototype.adjustAlignmentGuide=function(U,l){var y=this,n=y.removeAlignmentGuide(U);return n?(y.addAlignmentGuide(n.axis,l,U),!0):!1};var pi=Vl.Guide.Rect=function(v){var S=this;S._interactor=v};pi.prototype={},pi.prototype.constructor=pi,pi.prototype.gatherRects=function(){var n,B,H,F,u=this,y=u._interactor.gv,d=[],V=[],r={x:d,y:V},E={},s=y.getDataModel(),z=s.a("width"),o=s.a("height");z&&o&&(n=0,B=0,H=z,F=o,d.push({node:s,type:0,p:n},{node:s,type:1,p:n+H/2},{node:s,type:2,p:n+H}),V.push({node:s,type:0,p:B},{node:s,type:1,p:B+F/2},{node:s,type:2,p:B+F}),E[s._id||0]={x:n,y:B,width:H,height:F}),s.each(function(e){if(ps(e)&&!y.isSelected(e)&&y.isVisible(e)){var Y=!1;if(y.sm().getSelection().each(function(T){Y||(e.isHostOn(T)?Y=!0:e.isDescendantOf(T)&&(Y=!0))}),!Y){var u=e.getRect();n=u.x,B=u.y,H=u.width,F=u.height,d.push({node:e,type:0,p:n},{node:e,type:1,p:n+H/2},{node:e,type:2,p:n+H}),V.push({node:e,type:0,p:B},{node:e,type:1,p:B+F/2},{node:e,type:2,p:B+F}),E[e._id]=u}}}),d.sort(function(W,D){return W.p-D.p}),V.sort(function(Z,i){return Z.p-i.p}),u._grid=r,u._87I=E},pi.prototype.gatherLines=function(i,U,C){var y,g,d,E,P,N,_,R,Q,q,J,r,j=this,A=[j.findClosest({x:i.x,y:i.y},U),j.findClosest({x:i.x+i.w/2,y:i.y+i.h/2},U),j.findClosest({x:i.x+i.w,y:i.y+i.h},U)],B={},G=j._87I;C=C||255;var a,v;for(j._guideLine=[],y=0;2>y;y++)for(B={},0===y?(E="y",R=i.x,Q=R+i.w):(E="x",R=i.y,Q=R+i.h),g=0;3>g;g++)P=A[g],P&&isFinite(P[E])&&(a=1<<3*y+g,C&a&&(N=P[E+"Line"],_=N.node,v=_._id||0,B[v]||(B[v]=!0,r=G[v],"y"===E?(q=r.x,J=r.x+r.width):(q=r.y,J=r.y+r.height),d=N.p,j._guideLine.push({type:E,a:R,b:Q,c:q,d:J,p:d,center:1===N.type}))))},pi.prototype._binarySearchClosest=function(l,H){if(!H.length)return{dis:1/0};for(var W,Y=0,c=H.length-1;c-Y>1;)W=Math.floor((Y+c)/2),H[W].p<l?Y=W:c=W;var Q=H[Y].p-l,k=H[c].p-l;return Math.abs(Q)<=Math.abs(k)?{line:H[Y],dis:Q}:{line:H[c],dis:k}},pi.prototype.findClosest=function(E,X,M){var p=this,J=p._interactor,u=J.gv,A=p._grid;M&&(E=Vl.toWorldPosition(u,E));var C,Y=p._binarySearchClosest(E.x,A.x),N=p._binarySearchClosest(E.y,A.y),g=Y.dis,S=N.dis,D=u._zoom,z=J.getStyle("smartGuideSensitivity")/D,o={};return Math.abs(g)<z&&"y"!==X&&(o.x=M?g*D:g,o.xLine=Y.line,C=!0),Math.abs(S)<z&&"x"!==X&&(o.y=M?S*D:S,o.yLine=N.line,C=!0),C?o:void 0},pi.prototype._42=function(){var U=this,b=U._guideLine;if(b&&!K.Default.isCtrlDown()){var B,A,h,y,H,S,w,k,c,v,E,D,F,l,W,Q,g,P=U._interactor,r=P.gv,s=P._context,i=r.tx(),d=r.ty(),q=r._zoom,V=P.getStyle("guideLineTextSpacing");for(B=0,A=b.length;A>B;B++)h=b[B],k=h.type,c=h.p,v=h.a,E=h.b,D=h.c,F=h.d,l=Math.min(v,D),W=Math.max(E,F),"x"===k?(y=c*q+i,H=l*q+d,S=y,w=W*q+d):(y=l*q+i,H=c*q+d,S=W*q+i,w=H),Vl.Icons.DrawIcon(P,s,Vl.Icons.MoveLineGuide,{rect:[y,H,S,w],center:h.center}),F>=v&&E>=D||(l=v>F?F:E,W=v>F?v:D,g=W-l,"x"===k?(h.center2center||(y-=V,S=y),H=l*q+d,w=W*q+d,Q=Vl.Icons.MoveLineGuideDistanceV):"y"===k&&(h.center2center||(H-=V,w=H),y=l*q+i,S=W*q+i,Q=Vl.Icons.MoveLineGuideDistanceH),Vl.Icons.DrawIcon(P,s,Q,{x0:y,y0:H,x1:S,y1:w,dis:g}))}},pi.prototype.clear=function(){this._guideLine=null},Vl.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Vm=Vl.Icons={},ll=1e4,kg=null,sl="rgb(51,153,255)",Rq="rgb(183,232,135)",Ph="rgb(255,204,153)",np=6;K.Default.setImage("Icons.RectPoint",{width:np,height:np,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:sl,rect:[0,0,np,np]}]});var Md="#e000e0";Vm.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var H=Vm.GroupSubEntityRect.data;if(!H)return[];var b=H.min,G=H.max;return[b.x,b.y,b.x,G.y,G.x,G.y,G.x,b.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Vm.GroupSubEntityRect.data.isKeyOb?Md:"#666666"}}}]},Vm.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Vm.Line.data.P1.x,Vm.Line.data.P1.y],np,np]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Vm.Line.data.P2.x,Vm.Line.data.P2.y],np,np]}}}]},Vm.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Vm.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Vm.Rect={comps:[{type:"shape",points:{func:function(){var l=Vm.Rect.data;if(!l)return[];var f=l.LT,g=l.LB,Y=l.RB,e=l.RT;return[f.x,f.y,g.x,g.y,Y.x,Y.y,e.x,e.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:sl},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vm.Rect.data.rotation}},rect:{func:function(){return[[Vm.Rect.data.LT.x,Vm.Rect.data.LT.y],np,np]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vm.Rect.data.rotation}},rect:{func:function(){return[[Vm.Rect.data.LB.x,Vm.Rect.data.LB.y],np,np]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vm.Rect.data.rotation}},rect:{func:function(){return[[Vm.Rect.data.RB.x,Vm.Rect.data.RB.y],np,np]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vm.Rect.data.rotation}},rect:{func:function(){return[[Vm.Rect.data.RT.x,Vm.Rect.data.RT.y],np,np]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vm.Rect.data.rotation}},visible:{func:function(){return Vm.Rect.data.L?!0:!1}},rect:{func:function(){return[[Vm.Rect.data.L.x,Vm.Rect.data.L.y],np,np]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vm.Rect.data.rotation}},visible:{func:function(){return Vm.Rect.data.R?!0:!1}},rect:{func:function(){return[[Vm.Rect.data.R.x,Vm.Rect.data.R.y],np,np]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vm.Rect.data.rotation}},visible:{func:function(){return Vm.Rect.data.T?!0:!1}},rect:{func:function(){return[[Vm.Rect.data.T.x,Vm.Rect.data.T.y],np,np]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Vm.Rect.data.rotation}},visible:{func:function(){return Vm.Rect.data.B?!0:!1}},rect:{func:function(){return[[Vm.Rect.data.B.x,Vm.Rect.data.B.y],np,np]}}}]};var xs=16;K.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:sl,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:sl,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Vm.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Vm.Anchor.data.POS.x,Vm.Anchor.data.POS.y],xs,xs]}}}]},Vm.TipShiftX=12,Vm.TipShiftY=12;var Lo=[8,28];Vm.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Vm.TipHelper.data.helperPos.x,Vm.TipHelper.data.helperPos.y,Lo[0]*Vm.TipHelper.data.size,Lo[1]]}},background:{func:function(){return kg.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Vm.TipHelper.data.text}},rect:{func:function(){return[Vm.TipHelper.data.helperPos.x,Vm.TipHelper.data.helperPos.y,Lo[0]*Vm.TipHelper.data.size,Lo[1]]}},color:{func:function(){return kg.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Og=7;Vm.ShapePoint={comps:[{type:"circle",rect:{func:function(){var q=Vm.ShapePoint.data;return[q,Og,Og]}},background:"#ffffff",borderWidth:1,borderColor:sl}]},Vm.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return Vm.ShapeBgCurve.data.P}},segments:{func:function(){return Vm.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:sl}]};var yj=8;Vm.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var A=Vm.ShapeHighlighPoint.data;return[[A.x,A.y],yj,yj]}},background:{func:function(){return kg.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var gg=10;Vm.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var B=Vm.ShapeHighlighRealPoint.data;return[[B.x,B.y],gg,gg]}},background:"#ffffff",borderWidth:2,borderColor:sl}]};var Fr=8;Vm.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var $=Vm.ShapeHighlighCtrlPoint.data,S=$.x,Q=$.y,T=Fr/2;return[S-T,Q-T,S-T,Q+T,S+T,Q+T,S+T,Q-T]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return kg.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return kg.getStyle("shapeCtrlPointBorderColor")||sl}}}]};var lr=3;Vm.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Vm.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:lr,borderColor:{func:function(){return kg.getStyle("curveHighlightColor")}}}]},Vm.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Vm.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Vm.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Vm.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Vm.MoveLineGuide.data.center?Rq:Ph}}}]};var Qp=5;Vm.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var X=Vm.MoveLineGuideDistanceH.data,x=X.x0,C=X.y0;return[x,C-Qp,x,C+Qp]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ph},{type:"shape",points:{func:function(){var u=Vm.MoveLineGuideDistanceH.data,I=u.x1,Q=u.y1;return[I,Q-Qp,I,Q+Qp]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ph},{type:"text",text:{func:function(){return Math.round(Vm.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var l=Vm.MoveLineGuideDistanceH.data;return[[(l.x0+l.x1)/2,l.y0-10],20,20]}},color:Ph,font:"12px Arial",align:"center"}]},Vm.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var T=Vm.MoveLineGuideDistanceV.data,V=T.x0,k=T.y0;return[V-Qp,k,V+Qp,k]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ph},{type:"shape",points:{func:function(){var x=Vm.MoveLineGuideDistanceV.data,i=x.x1,Y=x.y1;return[i-Qp,Y,i+Qp,Y]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ph},{type:"text",text:{func:function(){return Math.round(Vm.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var _=Vm.MoveLineGuideDistanceV.data;return[[_.x0-10,(_.y0+_.y1)/2],20,20]}},color:Ph,font:"12px Arial",align:"center"}]},K.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Vm.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var l=Vm.EdgeElevationGuide.data,B=l.x,e=l.y,R=kg.getStyle("curveElevationIntersectSize"),b=kg.getStyle("curveElevationGuideShift");return B+=b[0],e+=b[1],[B-R,e-R,2*R,2*R]}}}]},K.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),K.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Vm.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Vm.ConnectGuide.data.rotation}},rect:{func:function(){var U=Vm.ConnectGuide.data.connect;U.x,U.y;var n=kg.getStyle("connectGuideIntersectSize");return[[U.x,U.y],2*n,2*n]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var A=Vm.ConnectGuide.data.cursorPos||Vm.ConnectGuide.data.connect,x=kg.getStyle("connectGuideIntersectSize");return[[A.x,A.y],2*x-2,2*x-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var Y=Vm.ConnectGuide.data.connect,R=Vm.ConnectGuide.data.cursorPos||Y;return[Y.x,Y.y,Y.x+.5*(R.x-Y.x),Y.y,R.x+.5*(Y.x-R.x),R.y,R.x,R.y]}}}]},K.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),K.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Vm.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var X=Vm.ConnectGuideGarbage.data.hover;return X?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var J=Vm.ConnectGuideGarbage.data,j=kg.getStyle("connectGuideGarbageIntersectsize");return J.hover&&(j+=5),[[J.x,J.y],2*j,2*j]}}}]};var wf=6;Vm.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Vm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var Z=Vm.ShapeActivingCtrl.data;return[Z.point.x,Z.point.y,Z.c1.x,Z.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:sl},{type:"shape",visible:{func:function(){return Vm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var u=Vm.ShapeActivingCtrl.data;return[u.point.x,u.point.y,u.c2.x,u.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:sl},{type:"shape",visible:{func:function(){return Vm.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var b=Vm.ShapeActivingCtrl.data.c1,K=b.x,f=b.y,c=wf/2;return"c1"===Vm.ShapeActivingCtrl.data.hl&&(c+=.5),[K-c,f-c,K-c,f+c,K+c,f+c,K+c,f-c]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return kg.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Vm.ShapeActivingCtrl.data.hl?kg.getStyle("shapeCtrlPointHighlightBorder")||sl:kg.getStyle("shapeCtrlPointBorderColor")||sl}}},{type:"shape",visible:{func:function(){return Vm.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var s=Vm.ShapeActivingCtrl.data.c2,W=s.x,O=s.y,x=wf/2;return"c2"===Vm.ShapeActivingCtrl.data.hl&&(x+=.5),[W-x,O-x,W-x,O+x,W+x,O+x,W+x,O-x]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return kg.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Vm.ShapeActivingCtrl.data.hl?kg.getStyle("shapeCtrlPointHighlightBorder")||sl:kg.getStyle("shapeCtrlPointBorderColor")||sl}}}]},Vl.Icons.DrawIcon=function(G,X,a,F){a.width=a.height=ll,a.data=F,kg=G,K.Default.drawImage(X,a,0,0,ll,ll)},Vl.Icons.MapPoints=function(N,x){for(var f=0,W=N.length;W>f;f++)N[f]/=x},Vl.roundTo=function(q,z,v){var i=Math.abs(q%z);return v>i||v>z-i?z*Math.round(q/z):q},Vl.toFixed=function(c){return Math.round(100*c)/100},Vl.getDataMatrix=function(u){if(u instanceof K.Shape){var r=new K.Math.Matrix2d,R=u.getPosition();return r.translate(-R.x,-R.y).scale(u.getScale().x,u.getScale().y).rotate(u.getRotation()).translate(R.x,R.y),r}return u.getMatrix?u.getMatrix():new K.Math.Matrix2d};var Bo=Vl.Math.Curve=function(){this._curves=[]};Bo.prototype={},Bo.prototype.constructor=Bo,Bo.prototype.createFromHtShape=function(j,_,P){_ instanceof K.List&&(_=_.toArray());var o,w,f,Z,d,D,l,V=this,T=null,M=null,h=0,L=Vl.Math.Vector2,S=Vl.Math.CubicBezier,X=function(K){return new L(j[K],j[K+1],P?P[K/2]:b)};for(w=0,f=_.length;f>w;w++){switch(Z=_[w],d=null,Z){case 1:M=X(h),T=M,h+=2;break;case 2:o=X(h),h+=2,d=new S(M,M.clone(),o.clone(),o),M=o;break;case 3:D=X(h),o=X(h+2),h+=4,d=new S(M,D.clone().sub(M).multiplyScalar(2/3).add(M),D.clone().sub(o).multiplyScalar(2/3).add(o),o),M=o;break;case 4:D=X(h),l=X(h+2),o=X(h+4),h+=6,d=new S(M,D,l,o),M=o;break;case 5:if(!T)break;d=new S(M,M.clone(),T.clone(),T),M=null,T=null}d&&(d._index=V._curves.length,V._curves.push(d))}},Bo.prototype.checkPoint=function(Z,d){var w,$,o,V,R,t=this,Y=t._curves;for(w=0,$=Y.length;$>w;w++)if(V=Y[w],R=V.intersectRect(Z,d,d),R.length)return o=0,R.forEach(function(H){o+=H.t}),o/=R.length,Z=V.getPointAt(o),Z.t=o,{bezier:V,intersection:Z}},Bo.prototype.insertKnot=function(S,n){var K=S.insertKnot(n),J=this,g=J._curves;g.splice(S._index,1,K[0],K[1])},Bo.prototype._isCloseEnough=function(h,M){return Math.abs(h.x-M.x)<1e-6&&Math.abs(h.y-M.y)<1e-6},Bo.prototype._isSamePoint=function(o,V){return o===V},Bo.prototype.moveRealPoint=function(U,J){var T=this,y=T._curves,m=J.clone().sub(U);y.forEach(function(M){var Y=M._p1;M._p2,M._p3;var p=M._p4;T._isSamePoint(Y,U)&&(M._p2.add(m),M._p1=J),T._isSamePoint(p,U)&&(M._p3.add(m),M._p4=J)})},Bo.prototype.moveCtrlDueToRealPointMovement=function(S,Y){var O=this,B=O._curves,d=function(g){g.add(Y),g.e&&Y.e&&(g.e+=Y.e)};B.forEach(function(E){var A=E._p1;E._p2,E._p3;var e=E._p4;O._isSamePoint(A,S)&&d(E._p2),O._isSamePoint(e,S)&&d(E._p3)})},Bo.prototype.moveCtrlPoint=function(c,N,o){var O=c[o];if(O){O.e!==b&&(N.e=O.e);var T=this,$=T._curves;N.clone().sub(O),$.forEach(function(V){var n;"c2"===o?n="_p2":"c1"===o&&(n="_p3"),T._isSamePoint(V[n],O)&&(V[n]=N)}),c[o]=N}},Bo.prototype.deleteRealPoint=function(S,B){var u,L,k,y,x,K,o,r=this,F=r._curves,j={},H=[],X=Vl.Math.CubicBezier;for(L=0,k=F.length;k>L;L++)u=F[L],y=u._p1,x=u._p2,K=u._p3,o=u._p4,(j[L]||!r._isSamePoint(y,S))&&(r._isSamePoint(o,S)?k>L+1&&r._isSamePoint(F[L+1]._p1,S)&&(B||H.push(new X(y,x,F[L+1]._p3,F[L+1]._p4))):H.push(u));r._curves=H},Bo.prototype.findPairs=function(w,C){var N,F,n,R,f,M,E,l,Q=this,H=Q._curves,h={},b=[];for(F=0,n=H.length;n>F;F++)N=H[F],R=N._p1,f=N._p2,M=N._p3,E=N._p4,!h[F]&&Q._isSamePoint(R,w)&&(C?b.push({point:R,r2:E}):b.push({point:R,c2:f})),Q._isSamePoint(E,w)&&(l=C?{point:E,r1:R}:{point:E,c1:M},n>F+1&&Q._isSamePoint(H[F+1]._p1,w)&&(C?l.r2=H[F+1]._p4:l.c2=H[F+1]._p2,h[F+1]=!0),b.push(l));return b},Bo.prototype.toHtShape=function(){var l=this,L=l._curves,e=[],b=[],B={x:1/0,y:1/0};return L.forEach(function(w){var i=w._p1,U=w._p2,D=w._p3,K=w._p4;return l._isCloseEnough(i,B)||(e.push(1),b.push(i.clone())),B=K,l._isCloseEnough(i,U)&&l._isCloseEnough(D,K)?(e.push(2),b.push(K.clone()),void 0):(e.push(4),b.push(U.clone(),D.clone(),K.clone()),void 0)}),{segments:e,points:b}};var Hq=Vl.Math.CubicBezier=function(g,V,d,h){var i=this;i._id=Vl.Math.CubicBezier._globalId++,i._p1=g,i._p2=V,i._p3=d,i._p4=h};Hq._globalId=1,Hq.prototype={},Hq.prototype.constructor=Hq,Hq.prototype.toString=function(){return this._id},Hq.prototype.intersectRect=function(L,_,p){var I=_/2,b=p/2,s=L.x,x=L.y,P=Vl.Math.Vector2,o=new P(-I+s,-b+x),d=new P(I+s,b+x),Z=new P(d.x,o.y),G=new P(o.x,d.y),h=this,q=h.intersectLine(o,Z),a=h.intersectLine(Z,d),W=h.intersectLine(d,G),v=h.intersectLine(G,o),R=q.concat(a).concat(W).concat(v);return R},Hq.prototype.intersectLine=function($,T){var X,f,z,o,R,Q,e,I,t,S,O,x,E,a=this,W=$.clone().min(T),m=$.clone().max(T);o=a._p1,R=a._p2,Q=a._p3,e=a._p4,X=o.clone().multiplyScalar(-1),f=R.clone().multiplyScalar(3),z=Q.clone().multiplyScalar(-3),O=X.add(f).add(z).add(e),X=o.clone().multiplyScalar(3),f=R.clone().multiplyScalar(-6),z=Q.clone().multiplyScalar(3),S=X.add(f).add(z),X=o.clone().multiplyScalar(-3),f=R.clone().multiplyScalar(3),t=X.add(f),I=o.clone(),E=new Vl.Math.Vector2($.y-T.y,T.x-$.x),x=$.x*T.y-T.x*$.y;for(var G=a.getRoots(E.dot(O),E.dot(S),E.dot(t),E.dot(I)+x),q=new Array,g=0,u=G.length;u>g;g++){var i=G[g];if(!(0>i||i>1)){var N=o.clone().lerp(R,i),V=R.clone().lerp(Q,i),j=Q.clone().lerp(e,i),s=N.lerp(V,i),D=V.lerp(j,i),w=s.lerp(D,i);w.t=i,$.x==T.x?W.y<=w.y&&w.y<=m.y&&q.push(w):$.y==T.y?W.x<=w.x&&w.x<=m.x&&q.push(w):w.x>=W.x&&w.y>=W.y&&w.x<=m.x&&w.y<=m.y&&q.push(w)}}return q},Hq.prototype.solveTForPoint=function($){var P,G,A,z,n=this;P=n._p1.x-$.x,G=n._p2.x-$.x,A=n._p3.x-$.x,z=n._p4.x-$.x;for(var B=n.getRoots(z-3*A+3*G-P,3*A-6*G+3*P,3*G-3*P,P),e=b,w=1/0,i=0,J=B.length;J>i;i++){var S=B[i];if(!(0>S||S>1)){var r=n._p1.clone().lerp(n._p2,S),D=n._p2.clone().lerp(n._p3,S),C=n._p3.clone().lerp(n._p4,S),K=r.lerp(D,S),X=D.lerp(C,S),F=K.lerp(X,S);F.t=S;var d=Math.abs(F.y-$.y);w>d&&(w=d,e=F)}}return e},Hq.prototype.getPointAt=function(E){var B=this,I=B._p1,g=B._p2,p=B._p3,w=B._p4,J=I.clone().lerp(g,E),O=g.clone().lerp(p,E),M=p.clone().lerp(w,E),i=J.lerp(O,E),T=O.lerp(M,E);return i.lerp(T,E)},Hq.prototype.getRoots=function(o,z,Q,p){var v,k,U,M,t,q=new Array;if(Math.abs(o)<1e-6){var v=z,k=Q/v,U=p/v,M=k*k-4*U;if(M>0){var t=Math.sqrt(M);q.push(.5*(-k+t)),q.push(.5*(-k-t))}else 0==M&&q.push(.5*-k)}z/=o,Q/=o,p/=o,v=(3*Q-z*z)/3,k=(2*z*z*z-9*Q*z+27*p)/27;var l=z/3,i=k*k/4+v*v*v/27,h=k/2;if(Math.abs(i)<=1e-6&&(i=0),i>0){var B,W,t=Math.sqrt(i);B=-h+t,W=B>=0?Math.pow(B,1/3):-Math.pow(-B,1/3),B=-h-t,B>=0?W+=Math.pow(B,1/3):W-=Math.pow(-B,1/3),q.push(W-l)}else if(0>i){var x=Math.sqrt(-v/3),Z=Math.atan2(Math.sqrt(-i),-h)/3,r=Math.cos(Z),T=Math.sin(Z),_=Math.sqrt(3);q.push(2*x*r-l),q.push(-x*(r+_*T)-l),q.push(-x*(r-_*T)-l)}else{var B;B=h>=0?-Math.pow(h,1/3):Math.pow(-h,1/3),q.push(2*B-l),q.push(-B-l)}return q},Hq.prototype._70I=function(){var j=this;return j._p1.distanceToSquared(j._p2)<1e-10&&j._p3.distanceToSquared(j._p4)<1e-10},Hq.prototype.insertKnot=function(P){var Q=this,Y=Q._p1,X=Q._p2,O=Q._p3,L=Q._p4,e=Y.clone().lerp(X,P),l=X.clone().lerp(O,P),Z=O.clone().lerp(L,P),G=e.clone().lerp(l,P),v=l.clone().lerp(Z,P),F=G.clone().lerp(v,P);return Q._70I()?(Y.clone().lerp(L,P),[new Vl.Math.CubicBezier(Y,Y.clone(),F.clone(),F),new Vl.Math.CubicBezier(F,F.clone(),L.clone(),L)]):[new Vl.Math.CubicBezier(Y,e,G,F),new Vl.Math.CubicBezier(F,v,Z,L)]};var Ue=K.Default.getInternal().ui().EdgeUI,qq={_47O:function(q){var w=this,l=qq.getBackups()._47O;Vl.inEdit(w.gv)||l.call(w,q)}};Vl.Inject.registAsModule(qq,Ue);var qf=K.Default.getInternal().ui().NodeUI,Zm={_47O:function(K){var U=this,f=Zm.getBackups()._47O;Vl.inEdit(U.gv)||f.call(U,K)},getSelectWidth:function(){var q=this,c=q.gv,U=q._data;if(c.isEditable(U)&&Vl.inEdit(c))return 0;var f=Zm.getBackup("getSelectWidth");return f.call(q)}};Vl.Inject.registAsModule(Zm,qf);var bl=K.graph.GraphView,Uc={_editPointSize:function(){var W=K.Default.isTouchable,Y=Vl.getStyle("pointSize");return Y[W?0:1]}(),isPointEditable:function(s){var c=this;if(Vl.inEdit(c))return c._pointEditableFunc?c._pointEditableFunc(s):!0;var V=Uc.getBackup("isPointEditable");V.call(c,s)},isEditable:function(q){var V,M=this,s=Uc.getBackup("isEditable");if(V=q instanceof Vl.Group?!0:s.call(M,q),!Vl.inEdit(M))return V;if(!(q instanceof K.Edge))return V;if(!q.s("2d.editable"))return!1;var O=M.getEditableFunc();return O?O(q):!0},_42:function(D,_){var L=this,p=Uc.getBackups()._42;if(p.call(L,D,_),Vl.inEdit(L)){var x=L.getEditInteractor();x.drawImpl()}}};Vl.Inject.registAsModule(Uc,bl);var Ef=K.Default.getInternal().ui().ShapeUI,ns={_47O:function(a){var z=this,M=ns.getBackups()._47O;Vl.inEdit(z.gv)||M.call(z,a)}};Vl.Inject.registAsModule(ns,Ef);var dh=K.graph.DefaultInteractor,Vi={handle_mousewheel:function(e){var M=this,b=Vi.getBackup("handle_mousewheel");Vl.inEdit(M.gv)||b.call(M,e)}};Vl.Inject.registAsModule(Vi,dh);var Sr=K.graph.MoveInteractor,yk={_calcShift:function(l,Q){var e=this,g=yk.getBackup("_calcShift"),r=e.gv;if(!Vl.inEdit(r))return g.call(e,l,Q);var h=r.getEditInteractor(),X=h.getSubModule("Move").calcShift(l,Q,e);return X||g.call(e,l,Q)},clear:function(e){var q=this,N=yk.getBackup("clear");N.call(q,e);var G=q.gv;if(Vl.inEdit(G)){var I=G.getEditInteractor();I.getSubModule("Move").clear(e)}}};Vl.Inject.registAsModule(yk,Sr);var pi=Vl.Rect=function(F){this.catalog="Rect",this._interactor=F};pi.prototype={},pi.prototype.constructor=pi,pi.prototype.gatherInfo=function(v,O){var W=this;if(1===O.length){var r=O[0];return r instanceof K.Shape&&r._70I()?W.gatherLine(v,r):Tb(r,v)?!1:W.gatherSingleTarget(v,r)}return O.length>1?W.gatherMultiTargets(v,O):!1},pi.prototype.gatherSingleTarget=function(M,t){if(t.getCorners){var G,J=this,s=J.info;J.target=t,G=J.screenInfo={};var h=t.getCorners();s.LT=new Vl.Math.Vector2(h[0]),s.LB=new Vl.Math.Vector2(h[1]),s.RB=new Vl.Math.Vector2(h[2]),s.RT=new Vl.Math.Vector2(h[3]),s.T=s.LT.clone().add(s.RT).divideScalar(2),s.B=s.LB.clone().add(s.RB).divideScalar(2),s.L=s.LT.clone().add(s.LB).divideScalar(2),s.R=s.RT.clone().add(s.RB).divideScalar(2);for(var j in s)G[j]=Vl.toScreenPosition(M,s[j]);var r=J._interactor,m=r.getStyle("checkSize"),Y=function(g,O,p){var u=O.clone().sub(g).setLength(-m),D=p.clone().sub(g).setLength(-m),_=u.add(D).add(g);return _};return G.rotLT=Y(G.LT,G.RT,G.LB),G.rotLB=Y(G.LB,G.LT,G.RB),G.rotRB=Y(G.RB,G.LB,G.RT),G.rotRT=Y(G.RT,G.LT,G.RB),G.rotT=G.rotLT.clone().add(G.rotRT).divideScalar(2),G.rotB=G.rotLB.clone().add(G.rotRB).divideScalar(2),G.rotL=G.rotLT.clone().add(G.rotLB).divideScalar(2),G.rotR=G.rotRT.clone().add(G.rotRB).divideScalar(2),G.rotation=t.getRotation(),J.gatherConnectInfo(),!0}},pi.prototype.gatherConnectInfo=function(){var C=this,o=C.target,B=C._interactor,S=C.screenInfo,t=B.gv;if(o instanceof K.Node&&B.getStyle("connectGuideVisible")){var i=o.s("connectGuideShift")||B.getStyle("connectGuideShift"),f=o.getAnchor(),F=o.getSize(),E=o.toGlobal({x:F.width*(i[0]-f.x),y:F.height*(i[1]-f.y)});E=Vl.toScreenPosition(t,E),S.P1?E.add(S.P2.clone().sub(S.P1).setLength(i[2])):(E.add(S.RT.clone().sub(S.LT).setLength(i[2])),E.add(S.LB.clone().sub(S.LT).setLength(i[3]))),S.connect=E}},pi.prototype.gatherMultiTargets=function($,t){var K=Vl.Group.findOrCreateGroup(t);if(!K)return!1;var e=this;return e.editing&&"rotate"!==e.editing.mode||K.calcInfo(),e.gatherSingleTarget($,K)},pi.prototype.gatherLine=function(z,S){this.target=S;var p=this.screenInfo={},c=S.getPoints(),F=Vl.getDataMatrix(S);return p.P1=Vl.toScreenPosition(z,F.apply(c.get(0))),p.P2=Vl.toScreenPosition(z,F.apply(c.get(1))),this.gatherConnectInfo(),!0},pi.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],pi.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],pi.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],pi.prototype.check=function(v,r,_){if(K.Default.isLeftButton(r)){var c=this;if(c.editing=null,c.tipInfo=null,c.screenInfo){var C=c.target,N=v.isEditable(C),V=c.screenInfo;if(N&&V.connect){var h=c._checkConnect(_);if(h)return h}if(V.P1)return c._checkLine(_);var t,E,T,B=null,e=c._interactor,y=e.getStyle("checkSize");if(N&&v.isRectEditable(C))for(E=0;E<Vl.Rect.ResizeKeys.length;E++)if(T=Vl.Rect.ResizeKeys[E],Vl.checkHit(_,V[T],y)){B=T,t="resize";break}if(!B&&N&&v.isRotationEditable(C)){var u=e.getStyle("rotateCheckSize");for(E=0;E<Vl.Rect.RotateKeys.length;E++)if(T=Vl.Rect.RotateKeys[E],Vl.checkHit(_,V[T],u)){B=T,t="rotate";break}}if(!B)return e.setCursor("default"),void 0;if("rotate"===t){var n,Z=v.lp(r);if(C instanceof Vl.Group){var l=e.getStyle("groupRotateModeKey");"string"==typeof l&&(l=[l]);for(var s=!1,Y=0,o=l.length;o>Y;Y++)if(r[l[Y]]){s=!0;break}var q=e.getStyle("groupRotateModeDefault");n=s?"batch"===q?"block":"batch":q}var D="batch"===n?C.getAnchor2():C.getPosition(),k=Math.atan2(Z.y-D.y,Z.x-D.x);e._setRotateCursor(k),c.editing={mode:t,key:B,pos:D,flipY:C.getScale().y<0,rotation:C.getRotation(),hitRot:k},n&&(c.editing.groupRotateMode=n)}else{var I=Vl.Rect.ResizeKeys.indexOf(B),L=Vl.Rect.ResizeDirection[I],w=Math.cos(C.getRotation()),W=Math.sin(C.getRotation()),O=L.x*Math.sign(C.getScale().x),x=L.y*Math.sign(C.getScale().y),P=Math.atan2(-W*O-w*x,w*O-W*x),f=(Math.round(P/(Math.PI/4))+8)%8,z=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][f];
this._interactor.setCursor(z);var p=C.getWidth(),b=C.getHeight(),F=C.getAnchor();c.editing={mode:t,key:B,rect:{x:-p*F.x,y:-b*F.y,width:p,height:b},anchor:F,matrix:C.getMatrix()}}return B}}},pi.prototype._checkLine=function(L){var e=this;e.screenInfo;var j,P=e._interactor.getStyle("checkSize");if(Vl.checkHit(L,e.screenInfo.P1,P))j="P1";else{if(!Vl.checkHit(L,e.screenInfo.P2,P))return this._interactor.setCursor("default"),void 0;j="P2"}return e.editing={mode:"line",key:j},j},pi.prototype._checkConnect=function(J){var L=this,S=L.screenInfo,p=L._interactor,h=p.getStyle("connectGuideIntersectSize"),E=S.connect,m=J.x,C=E.x;if(C>m&&h>C-m&&Math.abs(E.y-J.y)<h||m>=C&&Vl.checkHit(J,E,h)){var w="connect",q=G.getConnectAction(p.gv);return L.editing={mode:w},q&&q.delete&&q.delete.visible.call(null,p.gv,L.target)&&(L.editing.hasDeleteAction=!0),p.setCursor("default"),w}},pi.prototype._fireEditEvent=function(M,p){var K=this._interactor,t=this.editing;if(t){var r=t.mode;r="rotate"===r?"Rotation":"connect"===r?"Connection":r[0].toUpperCase()+r.slice(1),K.fi({kind:M+"Edit"+r,event:p})}},pi.prototype.startEdit=function(Y,S){Y.startDragging(S);var Z=this;Z._interactor.fi({kind:"prepareEdit",event:S});var A=Z.editing,s=Z.target;if(A){if(Z._fireEditEvent("begin",S),"rotate"===A.mode)return A.groupRotateMode&&s.beginRotate(A),void 0;if("connect"!==A.mode)("line"===A.mode||s&&0===s.getRotation())&&(Z._inSmartGuide=!0,Z._interactor.rectGuide.gatherRects());else if(A.hasDeleteAction){var F=Y.gv,C=Z._interactor.getStyle("connectGuideGarbageShift");A.garbageInfo={x:F.getWidth()*C[0]+C[2],y:F.getHeight()*C[1]+C[3],size:Z._interactor.getStyle("connectGuideGarbageIntersectsize")},Y._42()}}},pi.prototype._46O=function(y){var E,S=this,f=S.editing;if(f){if("connect"===f.mode&&!f.canceled&&!f.deleted)try{f.garbageInfo&&f.garbageInfo.hover?G.doDeleteConnectionAction(S._interactor.gv,S.target):G.doConnectAction(S._interactor.gv,S.target,f.target)}catch(c){console.error(c)}E=S.editing.groupRotateMode,S._fireEditEvent("end",y),S.editing=null}S.tipInfo=null,S._inSmartGuide&&(S._interactor.rectGuide.clear(),S._inSmartGuide=!1),E&&S.target&&S.target.endRotate()},pi.prototype.handleNormalStateDelete=function(){var F=this,u=F.editing;if(u&&"connect"===u.mode&&!u.canceled&&!u.deleted){if(u.garbageInfo){try{G.doDeleteConnectionAction(F._interactor.gv,F.target)}catch(k){console.error(k)}u.garbageInfo=null}return u.cursorPos=null,u.targetCorners=null,u.deleted=!0,F._interactor._42(),!0}},pi.prototype.handleNormalStateKeyDown=function(F){var A=this,h=A.editing;return!h||"connect"!==h.mode||h.canceled||h.deleted?void 0:K.Default.isEsc(F)?(h.cursorPos=null,h.targetCorners=null,h.canceled=!0,A._interactor._42(),!0):void 0},pi.prototype.handleEdit=function(z,a){var M=this,i=M.editing;if(i){var p,x,f,R,g,n=M.target,Q=i.key,E=i.mode,I=z.lp(a),V=M._interactor;if("connect"===E){if(i.canceled)return;if(i.deleted)return;i.cursorPos=V._getLogicalPoint(a);var m=i.garbageInfo;return m&&Vl.checkHit(i.cursorPos,m,m.size)?(m.hover=!0,i.target=null,i.targetCorners=null):(m&&(m.hover=!1),i.target=z.getDataAt(I,function(h){return z.isSelectable(h)?ps(h)?!0:!1:!1})||null,i.targetCorners=Vl.getTargetCornersOnScreen(z,i.target)),V._42(),void 0}if("rotate"===E){var W,l,X=i.pos,v=Math.atan2(I.y-X.y,I.x-X.x);if(i.groupRotateMode?l=v-i.hitRot:(W=v-i.hitRot,l=i.rotation+W),l%=2*Math.PI,0>l&&(l+=2*Math.PI),!K.Default.isCtrlDown(a)){var s,d;rl(a)?(s=V.getStyle("shiftRotateRound"),d=s/2):(s=V.getStyle("rotateRound"),d=V.getStyle("rotateSensitivity")),l=Vl.roundTo(l,s,d)}i.groupRotateMode?(W=l-(i.lastRotation||0),0!==W&&(n.addRotation(W,i.groupRotateMode),i.lastRotation=l)):n.setRotation(l),V._setRotateCursor(v),l>Math.PI&&(l-=2*Math.PI);var w=180*(l/Math.PI);w=w.toFixed(2),p=""+w+""}else if("resize"===E){var q=i.rect;f=q.x,R=q.y;var P,u=q.width,N=q.height,A=i.anchor,D=i.matrix,c=rl(a),F=M._unionPointMode1,U=M._unionPointMode2;if(M._inSmartGuide&&!K.Default.isCtrlDown(a)&&!c){var y;"L"===Q||"R"===Q?y="x":("T"===Q||"B"===Q)&&(y="y"),M._adsorbedToClosest(I,y),g=!0}P=D.tfi(I);var j;"LT"===Q?(q=F(P,{x:f+u,y:R+N},u,N,c),j=9):"T"===Q?(q=U({x:f,y:P.y},{x:f+u,y:R+N},u,N,c,"v"),j=1):"RT"===Q?(q=F(P,{x:f,y:R+N},u,N,c),j=33):"L"===Q?(q=U({x:P.x,y:R},{x:f+u,y:R+N},u,N,c,"h"),j=8):"R"===Q?(q=U({x:f,y:R},{x:P.x,y:R+N},u,N,c,"h"),j=32):"LB"===Q?(q=F(P,{x:f+u,y:R},u,N,c),j=12):"B"===Q?(q=U({x:f,y:R},{x:f+u,y:P.y},u,N,c,"v"),j=4):"RB"===Q&&(q=F(P,{x:f,y:R},u,N,c),j=36);var Y=D.tf(q.x+q.width*A.x,q.y+q.height*A.y);n.setPosition(Y),n.setSize(q.width,q.height),g&&(x=n.getRect(),V.rectGuide.gatherLines({node:n,x:x.x,y:x.y,w:x.width,h:x.height},y,j)),p=""+Math.round(q.width)+" * "+Math.round(q.height)}else if("line"===E){if(rl(a)){var k=n.getPoints(),h="P1"===Q?k.get(1):k.get(0),L={x:I.x-h.x,y:I.y-h.y},B=V.getStyle("shiftLineRotateRound"),H=M._shiftDirList;if(!H||M._shiftRotateRound!==B){M._shiftRotateRound=B,M._shiftDirList=H=[];for(var $=0;$<Math.PI;$+=B)H.push({x:e($),y:t($)})}for(var S,T=0,O=0,J=H.length;J>O;O++){var C=H[O],_=C.x*L.x+C.y*L.y;Math.abs(_)>Math.abs(T)&&(T=_,S=C)}I={x:h.x+S.x*T,y:h.y+S.y*T},V.rectGuide.clear()}else M._inSmartGuide&&!K.Default.isCtrlDown(a)&&(M._adsorbedToClosest(I),g=!0);var r=Vl.getDataMatrix(n).applyInverse(I);n.setPoint("P1"===Q?0:1,r,!0);var Z=n.getPoints(),b=Z.get(0),o=Z.get(1);f=b.x-o.x,R=b.y-o.y,p=" "+Math.round(Math.sqrt(f*f+R*R))+" ",g&&(x=n.getRect(),V.rectGuide.gatherLines({node:n,x:x.x,y:x.y,w:x.width,h:x.height}))}if(p){var G=K.Default.getLogicalPoint(a,V._canvas);G.x+=Vl.Icons.TipShiftX,G.y+=Vl.Icons.TipShiftY,M.tipInfo={helperPos:G,text:p,size:p.length}}M._fireEditEvent("between",a)}},pi.prototype._unionPointMode1=function(c,b,h,H,X){if(X&&h&&H){var G=c.x-b.x,j=c.y-b.y;Math.abs(G*H)<Math.abs(j*h)?(j=Math.sign(j)*Math.abs(G*H/h),c.y=b.y+j):(G=Math.sign(G)*Math.abs(j*h/H),c.x=b.x+G)}return K.Default.unionPoint(c,b)},pi.prototype._unionPointMode2=function(V,W,t,a,S,L){var c=K.Default.unionPoint(V,W);if(S&&t&&a){var X;"v"===L?(X=c.x+c.width/2,c.width=t*c.height/a,c.x=X-c.width/2):(X=c.y+c.height/2,c.height=a*c.width/t,c.y=X-c.height/2)}return c},pi.prototype._adsorbedToClosest=function(f,l){var q=this,x=q._interactor,w=x.rectGuide.findClosest(f,l),Q=x.gridGuide.findClosest(f,l),p=1/0,Z=1/0;w&&(isFinite(w.x)&&(p=w.x),isFinite(w.y)&&(Z=w.y)),Q&&(isFinite(Q.x)&&Math.abs(Q.x)<Math.abs(p)&&(p=Q.x),isFinite(Q.y)&&Math.abs(Q.y)<Math.abs(Z)&&(Z=Q.y)),isFinite(p)&&(f.x+=p),isFinite(Z)&&(f.y+=Z)},pi.prototype._42=function(Q,H,n){var k=this;k.info={},k.screenInfo=null;var P=k._interactor;if(!P.editDetail&&k.gatherInfo(H,n)){var D=k.editing,K=D?D.groupRotateMode:null,F=k.screenInfo;"block"!==K&&(F.P1?Vl.Icons.DrawIcon(P,Q,Vl.Icons.Line,F):Vl.Icons.DrawIcon(P,Q,Vl.Icons.Rect,F),F.connect&&(Vl.Icons.DrawIcon(P,Q,Vl.Icons.ConnectGuide,{rotation:F.rotation,connect:F.connect,cursorPos:D?D.cursorPos:null}),D&&(D.targetCorners&&Vl.Icons.DrawIcon(P,Q,Vl.Icons.NodeHoverGuide,D.targetCorners),D.garbageInfo&&Vl.Icons.DrawIcon(P,Q,Vl.Icons.ConnectGuideGarbage,D.garbageInfo))),k.tipInfo&&Vl.Icons.DrawIcon(P,Q,Vl.Icons.TipHelper,k.tipInfo)),k.target instanceof Vl.Group&&k.target._42(P,Q,H)}};var Dq=Vl.Anchor=function(t){this.catalog="Anchor",this._interactor=t};Dq.prototype={},Dq.prototype.constructor=Dq,Dq.prototype.gatherInfo=function(u,S){var $=this;if(1===S.length){var s=S[0];if(!s.getAnchor)return;if(s instanceof K.Shape&&s._70I())return;if(Tb(s,u))return;return $.gatherSingleTarget(u,S[0])}return S.length>1?$.gatherMultiTargets(u,S):!1},Dq.prototype.gatherSingleTarget=function(G,w){var C=this;return C.info.POS=w.getPosition(),C.screenInfo.POS=Vl.toScreenPosition(G,C.info.POS),C.target=w,!0},Dq.prototype.gatherMultiTargets=function(i,h){var g=this,s=Vl.Group.findOrCreateGroup(h);return s?(g.screenInfo.POS=Vl.toScreenPosition(i,s.getAnchor2()),g.target=s,!0):!1},Dq.prototype.isVisible=function(){var D=this,F=D._interactor;if(F.getStyle("anchorVisible")===!1)return!1;var M=D.target;if(M){if(this.editing)return!0;var P=M.getAnchor(),l=F.getStyle("anchorOutsideVisibleThreshold");if(P.x<-l||P.x>1+l||P.y<-l||P.y>1+l)return!0;var d=M.getSize(),T=M.getScale(),L=Math.min(Math.abs(d.width*T.x),Math.abs(d.height*T.y));if(L*F.gv._zoom<F.getStyle("anchorHideThreshold"))return!1}return!0},Dq.prototype.check=function(q,F,V){if(K.Default.isLeftButton(F)){var f=this,R=f._interactor;if(f.isVisible()&&R.getStyle("anchorMovable")!==!1){f.editing=null,f.tipInfo=null;var m=f.target;if(m&&q.isAnchorEditable(m)&&q.isEditable(m)){var k;if(f.screenInfo&&(k=f.screenInfo.POS)&&Vl.checkHit(V,new Vl.Math.Vector2(k),R.getStyle("checkSize"))){if(m instanceof Vl.Group)return f.editing={},!0;var d=m.getWidth(),w=m.getHeight(),X=m.getAnchor();return f.editing={rect:{x:-d*X.x,y:-w*X.y,width:d,height:w},anchor:X,matrix:m.getMatrix()},!0}}}}},Dq.prototype.startEdit=function(m,i){m.startDragging(i),m.fi({kind:"beginEditAnchor",event:i})},Dq.prototype._46O=function(M){var W=this;W.editing&&(W.editing=null,W._interactor.fi({kind:"endEditAnchor",event:M})),W.tipInfo=null},Dq.prototype.handleEdit=function(B,n){var L=this,r=L.target;if(r){var d=L.editing;if(d){var m=B.lp(n),C=L._interactor;if(r instanceof Vl.Group)return r.setAnchor2(m),C._42(),void 0;var D=d.matrix,q=D.tfi(m),k=d.rect,c=(q.x-k.x)/k.width,l=(q.y-k.y)/k.height;if(!K.Default.isCtrlDown(n)){var z=C.getStyle("anchorRound"),Q=C.getStyle("anchorSensitivity");c=Vl.roundTo(c,z,Q),l=Vl.roundTo(l,z,Q)}r.setAnchor(c,l,!0);var j=K.Default.getLogicalPoint(n,C._canvas);j.x+=Vl.Icons.TipShiftX,j.y+=Vl.Icons.TipShiftY;var o=""+c.toFixed(2)+", "+l.toFixed(2);L.tipInfo={helperPos:j,text:o,size:o.length},C.fi({kind:"betweenEditAnchor",event:n})}}},Dq.prototype._42=function(Q,g,z){var t=this;t.info={},t.screenInfo={};var N=t._interactor;N.editDetail||t.gatherInfo(g,z)&&t.isVisible()&&(Vl.Icons.DrawIcon(N,Q,Vl.Icons.Anchor,t.screenInfo),t.tipInfo&&Vl.Icons.DrawIcon(N,Q,Vl.Icons.TipHelper,t.tipInfo))};var Bo=Vl.Curve=function(V){this.catalog="Curve",this._interactor=V};Bo.prototype={},Bo.prototype.constructor=Bo,p.defineProperties(Bo.prototype,{activing:{get:function(){return this._activing},set:function(C){var G=this;if(C)G._activing=new Vl.CurveActiving(this,C);else{var U=G._activing;U&&U.dispose(),G._activing=null}}}}),Bo.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Bo.prototype.setUp=function(){var O=this,K=O._interactor;K&&K.gv.mp(O._onGraphviewPropertyChanged,O)},Bo.prototype._onGraphviewPropertyChanged=function(S){("zoom"===S.property||"translateX"===S.property||"translateY"===S.property)&&this._handleDataChanged()},Bo.prototype.tearDown=function(){var p=this,w=p._interactor;w&&w.gv.ump(p._onGraphviewPropertyChanged,p)},Bo.prototype.canEnterEditDetailMode=function(){var y=this,g=y._interactor,N=g._getValidSelection();if(1===N.length){var t=N[0],u=t instanceof K.Edge;if(t instanceof K.Shape||u){if(u){var p=t.s("edge.type");if(p&&"points"!==p)return}var x=g.gv;if(x.isPointEditable(t)&&x.isEditable(t))return y.target=t,!0}}},Bo.prototype.preHandleScroll=function(){var $=this.editing;return $&&$.inEdit?!0:void 0},Bo.prototype.getCurrentSelectintStatus=function(){var s=this;if(s.activing&&!s.activing.selections){if(s.activing.status!=b)return s.activing.status;var U=function(U){var X=s.activing.status;s.activing.status=U,s._interactor.fp("shapePointStatus",X,U)},u=Vl.Curve.PointType,z=s.activing.point,G=s.activing.pairs;if(!G||1!==G.length)return U(u.Mirrored);var X=G[0],Z=X.c1&&X.c1.isNearEnough(z),d=X.c2&&X.c2.isNearEnough(z);if(!X.c1||!X.c2)return Z||d?U(u.Straight):U(u.Disconnected);if(Z&&d)return U(u.Straight);if(Z||d)return U(u.Asymmetric);var v=X.c1.clone().sub(z),F=X.c2.clone().sub(z);return Math.abs(v.x*F.y-v.y*F.x)>1e-5||v.x*F.x>0?U(u.Disconnected):Math.abs(v.length()-F.length())>1e-5?U(u.Asymmetric):U(u.Mirrored)}},Bo.prototype.handle_keydown=function(m){var _=this;if(_._interactor.editDetail){var P=Vl.Curve.PointType;"1"===m.key?_._setCurrentSelectionStatus(P.Straight):"2"===m.key?_._setCurrentSelectionStatus(P.Mirrored):"3"===m.key?_._setCurrentSelectionStatus(P.Disconnected):"4"===m.key&&_._setCurrentSelectionStatus(P.Asymmetric)}},Bo.prototype.setCurrentSelectionStatus=function(O){var k=this,y=k._interactor;if(y){var h=y.gv;h.dm().beginTransaction(),this._setCurrentSelectionStatus(O),h.dm().endTransaction()}},Bo.prototype._setCurrentSelectionStatus=function(B){var h=this,v=h.activing;if(v){var z=h.getCurrentSelectintStatus();if(null!==z&&z!==B){v.status=B;var J=h.activing.point,_=h.activing.pairs;if(_&&1===_.length){var x=_[0],C=h.screenInfo.curve,o=Vl.Curve.PointType,e=function(){h._writeToHt(),h._interactor.fp("shapePointStatus",z,B)};if(B===o.Straight)return C.moveCtrlPoint(x,J,"c1"),C.moveCtrlPoint(x,J,"c2"),e(),void 0;if(z===o.Straight){var S=C.findPairs(J,!0),a=S[0],j=a.r1||J,$=a.r2||J,W=$.clone().sub(j).multiplyScalar(.25);return C.moveCtrlPoint(x,J.clone().sub(W),"c1"),C.moveCtrlPoint(x,J.clone().add(W),"c2"),e(),void 0}var y=x.c1,s=x.c2;if(y&&s){if(B===o.Mirrored)return C.moveCtrlPoint(x,J.clone().multiplyScalar(2).sub(s),"c1"),e(),void 0;if(B===o.Asymmetric&&z===o.Disconnected){var N=y.clone().sub(J).length(),W=J.clone().sub(s).setLength(N).add(J);return C.moveCtrlPoint(x,W,"c1"),e(),void 0}}v._firePointChange(),h._interactor.fp("shapePointStatus",z,B)}}}},Bo.prototype._handleDataChanged=function(n){var u=this;if(u.screenInfo&&u.target){var x=u._interactor;u.gatherSingleTarget(x.gv,u.target,!0),u.check(x.gv,null,n?x._getLogicalPoint(n):new Vl.Math.Vector2(x._lastClientPoint)),x._42()}},Bo.prototype.gatherSingleTarget=function(n,X,t){var B,M,d=this;d.screenInfo&&d.screenInfo.curve&&(M=d.screenInfo.curve._curves);var E=d.editing;B=E?d.screenInfo:d.screenInfo={};var N,c,W=X instanceof K.Edge;W?(N=X.s("edge.segments"),c=X.s("edge.points")||new K.List):(N=X._58O,c=X._59O),B.S=N;var s,k=B.P=[],I=Vl.getDataMatrix(X);if(X instanceof K.Polyline&&(s=X.getElevation()||0,B.E=[]),c.each(function(T){B.E&&B.E.push(T.e||s),T=I.apply(T);var z=Vl.toScreenPosition(n,T);k.push(z.x,z.y)}),W){var P=Vl.toScreenPosition(n,X._lastSourcePoint),O=Vl.toScreenPosition(n,X._lastTargetPoint);k.splice(0,0,P.x,P.y),k.push(O.x,O.y)}if(!B.S||!B.S.size()){B.S=new K.List,B.S.add(1);for(var g=0;g<k.length/2-1;g++)B.S.add(2)}if((!E||t)&&d.convertToCubicBezier(M),d.activing&&(t||!d.editing||"realPoint"===d.editing.type)){var F=B.curve.findPairs(d.activing.point);d.activing.pairs=F}W&&"points"!==X.s("edge.type")&&d._writeToHt()},Bo.prototype._convertToNewPoint=function(h,m,E){var A,Z,Y;for(A=0,Z=m.length;Z>A;A++){if(Y=m[A],Y._p1.isNearEnough(h))return Y._p1;if(Y._p4.isNearEnough(h))return Y._p4}if(E)for(A=0,Z=Math.min(E.length,Z);Z>A;A++){if(Y=E[A],Y._p1===h)return m[A]._p1;if(Y._p4===h)return m[A]._p4}},Bo.prototype.convertToCubicBezier=function(R){var M,P,c=this,N=new Vl.Math.Curve,F=c.screenInfo;if(N.createFromHtShape(F.P,F.S,F.E),F.curve=N,c.activing){var t=N._curves;if(M=c.activing.point,P=c._convertToNewPoint(M,t,R),P&&(c.activing.point=P),c.activing.selections){var m=-1,X=c.activing.selections;X.forEach(function(M){m++,P=c._convertToNewPoint(M,t,R),P&&(X[m]=P)})}}},Bo.prototype.check=function(m,b,f){if(!b||K.Default.isLeftButton(b)){var V=this;if(V._interactor.setCursor("default"),V.editing=null,V.highlight=null,V.tipInfo=null,V.screenInfo){if(Lp())return V._interactor._42(),!0;if(V._checkEditCtrlPoint(f))return V._interactor._42(),!0;if(V._checkEditRealPoint(f))return V._interactor._42(),!0;if(V._checkEditElevation(f))return V._interactor._42(),!0;var U=V.screenInfo.curve,B=U.checkPoint(f,V._interactor.getStyle("curveIntersectSize"));if(B){var x=V.highlight={};x.type="insertKnot",x.bezier=B.bezier,x.point=B.intersection}return V._interactor._42(),!0}}},Bo.prototype._checkEditRealPoint=function(X){var n,G,Y,m,x,l,B=this,E=B.screenInfo.curve._curves,J=B._interactor.getStyle("curvePointIntersectSize"),t=1/0;for(J*=J,Y=0,m=E.length;m>Y;Y++)n=E[Y],x=n._p1,l=X.distanceToSquared(x),t>l&&(t=l,G=x),x=n._p4,l=X.distanceToSquared(x),t>l&&(t=l,G=x);if(t>J)return!1;var M=B.highlight={};return M.type="changeRealPoint",M.point=G,B.editing={type:"realPoint",point:G,shiftGuide:{point:G.clone(),dir:"x",limit:0}},B._interactor.setCursor("crosshair"),!0},Bo.prototype._checkEditElevation=function(F){var q=this;if(!q._interactor.getStyle("curveElevationVisible"))return!1;var b=q.activing;if(!b)return!1;var _=b.getCurrentEditingPoint();if(!_)return!1;var Z=q._interactor,l=Z.getStyle("curveElevationGuideShift"),o=Z.getStyle("curveElevationIntersectSize"),s=F.distanceToSquared({x:_.x+l[0],y:_.y+l[1]});if(!(s>o*o)){var k=q.highlight={};k.type="elevation";var i=new Vl.Math.Vector2(F.x,F.y,_.e);return q.editing={type:"elevation",startPoint:i},q._interactor.setCursor("crosshair"),!0}},Bo.prototype._checkEditCtrlPoint=function(_){var s=this;if(s.activing&&!s.activing.selections){var K=s.getCurrentSelectintStatus();if(K!==Vl.Curve.PointType.Straight){var h=s.activing.pairs;if(h){var d=s._interactor.getStyle("curvePointIntersectSize");d*=d;var i,N,l,z,b,J,y,I,v,G=1/0;for(y=0,v=h.length;v>y;y++)for(z=h[y],I=0;2>I;I++)b=0===I?"c1":"c2",z[b]&&(J=_.distanceToSquared(z[b]),G>J&&(G=J,i=z,N=y,l=b));if(G>d)return!1;s.activing.hlpair=i,s.activing.hltype=l;var L=s.highlight={};return L.type="changeCtrlPoint",L.point=i[l],s.editing={type:"ctrlPoint",pair:i,pairId:N,ctrlType:l,direction:i[l].clone().sub(s.activing.point).normalize()},s._interactor.setCursor("crosshair"),!0}}}},Bo.prototype.startEdit=function(M,R){M.startDragging(R);var l=this;l.highlight&&"insertKnot"===l.highlight.type&&(l.insertKnot(),l.gatherSingleTarget(l._interactor.gv,l.target),l.activing=null,l._checkEditRealPoint(l._interactor._getLogicalPoint(R)));var E=l._activing;if(E){var e=l.editing?l.editing.type:null;"ctrlPoint"===e?E.editingCtrl={pairId:l.editing.pairId,type:E.hltype}:"realPoint"===e&&(E.editingCtrl=!1)}var A=l.highlight,b=K.Default.isCtrlDown(R);if(!A||Lp()){var J=l._interactor.gv;if(!J.setFocus(R)||J._scrolling)return;return J.isPannable()&&Bb(R)&&!b&&(l._pan={tx:J.tx(),ty:J.ty()},M.fi({kind:"beginPan",event:R})),void 0}if("changeRealPoint"===A.type){var t,v=l.activing?l.activing.point:null,k=l.activing?l.activing.selections:null;if(b&&l.activing)v===A.point?(k?(l.activing={point:k[0]},k.length>1&&(k.splice(0,1),l.activing.selections=k)):l.activing=null,l.editing=null):k&&(t=k.indexOf(A.point))>=0?(k.length>1?k.splice(t,1):delete l.activing.selections,l.editing=null):k?(k.push(v),l.activing={point:A.point,selections:k}):l.activing={point:A.point,selections:[v]};else if(k)v===A.point||((t=k.indexOf(A.point))>=0?(k.splice(t,1,v),l.activing={point:A.point,selections:k}):l.activing={point:A.point});else{var w;v===A.point&&(w=l.activing.status),l.activing={point:A.point},w&&(l.activing.status=w)}M.fi({kind:"beginEditPoint",event:R})}},Bo.prototype.insertKnot=function(){var h=this,i=h.highlight,A=h.screenInfo.curve;A.insertKnot(i.bezier,i.point.t),h._writeToHt()},Bo.prototype._writeToHt=function(){var n,N,r,t,G=this,i=G.screenInfo.curve,g=i.toHtShape(),Q=g.points,p=[],q=g.segments,I=G._interactor.gv,V=G.target,X=V instanceof K.Edge,k=Vl.getDataMatrix(V).invert();t=V instanceof K.Polyline,t&&(r=V.getElevation());for(var y=0,$=Q.length;$>y;y++)n=Q[y],N=Vl.toWorldPosition(I,n),N=k.apply(N),n.e!=b&&n.e!==r&&(N.e=n.e),p.push(N);if(V._writing=!0,X){V.s("edge.type","points"),V.setStyle("edge.segments",q),V.setStyle("edge.points",p.slice(1,p.length-1)),V.setStyle("edge.source.offset.x",0),V.setStyle("edge.source.offset.y",0),V.setStyle("edge.target.offset.x",0),V.setStyle("edge.target.offset.y",0);var h=G._nextChangeEdgeHost;delete G._nextChangeEdgeHost,h&&("source"===h.type?V.setSource(h.host):V.setTarget(h.host)),G._writeEdgeHostAnchor("source",p[0]),G._writeEdgeHostAnchor("target",p[p.length-1])}else p.length?(V.setSegments(q),V.setPoints(p,!0)):V.removeFromDataModel();delete V._writing},Bo.prototype._writeEdgeHostAnchor=function(A,p){var v=this,$=v.target,R=v._calcHostAnchor($,A,p);$.s("edge."+A+".anchor.x",R.x),$.s("edge."+A+".anchor.y",R.y)},Bo.prototype._calcHostAnchor=function(h,Z,e,$){$||($="source"===Z?h.getSource():h.getTarget());var W=$.getRotation(),Y=$.getAnchor(),r=this._interactor.gv;if(Tb($,r)&&(W=0),W){var S=$.getMatrix(),n=S.tfi(e),w=$.getSize();return{x:n.x/w.width+Y.x,y:n.y/w.height+Y.y}}var b=cq(r,$),T={x:(e.x-b.x)/b.width,y:(e.y-b.y)/b.height};return T},Bo.prototype._handlePanning=function(Y){var p=this,h=p._pan;if(h){h.started=!0;var y=p._interactor,J=y.gv,F=y._lastClientPoint,t=Jk(Y);J.setTranslate(h.tx+t.x-F.x,h.ty+t.y-F.y),p.gatherSingleTarget(y.gv,p.target),y._42(),y.fi({kind:"betweenPan",event:Y})}},Bo.prototype.handleEdit=function(o,A){var t=this,H=t.editing;if(t._pan)return t._handlePanning(A),void 0;if(H){H.inEdit=!0;var e,U,X,E=t._interactor._getLogicalPoint(A),j=K.Default.isCtrlDown(A),l=K.Default.isShiftDown(A),k=H.type,p=t.activing;if(t._guideInfo=null,"ctrlPoint"===k&&l){var $=t.editing.direction.clone();e=p.point;var d=$.dot(E.clone().sub(e));E=$.setLength(d).add(e)}else if("ctrlPoint"===k||"realPoint"===k){var $;if("realPoint"===k&&l){var n=t.editing.shiftGuide;U=n.point;var V=Math.abs(E.x-U.x),S=Math.abs(E.y-U.y);V>S&&V>n.limit&&"y"===n.dir&&(n.dir="x"),S>V&&S>n.limit&&"x"===n.dir&&(n.dir="y"),$=n.dir,"x"===$?(E.y=U.y,n.limit=Math.max(n.limit,V)):"y"===$&&(E.x=U.x,n.limit=Math.max(n.limit,S))}var O=t._isEditEdgeSourceTarget();if(O){var _=t._editEdgeSourceTarget(O,E,j);_&&(X=_.tipText)}else if(!j){var s=t._guidingToEdit(E,$),M="realPoint"===k?t._interactor.gridGuide.findClosest(E,$,!0):null,Z=1/0,Q=1/0;M&&(M.x&&(Z=M.x),M.y&&(Q=M.y));var I=!1;s&&(s.xList&&(Math.abs(s.x)<=Math.abs(Z)?(I=!0,Z=s.x):delete s.xList),s.yList&&(Math.abs(s.y)<=Math.abs(Q)?(I=!0,Q=s.y):delete s.yList),I&&(t._guideInfo=s)),isFinite(Z)&&(E.x+=Z),isFinite(Q)&&(E.y+=Q),I&&(s.v=E)}}var v=t.screenInfo.curve;if("realPoint"===H.type){e=H.point,e.e!==b&&(E.e=e.e),v.moveRealPoint(e,E),H.point=E,t.highlight.point=E;var P=p.status,m=p.selections;if(t.activing={point:E,status:P},m){var h=E.clone().sub(e),c=0;m.forEach(function(K){var F=K.clone().add(h);v.moveRealPoint(K,F),m[c++]=F}),t.activing.selections=m}}else if("ctrlPoint"===H.type){var x=p.pairs,J=x[H.pairId];v.moveCtrlPoint(J,E,H.ctrlType);var T=p.status,r=Vl.Curve.PointType;if((T===r.Mirrored||T===r.Asymmetric)&&J.c1&&J.c2){var e=new Vl.Math.Vector2(p.point),g="c1"===H.ctrlType?"c2":"c1";if(T===Vl.Curve.PointType.Mirrored)v.moveCtrlPoint(J,e.clone().multiplyScalar(2).sub(E),g);else if(T===r.Asymmetric){var d=J[g].clone().sub(e).length(),C=e.clone().sub(J[H.ctrlType]).setLength(d).add(e);isNaN(C.x)||v.moveCtrlPoint(J,C,g)}}p._firePointChange()}else if("elevation"===H.type){U=H.startPoint;var i=U.e+(U.y-E.y)/o._zoom;t._setCurrentPointImpl("e",i),p._firePointChange(),X="E: "+Vl.toFixed(i)}var W=K.Default.getLogicalPoint(A,t._interactor._canvas);if(W.x+=Vl.Icons.TipShiftX,W.y+=Vl.Icons.TipShiftY,!X){var D=Vl.toWorldPosition(o,E);X=""+Vl.toFixed(D.x)+", "+Vl.toFixed(D.y)}t.tipInfo={helperPos:W,text:X,size:X.length},t._writeToHt(),t._interactor.fi({kind:"betweenEditPoint",event:A})}},Bo.prototype._setCurrentPointImpl=function(d,r){var G=this,u=G._activing;if(!u)return!1;var s=G.target;if(!s)return!1;var X=u.getCurrentEditingPoint();if(!X)return!1;var O=u.editingCtrl;if(!O)var C=X.clone();if("e"===d)X.e=r;else{var o;if("x"===d||"y"===d){var _=u._lastFirePoint;o="x"===d?{x:r,y:_?_.y:0}:{x:_?_.x:0,y:r}}else"object"==typeof d?(o=d,d.e!==b&&(X.e=d.e)):(o={x:arguments[0],y:arguments[1]},arguments[2]!==b&&(X.e=arguments[2]));var Z=Vl.getDataMatrix(s);o=Vl.toScreenPosition(G._interactor.gv,Z.apply(o)),X.x=o.x,X.y=o.y}if(!O){var U=C.multiplyScalar(-1).add(X);X.e&&C.e&&(U.e=X.e-C.e),G.screenInfo.curve.moveCtrlDueToRealPointMovement(X,U)}return!0},Bo.prototype.setCurrentPoint=function(Z,w){return this._setCurrentPointImpl(Z,w)?(this._writeToHt(),!0):!1},Bo.prototype._isEditEdgeSourceTarget=function(){var r=this,T=r.target;if(!(T instanceof K.Edge))return!1;var U=r.editing.point,A=r.screenInfo.curve._curves;return U===A[0]._p1?"source":U===A[A.length-1]._p4?"target":!1},Bo.prototype._editEdgeSourceTarget=function(A,f,d){var F,t=this,N=t.target;if(F="source"===A?N.getSource():N.getTarget()){var J=t._interactor.gv,g=Vl.toWorldPosition(J,f),H=t._calcHostAnchor(N,A,g,F);if(!d){var r=t._interactor.getStyle("anchorRound"),R=t._interactor.getStyle("anchorSensitivity");H.x=Vl.roundTo(H.x,r,R),H.y=Vl.roundTo(H.y,r,R)}if(t._interactor.getStyle("edgeHostDetectPerFrame")||H.x<0||H.x>1||H.y<0||H.y>1){var l=J.getDataAt(g,function(g){return J.isSelectable(g)?ps(g)?!0:!1:!1});if(l){var k=t._calcHostAnchor(N,A,g,l);F=l,t._nextChangeEdgeHost={type:A,host:l},H=k,d||(H.x=Vl.roundTo(H.x,r,R),H.y=Vl.roundTo(H.y,r,R))}}if(!d){var U=nr(J,F,0,0,0,H.x,H.y),o=Vl.toScreenPosition(J,U);f.x=o.x,f.y=o.y}return t._edgeHostGuideInfo=Vl.getTargetCornersOnScreen(J,F),{host:F,anchor:H,tipText:""+H.x.toFixed(2)+", "+H.y.toFixed(2)}}},Bo.prototype._guidingToEdit=function(x,C){var M,j,p=this;if(M=p.screenInfo.curve){j=M._curves;var V,z,N,b,g,c,S,$,d=1/0,t=1/0,v=[];for(p.editing&&"realPoint"===p.editing.type&&($=p.editing.point),g=0,c=2*j.length;c>g;g++)S=j[Math.floor(g/2)][g%2?"_p4":"_p1"],v.indexOf(S)>=0||(v.push(S),$&&$===S||(N=S.x-x.x,b=S.y-x.y,Math.abs(N)<Math.abs(d)?(d=N,V=[S]):N===d&&V.push(S),Math.abs(b)<Math.abs(t)?(t=b,z=[S]):b===t&&z.push(S)));var n=p._interactor.getStyle("smartGuideSensitivity");if((Math.abs(d)>n||"y"===C)&&(V=null),(Math.abs(t)>n||"x"===C)&&(z=null),V||z){var s=!1,r={};if(V&&(s=!0,r.xList=V,r.x=d),z&&(s=!0,r.yList=z,r.y=t),s)return r}}},Bo.prototype._46O=function(n){var B=this;B.editing&&(B.editing=null,B._interactor.fi({kind:"endEditPoint",event:n})),B._guideInfo=null,B._edgeHostGuideInfo=null,B._pan&&(B._pan=null,B._interactor.fi({kind:"endPan",event:n})),B.tipInfo=null},Bo.prototype._canDeletePoint=function(h,o){var C=this.target;if(!(C instanceof K.Edge))return!0;var f=h._curves[0],M=h._curves[h._curves.length-1];return f._p1===o||M._p4===o?!1:!0},Bo.prototype.handleDelete=function(){var V=this;if(V.activing&&V.screenInfo){var F=K.Default.isShiftDown(),J=V.screenInfo.curve;V._canDeletePoint(J,V.activing.point)&&J.deleteRealPoint(V.activing.point,F),V.activing.selections&&V.activing.selections.forEach(function(x){V._canDeletePoint(J,x)&&J.deleteRealPoint(x,F)}),V.activing=null,delete V.editing,delete V.tipInfo,delete V._pan,V._writeToHt(),V._interactor.fp("deleteShapePoint",!1,!0)}},Bo.prototype.handleDoubleClick=function(C){var E=this,H=E._interactor._getLogicalPoint(C);if(E.screenInfo&&E._checkEditRealPoint(H)){var T=E.getCurrentSelectintStatus(),A=Vl.Curve.PointType;return T=T===A.Mirrored?A.Straight:A.Mirrored,E._setCurrentSelectionStatus(T),E._interactor._42(),!0}},Bo.prototype._drawHighlight=function(B){var d=this,w=d.highlight;if(w){var E=w.bezier,C=d._interactor;E&&Vl.Icons.DrawIcon(C,B,Vl.Icons.ShapeHighlightCurve,[E._p1.x,E._p1.y,E._p2.x,E._p2.y,E._p3.x,E._p3.y,E._p4.x,E._p4.y]);var b=w.point;b&&"insertKnot"===w.type&&Vl.Icons.DrawIcon(C,B,Vl.Icons.ShapeHighlighPoint,b)}},Bo.prototype._drawGuide=function(h){var J=this,G=J._guideInfo;if(G){var t,v,B,I,Y=G.v;for(t=0;2>t;t++)if(I=0===t?G.xList:G.yList)for(v=0,B=I.length;B>v;v++)Vl.Icons.DrawIcon(J._interactor,h,Vl.Icons.ShapeGuideLine,[Y.x,Y.y,I[v].x,I[v].y])}},Bo.prototype._drawCurrentPoint=function(j){var l=this;if(l.activing){var K=l.activing,z=l.getCurrentSelectintStatus(),b=l._interactor;if(z!==Vl.Curve.PointType.Straight){var O=K.pairs;K.hlpair,K.hltype;var M=K.selections,x=K.editingCtrl;if(O&&!M){var W,n,A;for(n=0,A=O.length;A>n;n++)W=O[n],x&&n===x.pairId&&W[x.type]?Vl.Icons.DrawIcon(b,j,Vl.Icons.ShapeActivingCtrl,{point:W.point,c1:W.c1,c2:W.c2,hl:x.type}):Vl.Icons.DrawIcon(b,j,Vl.Icons.ShapeActivingCtrl,W)}}Vl.Icons.DrawIcon(b,j,Vl.Icons.ShapeHighlighRealPoint,l.activing.point),M&&M.forEach(function(e){Vl.Icons.DrawIcon(b,j,Vl.Icons.ShapeHighlighRealPoint,e)})}},Bo.prototype.clear=function(){var x=this;x.editing=null,x._guideInfo=null,x.activing=null,x.highlight=null},Bo.prototype._42=function(M){var I=this;I.info={},I.editing||(I.screenInfo=null);var W=I._interactor;if(!W.editDetail)return I.clear(),void 0;if(!I.target||!I._interactor.gv.isSelected(I.target)||!I._interactor.gv.isVisible(I.target))return W.editDetail=!1,I.clear(),void 0;if(I.gatherSingleTarget(W.gv,I.target),Vl.Icons.DrawIcon(W,M,Vl.Icons.ShapeBgCurve,I.screenInfo),I._drawHighlight(M),I._drawCurrentPoint(M),I._getRealPoint().forEach(function(J){Vl.Icons.DrawIcon(W,M,Vl.Icons.ShapePoint,J)}),I._drawGuide(M),I.tipInfo&&Vl.Icons.DrawIcon(W,M,Vl.Icons.TipHelper,I.tipInfo),I._edgeHostGuideInfo&&Vl.Icons.DrawIcon(W,M,Vl.Icons.NodeHoverGuide,I._edgeHostGuideInfo),I._interactor.getStyle("curveElevationVisible")&&I.target instanceof K.Polyline&&I.activing){var E=I.activing.getCurrentEditingPoint();E&&Vl.Icons.DrawIcon(W,M,Vl.Icons.EdgeElevationGuide,E)}},Bo.prototype._getRealPoint=function(){var M=this.screenInfo,w=M.P,X=M.S,_=-1,h=[];return X.each(function(Y){var d=1;if(3===Y)d=2;else if(4===Y)d=3;else if(5===Y)return;_+=d,h.push({x:w[2*_],y:w[2*_+1]})}),h};var yc=Vl.MoveHelper=function(C){var n=this;n.catalog="Move",n._interactor=C};yc.prototype={},yc.prototype.constructor=yc,yc.prototype.calcShift=function(J,f,p){var m,y,o=this,r=o._interactor.gv,F=r.lp(f);if("beginMove"===J&&o._gatherGridInfo(p._lastLogicalPoint||F),m=o._target){var O=m.downPosition;if(O){var n=o._interactor.getStyle("moveSensitivity")/r._zoom;if(O.distanceTo(F)<n)return{x:0,y:0};delete m.downPosition}var j;y=K.Default.isShiftDown(f),y&&(F=o._dealShiftDown(F),j=m.shiftGuide.dir);var x,C=m.rawPos={x:m.pos.x+F.x-m.lp.x,y:m.pos.y+F.y-m.lp.y};if(K.Default.isCtrlDown(f)){if(x=o._calcShiftByAddon(),o._target.node instanceof Vl.Group){var H=o._target.node;H._position.x+=x.x,H._position.y+=x.y}return x}for(var I,t=m.x+C.x,s=m.y+C.y,u={x:t,y:s},b={x:t+m.w/2,y:s+m.h/2},L={x:t+m.w,y:s+m.h},g=o._interactor.rectGuide,$=o._interactor.gridGuide,e=[g.findClosest(u,j),g.findClosest(b,j),g.findClosest(L,j),$.findClosest(u,j),$.findClosest(b,j),$.findClosest(L,j)],E=1/0,i=1/0,S=0,c=e.length;c>S;S++)I=e[S],I&&(t=I.x,s=I.y,isFinite(t)&&Math.abs(t)<Math.abs(E)&&(E=t),isFinite(s)&&Math.abs(s)<Math.abs(i)&&(i=s));if(isFinite(E)||(E=0),isFinite(i)||(i=0),x=o._calcShiftByAddon(E,i),o._target.node instanceof Vl.Group){var H=o._target.node;H._position.x+=x.x,H._position.y+=x.y}var q=m.node;if(!Tb(q,r)){var M=C.x+E,Q=C.y+i;o._interactor.rectGuide.gatherLines({node:q,x:m.x+M,y:m.y+Q,w:m.w,h:m.h},j)}return x}},yc.prototype._calcShiftByAddon=function(x,K){var P=this._target,z=P.rawPos,R=P.node.getPosition();return x=x||0,K=K||0,{x:z.x-R.x+x,y:z.y-R.y+K}},yc.prototype._dealShiftDown=function(s){var Z=this,Q=Z._target.shiftGuide,z=Z._target.lp,f=Math.abs(s.x-z.x),o=Math.abs(s.y-z.y);f>o&&f>Q.limit&&"y"===Q.dir&&(Q.dir="x"),o>f&&o>Q.limit&&"x"===Q.dir&&(Q.dir="y");var N=Q.dir;return"x"===N?(s.y=z.y,Q.limit=Math.max(Q.limit,f)):"y"===N&&(s.x=z.x,Q.limit=Math.max(Q.limit,o)),s},yc.prototype._gatherGridInfo=function(h){var l,F=this,X=F._interactor,v=X._getValidSelection();if(1===v.length){if(l=v[0],!l.getRect)return F._target=null,void 0}else if(l=Vl.Group.findOrCreateGroup(v),!l)return F._target=null,void 0;var g=l.getPosition(),T=l.getRect();F._target={node:l,x:T.x-g.x,y:T.y-g.y,w:T.width,h:T.height,lp:{x:h.x,y:h.y},pos:{x:g.x,y:g.y},shiftGuide:{dir:"x",limit:0},downPosition:new Vl.Math.Vector2(h)},X.rectGuide.gatherRects()},yc.prototype.clear=function(){var s=this;s._interactor.rectGuide.clear(),s._interactor._42()};var Bi="directional",Yn="point",Bd="spot",ar="light.color",ic=function(Z,Y){cr(Y)&&Fo.test(Y)?Ff(Z,Y):wg(Y)&&Y.modelType?zr(Z,Y):vf[Z]=Y},So=function(O){if(wg(O))return O;var Z=vf[O];return O&&Z===b&&Fo.test(O)&&(is&&is[O]||Ff(O,O)),Z};dd(G,{graph3dViewAttributes:f,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:L/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Jj,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:L/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:ic,getShape3dModel:So,createMatrix:function(W,p){te(W)||(W=[W]);
for(var R=W.length-1;R>=0;R--){var q=W[R];p=ak(q.mat,q.s3,q.r3,q.rotationMode,q.t3,p)}return p},transformVec:function(l,T){return wd(l,T)},createBoxModel:function(){return{vs:Xi,ns:zj,uv:Pn,is:Gc}},createRoundRectModel:function(I,e){return Xm.roundRect(I,e)},createStarModel:function(t,L){return Xm.star(t,L)},createRectModel:function(P,j){return Xm.rect(P,j)},createTriangleModel:function(z,e){return Xm.triangle(z,e)},createRightTriangleModel:function(G,$){return Xm.rightTriangle(G,$)},createParallelogramModel:function(i,j){return Xm.parallelogram(i,j)},createTrapezoidModel:function(x,L){return Xm.trapezoid(x,L)},createSmoothSphereModel:function(b,F,w,Z,d,E,M){return Mp(new md(b,F,w,Z,d,E,M))},createSphereModel:function(L,s,M,Z,x,E){return L?jk(L,s,M,Z,x,E):G.createSmoothSphereModel()},createSmoothConeModel:function(O,r,Y,$,J){return es(O,r,Y,$,J)},createConeModel:function(X,E,D,U,j,G){return X?Vo(X,E,D,U,j,G):es(G)},createSmoothCylinderModel:function(L,g,i,Z,P,F,V,y){return Mp(new Kd(L,g,i,Z,P,F,V,y))},createCylinderModel:function(I,u,c,O,$,U,n){return I?Nn(I,u,c,O,$,U,n):Pf(U,n)},createSmoothTorusModel:function(m,W,T,k,I,w){return Mp(new jj(m,W,T,k,I,w))},createTorusModel:function(t,o,B,U,F,g,Q){return t?sg(t,o,B,U,F,g,Q):Qe(g,Q)},createExtrusionModel:function(q,g,D,p,I,a,Z,k){return le(q,g,D,p,I,a,Z,k)},createSmoothRingModel:function(k,v,E,p,z,K){for(var Y=[],V=0;V<k.length-1;V+=2)Y.push({x:k[V],y:k[V+1]});for(k=Uj(Y,v,E)[0],Y=[],V=0;V<k.length;V++){var J=k[V];Y.push(new gb(J.x,0,J.y))}return Mp(new to(Y,K,p,z))},createTextGeometry:function(K,n){return Mp(new Ig(K,n))},loadFontFace:function(q,Q){G.xhrLoad(q,function(B){if(!B)return Q();var E;try{E=JSON.parse(B)}catch(i){E=JSON.parse(B.substring(65,B.length-2))}wp.loadFace(E),Q&&Q(E.familyName.toLowerCase())},Q?null:{sync:!0})},getRotationFromMatrix4:function(){var l={};return function(J,M,V){var i=Q,y=J[0],H=J[4],B=J[8],P=J[1],e=J[5],z=J[9],c=J[2],p=J[6],S=J[10];if(M=M||"xyz",M=M[2]+M[1]+M[0],M=M.toUpperCase(),"XYZ"===M)l._y=Math.asin(i(B,-1,1)),Math.abs(B)<.99999?(l._x=Math.atan2(-z,S),l._z=Math.atan2(-H,y)):(l._x=Math.atan2(p,e),l._z=0);else if("YXZ"===M)l._x=Math.asin(-i(z,-1,1)),Math.abs(z)<.99999?(l._y=Math.atan2(B,S),l._z=Math.atan2(P,e)):(l._y=Math.atan2(-c,y),l._z=0);else if("ZXY"===M)l._x=Math.asin(i(p,-1,1)),Math.abs(p)<.99999?(l._y=Math.atan2(-c,S),l._z=Math.atan2(-H,e)):(l._y=0,l._z=Math.atan2(P,y));else if("ZYX"===M)l._y=Math.asin(-i(c,-1,1)),Math.abs(c)<.99999?(l._x=Math.atan2(p,S),l._z=Math.atan2(P,y)):(l._x=0,l._z=Math.atan2(-H,e));else if("YZX"===M)l._z=Math.asin(i(P,-1,1)),Math.abs(P)<.99999?(l._x=Math.atan2(-z,e),l._y=Math.atan2(-c,y)):(l._x=0,l._y=Math.atan2(B,S));else{if("XZY"!==M)return null;l._z=Math.asin(-i(H,-1,1)),Math.abs(H)<.99999?(l._x=Math.atan2(p,e),l._y=Math.atan2(B,y)):(l._x=Math.atan2(-z,S),l._y=0)}return V?(V[0]=l._x,V[1]=l._y,V[2]=l._z,V):[l._x,l._y,l._z]}}(),createRingModel:function(L,c,w,q,Y,b,z,s,K,x){for(var P=[],S=0;S<L.length-1;S+=2)P.push({x:L[S],y:L[S+1]});b=b||G.shapeSide,z=z||0,s=s||b;var d,y,k,F,u,g,D,$,r,O,S,M,R,X,n,T,U,W,_=[],i=[],E=K?[]:f,J=K?[]:f,V=x?[]:f,C=x?[]:f,o=q?[]:f,A=q?[]:f,a=Y?[]:f,v=Y?[]:f,L=Uj(P,c,w),N=pg(L),h=0,H=2*Math.PI/b;return L.forEach(function(c){if(k=c.length,k>1){if(F=c[0],q)for(g=F.x,$=F.y,S=z;s>S;S++)M=S+1,R=S*H,X=M*H,n=t(R),T=e(R),U=t(X),W=e(X),o.push(n*g,$,-T*g,U*g,$,-W*g,0,$,0),A.push(.5-.5*n,.5-.5*T,.5-.5*U,.5-.5*W,.5,.5);for(O=0;k>O;O++){for(u=c[O],g=F.x,D=u.x,$=F.y,r=u.y,d=h/N,h+=Bj(F,u),y=h/N,S=z;s>S;S++)M=S+1,R=S*H,X=M*H,n=t(R),T=e(R),U=t(X),W=e(X),_.push(n*D,r,-T*D,U*D,r,-W*D,n*g,$,-T*g,U*D,r,-W*D,U*g,$,-W*g,n*g,$,-T*g),i.push(S/b,y,M/b,y,S/b,d,M/b,y,M/b,d,S/b,d),K&&S===z&&(E.push(0,$,0,0,r,0,n*D,r,-T*D,n*D,r,-T*D,n*g,$,-T*g,0,$,0),J.push(0,.5-$,0,.5-r,2*D,.5-r,2*D,.5-r,2*g,.5-$,0,.5-$)),x&&M===s&&(V.push(0,$,0,U*D,r,-W*D,0,r,0,U*D,r,-W*D,0,$,0,U*g,$,-W*g),C.push(1,.5-$,1-2*D,.5-r,1,.5-r,1-2*D,.5-r,1,.5-$,1-2*g,.5-$));F=u}if(Y)for(g=F.x,$=F.y,S=z;s>S;S++)M=S+1,R=S*H,X=M*H,n=t(R),T=e(R),U=t(X),W=e(X),a.push(U*g,$,-W*g,n*g,$,-T*g,0,$,0),v.push(.5-.5*U,.5+.5*W,.5-.5*n,.5+.5*T,.5,.5)}}),{vs:_,uv:i,bottom_vs:a,bottom_uv:v,top_vs:o,top_uv:A,from_vs:E,from_uv:J,to_vs:V,to_uv:C}}},!0),dd(H,{"3d.move.mode":b,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":b,"edge.gradient.color":b,"edge.source.t3":b,"edge.target.t3":b,"light.type":Yn,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":L/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":$j,"wf.short":!1,"wf.mat":b,"wf.geometry":!1,batch:b,"transparent.mask":!1,brightness:b,"select.brightness":.7,"repeat.uv.length":b,alphaTest:.4,"label.face":Wf,"label.t3":b,"label.r3":b,"label.texture.scale":2,"label.rotationMode":ug,"label.light":!1,"label.blend":b,"label.reverse.flip":!1,"label.reverse.color":Pj,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Wf,"label2.t3":b,"label2.r3":b,"label2.texture.scale":2,"label2.rotationMode":ug,"label2.light":!1,"label2.blend":b,"label2.reverse.flip":!1,"label2.reverse.color":Pj,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Wf,"note.t3":b,"note.r3":b,"note.texture.scale":2,"note.rotationMode":ug,"note.light":!1,"note.blend":b,"note.reverse.flip":!1,"note.reverse.color":Pj,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Wf,"note2.t3":b,"note2.r3":b,"note2.texture.scale":2,"note2.rotationMode":ug,"note2.light":!1,"note2.blend":b,"note2.reverse.flip":!1,"note2.reverse.color":Pj,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:b,"shape3d.color":Ko,"shape3d.top.color":b,"shape3d.bottom.color":b,"shape3d.from.color":b,"shape3d.to.color":b,"shape3d.image":b,"shape3d.top.image":b,"shape3d.bottom.image":b,"shape3d.from.image":b,"shape3d.to.image":b,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":b,"shape3d.side.to":b,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":b,"shape3d.opacity":b,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Pj,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":b,"shape3d.uv.scale":b,"shape3d.top.uv.offset":b,"shape3d.top.uv.scale":b,"shape3d.bottom.uv.offset":b,"shape3d.bottom.uv.scale":b,"shape3d.from.uv.offset":b,"shape3d.from.uv.scale":b,"shape3d.to.uv.offset":b,"shape3d.to.uv.scale":b,"shape3d.top.cap":b,"shape3d.bottom.cap":b,"shape3d.start.angle":0,"shape3d.sweep.angle":U,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":b,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Ko,"all.image":b,"all.blend":b,"all.opacity":b,"all.reverse.flip":!1,"all.reverse.color":Pj,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":b,"all.uv.offset":b,"all.uv.scale":b,"all.discard.selectable":!0,mat:b,"left.mat":b,"right.mat":b,"top.mat":b,"bottom.mat":b,"front.mat":b,"back.mat":b},!0);var ql,Ud=!1,Fl=[0,0,0,0],ej={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Rj,2:$e,3:Jb,4:De,5:Wf,6:mb}},xi=function(d,R,q,h){if(R.getFaceVisible(d,q)){Mg(R,cl(d,R.getFaceMat(d,q)||R.getMat(d)));var J=R._26I;R.getFaceReverseCull(d,q)?J.enable(J.CULL_FACE):J.disable(J.CULL_FACE),Yo(J,R._prg.uFixPickReverseColor,ej[q]),fd(J),Ti(J,h,6),Ge(J),zn(R)}},ij=function(e){return e instanceof zd},xb=function(N){return[N.x,N.e||0,N.y]},lj=function(e,g,M){for(var g=zg(g),D=g[0],s=g[1],L=g[2];M--;)e.push(D,s,L)},Pc=function(i,z,p){for(var z=zg(z),x=z[0],c=z[1],X=z[2],B=z[3];p--;)i.push(x,c,X,B)},Vh=function(Z,T,o){if(T)for(var F,K,a,C=T[0],q=T[1],H=T[2],J=T[4],X=T[5],$=T[6],w=T[8],B=T[9],V=T[10],d=T[12],L=T[13],m=T[14],I=o.length,y=0,y=0;I>y;y+=3)F=o[y],K=o[y+1],a=o[y+2],Z.push(C*F+J*K+w*a+d,q*F+X*K+B*a+L,H*F+$*K+V*a+m);else nf(Z,o)},Nm=function($,M){var b=M.s("light.intensity"),p=zg(M.s(ar)),w=p[0],P=p[1],G=p[2];1!==b&&(w*=b,P*=b,G*=b),$.push(w,P,G,M.s("light.disabled")?1:0)},hi=function(e,Z,Q){Yo(Z,Q.uHeadlightRange,e._headlightRange);var m=e._headlightIntensity,a=zg(e._headlightColor);1!==m&&(a=[a[0]*m,a[1]*m,a[2]*m]),Yo(Z,Q.uHeadlightColor,[a[0],a[1],a[2],e._headlightDisabled?1:0]);var C=e._59O,f=e._spots,o=e._dirs;if(C.length){var L=[],N=[],I=[];C.forEach(function(U){Nm(L,U),nf(N,e._transformPointToViewSpace(U.p3())),I.push(U.s("light.range"))}),Z.uniform4fv(Q.uPointColor,L),Z.uniform1fv(Q.uPointRange,I),Z.uniform3fv(Q.uPointPosition,N)}if(f.length){var T=[],M=[],u=[],x=[],c=[],U=[];f.forEach(function(Z){Nm(T,Z),nf(M,e._transformPointToViewSpace(Z.p3())),nf(c,e._transformDirectionToViewSpace(Z.p3(),Z.s("light.center"))),u.push(Z.s("light.range")),x.push(t(Z.s("light.angle")/2)),U.push(Z.s("light.exponent"))}),Z.uniform4fv(Q.uSpotColor,T),Z.uniform1fv(Q.uSpotRange,u),Z.uniform1fv(Q.uSpotAngle,x),Z.uniform1fv(Q.uSpotExponent,U),Z.uniform3fv(Q.uSpotPosition,M),Z.uniform3fv(Q.uSpotDirection,c)}if(o.length){var k=[],D=[];o.forEach(function(h){Nm(k,h),nf(D,e._transformDirectionToViewSpace(h.p3()))}),Z.uniform4fv(Q.uDirColor,k),Z.uniform3fv(Q.uDirDirection,D)}},nl=function(x){return x>0&&0===(x-1&x)},Qf=function(X){return X=o(0,S(L,X)),X=o(xp,S(L-xp,X))},qb=function(){return.05+E()/2},eh=function(d,m,R,E){var F,I=d.getEye();return d.isOrtho()?(F=el(d.getCenter(),I),F[0]+=E[0],F[1]+=E[1],F[2]+=E[2]):F=I,Hh(m,R,E,F)},Hh=function(m,a,n,O){var J=ln(m,a),$=el(O,n,!0),W=ln($,a);if(g(W)<xp)return f;var h=(J-ln(n,a))/W;return[n[0]+$[0]*h,n[1]+$[1]*h,n[2]+$[2]*h]},vq=function(O,B){return{x:2*O.x-B.x,y:2*O.y-B.y}},Qm=function(f,R,z,T){var M,_;if(!f)return M=I(R.y-z.y,z.x-R.x),{x:R.x+T*e(M),y:R.y+T*t(M)};if(!z)return M=I(f.y-R.y,R.x-f.x),{x:R.x+T*e(M),y:R.y+T*t(M)};var H=el([f.x,f.y,0],[R.x,R.y,0],!0),X=el([z.x,z.y,0],[R.x,R.y,0],!0),s=-(H[0]+X[0])/2,K=-(H[1]+X[1])/2,d=F(s*s+K*K);if(xp>d)return M=I(f.y-R.y,R.x-f.x),{x:R.x+T*e(M),y:R.y+T*t(M)};var p=f.x-R.x,Y=f.y-R.y,E=z.x-R.x,c=z.y-R.y,D=F(p*p+Y*Y),h=F(E*E+c*c);M=v(ln(H,X))/2,_=H[1]*X[0]-H[0]*X[1]>0?-1:1,s/=d,K/=d;var S=T/e(M),J=o(D,h)/t(M);d=Math.min(S,J);var a={x:R.x+_*d*s,y:R.y+_*d*K};return z.b&&S>h/t(M)&&(a.adjust=!0),a},Go=function(X){var t=X[1],d=X[2],J=X[3],I=X[6],S=X[7],T=X[11];X[1]=X[4],X[2]=X[8],X[3]=X[12],X[4]=t,X[6]=X[9],X[7]=X[13],X[8]=d,X[9]=I,X[11]=X[14],X[12]=J,X[13]=S,X[14]=T},sr=function(B){var Z=B[0],p=B[1],b=B[2],i=B[3],g=B[4],x=B[5],o=B[6],d=B[7],v=B[8],k=B[9],K=B[10],I=B[11],F=B[12],t=B[13],D=B[14],G=B[15],E=Z*x-p*g,X=Z*o-b*g,W=Z*d-i*g,N=p*o-b*x,j=p*d-i*x,z=b*d-i*o,P=v*t-k*F,c=v*D-K*F,J=v*G-I*F,s=k*D-K*t,R=k*G-I*t,$=K*G-I*D,q=E*$-X*R+W*s+N*J-j*c+z*P;return q?(q=1/q,B[0]=(x*$-o*R+d*s)*q,B[1]=(b*R-p*$-i*s)*q,B[2]=(t*z-D*j+G*N)*q,B[3]=(K*j-k*z-I*N)*q,B[4]=(o*J-g*$-d*c)*q,B[5]=(Z*$-b*J+i*c)*q,B[6]=(D*W-F*z-G*X)*q,B[7]=(v*z-K*W+I*X)*q,B[8]=(g*R-x*J+d*P)*q,B[9]=(p*J-Z*R-i*P)*q,B[10]=(F*j-t*W+G*E)*q,B[11]=(k*W-v*j-I*E)*q,B[12]=(x*c-g*s-o*P)*q,B[13]=(Z*s-p*c+b*P)*q,B[14]=(t*X-F*N-D*E)*q,B[15]=(v*N-k*X+K*E)*q,void 0):f},dj=function(S,u){if(u){var b=u[0],P=u[1],K=u[2];S[12]=S[0]*b+S[4]*P+S[8]*K+S[12],S[13]=S[1]*b+S[5]*P+S[9]*K+S[13],S[14]=S[2]*b+S[6]*P+S[10]*K+S[14],S[15]=S[3]*b+S[7]*P+S[11]*K+S[15]}},bd=function(k,g){if(g){var q=g[0],G=g[1],a=g[2];k[0]=k[0]*q,k[1]=k[1]*q,k[2]=k[2]*q,k[3]=k[3]*q,k[4]=k[4]*G,k[5]=k[5]*G,k[6]=k[6]*G,k[7]=k[7]*G,k[8]=k[8]*a,k[9]=k[9]*a,k[10]=k[10]*a,k[11]=k[11]*a}},Jq=function(M,g,P){var v=g[0],H=g[1],r=g[2],$=g[3],Q=g[4],x=g[5],V=g[6],f=g[7],G=g[8],q=g[9],p=g[10],w=g[11],o=g[12],h=g[13],Y=g[14],a=g[15],U=P[0],k=P[1],i=P[2],z=P[3];return M[0]=U*v+k*Q+i*G+z*o,M[1]=U*H+k*x+i*q+z*h,M[2]=U*r+k*V+i*p+z*Y,M[3]=U*$+k*f+i*w+z*a,U=P[4],k=P[5],i=P[6],z=P[7],M[4]=U*v+k*Q+i*G+z*o,M[5]=U*H+k*x+i*q+z*h,M[6]=U*r+k*V+i*p+z*Y,M[7]=U*$+k*f+i*w+z*a,U=P[8],k=P[9],i=P[10],z=P[11],M[8]=U*v+k*Q+i*G+z*o,M[9]=U*H+k*x+i*q+z*h,M[10]=U*r+k*V+i*p+z*Y,M[11]=U*$+k*f+i*w+z*a,U=P[12],k=P[13],i=P[14],z=P[15],M[12]=U*v+k*Q+i*G+z*o,M[13]=U*H+k*x+i*q+z*h,M[14]=U*r+k*V+i*p+z*Y,M[15]=U*$+k*f+i*w+z*a,M},jd=function(c,q,E,Y){var t,D,O,o,e,T,r,I,R,u,Z=q[0],H=q[1],M=q[2],N=Y[0],y=Y[1],A=Y[2],C=E[0],f=E[1],G=E[2];return g(Z-C)<xp&&g(H-f)<xp&&g(M-G)<xp?Qn(c):(r=Z-C,I=H-f,R=M-G,u=1/F(r*r+I*I+R*R),r*=u,I*=u,R*=u,t=y*R-A*I,D=A*r-N*R,O=N*I-y*r,u=F(t*t+D*D+O*O),u?(u=1/u,t*=u,D*=u,O*=u):(t=0,D=0,O=0),o=I*O-R*D,e=R*t-r*O,T=r*D-I*t,u=F(o*o+e*e+T*T),u?(u=1/u,o*=u,e*=u,T*=u):(o=0,e=0,T=0),c[0]=t,c[1]=o,c[2]=r,c[3]=0,c[4]=D,c[5]=e,c[6]=I,c[7]=0,c[8]=O,c[9]=T,c[10]=R,c[11]=0,c[12]=-(t*Z+D*H+O*M),c[13]=-(o*Z+e*H+T*M),c[14]=-(r*Z+I*H+R*M),c[15]=1,c)},kq=function(E,Y,_,d,j){var V=1/z(Y/2),w=1/(d-j);return E[0]=V/_,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=V,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=(j+d)*w,E[11]=-1,E[12]=0,E[13]=0,E[14]=2*j*d*w,E[15]=0,E},Zc=function(M,K,F,t,w,q,p){var E=1/(K-F),z=1/(t-w),g=1/(q-p);return M[0]=-2*E,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*z,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=2*g,M[11]=0,M[12]=(K+F)*E,M[13]=(w+t)*z,M[14]=(p+q)*g,M[15]=1,M},An=function(v,g){var n=g[0],a=g[1],U=g[2],s=g[3],q=n*n+a*a+U*U+s*s,B=q?1/q:0;return v[0]=-n*B,v[1]=-a*B,v[2]=-U*B,v[3]=s*B,v},qh=function(b,P){var H=P[0]+P[5]+P[10],v=0;return H>0?(v=2*Math.sqrt(H+1),b[3]=.25*v,b[0]=(P[6]-P[9])/v,b[1]=(P[8]-P[2])/v,b[2]=(P[1]-P[4])/v):P[0]>P[5]&P[0]>P[10]?(v=2*Math.sqrt(1+P[0]-P[5]-P[10]),b[3]=(P[6]-P[9])/v,b[0]=.25*v,b[1]=(P[1]+P[4])/v,b[2]=(P[8]+P[2])/v):P[5]>P[10]?(v=2*Math.sqrt(1+P[5]-P[0]-P[10]),b[3]=(P[8]-P[2])/v,b[0]=(P[1]+P[4])/v,b[1]=.25*v,b[2]=(P[6]+P[9])/v):(v=2*Math.sqrt(1+P[10]-P[0]-P[5]),b[3]=(P[1]-P[4])/v,b[0]=(P[8]+P[2])/v,b[1]=(P[6]+P[9])/v,b[2]=.25*v),b},ki=function(V,w,K){var m=w[0],f=w[1],N=w[2],c=w[3],Y=m+m,M=f+f,i=N+N,o=m*Y,j=m*M,l=m*i,n=f*M,a=f*i,$=N*i,S=c*Y,C=c*M,T=c*i;return V[0]=1-(n+$),V[1]=j+T,V[2]=l-C,V[3]=0,V[4]=j-T,V[5]=1-(o+$),V[6]=a+S,V[7]=0,V[8]=l+C,V[9]=a-S,V[10]=1-(o+n),V[11]=0,V[12]=K[0],V[13]=K[1],V[14]=K[2],V[15]=1,V},qj=G.getRotationFromMatrix4,Cq=function(){var w=[0,0,0],Y=[0,0,0],K=[0,0,0],F=function(r,W,D){r[0]=W[1]*D[2]-W[2]*D[1],r[1]=W[2]*D[0]-W[0]*D[2],r[2]=W[0]*D[1]-W[1]*D[0]},d=function(r){return r[0]*r[0]+r[1]*r[1]+r[2]*r[2]},B=function(N){var v=Math.sqrt(d(N));N[0]/=v,N[1]/=v,N[2]/=v},E=function(W,S,y){W[0]=S[0]-y[0],W[1]=S[1]-y[1],W[2]=S[2]-y[2]};return function(V,v,f){var W=dn();return E(K,V,v),0===d(K)&&(K[2]=1),B(K),F(w,f,K),0===d(w)&&(1===Math.abs(f[2])?K[0]+=1e-4:K[2]+=1e-4,B(K),F(w,f,K)),B(w),F(Y,K,w),W[0]=w[0],W[4]=Y[0],W[8]=K[0],W[1]=w[1],W[5]=Y[1],W[9]=K[1],W[2]=w[2],W[6]=Y[2],W[10]=K[2],W}}(),Nr=function(f,t){if(f.vr.enable){var Y=f.vr.getViewMatrix(t);if(Y)return Y}return jd(t?t:dn(),f._eye,f._center,f._up)},fi=function(F){if(F.vr.enable){var y=F.vr.getProjectMatrix();if(y)return y}var K=F.getAspect(),l=F._near,g=F._far,i=dn();if(F._ortho){var x=F._orthoWidth/2,P=x/K;Zc(i,-x,x,-P,P,l,g)}else kq(i,F._fovy,K,l,g);return i},$l=function(N,L){if(!N)return f;var M=0,J=1,V=2,c=[],a=0,e=N.length,m=e/3;if(L){for(;e>a;a++)c[a]=0;for(a=0;a<L.length;a+=3){var g=[],d=[],B=[];g[M]=N[3*L[a+1]+M]-N[3*L[a]+M],g[J]=N[3*L[a+1]+J]-N[3*L[a]+J],g[V]=N[3*L[a+1]+V]-N[3*L[a]+V],d[M]=N[3*L[a+2]+M]-N[3*L[a+1]+M],d[J]=N[3*L[a+2]+J]-N[3*L[a+1]+J],d[V]=N[3*L[a+2]+V]-N[3*L[a+1]+V],B[M]=g[J]*d[V]-g[V]*d[J],B[J]=g[V]*d[M]-g[M]*d[V],B[V]=g[M]*d[J]-g[J]*d[M];for(var H=0;3>H;H++)c[3*L[a+H]+M]+=B[M],c[3*L[a+H]+J]+=B[J],c[3*L[a+H]+V]+=B[V]}}else for(a=0;m>a;a+=3){var g=[],d=[],B=[];g[M]=N[3*(a+1)+M]-N[3*a+M],g[J]=N[3*(a+1)+J]-N[3*a+J],g[V]=N[3*(a+1)+V]-N[3*a+V],d[M]=N[3*(a+2)+M]-N[3*(a+1)+M],d[J]=N[3*(a+2)+J]-N[3*(a+1)+J],d[V]=N[3*(a+2)+V]-N[3*(a+1)+V],B[M]=g[J]*d[V]-g[V]*d[J],B[J]=g[V]*d[M]-g[M]*d[V],B[V]=g[M]*d[J]-g[J]*d[M];for(var H=0;3>H;H++)c[3*(a+H)+M]=B[M],c[3*(a+H)+J]=B[J],c[3*(a+H)+V]=B[V]}for(a=0;e>a;a+=3){var x=[];x[M]=c[a+M],x[J]=c[a+J],x[V]=c[a+V];var G=F(x[M]*x[M]+x[J]*x[J]+x[V]*x[V]);0===G&&(G=xp),x[M]=x[M]/G,x[J]=x[J]/G,x[V]=x[V]/G,c[a+M]=x[M],c[a+J]=x[J],c[a+V]=x[V]}return new uh(c)},Vj=function(y,J,M,s){if(M||(M=y.createTexture()),J){var h=y.TEXTURE_2D,R=y.REPEAT,S=y.CLAMP_TO_EDGE,g=y.TEXTURE_MIN_FILTER;s!==y.NEAREST&&(s=y.LINEAR),Zq(y,M),y.texImage2D(h,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,J),Pm(y,y.TEXTURE_MAG_FILTER,s),nl(J.width)&&nl(J.height)&&!J.clampToEdge?(Pm(y,y.TEXTURE_WRAP_S,R),Pm(y,y.TEXTURE_WRAP_T,R),Pm(y,g,y.LINEAR_MIPMAP_LINEAR),y.generateMipmap(h)):(Pm(y,y.TEXTURE_WRAP_S,S),Pm(y,y.TEXTURE_WRAP_T,S),Pm(y,g,s)),Zq(y,f)}return M},Ip=function(W,o){var C=new Uint8Array(3);return o=o||W.createTexture(),Zq(W,o),Pm(W,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texImage2D(W.TEXTURE_2D,0,W.RGB,1,1,0,W.RGB,W.UNSIGNED_BYTE,C),o},Ug=function(x){x._26I&&x._prg&&(x._26I.deleteProgram(x._prg),x._prg=f)},Ro=function(w,h,k,x){var O=w.createShader(k);return w.shaderSource(O,x),w.compileShader(O),w.attachShader(h,O),O},pc=function(X){return X.createBuffer()},Zq=function(G,w){G.bindTexture(G.TEXTURE_2D,w)},db=function(h,t){h.bindFramebuffer(h.FRAMEBUFFER,t)},Pm=function(F,r,k){F.texParameteri(F.TEXTURE_2D,r,k)},ho=function(P,A){if(A){var A=zg(A);P.clearColor(A[0],A[1],A[2],A[3])}},Gd=function(v,B){Yo(v,B.uFix,!0),mp(v,B.aNormal)},Dj=function(W,v){Yo(W,v.uFix,!1),_m(W,v.aNormal)},Sk=function(e,l,M,w,X,U,x,b){e._picking||(M?(Yo(e,l.uBlend,!0),Yo(e,l.uBlendColor,M)):Yo(e,l.uBlend,!1),Yo(e,l.uLight,w==f?!0:w),mj(X)&&1!==X&&Yo(e,l.uPartOpacity,X),Yo(e,l.uReverseFlip,U==f?!1:U),Yo(e,l.uFixPickReverseColor,x||Pj)),b?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE)},Yg=function(s,p){s._picking||Yo(s,p.uPartOpacity,1)},fd=function(w,q,e,g,v,D,b,n,Q){if(!e)return w.activeTexture(w.TEXTURE0),Zq(w,w._emptyTexture),w.activeTexture(w.TEXTURE1),Zq(w,w._emptyBlendTexture),void 0;Yo(w,q.uTexture,!0),Yo(w,q.uDiscardSelectable,_g(g)?g:!0),_m(w,q.aUv),Hl(w,v,D,q.aUv,2),Q?(Yo(w,q.uBlendTexture,!0),w.activeTexture(w.TEXTURE1),Zq(w,Q),w.uniform1i(q.uBlendSampler,1)):(Yo(w,q.uBlendTexture,!1),w.activeTexture(w.TEXTURE1),Zq(w,w._emptyBlendTexture)),w.activeTexture(w.TEXTURE0),Zq(w,e),w.uniform1i(q.uSampler,0);var Z=[0,0,1,1];b&&(Z[0]=b[0],Z[1]=b[1]),n&&(Z[2]=n[0],Z[3]=n[1]),Yo(w,q.uOffsetScale,Z)},Ge=function(I,H,V){I.activeTexture(I.TEXTURE0),Zq(I,f),I.activeTexture(I.TEXTURE1),Zq(I,f),V&&(mp(I,H.aUv),Yo(I,H.uTexture,!1),Yo(I,H.uBlendTexture,!1))},ss=function(j,U,q,b,x,m){!q||D||A||j.lineWidth(q),b&&!j._picking&&Yo(j,U.uFixPickReverseColor,b),x&&Hl(j,x,m,U.aPosition)},yr=function(w,T,b,W){ql&&(W=w[ql]),w.drawArrays(W==f?w.TRIANGLES:W,T,b);var v=w._renderInfo;v&&(v.calls++,v.vertices+=b,(W==f||W===w.TRIANGLES)&&(v.faces+=b/3),W===w.LINES&&(v.lines+=b/2))},Ti=function(X,$,H,A){ql&&(A=X[ql]),X.drawElements(A==f?X.TRIANGLES:A,H,X.UNSIGNED_SHORT,$==f?0:2*$);var V=X._renderInfo;V&&(V.calls++,V.vertices+=H,(A==f||A===X.TRIANGLES)&&(V.faces+=H/3),A===X.LINES&&(V.lines+=H/2))},jl=function(u,T,L,Q,I){var y=u.ARRAY_BUFFER;u.bindBuffer(y,T),L&&u.bufferData(y,L,u.STATIC_DRAW),Q!=f&&u.vertexAttribPointer(Q,I?I:3,u.FLOAT,!1,0,0)},Hl=function(t,m,z,Q,l){return z?(ci(t,t.ARRAY_BUFFER,m,z),Q!=f&&t.vertexAttribPointer(Q,l?l:3,t.FLOAT,!1,0,0),void 0):jl(t,m,z,Q,l)},Ao=function(H,k,o){var I=H.ELEMENT_ARRAY_BUFFER;H.bindBuffer(I,k),o&&H.bufferData(I,o,H.STATIC_DRAW)},Pi=function(j,g,q){ci(j,j.ELEMENT_ARRAY_BUFFER,g,q)},ci=function(w,l,q,t){var q,n=t.glBuf,X=w._id;n&&(q=n[X])&&q._buf?w.bindBuffer(l,q._buf):(q={_buf:pc(w)},w._bufPool.push(q),w.bindBuffer(l,q._buf),w.bufferData(l,t,w.STATIC_DRAW),n||(n=t.glBuf={}),n[X]=q),q._fid=w._renderInfo.frame},Yo=function(V,R,S){if(S!=f&&R!=f){S=zg(S);var X=S.length;3===X?V.uniform3fv(R,S):4===X?V.uniform4fv(R,S):16===X?V.uniformMatrix4fv(R,!1,S):_g(S)?V.uniform1i(R,S?1:0):2===X?V.uniform2fv(R,S):V.uniform1f(R,S)}},_m=function(_,y){y!=f&&y>=0&&_.enableVertexAttribArray(y)},mp=function(c,I){I!=f&&I>=0&&c.disableVertexAttribArray(I)},zn=function(x,A){var y=x.getGL(),c=x._prg;x._7O=x._8O.pop(),A&&(Yo(y,c.uMVMatrix,x._7O),x._6O=A,Yo(y,c.uNMatrix,A))},Fn=function(r,l){return l||(l=dn()),Jr(l,r),sr(l),Go(l),l},Mg=function(y,v){var K=y.getGL(),G=y._prg,r=y._7O;v&&(y._8O.push(Zr(r)),Jq(r,r,v)),Yo(K,G.uMVMatrix,r),Yo(K,G.uNMatrix,Fn(r,y._6O))},Jm=function(q,Y,U,b,I,M){if(U){if(b){var G=U.value++,v=2147483648|G,l=[(255&v>>16)/255,(255&v>>8)/255,(255&v)/255,(255&v>>24)/255];U[G]={data:I,part:M}}else l=Fl;return Yo(q,Y.uFixPickReverseColor,l),l}},ik=function(){var b={center:function(g,d,h,Q,W){var C=-d[1]/2,P={x:-d[0]/2,y:C,width:d[0],height:d[1]},l=Ll(g,P,h);return[l.x+Q,-l.y-W,qb()]},front:function(V,N,v,O,j){var b=-N[1]/2,p={x:-N[0]/2,y:b,width:N[0],height:N[1]},T=Ll(V,p,v);return[T.x+O,-T.y-j,N[2]/2+qb()]},back:function(f,$,W,s,T){var C=-$[0]/2,L=-$[1]/2,y={x:C,y:L,width:$[0],height:$[1]},O=Ll(f,y,W);return[-O.x-s,-O.y-T,-$[2]/2-qb()]},left:function(V,m,_,D,Y){var h=-m[1]/2,r={x:-m[2]/2,y:h,width:m[2],height:m[1]},u=Ll(V,r,_);return[-m[0]/2-qb(),-u.y-Y,u.x+D]},right:function(I,h,C,u,x){var B=-h[2]/2,k=-h[1]/2,H={x:B,y:k,width:h[2],height:h[1]},E=Ll(I,H,C);return[h[0]/2+qb(),-E.y-x,-E.x-u]},top:function(o,Z,_,V,j){var k={x:-Z[0]/2,y:-Z[2]/2,width:Z[0],height:Z[2]},F=Ll(o,k,_);return[F.x+V,Z[1]/2+qb(),F.y+j]},bottom:function(V,m,z,Y,l){var G=-m[2]/2,A={x:-m[0]/2,y:G,width:m[0],height:m[2]},y=Ll(V,A,z);return[y.x+Y,-m[1]/2-qb(),-y.y-l]}};return function(L,M,n,I,r,Y){return b[I](L,M,n,r||0,Y||0)}}(),Qk=function(y,U,N,I,B,e,v,K,$,P){if(B&&(U[0]+=B[0],U[1]+=B[1],U[2]+=B[2]),dj(y,N),K){var f=dn();if(Yl(f,$,P),wd(U,f),dj(y,U),y.auto=K,y.pos=wd([0,0,0],y),e){var V=y.mat2=dn();Yl(V,e,v)}}else Yl(y,$,P),dj(y,U),I===Rj?Ki(y,-x):I===$e?Ki(y,x):I===Jb?yh(y,-x):I===De?yh(y,x):I===mb&&Ki(y,L),Yl(y,e,v);return y},Co=function(L,W){var z=W.auto,k=W.mat2,r=L.gv;if(z){var j,x=dn(),V=[0,0,0,0];j="string"==typeof z?[z.indexOf("x")<0?r._eye[0]:r._center[0],z.indexOf("y")<0?r._eye[1]:r._center[1],z.indexOf("z")<0?r._eye[2]:r._center[2]]:r._eye,qh(V,jd(dn(),j,r._center,r._up)),ki(x,An(V,V),W.pos),k&&Jq(x,x,k),Mg(r,x)}else Mg(r,W)},op=function(g,O,$,b,j){var s=g.s,e=g.gv,v=e.getGL(),R=e._prg,P=e._buffer,C=e._1O;Vj(v,Pp,C),Co(g,$),Sk(v,R,s(O+".blend"),s(O+".light"),s(O+".opacity"),s(O+".reverse.flip"),s(O+".reverse.color"),s(O+".reverse.cull")),fd(v,R,C,j,P.uv,Rk),Hl(v,P.vs,b,R.aPosition),Hl(v,P.ns,Hc,R.aNormal),Pi(v,P.is,Gj),Ti(v,0,Gj.length),Ge(v,R,C),Yg(v,R),zn(e)},rb=function(J,o,c){var X=J.gv,W=J.data,L=J[o]={blend:X.getBodyColor(W)||X.getFaceBlend(W,o),light:X.getFaceLight(W,o),color:X.getFaceColor(W,o),opacity:X.getFaceOpacity(W,o),transparent:X.getFaceTransparent(W,o),reverseFlip:X.getFaceReverseFlip(W,o),reverseColor:X.getFaceReverseColor(W,o),reverseCull:X.getFaceReverseCull(W,o),texture:X.getFaceImage(W,o),blendTexture:X.getFaceBlendImage(W,o),discardSelectable:X.getFaceDiscardSelectable(W,o)};if("csg"!==o){L.uv=X.getFaceUv(W,o)||c&&c[o+"Uv"],L.uvScale=X.getFaceUvScale(W,o)||c&&c[o+"UvScale"],L.uvOffset=X.getFaceUvOffset(W,o)||c&&c[o+"UvOffset"];var U=X.getFaceMat(W,o);U&&(L.mat=cl(W,U))}return L},em=function(M,R,t,Z,s){if(Z){if(!s(Z.transparent))return;var O=M.data,V=M.gv,H=V._buffer,c=V.getTexture(Z.texture,O),E=V.getTexture(Z.blendTexture,O);fd(R,t,c,Z.discardSelectable,H.uv,Z.tuv,Z.uvOffset,Z.uvScale,E),Sk(R,t,Z.blend,Z.light,Z.opacity,Z.reverseFlip,Z.reverseColor,Z.reverseCull),Yo(R,t.uDiffuse,Z.color),Hl(R,H.vs,Z.vs,t.aPosition),Hl(R,H.ns,Z.ns,t.aNormal),yr(R,0,Z.vs.length/3),Yg(R,t),Ge(R,t,c)}},Hg=function(g,v,m,Q,P,o){var O,W,E,D,J,z,I,S,F,j,A,k=[Q-v,P-m],b=g?g.length:0;for(E=0;b>E;E++){for(D=2,O=g[E],J=O[0],z=O[1];D+1<O.length;){if(I=O[D],S=O[D+1],W=Dh(v,m,Q,P,J,z,I,S,!0)){F=[I-J,S-z],j=Bj(F),F[0]/=j,F[1]/=j,j=ln(k,F),j=j>0?o:-o,A=[F[0]*j,F[1]*j];break}J=I,z=S,D+=2}if(A)break}if(A)for(Q=v+A[0],P=m+A[1],E=0;b>E;E++)for(D=2,O=g[E],J=O[0],z=O[1];D+1<O.length;){if(I=O[D],S=O[D+1],W=Dh(v,m,Q,P,J,z,I,S,!0))return[0,0];J=I,z=S,D+=2}return A?A:[Q-v,P-m]},Nc=K.graph3d={},Gr=function(Q,K,P){Gh(r+".graph3d."+Q,K,P)},Ii="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",re="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";dd(G,{setBatchInfo:function(C,j){hl[C]=j},getBatchInfo:function(B){return hl[B]}},!0);var _k=[1,1,1],eo=[1,0,0,0,0,1,0,1,1,1,1,0],so=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],wj=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Vp=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Vf=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],bf=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],lk=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Ci=function(U,l){fe(U,l,"_batchModelMap","_batchIndexMap"),Zk(U,l,"_wireframeModelMap","_wireframeIndexMap"),Zk(U,l,"_polylineModelMap","_polylineIndexMap"),Zk(U,l,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Zk(U,l,"_polylineModelMapSwap","_polylineIndexMapSwap")},fe=function(h,H,$,Y){if(!H)return h[$]={},h[Y]={},void 0;var K=H._id,B=h[Y],d=B[K];if(d){var C=h[$],y=d.batch,I=C[y],E=I.ds,w=d.index;if(I.invalidate=!0,delete B[K],E.splice(w,1),Cm(E))return delete C[y],void 0;for(var c=d.begin,V=d.size,g=3*c,j=3*V,X=4*c,v=4*V,_=I.vs,M=I.ps,z=I.uv,r=I.cs,p=I.bs,R=I.rs,x=I.ns,D=I.ls;w<E.length;w++)d=B[E[w]._id],d.index--,d.begin-=V;_.splice(g,j),M.splice(X,v),z&&z.splice(2*c,2*V),r&&r.splice(X,v),p&&p.splice(g,j),R&&R.splice(c,V),x&&x.splice(g,j),D&&D.splice(c,V)}},Zk=fe,Pr=function(R,j,H,S){if(!S)return f;var b=j[S];if(!b){var u=hl[S]||Lr,h=u.image?[]:f;b=j[S]={vs:[],ns:[],uv:h,cs:h?f:u.color?f:[],bs:u.blend?[]:f,ps:[],rs:u.brightness?[]:f,ds:[]}
}return b.invalidate=!0,R[H._id]={index:b.ds.length,begin:b.vs.length/3,batch:S},b.ds.push(H),b},Kb=function(e,u){return u!=f&&1!==u?[e[0]*u,e[1]*u,e[2]*u,e[3]]:e},ie=function(m,j,Z){var L=m.getBrightness(j),J=zg(Z.color||"white"),t=J[3]<1,O=Math.ceil(Z.width)||1,z=(t?"T":"O")+O,b=m._wireframeIndexMap,F=m._wireframeModelMap,S=F[z];S||(S=F[z]={vs:[],cs:[],ps:[],ds:[],T:t,W:O});var h,C=m.getData3dUI(j),I=Ch(C);if(Z.geometry){if(!I)return;if(h=xd(I),!h)return}else h=Z.short?Em:Ep;S.invalidate=!0;var D=S.vs,w=S.cs,v=S.ds,Q=b[j._id]={index:v.length,begin:D.length/3,batch:z};v.push(j);var K=cl(j,Z.mat),e=C._calcAnchorMat(j);e&&Jq(K,K,e),Vh(D,K,h);var p=Q.size=D.length/3-Q.begin;Pc(w,Kb(J,L),p)},io=function(L,H,t,W,V,B,j,I,s){var P=L.getBrightness(H);P==f&&(P=1);var z=Kb(zg(W),P),k=z[3]<1;B=Math.ceil(B)||1;var G=(k?"T":"O")+B;if(j){var S=j[0],y=(j[1]||S)+S;G+="-"+S+"-"+y,s&&(G+="-"+Cj(s)+"-"+P,s=Kb(zg(s),P))}var U=L._polylineIndexMap,p=L._polylineModelMap,R=p[G];R||(R=p[G]={vs:[],cs:[],ps:[],ds:[],ls:j?[]:f,T:k,W:B},j&&(R.D=S,R.G=y,R.A=s)),R.invalidate=!0;var T,d=R.vs,O=R.cs,o=R.ds,q=R.ls,Y=U[H._id]={index:o.length,begin:d.length/3,batch:G};o.push(H),nf(d,t);var F,J=Y.size=d.length/3-Y.begin,Z=t.length,Q=0,b=[];if(j||V)for(T=0;Z>T;T+=6)F=Bj([t[T],t[T+1],t[T+2]],[t[T+3],t[T+4],t[T+5]]),b.push(F),Q+=F;if(Q&&V){var A,v=Kb(zg(V),P),g=[v[0]-z[0],v[1]-z[1],v[2]-z[2],v[3]-z[3]],D=0;for(T=0;Z>T;T+=6)A=D/Q,Pc(O,[z[0]+g[0]*A,z[1]+g[1]*A,z[2]+g[2]*A,z[3]+g[3]*A],1),D+=b[T/6],A=D/Q,Pc(O,[z[0]+g[0]*A,z[1]+g[1]*A,z[2]+g[2]*A,z[3]+g[3]*A],1)}else Pc(O,z,J);if(j)for(D=I||0,T=0;Z>T;T+=6)q.push(D),D+=b[T/6],q.push(D)},Qq=function(f,l,b){if(l)for(var k=4*l.begin,u=b[l.batch].ps,a=0;a<l.size;a++)u[k++]=f[0],u[k++]=f[1],u[k++]=f[2],u[k++]=f[3]},kb=function(J,r){var Z=r+["32"],h=J[r],t=J[Z];h?t&&t.length===h.length?(t.set(h),t.glBuf=null):J[Z]=new uh(h):delete J[Z]},Cg=function(j,V,H,b,g,m,p,D,e){if(te(H))H.forEach(function(U){Cg(j,V,U,b,g,m,p,D,e)});else if(cr(H))Cg(j,V,Ch(b,H),b,g,m,p,D,e);else if(wg(H)){var l,d=wn(H.mat,V,j),Z=wn(H.s3,V,j),J=wn(H.t3,V,j),n=wn(H.r3,V,j);if((Z||n||J||d)&&(l=ak(d,Z,n,wn(H.rotationMode,V,j),J),m.push(l)),H.shape3d)Cg(j,V,H.shape3d,b,g,m,p,D,H);else{var h=b.s;e=e||Lr;var Y=m[0],C=m.length,U=h("shape3d.color",H.color,e.color);if(g||(g=h("shape3d.blend",H.blend,e.blend)),C>1){Y=Zr(Y);for(var x=1;C>x;x++)Jq(Y,Y,m[x])}H.vs&&h(nq,H.visible,e.visible)&&gk(Y,p,D,H.vs,H.uv,H.is,g,U),H.top_vs&&h(mf,H.topVisible,e.topVisible)&&gk(Y,p,D,H.top_vs,H.top_uv,H.top_is,g,h("shape3d.top.color",H.topColor,e.topColor)||U),H.bottom_vs&&h(ib,H.bottomVisible,e.bottomVisible)&&gk(Y,p,D,H.bottom_vs,H.bottom_uv,H.bottom_is,g,h("shape3d.bottom.color",H.bottomColor,e.bottomColor)||U),H.from_vs&&h(Am,H.fromVisible,e.fromVisible)&&gk(Y,p,D,H.from_vs,H.from_uv,H.from_is,g,h("shape3d.from.color",H.fromColor,e.fromColor)||U),H.to_vs&&h(Fc,H.toVisible,e.toVisible)&&gk(Y,p,D,H.to_vs,H.to_uv,H.to_is,g,h("shape3d.to.color",H.toColor,e.toColor)||U)}l&&m.pop()}},gk=function(Q,a,H,l,x,O,b,v){var K,Z=a.cs,W=a.uv,X=a.bs;if(O){K=O.length;for(var U=0;K>U;U++){var P=O[U];Vh(H,Q,[l[3*P],l[3*P+1],l[3*P+2]]),W&&nf(W,[x[2*P],x[2*P+1]])}}else K=l.length/3,Vh(H,Q,l),W&&nf(W,x);Z&&Pc(Z,v,K),X&&(b?lj(X,b,K):nf(X,_k,K))},Je=function(u,g,j,R){var l=[];R?Cg(u.gv,u.data,R,u,u.getBodyColor(),[g],j,l):(Kr(u,Rj,g,j,l),Kr(u,$e,g,j,l),Kr(u,Wf,g,j,l),Kr(u,mb,g,j,l),Kr(u,Jb,g,j,l),Kr(u,De,g,j,l),Kr(u,"csg",g,j,l)),l.length&&(nf(j.vs,l),nf(j.ns,$l(l)))},Kr=function(j,M,b,D,x){var u=j[M];if(u){var G=u.tuv;if(G){var g,S,h,V,O=u.uvScale,J=u.uvOffset;if(O)for(g=G.length,S=O[0],h=O[1],V=0;g>V;V+=2)G[V]*=S,G[V+1]*=h;if(J)for(g=G.length,S=J[0],h=J[1],V=0;g>V;V+=2)G[V]+=S,G[V+1]+=h}gk(b,D,x,u.vs,G,f,u.blend,u.color)}},zp=function(M,b,C,$,y,e,Q,E){var Y,I=C.cs,N=C.uv,W=C.bs;if(M.getFaceVisible(b,e)){var r=M.getFaceMat(b,e);if(r&&(y=cl(b,r)),Vh(Q,y,E),I&&Pc(I,M.getFaceColor(b,e),6),N){var f=M.getFaceUv(b,e)||$[e+"Uv"],K=M.getFaceUvScale(b,e)||$[e+"UvScale"],T=M.getFaceUvOffset(b,e)||$[e+"UvOffset"];f=f?[f[6],f[7],f[0],f[1],f[2],f[3],f[2],f[3],f[4],f[5],f[6],f[7]]:eo;var n=f[0],d=f[1],U=f[2],B=f[3],q=f[4],Z=f[5],O=f[6],k=f[7],x=f[8],a=f[9],g=f[10],D=f[11];if(K){var F=K[0],V=K[1];n*=F,d*=V,U*=F,B*=V,q*=F,Z*=V,O*=F,k*=V,x*=F,a*=V,g*=F,D*=V}if(T){var l=T[0],u=T[1];n+=l,d+=u,U+=l,B+=u,q+=l,Z+=u,O+=l,k+=u,x+=l,a+=u,g+=l,D+=u}N.push(n,d,U,B,q,Z,O,k,x,a,g,D)}W&&(Y=M.getBodyColor(b)||M.getFaceBlend(b,e),Y?lj(W,Y,6):nf(W,_k,6))}},Wc=function(j,z,T,x){var b=j.getGL(),l=j._prg,p=j._buffer;if(!Er(z)){Mg(j),Gd(b,l);for(var O in z){var D=z[O];if(!(x&&!D.T||!x&&D.T)){D.invalidate?(D.invalidate=!1,kb(D,"vs"),kb(D,"cs"),kb(D,"ls"),kb(D,"ps")):T&&kb(D,"ps");var J=D.vs32,N=T?D.ps32:D.cs32;ss(b,l,D.W,f,p.vs,J);var h=D.D,q=!j._dashDisabled&&h;Yo(b,l.uAlphaTest,H.alphaTest),q&&(Yo(b,l.uDash,!0),Yo(b,l.uDashDistance,h),Yo(b,l.uDashGapDistance,D.G),_m(b,l.aLineDistance),Hl(b,p.lineDistance,D.ls32,l.aLineDistance,1),Yo(b,l.uDiffuse,D.A||jb));var d=!j._batchColorDisabled;d&&(Yo(b,l.uBatchColor,!0),_m(b,l.aBatchColor),Hl(b,p.batchColor,N,l.aBatchColor,4)),fd(b),yr(b,0,J.length/3,b.LINES),Ge(b),d&&(Yo(b,l.uBatchColor,!1),mp(b,l.aBatchColor)),q&&(Yo(b,l.uDash,!1),mp(b,l.aLineDistance))}}Dj(b,l)}},fo=function(q,G,n){var D,g,$,P,k,i,M,Z,F,X,R,j=q.getGL(),U=q._prg,v=q._buffer,e=q._batchModelMap;if(!Er(e)){Mg(q);for(D in e)if(g=hl[D]||Lr,!(n&&!g.transparent||!n&&g.transparent)&&($=e[D],G||!g.transparentMask)){var V=n&&g.autoSort!==!1&&(q._33Q||$.invalidate);if($.invalidate?($.invalidate=!1,kb($,"vs"),kb($,"ns"),kb($,"cs"),kb($,"rs"),kb($,"ps"),kb($,"bs"),kb($,"uv")):G&&kb($,"ps"),k=$.vs32,i=G?$.ps32:$.cs32,F=$.uv32,M=$.bs32,Z=$.rs32,R=k.length/3,V&&($.is=Kg(k,q.getEye())),R){P=g.light,X=q.getTexture(g.image),Sk(j,U,f,g.light,g.opacity,g.reverseFlip,g.reverseColor,g.reverseCull),i?q._batchColorDisabled||(Yo(j,U.uBatchColor,!0),_m(j,U.aBatchColor),Hl(j,v.batchColor,i,U.aBatchColor,4)):Yo(j,U.uDiffuse,g.color||jb);var y=g.alphaTest;Yo(j,U.uAlphaTest,y===b?H.alphaTest:y);var T=M&&!q._batchBlendDisabled;T&&(Yo(j,U.uBatchBlend,!0),_m(j,U.aBatchBlend),Hl(j,v.batchBlend,M,U.aBatchBlend));var m=Z&&!q._batchBrightnessDisabled;m&&(Yo(j,U.uBatchBrightness,!0),_m(j,U.aBatchBrightness),Hl(j,v.batchBrightness,Z,U.aBatchBrightness,1)),F?fd(j,U,X,g.discardSelectable,v.uv,F,g.uvOffset,g.uvScale):fd(j),Hl(j,v.vs,k,U.aPosition),Hl(j,v.ns,$.ns32,U.aNormal),$.is?(Ao(j,v.is,$.is),Ti(j,0,R)):yr(j,0,R),F?Ge(j,U,X):Ge(j),i&&!q._batchColorDisabled&&(Yo(j,U.uBatchColor,!1),mp(j,U.aBatchColor)),T&&(Yo(j,U.uBatchBlend,!1),mp(j,U.aBatchBlend)),m&&(Yo(j,U.uBatchBrightness,!1),mp(j,U.aBatchBrightness)),Yg(j,U)}}}},Kg=function(s,d){for(var F=s.length/3,X=new Array(F),m=F/3,Y=new Array(m),x=0;m>x;x++)Y[x]=x;Y.sort(function(L,l){var D=9*L,U=[(s[D]+s[D+3]+2*s[D+6])/4,(s[D+1]+s[D+4]+2*s[D+7])/4,(s[D+2]+s[D+5]+2*s[D+8])/4];D=9*l;var v=[(s[D]+s[D+3]+2*s[D+6])/4,(s[D+1]+s[D+4]+2*s[D+7])/4,(s[D+2]+s[D+5]+2*s[D+8])/4],b=Bj(d,U)-Bj(d,v);return b>0?-1:0>b?1:0});for(var x=0;m>x;x++){var k=3*x,t=3*Y[x];X[k]=t,X[k+1]=t+1,X[k+2]=t+2}return new vr(X)},Cp={obj:function($,b){var l={mat:$.mat,s3:$.s3,r3:$.r3,rotationMode:$.rotationMode,t3:$.t3,cube:$.cube==f?!0:$.cube,center:$.center==f?!0:$.center,ignoreMtls:$.ignoreMtls,ignoreTransparent:$.ignoreTransparent,ignoreColor:$.ignoreColor,ignoreImage:$.ignoreImage,ignoreNormal:$.ignoreNormal,prefix:$.prefix,flipY:$.flipY,flipFace:$.flipFace,reverseFlipMtls:$.reverseFlipMtls,finishFunc:function(y,U){if(y){var U=[];for(var f in y){var t=y[f];U.rawS3=t.rawS3,U.push(t),$.eachModel&&$.eachModel(f,t)}U.json=$,b(U)}else b()}};G.loadObj($.obj,$.mtl,l)}};G.getModelTypeHandlers=function(){return Cp},G.setModelTypeHandler=function(v,E){Cp[v]=E},G.getModelTypeHandler=function(u){return Cp[u]},G.handleModelLoaded=function(){},G.handleUnfoundModel=function(){};var is=f,Sh=f,_f=function(G){is&&!G._loadingModelView_&&(Sh||(Sh={}),Sh[G._loadingModelView_=Rp()]=G)},Ff=function(k,z){is||(is={});var U=is[k];if(U){if(U.url===z)return;U.request.onload=dr,U.request.onerror=dr}var S=new XMLHttpRequest;if(is[k]={request:S,url:z},S.overrideMimeType&&S.overrideMimeType("text/plain"),z=G.beforeLoadURL(z),z.data){var l=G.parse(z.data);zr(k,l,z)}else S.open("GET",encodeURI(z),!0),S.onload=function(Y){if(200===this.status||0===this.status){var l=G.parse(Y.target.response||Y.target.responseText);zr(k,l,z)}else sb(k,G.handleUnfoundModel(k,z)||f)},S.onerror=function(){sb(k,G.handleUnfoundModel(k,z)||f)},S.send(null)},zr=function(r,Q,V){var l=Q.modelType;if(!l)return sb(r,Q),G.handleModelLoaded(r,Q),void 0;var a=G.getModelTypeHandler(l);if(a){var D=function(j){j?(sb(r,j),G.handleModelLoaded(r,j)):sb(r,G.handleUnfoundModel(r,V)||f)};a(Q,D)}else sb(r,G.handleUnfoundModel(r,V)||f)},sb=function(Q,i){if(vf[Q]=i,delete is[Q],Er(is)&&(is=f,Sh)){for(var $ in Sh){var A=Sh[$];A._2O&&(A._2O={}),A.invalidateAll&&A.invalidateAll(b,"modelLoaded",Q),A.redraw&&A.redraw(),A.iv(),delete A._loadingModelView_}Sh=f}if(i&&Sh)for(var $ in Sh){var A=Sh[$];A.invalidateAll&&A.invalidateAll(b,"modelLoading",Q),A.redraw&&A.redraw(),A.iv()}},Rk=new uh([0,0,0,1,1,1,1,0]),Hc=new uh([0,0,1,0,0,1,0,0,1,0,0,1]),Gj=new vr([0,1,2,2,3,0]),Xi=new uh([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Gc=new vr([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Pn=new uh([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),zj=$l(Xi,Gc),hk=(new uh([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new vr([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Rj,Wf,$e,mb,Jb,De]),Ep=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Em=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],jk=function(P,E,D,p,f,o){o=o||16,P=P||16,E=E||0,D=D||P;var R,H,d,Y,O,j,m,v,s=.5,I=[],$=[],F=U/P,T=L/o;for(R=0;o>R;R++)for(O=R+1,Y=R*T,v=O*T,H=E;D>H;H++)j=H+1,d=H*F,m=j*F,I.push(s*e(Y)*t(d),s*t(Y),-s*e(Y)*e(d),s*e(v)*t(m),s*t(v),-s*e(v)*e(m),s*e(Y)*t(m),s*t(Y),-s*e(Y)*e(m),s*e(Y)*t(d),s*t(Y),-s*e(Y)*e(d),s*e(v)*t(d),s*t(v),-s*e(v)*e(d),s*e(v)*t(m),s*t(v),-s*e(v)*e(m)),$.push(H/P,R/o,j/P,O/o,j/P,R/o,H/P,R/o,H/P,O/o,j/P,O/o);if(p){var V=[],b=[];for(d=E*F,R=0;o>R;R++)O=R+1,Y=R*T,v=O*T,V.push(0,0,0,s*e(v)*t(d),s*t(v),-s*e(v)*e(d),s*e(Y)*t(d),s*t(Y),-s*e(Y)*e(d)),b.push(0,.5,E/P,O/o,E/P,R/o)}if(f){var A=[],M=[];for(d=D*F,R=0;o>R;R++)O=R+1,Y=R*T,v=O*T,A.push(0,0,0,s*e(Y)*t(d),s*t(Y),-s*e(Y)*e(d),s*e(v)*t(d),s*t(v),-s*e(v)*e(d)),M.push(1,.5,D/P,R/o,D/P,O/o)}return{vs:I,uv:$,from_vs:V,from_uv:b,to_vs:A,to_uv:M}},Qe=function(m,n,K){m=m||.17,n=n||12,K=K||18,0>m?m=0:m>.25&&(m=.25);var l,$,f,B,c,x,Q,M=.5,q=[],O=[],R=[],D=U/K,W=U/n,g=M-m;for($=0;n>=$;$++)for(B=-L+$*W,x=t(B),c=e(B),l=0;K>=l;l++)f=l*D,Q=g+m*x,q.push(t(f)*Q,c*m,-e(f)*Q),O.push(l/K,1-$/n);for($=0;n>$;$++){var J=$*(K+1),X=($+1)*(K+1);for(l=0;K>l;l++)R.push(J+l,X+l+1,X+l,J+l,J+l+1,X+l+1)}return{vs:q,uv:O,is:R}},sg=function(D,T,o,F,j,s,E){E=E||12,D=D||18,T=T||0,o=o||D,s=s||.17,0>s?s=0:s>.25&&(s=.25);var c,I,Q,H,k,h,Z,B,l,u,y=.5,m=[],n=[],P=U/D,x=U/E,v=y-s;for(Q=0;E>Q;Q++)for(H=Q+1,Z=-L+Q*x,B=-L+H*x,c=T;o>c;c++)I=c+1,k=c*P,h=I*P,l=v+s*t(Z),u=v+s*t(B),m.push(t(k)*l,e(Z)*s,-e(k)*l,t(h)*l,e(Z)*s,-e(h)*l,t(h)*u,e(B)*s,-e(h)*u,t(k)*l,e(Z)*s,-e(k)*l,t(h)*u,e(B)*s,-e(h)*u,t(k)*u,e(B)*s,-e(k)*u),n.push(c/D,1-Q/E,I/D,1-Q/E,I/D,1-H/E,c/D,1-Q/E,I/D,1-H/E,c/D,1-H/E);if(F){var V=[],C=[];for(Q=0;E>Q;Q++)H=Q+1,Z=-L+Q*x,B=-L+H*x,k=T*P,l=v+s*t(Z),u=v+s*t(B),V.push(t(k)*l,e(Z)*s,-e(k)*l,t(k)*u,e(B)*s,-e(k)*u,t(k)*v,0,-e(k)*v),C.push(.5+.5*t(Z),.5-.5*e(Z),.5+.5*t(B),.5-.5*e(B),.5,.5)}if(j){var M=[],r=[];for(Q=0;E>Q;Q++)H=Q+1,Z=-L+Q*x,B=-L+H*x,k=o*P,l=v+s*t(Z),u=v+s*t(B),M.push(t(k)*l,e(Z)*s,-e(k)*l,t(k)*v,0,-e(k)*v,t(k)*u,e(B)*s,-e(k)*u),r.push(.5-.5*t(Z),.5-.5*e(Z),.5,.5,.5-.5*t(B),.5-.5*e(B))}return{vs:m,uv:n,from_vs:V,from_uv:C,to_vs:M,to_uv:r}},Pf=function(P,B){for(var k,$,f,G=.5,j=16,Q=[],z=[],J=[],V=U/j,O=0;j>=O;O++)k=O*V,$=t(k)*G,f=e(k)*G,Q.push($,-G,f,$,G,f),z.push(1-O/j,1,1-O/j,0);for(O=0;j>O;O++)J.push(2*O,2*O+1,2*O+3,2*O,2*O+3,2*O+2);if(B){var w=[],a=[],Y=[];for(w.push(0,-G,0),a.push(.5,.5),O=0;j>=O;O++)k=O*V,$=t(k),f=e(k),w.push($*G,-G,-f*G),a.push(.5+.5*$,.5+.5*f);for(O=0;j>O;O++)Y.push(0,O+2,O+1)}if(P){var S=[],H=[],_=[];for(S.push(0,G,0),H.push(.5,.5),O=0;j>=O;O++)k=O*V,$=t(k),f=e(k),S.push($*G,G,-f*G),H.push(.5+.5*$,.5-.5*f);for(O=0;j>O;O++)_.push(0,O+1,O+2)}return{vs:Q,uv:z,is:J,bottom_vs:w,bottom_uv:a,bottom_is:Y,top_vs:S,top_uv:H,top_is:_}},Nn=function(X,$,K,E,Q,r,B){X=X||12,$=$||0,K=K||X;for(var M,g,T,H,q,f,Z,k,N=.5,s=[],V=[],z=U/X,Y=$;K>Y;Y++)M=Y+1,g=Y*z,T=M*z,H=t(g)*N,q=e(g)*N,f=t(T)*N,Z=e(T)*N,s.push(H,-N,-q,f,-N,-Z,H,N,-q,f,-N,-Z,f,N,-Z,H,N,-q),V.push(Y/X,1,M/X,1,Y/X,0,M/X,1,M/X,0,Y/X,0);if(B){var a=[],h=[];for(Y=$;K>Y;Y++)g=z*Y,T=z*(Y+1),H=t(g),q=e(g),f=t(T),Z=e(T),a.push(H*N,-N,-q*N,0,-N,0,f*N,-N,-Z*N),h.push(.5+.5*H,.5+.5*q,.5,.5,.5+.5*f,.5+.5*Z)}if(r){var C=[],d=[];for(Y=$;K>Y;Y++)g=z*Y,T=z*(Y+1),H=t(g),q=e(g),f=t(T),Z=e(T),C.push(H*N,N,-q*N,f*N,N,-Z*N,0,N,0),d.push(.5+.5*H,.5-.5*q,.5+.5*f,.5-.5*Z,.5,.5)}if(E){var p=[],S=[];g=z*$,H=t(g)*N,q=e(g)*N,k=$/X,p.push(0,N,0,0,-N,0,H,-N,-q,H,-N,-q,H,N,-q,0,N,0),S.push(0,0,0,1,k,1,k,1,k,0,0,0)}if(Q){var O=[],G=[];g=z*K,H=t(g)*N,q=e(g)*N,k=K/X,O.push(0,-N,0,0,N,0,H,N,-q,H,N,-q,H,-N,-q,0,-N,0),G.push(1,1,1,0,k,0,k,0,k,1,1,1)}return{vs:s,uv:V,bottom_vs:a,bottom_uv:h,top_vs:C,top_uv:d,from_vs:p,from_uv:S,to_vs:O,to_uv:G}},es=function(E,z,J,V,q){z=z||18,J=J||0,V=V==f?U:V,q=q==f?.5:q;for(var s,D,Y,y,v,S,g=[0,.5,.75,.875,.9375],H=[],b=[],l=[],N=V/z,p=0;p<g.length;p++){var c=0===p%2?0:.5;for(s=0;z>=s;s++)D=(s+c)*N+J,Y=1-g[p],H.push(t(D)*q*Y,-q+2*g[p]*q,-e(D)*q*Y),b.push((s+c)/z,Y)}for(p=0;p<g.length-1;p++){var W=p*(z+1),R=(p+1)*(z+1);for(s=0;z>s;s++)l.push(W+s,R+s+1,R+s,W+s,W+s+1,R+s+1)}for(S=H.length/3-(z+1),s=0;z>s;s++)H.push(0,q,0),b.push((s+.5)/z,0);for(s=0;z>s;s++)l.push(S+s,S+s+1,S+(z+1)+s);if(E){var o=[],u=[],Z=[];for(o.push(0,-q,0),u.push(.5,.5),s=0;z>=s;s++)D=s*N+J,y=t(D),v=e(D),o.push(y*q,-q,-v*q),u.push(.5+.5*y,.5+.5*v);for(s=0;z>s;s++)Z.push(0,s+2,s+1)}return{vs:H,uv:b,is:l,bottom_vs:o,bottom_uv:u,bottom_is:Z}},Vo=function(W,l,L,s,C,i){W=W||16,l=l||0,L=L||W;for(var g=.5,x=[],N=[],F=U/W,P=l;L>P;P++){var y=P+1,u=F*P,M=F*y;x.push(t(u)*g,-g,-e(u)*g,t(M)*g,-g,-e(M)*g,0,g,0),N.push(P/W,1,y/W,1,(P+y)/2/W,0)}if(i){var w=[],k=[];for(P=l;L>P;P++){u=F*P,M=F*(P+1);var z=t(u),T=e(u),D=t(M),j=e(M);w.push(z*g,-g,-T*g,0,-g,0,D*g,-g,-j*g),k.push(.5+.5*z,.5+.5*T,.5,.5,.5+.5*D,.5+.5*j)}}if(s){var f=[],S=[];u=F*l,f.push(0,g,0,0,-g,0,t(u)*g,-g,-e(u)*g),S.push(0,0,0,1,l/W,1)}if(C){var $=[],b=[];u=F*L,$.push(0,-g,0,0,g,0,t(u)*g,-g,-e(u)*g),b.push(1,1,1,0,L/W,1)}return{vs:x,uv:N,bottom_vs:w,bottom_uv:k,from_vs:f,from_uv:S,to_vs:$,to_uv:b}},le=function(C,h,w,a,s,y,Q,r){for(var d=[],e=0;e<C.length-1;e+=2)d.push({x:C[e],y:C[e+1]});return Vr(d,h,w,a,s,y,Q,r,!1)},Xm={roundRect:function(p,e){return le([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],p,e,3)},star:function(X,E){return le([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],X,E)},rect:function(C,V){return le([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],C,V)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(t,i){return le([0,-.5,.5,.5,-.5,.5],[1,2,2,5],t,i)},rightTriangle:function(d,J){return le([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],d,J)},parallelogram:function(o,y){return le([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],o,y)},trapezoid:function(Q,U){return le([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],Q,U)}},Bf={sphere:1,cylinder:1,cone:1,torus:1},pj={torus:1,sphere:1},om=dd(lg(Xm),{cylinder:1}),Kf=dd(lg(Xm),{cylinder:1,cone:1}),Tl=function(v,m,C){var x,$=wn(v.mat,C,m),M=wn(v.s3,C,m),H=wn(v.t3,C,m),A=wn(v.r3,C,m);return(M||A||H||$)&&(x=Zr(m._6O),Mg(m,ak($,M,A,wn(v.rotationMode,C,m),H))),x},uk=function(r,$,P,y,g,T,N){if(te(P))P.forEach(function(Q){uk(r,$,Q,y,g,T,N)});else if(cr(P))uk(r,$,Ch(y,P),y,g,T,N);else if(wg(P))if(P.shape3d){var D=Tl(P,r,$);uk(r,$,P.shape3d,y,g,T,P),D&&zn(r,D)}else Uk(r,$,P,y.s,g,T,N)},Uk=function(j,L,R,n,F,i,w){if(w=w||Lr,!i||i(n("shape3d.transparent",R.transparent,w.transparent))){var M=Tl(R,j,L);wh(R);var B=j._26I,u=j._prg,o=j._buffer,g=n("shape3d.color",R.color,w.color);F||(F=n("shape3d.blend",R.blend,w.blend));var K,h=R.opacity==f?w.opacity:R.opacity,U=n("shape3d.opacity");K=U!=f&&h!=f?h*U:h!=f?h:U,Sk(B,u,F,n("shape3d.light",R.light,w.light),K,n("shape3d.reverse.flip",R.reverseFlip,w.reverseFlip),n("shape3d.reverse.color",R.reverseColor,w.reverseColor),n("shape3d.reverse.cull",R.reverseCull,w.reverseCull)),R.vs&&n(nq,R.visible,w.visible)&&Dg(B,u,o,g,j.getTexture(n("shape3d.image",R.image,w.image),L),n("shape3d.discard.selectable",R.discardSelectable,w.discardSelectable),R.vs,R.uv,R.ns,R.is,n("shape3d.uv.offset",R.uvOffset,w.uvOffset),n("shape3d.uv.scale",R.uvScale,w.uvScale)),R.top_vs&&n(mf,R.topVisible,w.topVisible)&&Dg(B,u,o,n("shape3d.top.color",R.topColor,w.topColor)||g,j.getTexture(n("shape3d.top.image",R.topImage,w.topImage),L),n("shape3d.top.discard.selectable",R.topDiscardSelectable,w.topDiscardSelectable),R.top_vs,R.top_uv,R.top_ns,R.top_is,n("shape3d.top.uv.offset",R.topUvOffset,w.topUvOffset),n("shape3d.top.uv.scale",R.topUvScale,w.topUvScale)),R.bottom_vs&&n(ib,R.bottomVisible,w.bottomVisible)&&Dg(B,u,o,n("shape3d.bottom.color",R.bottomColor,w.bottomColor)||g,j.getTexture(n("shape3d.bottom.image",R.bottomImage,w.bottomImage),L),n("shape3d.bottom.discard.selectable",R.bottomDiscardSelectable,w.bottomDiscardSelectable),R.bottom_vs,R.bottom_uv,R.bottom_ns,R.bottom_is,n("shape3d.bottom.uv.offset",R.bottomUvOffset,w.bottomUvOffset),n("shape3d.bottom.uv.scale",R.bottomUvScale,w.bottomUvScale)),R.from_vs&&n(Am,R.fromVisible,w.fromVisible)&&Dg(B,u,o,n("shape3d.from.color",R.fromColor,w.fromColor)||g,j.getTexture(n("shape3d.from.image",R.fromImage,w.fromImage),L),n("shape3d.from.discard.selectable",R.fromDiscardSelectable,w.fromDiscardSelectable),R.from_vs,R.from_uv,R.from_ns,R.from_is,n("shape3d.from.uv.offset",R.fromUvOffset,w.fromUvOffset),n("shape3d.from.uv.scale",R.fromUvScale,w.fromUvScale)),R.to_vs&&n(Fc,R.toVisible,w.toVisible)&&Dg(B,u,o,n("shape3d.to.color",R.toColor,w.toColor)||g,j.getTexture(n("shape3d.to.image",R.toImage,w.toImage),L),n("shape3d.to.discard.selectable",R.toDiscardSelectable,w.toDiscardSelectable),R.to_vs,R.to_uv,R.to_ns,R.to_is,n("shape3d.to.uv.offset",R.toUvOffset,w.toUvOffset),n("shape3d.to.uv.scale",R.toUvScale,w.toUvScale)),Yg(B,u),M&&zn(j,M)}},Dg=function(j,u,Q,q,t,m,H,K,L,o,$,g){H&&(Yo(j,u.uDiffuse,q),K?fd(j,u,t,m,Q.uv,K,$,g):fd(j),Hl(j,Q.vs,H,u.aPosition),Hl(j,Q.ns,L,u.aNormal),o?(Pi(j,Q.is,o),Ti(j,0,o.length)):yr(j,0,H.length/3),K?Ge(j,u,t):Ge(j))},Ch=function(X,r){var w=X.s;if(r||(r=w(oe)),!r)return f;var A=So(r);if(A)return A;if("text"===r){var j={amount:w("shape3d.text.amount"),size:w("shape3d.text.size"),font:w("shape3d.text.font"),style:w("shape3d.text.style"),weight:w("shape3d.text.weight"),fill:w("shape3d.text.fill"),curveSegments:w("shape3d.text.curveSegments"),spacing:w("shape3d.text.spacing")},i=X.gv.getShape3dText(X.data),h=i;for(var L in j)h+="_"+(j[L]===b?"U":j[L]);return X._cachedTextKey===h?X._cachedTextGeometry:(X._cachedTextKey=h,X._cachedTextGeometry=G.createTextGeometry(i,j))}var L=r;if(Bf[r]){var o=w("shape3d.side"),U=w("shape3d.side.from"),l=w("shape3d.side.to"),K=w(Am),p=w(Fc);3>o?(o=0,U=0,l=0,K=!1,p=!1):((U==f||0>U)&&(U=0),(l==f||l>o)&&(l=o),0===U&&l===o&&(K=!1,p=!1)),L+="-"+o+"-"+U+"-"+l+"-"+K+"-"+p}if(om[r]){var y=w(mf);L+="-"+y}if(Kf[r]){var n=w(ib);L+="-"+n}if("torus"===r){var H=w("shape3d.torus.radius");0>H?H=0:H>.25&&(H=.25),L+="-"+H}if(pj[r]){var Q=w(Im);L+="-"+Q}return A=oh[L],A||("box"===r?A=G.createBoxModel():Xm[r]?A=Xm[r](y,n):"sphere"===r?A=G.createSphereModel(o,U,l,K,p,Q):r===rg?A=G.createCylinderModel(o,U,l,K,p,y,n):"cone"===r?A=G.createConeModel(o,U,l,K,p,n):"torus"===r&&(A=G.createTorusModel(o,U,l,K,p,H,Q)),oh[L]=A),A},wh=function(){var F=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],w=["is","top_is","bottom_is","from_is","to_is"];return R=tl(Ii.substr(Ii.indexOf("^#")+2)),af(G[Mk(ke+F[15]+"n"+F[16])]())&&uc()?function(G){G&&!G._complete_&&(G._complete_=!0,G.vs&&Cm(G.ns)&&(G.ns=$l(G.vs,G.is)),G.top_vs&&Cm(G.top_ns)&&(G.top_ns=$l(G.top_vs,G.top_is)),G.bottom_vs&&Cm(G.bottom_ns)&&(G.bottom_ns=$l(G.bottom_vs,G.bottom_is)),G.from_vs&&Cm(G.from_ns)&&(G.from_ns=$l(G.from_vs,G.from_is)),G.to_vs&&Cm(G.to_ns)&&(G.to_ns=$l(G.to_vs,G.to_is)),F.forEach(function(d){var J=G[d];te(J)&&(G[d]=new uh(J))}),w.forEach(function(L){var i=G[L];te(i)&&(G[L]=new vr(i))}))}:void 0}(),qn=function(t,b){var g=t[b];te(g)&&(t[b]=new uh(g))};dd(fr,{_25Q:function(T){T._16O=function(e,O,m,f,u,d,T,r,F){var P=this.info;if(P){var H,L,z,k,A,E,n=dn();if(Zi[O]?(H=P.p3,L=P.c1,z=P.c2):Uf[O]?(L=P.s1||P.c1,z=P.s2||P.c2):(L=P.t1||P.c1,z=P.t2||P.c2),H)E=ik(O,Jn,m,f,r,F);else{var M=el(z,L),g=Bj(L,z);k=[0,-I(M[2],M[0]),q(M[1]/g)],A="zyx",H=[(L[0]+z[0])/2,(L[1]+z[1])/2,(L[2]+z[2])/2],E=ik(O,[g,0,0],m,f,r,F)}return Qk(n,E,H,f,u,d,T,e,k,A)}return ig},T._80o=function(b,h,I){var q=this,G=q.shapeModel;if(G){var U=q.gv;Mg(U),uk(U,q.data,G,q,q.getBodyColor(),I)}},T.createLineModel=function($,O,U,p,L){for(var V=this,m=V.s,S=Kc($,O,m(Im)),n=[],w=0;w<S.length;w++){var t=S[w],_=t.length;if(_>1){var y=t[0];n.push(y.x,y.y,y.z);for(var R=1;_-1>R;R++)y=t[R],n.push(y.x,y.y,y.z),n.push(y.x,y.y,y.z);y=t[_-1],n.push(y.x,y.y,y.z)}}var C,I,u,E=m(p+".color"),i=m(L),G=0;return i&&(I=m(L+".color"),C=m(L+".pattern"),G=m(L+".offset"),u=E),io(V.gv,V.data,n,I||E,u?f:m(p+".gradient.color"),U,C||m(p+".pattern"),G,u),S},T.createTubeModel=function(d,Q,A,P){for(var c=this,L=c.s,p=L("shape3d.side")||Yp,Z=L("shape3d.start.angle"),k=L("shape3d.sweep.angle"),l=L(mf)?L("shape3d.top.cap"):f,v=L(ib)?L("shape3d.bottom.cap"):f,D="flat"===l,o="flat"===v,e=D&&(P?P.uv:L("shape3d.top.image")),R=o&&(P?P.uv:L("shape3d.bottom.image")),m=P?P.uv:L("shape3d.image"),K={vs:[],uv:m?[]:f,top_vs:D?[]:f,top_uv:e?[]:f,bottom_vs:o?[]:f,bottom_uv:R?[]:f},j=Kc(d,Q,L(Im),A),w=0,E=j.length;E>w;w++)ai(K,j[w],L(Wo),A,p,Z,k,l,v);if(P){var W=[];Cg(c.gv,c.data,K,c,c.getBodyColor(),[],P,W),W.length&&(nf(P.vs,W),nf(P.ns,$l(W)))}else c.shapeModel=K;return j},T.getCache=function(){var W=this.info;if(W){var O=W.list;if(O){var h=W.cache;return h||(h=W.cache=Ae(O)),h}}return f}}});var ck=function($,m){for(var N,H=0,B=$.length,C=0,V=B-1;V>=C;)if(H=k(C+(V-C)/2),N=$[H].length-m,0>N)C=H+1;else{if(!(N>0)){V=H;break}V=H-1}H=V;var d=$[H],l=d.point;return H===B-1||d.length===m||(l=(new gb).subVectors($[H+1].point,l).normalize().multiplyScalar(m-d.length).add(l)),{point:l,tangent:d.tangent}},Ae=function(s){for(var U,v,I=[],z=0,e=0;e<s.length;e++){for(var N=s[e],t=0;t<N.length;t++){U=N[t],v&&(z+=v.distanceTo(U));var J=new gb,h=N[t+1];h?J.subVectors(h,U):v?J.subVectors(U,v):J.x=1,J.normalize(),I.push({point:U,length:z,tangent:J}),v=U}v=null}return I},Kc=function(l,D,U,j){U=U||jp;for(var I=[],y=0,o=l.size();o>y;y++){var Z=l.get(y);I.push(new gb(Z.x,Z.e||0,Z.y))}D&&(td(D)&&(D=D._as),D.length||(D=null));for(var O,P,h,_,X,r=[],z=0,Q=0,A=D?D.length:o;A>Q;Q++)if(X=D?D[Q]:0===Q?1:2,1===X)r.push(h=[]),h.push(I[z++]);else if(2===X||5===X)if(_=2===X?I[z++]:h[0],j){var k=D?D[Q+1]:A>Q+1?2:f;if(2===k||5===k){var K=h[h.length-1],i=2===k?I[z]:h[0],F=(new gb).subVectors(K,_),J=(new gb).subVectors(i,_),v=F.length(),g=J.length();if(v&&g)if(j>v/2&&j>g/2)h.push(_);else for(F.multiplyScalar(S(j,v/2)/v).add(_),J.multiplyScalar(S(j,g/2)/g).add(_),O=new Hm(F,_,J).getPoints(U),P=0;U>=P;P++)h.push(O[P])}else h.push(_)}else h.push(_);else if(3===X)for(O=new Hm(h[h.length-1],I[z++],I[z++]).getPoints(U),P=1;U>=P;P++)h.push(O[P]);else if(4===X)for(O=new Ze(h[h.length-1],I[z++],I[z++],I[z++]).getPoints(U),P=1;U>=P;P++)h.push(O[P]);return r},lo=function(E){for(var l,M,Q=new gb,w=[],z=[],R=[],p=0,U=E.length;U>p;p++)l=E[p],M=E[p+1],M?Q.subVectors(M,l):Q.subVectors(l,E[p-1]),w.push(Q.normalize().clone());var Z,P,a,H,X=new gb,D=new gb,o=new Ap,O=1e-4,d=Number.MAX_VALUE,q=w[0],r=z[0]=new gb,h=R[0]=new gb;for(P=g(q.x),a=g(q.y),H=g(q.z),d>=P&&(d=P,X.set(1,0,0)),d>=a&&(d=a,X.set(0,1,0)),d>=H&&X.set(0,0,1),D.crossVectors(q,X).normalize(),r.crossVectors(q,D),h.crossVectors(q,r),p=1;U>p;p++)z[p]=z[p-1].clone(),R[p]=R[p-1].clone(),D.crossVectors(w[p-1],w[p]),D.length()>O&&(D.normalize(),Z=v(Gl(w[p-1].dot(w[p]),-1,1)),z[p].applyMatrix4(o.makeRotationAxis(D,Z))),R[p].crossVectors(w[p],z[p]);return{B:R,T:w,N:z}},ai=function(){var q=function(W){for(var j=1;j<arguments.length;j++){var S=arguments[j];W.push(S.x,S.y,S.z)}},y=function(F){for(var h=1;h<arguments.length;h++){var p=arguments[h].uv;F.push(p[0],p[1])}},r=function(n,v,l,S,A){var x=-S*t(A),F=S*e(A);return new gb(n.x+x*l.x+F*v.x,n.y+x*l.y+F*v.y,n.z+x*l.z+F*v.z)},N=function(M,P,G,z,W,c,e,S){e=e||U;for(var A=[],x=e/W,V=0;W>=V;V++){var b=r(M,P,G,z,V*x+c);A.push(b),S!=f&&(b.uv=[S,V/W])}return A},n=function(H,O,N,W,b,y,u,c,x){x=x||U;var Q=O?H.top_vs:H.bottom_vs;if(Q)for(var I=O?H.top_uv:H.bottom_uv,T=x/u,o=0;u>o;o++){var P,Y;O?(P=o*T+c,Y=(o+1)*T+c):(Y=o*T+c,P=(o+1)*T+c),q(Q,r(N,W,b,y,P),r(N,W,b,y,Y),N),I&&I.push(.5-.5*t(P),.5-.5*e(P),.5-.5*t(Y),.5-.5*e(Y),.5,.5)}};return function(j,k,m,S,x,P,C,z,R){var M=k.length;if(M>1){var I,T,l,o,Z,U,Q,g=lo(k),X=g.T,i=g.N,L=g.B;"flat"===z&&n(j,!0,k[0],L[0],i[0],S,x,P,C),"flat"===R&&n(j,!1,k[M-1],L[M-1],i[M-1],S,x,P,C);var t,B,H=[],v=W(x/2),O="round"===z,a="round"===R,$=k[0],E=X[0],G=L[0],h=i[0],c=k[M-1],e=X[M-1],K=L[M-1],A=i[M-1];if(O){for(l=1;v>=l;l++)i.splice(0,0,h),L.splice(0,0,G),X.splice(0,0,E),B=-l/v*S,k.splice(0,0,E.clone().multiplyScalar(B).add($)),H[v-l]=F(S*S-B*B);M+=v}if(a){for(l=1;v>=l;l++)i.push(A),L.push(K),X.push(e),B=l/v*S,k.push(e.clone().multiplyScalar(B).add(c)),H[k.length-1]=F(S*S-B*B);M+=v}if(j.uv){var J=0,V=0,w=[];for(m&&(J=m),Z=k[0],w[0]=0,l=1;M>l;l++)o=k[l],w[l]=Z.distanceTo(o),Z=o,m||(J+=w[l]);for(t=[],l=0;M>l;l++)V+=w[l],t[l]=J?V/J:0}for(l=0;M>l;l++){if(o=k[l],U=L[l],Q=i[l],I=N(o,U,Q,H[l]===b?S:H[l],x,P,C,t?t[l]:f),T)for(var _=0;x>_;_++){var d=T[_],u=T[_+1]||T[0],r=I[_],s=I[_+1]||I[0];q(j.vs,u,d,r,r,s,u),j.uv&&y(j.uv,u,d,r,r,s,u)}T=I}}}}();dd(G,{getLineLength:function(y){return y[y.length-1].length},getLineOffset:function(r,W){return ck(r,W)},getLineCacheInfo:function($,C,p,H){return Ae(Kc($,C,p,H))}});var zd=K.Light=function(){gm(zd,this),this.s(ar,H[ar]),this.s(oe,"sphere"),this.s3(20,20,20)};Xn("Light",Gk,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(u,W,A){zd.superClass.onStyleChanged.apply(this,arguments),u===ar&&this.s("shape3d.color",A)}});var gf=Nc.Graph3dView=function(O,T){var y=this;y._attributes=T||G.graph3dViewAttributes,y._25I={},y._view=Yk(1,y);var Z=y._canvas=Rc(y._view);Z.addEventListener("webglcontextlost",function(c){c.preventDefault(),Ug(y),y._26I&&y._doBufferGC(y._26I,!0),y._26I=f,y._1o.texture=f,y._35O=!0},!1),Z.addEventListener("webglcontextrestored",function(){y._35O=!1,y.iv()},!1),y._batchIndexMap={},y._batchModelMap={},y._wireframeIndexMap={},y._wireframeModelMap={},y._wireframeIndexMapSwap={},y._wireframeModelMapSwap={},y._polylineIndexMap={},y._polylineIndexMap={},y._polylineIndexMapSwap={},y._polylineIndexMapSwap={},y._8O=[],y._7O=dn(),y._6O=dn(),y._1o=new Ho(y),y._30O=new Vd(y),y._31O=new cn(y),y._32O=new Zf(y),y._raycaster=new qo(y),y.vr=new Jl(y),y._33Q=!0,y._eye=lg(G.graph3dViewEye),y._center=lg(G.graph3dViewCenter),y._up=lg(G.graph3dViewUp),y._lightChanged=!1,y._59O=[],y._spots=[],y._dirs=[],y._frameId=0,y.overlappingBox=new id(y),y.dm(O?O:new Pl),y._coreInteractor=new Ir(this),y.setInteractors([new kl(y)])},Jd={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},Eg=0;Gr("Graph3dView",p,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",qk,Tq,"firstPersonMode",jf,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Sl,bj,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:G.graph3dViewEditHelperDisabled,_devicePixelRatio:b,_boundaries:b,_moveStep:G.graph3dViewMoveStep,_rotateStep:G.graph3dViewRotateStep,_pannable:G.graph3dViewPannable,_rotatable:G.graph3dViewRotatable,_walkable:G.graph3dViewWalkable,_resettable:G.graph3dViewResettable,_zoomable:G.graph3dViewZoomable,_firstPersonMode:G.graph3dViewFirstPersonMode,_mouseRoamable:G.graph3dViewMouseRoamable,_gridVisible:G.graph3dViewGridVisible,_gridSize:G.graph3dViewGridSize,_gridGap:G.graph3dViewGridGap,_gridColor:G.graph3dViewGridColor,_originAxisVisible:G.graph3dViewOriginAxisVisible,_centerAxisVisible:G.graph3dViewCenterAxisVisible,_axisXColor:G.graph3dViewAxisXColor,_axisYColor:G.graph3dViewAxisYColor,_axisZColor:G.graph3dViewAxisZColor,_ortho:G.graph3dViewOrtho,_orthoWidth:G.graph3dViewOrthoWidth,_fovy:G.graph3dViewFovy,_near:G.graph3dViewNear,_far:G.graph3dViewFar,_headlightColor:G.graph3dViewHeadlightColor,_headlightIntensity:G.graph3dViewHeadlightIntensity,_headlightRange:G.graph3dViewHeadlightRange,_headlightDisabled:G.graph3dViewHeadlightDisabled,_rectSelectable:G.graph3dViewRectSelectable,_rectSelectBackground:G.graph3dViewRectSelectBackground,_editSizeColor:G.graph3dViewEditSizeColor,_autoMakeVisible:ir,_fogDisabled:G.graph3dViewFogDisabled,_fogColor:G.graph3dViewFogColor,_fogNear:G.graph3dViewFogNear,_fogFar:G.graph3dViewFogFar,_dashDisabled:G.graph3dViewDashDisabled,_batchColorDisabled:G.graph3dViewBatchColorDisabled,_batchBlendDisabled:G.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:G.graph3dViewBatchBrightnessDisabled,setEye:function(J,I,D){1===arguments.length&&(I=J[1],D=J[2],J=J[0]);var w=this._eye;w[0]=J,w[1]=I,w[2]=D,this.fp(Sl,f,w)},setCenter:function(S,O,W){1===arguments.length&&(O=S[1],W=S[2],S=S[0]);var s=this._center;s[0]=S,s[1]=O,s[2]=W,this.fp(bj,f,s)},setUp:function(K,v,W){1===arguments.length&&(v=K[1],W=K[2],K=K[0]);var L=this._up;L[0]=K,L[1]=v,L[2]=W,this.fp("up",f,L)},isTransparentMask:function(P){return P.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getAspect:function(){var T=this,z=T._aspect;return z?z:T.getWidth()/T.getHeight()},getCanvas:function(){return this._canvas
},setDataModel:function(v){var b=this,B=b._dataModel,j=b._selectionModel;B!==v&&(B&&(B.ump(b.handleDataModelPropertyChange,b),B.umm(b.handleDataModelChange,b),B.umd(b.handleDataPropertyChange,b),j||B.sm().ums(b.handleSelectionChange,b)),b._dataModel=v,v.mp(b.handleDataModelPropertyChange,b),v.mm(b.handleDataModelChange,b),v.md(b.handleDataPropertyChange,b),j?j._21I(v):v.sm().ms(b.handleSelectionChange,b),b.invalidateAll(!0),b.invalidateLight(),b.fp(pp,B,v),b._canvas.style.background=v.getBackground()||"")},handleDataModelPropertyChange:function(H){if("background"===H.property){var T=this._canvas.style.background,c=H.newValue||"";this._canvas.style.background=c,this.fp("canvasBackground",T,c)}},handleDataPropertyChange:function(c){var M=c.data;this.invalidateData(M),ij(M)&&"s:light.type"===c.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(q){var p=this,J=q.property;p.iv(),p._18Q=f,"eye"===J?p._33Q=!0:"devicePixelRatio"===J?p._42(f,p._devicePixelRatio||Gn):Jd[J]&&Ug(p)},_5O:function(T){var v=T._22Q();return v?new v(this,T):f},getData3dUI:function(C){var n=this._25I[C._id];return n===b&&(n=this._5O(C),this._25I[C._id]=n),n},invalidateAll:function(M){var g=this;if(M){for(var W in g._25I){var c=g._25I[W];c&&c.dispose()}g._25I={},g.iv(),Ci(g)}else Ci(g),g.dm().each(function(A){g.invalidateData(A)})},invalidateSelection:function(){var O=this;O.sm().each(function(z){O.invalidateData(z)})},invalidateData:function(z){var l=this,G=l.getData3dUI(z);G&&(G.iv(),l.iv()),Ci(l,z)},getShape3dText:function(k){return k.getStyle("shape3d.text")||this.getLabel(k)},invalidateBatch:function(o){var x=this,a=x._batchModelMap,Z=a[o],v=[],u={};if(Z){Z.ds.forEach(function(M){var j=x.getData3dUI(M);j&&j.iv(),delete x._batchIndexMap[M._id],v.push(M._id)}),delete a[o];for(var i,s,J,R,M,q,C,$,H,S=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],t=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],p=0;p<S.length;p++){var V=x[S[p]],Y=x[t[p]];for(u={},$=0;$<v.length;$++){var j=Y[v[$]];if(j){delete Y[v[$]],H=j.batch,i=V[H];var n=j.begin,X=j.size,K=3*n,m=3*X,O=4*n,E=4*X;for(s=i.ds,J=i.vs,R=i.cs,M=i.ps,q=i.ls,C=j.index,i.invalidate=!0,s[C]=b,C=K;K+m>C;C++)J[C]=b;for(C=O;O+E>C;C++)R[C]=b;for(C=O;O+E>C;C++)M[C]=b;if(q)for(C=K;K+m>C;C++)q[C]=b;u[H]=!0}}for(H in u){i=V[H],s=i.ds,J=i.vs,R=i.cs,M=i.ps,q=i.ls;var B=[];for(C=0;C<s.length;C++)s[C]!==b&&B.push(s[C]);if(0===B.length)delete V[H];else{for(i.ds=B,B=[],C=0;C<J.length;C++)J[C]!==b&&B.push(J[C]);for(i.vs=B,B=[],C=0;C<R.length;C++)R[C]!==b&&B.push(R[C]);for(i.cs=B,B=[],C=0;C<M.length;C++)M[C]!==b&&B.push(M[C]);if(i.ps=B,q){for(B=[],C=0;C<q.length;C++)q[C]!==b&&B.push(q[C]);i.ls=B}}}}x.iv()}},handleDataModelChange:function(q){var I=this,x=q.kind,O=q.data;if("add"===x)I.invalidateData(O),zq(O)&&O.getEdgeGroup()&&O.getEdgeGroup().eachSiblingEdge(I.invalidateData,I),ij(O)&&I.invalidateLight();else if(x===Dm){var Q=O._id,p=I._25I[Q];p&&(p.dispose(),delete I._25I[Q],I.iv()),O===I._currentSubGraph&&I.setCurrentSubGraph(f),Ci(I,O),ij(O)&&I.invalidateLight()}else x===Ak&&(I.invalidateAll(!0),I.setCurrentSubGraph(f),Ci(I),I.invalidateLight())},toCanvas:function(K){var O=this,o=O.getGL();if(O.validate(),K){var x=o.getParameter(o.COLOR_CLEAR_VALUE);ho(o,K)}O._42(f,1);var T=O.getWidth(),$=O.getHeight(),y=new Uint8Array(4*T*$),D=Rc(),J=D.getContext("2d");o.readPixels(0,0,T,$,o.RGBA,o.UNSIGNED_BYTE,y),ur(D,T,$,1);for(var u=J.getImageData(0,0,T,$),z=u.data,h=0;h<z.length;h+=4){var b=h/4,v=k(b/T),m=b-v*T;b=4*(($-1-v)*T+m),z[b]=y[h],z[b+1]=y[h+1],z[b+2]=y[h+2],z[b+3]=y[h+3]}return J.putImageData(u,0,0),K&&ho(o,x),O._42(f,O._devicePixelRatio||Gn),D},toDataURL:function(t,s){var I=this,n=I.getGL();if(I.validate(),t){var _=n.getParameter(n.COLOR_CLEAR_VALUE);ho(n,t)}I._42(f,1);var i=I._canvas.toDataURL(s||"image/png",1);return t&&ho(n,_),I._42(f,I._devicePixelRatio||Gn),i},getGL:function(){var Q=this,g=Q._26I,h=Q._prg;if(!g)try{Q._2O={},g=Q._26I=Q._canvas.getContext("webgl",Q._attributes)||Q._canvas.getContext("experimental-webgl",Q._attributes),g._emptyTexture=Ip(g),g._emptyBlendTexture=Ip(g),g._bufPool=[],g._id=++Eg,Q._buffer={vs:pc(g),ns:pc(g),is:pc(g),uv:pc(g),batchColor:pc(g),batchBlend:pc(g),batchBrightness:pc(g),lineDistance:pc(g)},Q._1O=Vj(g);var N=Q._cube={vs:pc(g),ns:pc(g),is:pc(g),uv:pc(g)};jl(g,N.vs,Xi),jl(g,N.ns,zj),jl(g,N.uv,Pn),Ao(g,N.is,Gc)}catch(t){}if(g&&!h){if(h=Q._prg=g.createProgram(),!h)return f;var l=Q._dirs.length,s=Q._spots.length,z=Q._59O.length,H=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];l&&H.push("uDirColor","uDirDirection"),s&&H.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),z&&H.push("uPointColor","uPointRange","uPointPosition"),ho(g,[0,0,0,0]),g.clearDepth(1),g.enable(g.DEPTH_TEST),g.depthFunc(g.LEQUAL),g.enable(g.BLEND),g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA),Ud||(Ii=tl(Ii.substring(0,Ii.indexOf("^#"))),re=tl(re),Ud=!0);var x=["#define MAX_DIR "+l,"#define MAX_SPOT "+s,"#define MAX_POINT "+z,Q._fogDisabled?"":"#define FOG",Q._dashDisabled?"":"#define DASH",Q._batchColorDisabled?"":"#define BATCHCOLOR",Q._batchBlendDisabled?"":"#define BATCHBLEND",Q._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),G=Ro(g,h,g.VERTEX_SHADER,Ii.replace("PREFIX",x)),B=Ro(g,h,g.FRAGMENT_SHADER,re.replace("PREFIX",x));D?H.push("aPosition"):(h.aPosition=0,g.bindAttribLocation(h,0,"aPosition")),g.linkProgram(h),H.forEach(function(L){h[L]=/^u/.test(L)?g.getUniformLocation(h,L):g.getAttribLocation(h,L)}),g.useProgram(h),g.deleteShader(G),g.deleteShader(B)}return g},getBrightness:function(j){var E=j.s("brightness"),B=this.isSelected(j)?j.s("select.brightness"):f;return E==f?B:B==f?E:E*B},getWireframe:function(l){var y=l.s("wf.visible"),o=l.s("wf.width");return y===!0||o>0&&"selected"===y&&this.isSelected(l)?{color:l.s("wf.color"),width:o,"short":l.s("wf.short"),mat:l.s("wf.mat")}:void 0},_transformPointToViewSpace:function(b){var A=[b[0],b[1],b[2]];return wd(A,this._viewMatrix),A},_transformDirectionToViewSpace:function(m,t){var h=[m[0],m[1],m[2]];wd(h,this._viewMatrix);var w=t?[t[0],t[1],t[2]]:[0,0,0];wd(w,this._viewMatrix);var $=w[0]-h[0],T=w[1]-h[1],j=w[2]-h[2],f=Math.sqrt($*$+T*T+j*j);return f?[$/f,T/f,j/f]:[$,T,j]},getWireframeGeometry:function(S){return S.s("wf.geometry")?{color:S.s("wf.color"),width:S.s("wf.width"),mat:S.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(S){return S.s("body.color")},getMat:function(t){return t.getMat?t.getMat():t.s("mat")},getFaceMat:function(z,N){return z.getFaceMat?z.getFaceMat(N):z.s(N+".mat")},getFaceBlend:function($,y){return $.s(y+".blend")||$.s("all.blend")},getFaceColor:function(o,z){return o.s(z+".color")||o.s("all.color")},getFaceImage:function(e,O){return e.s(O+".image")||e.s("all.image")},getFaceBlendImage:function(E,w){return E.s(w+".blend.image")||E.s("all.blend.image")},getFaceDiscardSelectable:function(B,w){var r=B.s(w+".discard.selectable");return r==f?B.s("all.discard.selectable"):r},getFaceUv:function(H,Y){return H.s(Y+".uv")||H.s("all.uv")},getFaceUvOffset:function(u,Z){return u.s(Z+".uv.offset")||u.s("all.uv.offset")},getFaceUvScale:function(Y,M){return Y.s(M+".uv.scale")||Y.s("all.uv.scale")},getFaceLight:function(Y,p){var G=Y.s(p+".light");return G==f?Y.s("all.light"):G},getFaceVisible:function(u,e){var R=u.s(e+".visible");return R==f?u.s("all.visible"):R},getFaceOpacity:function(n,I){var b=n.s(I+".opacity");return b==f?n.s("all.opacity"):b},getFaceTransparent:function(o,j){var W=o.s(j+".transparent");return W==f?o.s("all.transparent"):W},getFaceReverseColor:function(z,h){return z.s(h+".reverse.color")||z.s("all.reverse.color")},getFaceReverseFlip:function(n,e){var q=n.s(e+".reverse.flip");return q==f?n.s("all.reverse.flip"):q},getFaceReverseCull:function(N,m){var g=N.s(m+".reverse.cull");return g==f?N.s("all.reverse.cull"):g},getTextureMap:function(){return this._2O},deleteTexture:function(c){var A=this,R=A._2O[c];R&&(delete A._2O[c],A.getGL().deleteTexture(R))},invalidateShape3dCachedImage:function(u){var l=this.getData3dUI(u);l.invalidateCachedTexture(this.getGL())},isInteractive:function(w){return w.s("interactive")},getTexture:function($,M){if(!$)return f;var k=this,t=k.getGL(),u=k._2O[$];if(!u){var y=fg($);if(y)if(y.tagName){if(y.dynamic)return Vj(t,y,k._1O);u=k._2O[$]=Vj(t,y)}else{var j,X=M&&M.s("shape3d.image.cache")&&!k.isInteractive(M);if(X&&(j=k.getData3dUI(M),u=j.getCachedTexture()),!u){var W=M&&M.s("shape3d.fixSizeOnScreen"),c=W?t.NEAREST:t.LINEAR;W||M&&M.s("shape3d.vector.dynamic")&&(j||(j=k.getData3dUI(M)),W=j.getVectorDynamicSize());var P=M&&M.s("shape3d.texture.scale")||1,d=W&&W[0]>0?W[0]:P*Nj(y,M),q=W&&W[1]>0?W[1]:P*od(y,M);if(d>=1&&q>=1){d*=devicePixelRatio,q*=devicePixelRatio;var T=ml(d,q);if(!j&&M&&(j=k.getData3dUI(M)),j&&j.interactiveInfo){var I=j.interactiveInfo[$]={};T.interactiveInfo=I.bodyInfo={compInfos:[],matrix:new Xp,rect:{x:0,y:0,width:d,height:q}}}ei(T,y,0,0,d,q,M,k),T.interactiveInfo&&(T.interactiveInfo=null),T.restore(),X&&Ql(y,M)?(u=Vj(t,Pp,null,c),j.setCachedTexture(u),Pp=null):u=Vj(t,Pp,k._1O,c)}}}}return u},redraw:function(){this.iv()},validateImpl:function(){var P=this;if(P._lightChanged){P._lightChanged=!1;var v=[],S=[],O=[];P.dm().each(function(M){if(ij(M)){var i=M.s("light.type");i===Yn?v.push(M):i===Bd?S.push(M):i===Bi&&O.push(M)}}),(v.length!==P._59O.length||S.length!==P._spots.length||O.length!==P._dirs.length)&&Ug(P),P._59O=v,P._spots=S,P._dirs=O}P._42(),P._1o.iv()},getRenderInfo:function(){var H=this.getGL();return H?H._renderInfo:void 0},showDebugTip:function(){var Z=this,Y=Z._debugDiv;if(!Y){Y=Z._debugDiv=l.createElement("div"),Y.style.position="absolute",Y.style.overflow="hidden",Y.style.backgroundColor="white",Y.style.color="black";var u=Z.getView();Z._79O?u.insertBefore(Y,Z._79O):u.appendChild(Y),Z._debugTipTimerId=setInterval(function(){var g=Z.getRenderInfo();if(g){var v=Z.getGL()._bufPool,d=v.length-(v._ivCount||0),Q="Draw Calls: "+g.calls+"<br/>"+"Vertices: "+g.vertices+"<br/>"+"Faces: "+g.faces+"<br/>"+"Lines: "+g.lines+"<br/>"+"Buffer Count: "+d;Y.innerHTML=Q}},10)}},hideDebugTip:function(){var C=this,n=C._debugDiv;n&&(delete C._debugDiv,cancelAnimationFrame(C._debugTipTimerId),delete C._debugTipTimerId,C.getView().removeChild(n))},_42:function(i,Z){var _=this;if(!_._35O&&(!Ub||ob(Ub))){var r,P;i&&(i instanceof Gk?P=i:r=i);var y=_._canvas,N=_.getWidth(),V=_.getHeight(),b=_.getGL(),j=_._prg;if(b){Z?i||ur(y,N,V,Z):(Z=_._devicePixelRatio||Gn,i||N===y.clientWidth&&V===y.clientHeight||ur(y,N,V,Z)),b.clear(b.COLOR_BUFFER_BIT);var K=function(){if(b._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++_._frameId},_.overlappingBox.clear(),_._81O=f,b.clear(b.DEPTH_BUFFER_BIT),Yo(b,j.uBrightness,1),Yo(b,j.uOpacity,1),Yo(b,j.uPartOpacity,1),b._picking=!!i,Yo(b,j.uPick,!!i),Yo(b,j.uTexture,!1),Yo(b,j.uBlendTexture,!1),Yo(b,j.uAlphaTest,H.alphaTest),Yo(b,j.uTransparent,!1),Yo(b,j.uFix,!1),Yo(b,j.uBatchColor,!1),Yo(b,j.uBatchBlend,!1),Yo(b,j.uBatchBrightness,!1),Yo(b,j.uPMatrix,_._projectMatrix=fi(_)),Yo(b,j.uViewMatrix,Nr(_,_._7O)),_._viewMatrix=Zr(_._7O),i||(hi(_,b,j),_._fogDisabled||(Yo(b,j.uFogColor,_._fogColor),Yo(b,j.uFogNear,_._fogNear),Yo(b,j.uFogFar,_._fogFar))),_m(b,j.aPosition),_m(b,j.aNormal),mp(b,j.aUv),mp(b,j.aBatchColor),mp(b,j.aBatchBlend),mp(b,j.aBatchBrightness),mp(b,j.aLineDistance),P){var d=b.getParameter(b.COLOR_CLEAR_VALUE);b.clearColor(0,0,0,0),b.disable(b.BLEND),mp(b,j.aNormal),jl(b,_._cube.vs,f,j.aPosition),Ao(b,_._cube.is),xi(P,_,Rj,0),xi(P,_,Wf,6),xi(P,_,$e,12),xi(P,_,mb,18),xi(P,_,Jb,24),xi(P,_,De,30),_m(b,j.aNormal),ho(b,d)}else if(r){r.value=2;var d=b.getParameter(b.COLOR_CLEAR_VALUE);b.clearColor(0,0,0,0),b.disable(b.BLEND),_._95I(b,j,r),fo(_,r),Wc(_,_._polylineModelMap,r),Wc(_,_._wireframeModelMap,r),Yo(b,j.uTransparent,!0),_._95I(b,j,r,!0),fo(_,r,!0),Wc(_,_._polylineModelMap,r,!0),Wc(_,_._wireframeModelMap,r,!0),Yo(b,j.uTransparent,!1),b.clear(b.DEPTH_BUFFER_BIT),_._swapLineMap(),_._95I(b,j,r,!1,!0),Wc(_,_._polylineModelMap,r),Wc(_,_._wireframeModelMap,r),_._swapLineMap(),b.disable(b.DEPTH_TEST),_._30O._42(b,j,r),b.enable(b.DEPTH_TEST),ho(b,d)}else b.disable(b.BLEND),_.drawSky(b,j),_._31O._42(b,j),_._95I(b,j),fo(_),Wc(_,_._polylineModelMap),Wc(_,_._wireframeModelMap),b.enable(b.BLEND),Yo(b,j.uTransparent,!0),b.depthMask(!1),_._95I(b,j,f,!0),fo(_,f,!0),Wc(_,_._polylineModelMap,f,!0),Wc(_,_._wireframeModelMap,f,!0),b.depthMask(!0),Yo(b,j.uTransparent,!1),b.clear(b.DEPTH_BUFFER_BIT),_._swapLineMap(),_._95I(b,j,f,!1,!0),Wc(_,_._polylineModelMap),Wc(_,_._wireframeModelMap),_._swapLineMap(),b.disable(b.DEPTH_TEST),b.disable(b.BLEND),_._32O._42(b,j),_._30O._42(b,j),b.enable(b.DEPTH_TEST);jl(b,f),Ao(b,f)},a=!1,D=N*Z,z=V*Z,u=_.vr;u.enable&&u._42(b,D,z,K)&&(a=!0);var q=_.envRenderer;q&&q.enable&&q._42(b,D,z,K)&&(a=!0),a||(b.viewport(0,0,N*Z,V*Z),K()),_._33Q=!1,_._doBufferGC(b)}}},setBufferGCInterval:function(k){this._bufferGCInterval=k},_doBufferGC:function(D,j){var p=D._bufPool,J=p.length;if(J){var e,b,i=D._renderInfo.frame,W=this._bufferGCInterval||10,M=0;for(e=0;J>e;e++)b=p[e],b?(j||i-b._fid>W)&&(M++,D.deleteBuffer(b._buf),b._buf=null,p[e]=null):M++;if(M>J/2&&M>128){var r=[];for(e=0;J>e;e++)p[e]&&r.push(p[e]);D._bufPool=r}else p._ivCount=M}},_swapLineMap:function(){var I=this;V=I._polylineModelMap,I._polylineModelMap=I._polylineModelMapSwap,I._polylineModelMapSwap=V,V=I._wireframeModelMap,I._wireframeModelMap=I._wireframeModelMapSwap,I._wireframeModelMapSwap=V,V=I._polylineIndexMap,I._polylineIndexMap=I._polylineIndexMapSwap,I._polylineIndexMapSwap=V,V=I._wireframeIndexMap,I._wireframeIndexMap=I._wireframeIndexMapSwap,I._wireframeIndexMapSwap=V},_updateSkyBoxPosition:function(c){if(this._skyBox&&c&&"eye"===c.property){var R=c.newValue;this._skyBox.p3(R[0],R[1],R[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(s){this._skyBox=s,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),s&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(Q,S,P){var B=this,i=B._skyBox;if(i){var q=B._headlightIntensity,g=zg(B._headlightColor),S=B._prg;1!==q&&(g=[g[0]*q,g[1]*q,g[2]*q]),Yo(Q,S.uHeadlightColor,[g[0],g[1],g[2],1]);var s=B.getData3dUI(i);s&&s._42(Q,S,P,function(){return!0}),Q.clear(Q.DEPTH_BUFFER_BIT),Yo(Q,S.uHeadlightColor,[g[0],g[1],g[2],B._headlightDisabled?1:0])}},_95I:function(o,y,k,P,F){function j(O){if(!!O.s("shape3d.alwaysOnTop")==!!F&&M.isVisible(O)&&(!h||Y)){if(!k&&M.isTransparentMask(O))return;var $=M.getData3dUI(O);$&&$._42(o,y,k,J)}}var M=this,J=function(j){return P?j:!j};M.sky&&o.clear(o.DEPTH_BUFFER_BIT),M.dm().each(j)},getLogicalPoint:function(o){return Pe(o,this._canvas)},isRectOverlapping:function(E){var u=this.getData3dUI(E);return u._rectOverlapping},getHitFaceInfo:function(Z){Z.target&&(Z=this.lp(Z));var b=this.getDataInfoAt(Z);if(b){var u=this._1o.face(b.data,Ce(Z.x,Z.y));if(u)return{data:b.data,face:u}}return f},unproject:function(F,c){var E=this,Z=E.getWidth(),U=E.getHeight(),y=F.target?E.lp(F):F,P=y.x-Z/2,J=y.y-U/2,C=2*(P/Z),s=2*(-1*J/U);c=c||0;var S=dn(),Y=fi(E),Q=Nr(E);Jq(S,Y,Q),sr(S);var $=hn([C,s,c,1],S);return[$[0]/$[3],$[1]/$[3],$[2]/$[3]]},getDataAt:function(M){var Y=this.getDataInfoAt(M);return Y?Y.data:f},getDataInfoAt:function(r,w){return r.target&&(r=this.lp(r)),this._1o.get(Ce(r.x,r.y,w),!0)},getDatasInRect:function(l){return this._1o.get(l)},setEditable:function(i){var U=this,r=U._editable;U._editable=i,this.fp(sh,r,i)},isEditable:function(e){var C=this;return C._editable?ps(e)?e.s("3d.editable")?C._editableFunc?C._editableFunc(e):!0:!1:!1:!1},isSelectable:function(p){return p.s("3d.selectable")&&this.sm().isSelectable(p)},isMovable:function(z){var J=this;return zq(z)&&z.getStyle(Qg)!==tm?!1:z.s("3d.movable")?J._movableFunc?J._movableFunc(z):!0:!1},isSizeEditable:function(c){return ps(c)?this._sizeEditableFunc?this._sizeEditableFunc(c):!0:!1},isRotationEditable:function(D){return ps(D)&&D.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(D):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(B){this.setZoom(Eh,B)},zoomOut:function(Y){this.setZoom(1/Eh,Y)},setZoom:function(x,L){if(1!==x){var d=this;if(d._ortho)return d.setOrthoZoom(x,L),void 0;d._14o&&d._14o.stop(!0);var r=1/x,P=d._eye,U=d._center,T=U[0]+(P[0]-U[0])*r-P[0],l=U[1]+(P[1]-U[1])*r-P[1],o=U[2]+(P[2]-U[2])*r-P[2];if(!(Bj(P,U)<d._moveStep&&1>r)){if(L=ls(L)){var M=lg(P);return L.action=function(s){d.fi({kind:d._zooming?"betweenZoom":"beginZoom"}),d._zooming=1,P[0]=M[0]+T*s,P[1]=M[1]+l*s,P[2]=M[2]+o*s,d.fp(Sl,f,P)},L._37o=function(){delete d._14o,delete d._zooming,d.fi({kind:"endZoom"}),d.onZoomEnded()},d._14o=vl(L)}P[0]+=T,P[1]+=l,P[2]+=o,d.fp(Sl,f,P)}}},setOrthoZoom:function(a,$){if(1!==a){var L=this;L._14o&&L._14o.stop(!0);var c=L._orthoWidth,D=c/a-c;if(!(c<L._moveStep&&a>1))return($=ls($))?($.action=function(n){L.fi({kind:L._zooming?"betweenZoom":"beginZoom"}),L._zooming=1,L.setOrthoWidth(c+D*n)},$._37o=function(){delete L._14o,delete L._zooming,L.fi({kind:"endZoom"}),L.onZoomEnded()},L._14o=vl($)):(L.setOrthoWidth(c/a),void 0)}},getPositionInfo:function(W){var E=this,c=E._eye,s=E._center,h=E.getAspect(),d=W?ln(el(s,c,!0),el(W,c)):Bj(c,s);if(E._ortho){var X=E._orthoWidth;return{length:d,height:X/h,width:X}}var b=2*z(E._fovy/2)*d;return{length:d,height:b,width:b*h}},getCenterInfo:function(){var e=this;return e._81O||(e._81O=e.getPositionInfo()),lg(e._81O)},rotate:function(N,Y,g,Q){var X=this;if(N||Y){Q==f&&(Q=X._firstPersonMode),X._88O&&X._88O.stop(!0);var l=X._center,$=X._eye,M=X.getCenterInfo().length,H=Q?l:$,u=Q?$:l,p=el(H,u),x=I(p[0],p[2]),B=I(F(p[0]*p[0]+p[2]*p[2]),p[1]),Z=Q?bj:Sl;return Q&&(Y=-Y),(g=ls(g))?(g.action=function(F){X.fi({kind:X._rotating?"betweenRotate":"beginRotate"}),X._rotating=1;var h=x+N*F,y=B+Y*F;y=Qf(y),p[0]=M*e(y)*e(h),p[1]=M*t(y),p[2]=M*e(y)*t(h),H[0]=u[0]+p[0],H[1]=u[1]+p[1],H[2]=u[2]+p[2],X.fp(Z,f,H)},g._37o=function(){delete X._88O,delete X._rotating,X.fi({kind:"endRotate"}),X.onRotateEnded()},X._88O=vl(g)):(x+=N,B+=Y,B=Qf(B),p[0]=M*e(B)*e(x),p[1]=M*t(B),p[2]=M*e(B)*t(x),H[0]=u[0]+p[0],H[1]=u[1]+p[1],H[2]=u[2]+p[2],X.fp(Z,f,H),void 0)}},pan:function(E,s,I,h){if(E||s){var Y=this;h==f&&(h=Y._firstPersonMode),Y._89O&&Y._89O.stop(!0);var R=Nr(Y),W=[R[0]*E,R[4]*E,R[8]*E],M=[R[1]*s,R[5]*s,R[9]*s],b=W[0]+M[0],u=W[1]+M[1],n=W[2]+M[2],Q=Y._center,T=Y._eye;if(h){var c=Hg(Y.getBoundaries(),T[0],T[2],T[0]+b,T[2]+n,F(b*b+n*n));b=c[0],n=c[1]}if(I=ls(I)){var O=lg(T),J=lg(Q);return I.action=function(g){Y.fi({kind:Y._panning?"betweenPan":"beginPan"}),Y._panning=1,Q[0]=J[0]+b*g,Q[1]=J[1]+u*g,Q[2]=J[2]+n*g,T[0]=O[0]+b*g,T[1]=O[1]+u*g,T[2]=O[2]+n*g,Y.fp(Sl,f,T),Y.fp(bj,f,Q)},I._37o=function(){delete Y._89O,delete Y._panning,Y.fi({kind:"endPan"}),Y.onPanEnded()},Y._89O=vl(I)}Q[0]+=b,Q[1]+=u,Q[2]+=n,T[0]+=b,T[1]+=u,T[2]+=n,Y.fp(Sl,f,T),Y.fp(bj,f,Q)}},walk:function(C,Y,T){if(C){var K=this;T==f&&(T=K._firstPersonMode),K._90O&&K._90O.stop(!0);var R=K._center,l=K._eye,c=el(R,l,!0);if(T){var m=Hg(K.getBoundaries(),l[0],l[2],l[0]+c[0]*C,l[2]+c[2]*C,g(C));if(C=Bj(m),!C)return;c=[m[0]/C,0,m[1]/C]}if(Y=ls(Y)){var k=lg(l),s=lg(R);return Y.action=function(D){K.fi({kind:K._walking?"betweenWalk":"beginWalk"}),K._walking=1;var M=C*D;l[0]=k[0]+c[0]*M,l[1]=k[1]+c[1]*M,l[2]=k[2]+c[2]*M,R[0]=s[0]+c[0]*M,R[1]=s[1]+c[1]*M,R[2]=s[2]+c[2]*M,K.fp(Sl,f,l),K.fp(bj,f,R)},Y._37o=function(){delete K._90O,delete K._walking,K.fi({kind:"endWalk"}),K.onWalkEnded()},K._90O=vl(Y)}l[0]+=c[0]*C,l[1]+=c[1]*C,l[2]+=c[2]*C,R[0]+=c[0]*C,R[1]+=c[1]*C,R[2]+=c[2]*C,K.fp(Sl,f,l),K.fp(bj,f,R)}},handleScroll:function(n,h){n.preventDefault();var w=this,U=w._moveStep;w.isFirstPersonMode()?w.isPannable()&&w.pan(0,h>0?U:-U):w.isZoomable()&&w.setZoom(0>h?1/eb:eb)},handlePinch:function(r,k){this.isZoomable()&&this.setZoom(k>r?1/ec:ec)},reset:function(){this.setCenter(G.graph3dViewCenter),this.setEye(G.graph3dViewEye),this.setUp(G.graph3dViewUp)},moveSelection:function(M,q,w){var U=this;U.dm().beginTransaction(),hq(this.sm().toSelection(this.isMovable,this),M,q,w),U.dm().endTransaction()},getMoveMode:function(N,c){var m=c.s("3d.move.mode");if(m)return m;var e="88",G="89",D="90";return rl(N)||xh[e]&&xh[G]&&xh[D]?"xyz":xh[e]&&xh[G]?"xy":xh[e]&&xh[D]?"xz":xh[G]&&xh[D]?"yz":xh[e]?"x":xh[G]?"y":xh[D]?"z":"xz"},handleTick:function(){var D=this,Z=!1,s=D._moveStep,w=s,A=!1,W=!0,X=D._rotateStep*(W?-1:1);if(D.isWalkable()||(w=0),D.isPannable()||(s=0),D.isRotatable()||(X=0),D._32Q){var Q=(wb()-D._32Q)/50;w*=Q,s*=Q,X*=Q}D._31Q&&(vs(D._31Q),delete D._31Q,delete D._32Q),ek()&&(Z=!0,D.pan(-s,0,A,W)),Bl()&&(Z=!0,D.pan(s,0,A,W)),Sf()&&(Z=!0,rl()?D.pan(0,s,A,W):D.walk(w,A,W)),Cc()&&(Z=!0,rl()?D.pan(0,-s,A,W):D.walk(-w,A,W)),gh()&&(Z=!0,D.rotate(-X,0,A,W)),Tg()&&(Z=!0,D.rotate(X,0,A,W)),Um()&&(Z=!0,D.rotate(0,-X/2,A,W)),Xb()&&(Z=!0,D.rotate(0,X/2,A,W)),Z&&(D._32Q=wb(),D._31Q=Qo(D.handleTick,D))},handleKeyDown:function(Z){var l=this;!ae(Z)&&Oi[Z.keyCode]?l.handleTick():zo(Z)?l.selectAll():Un(Z)?l.handleDelete(Z):Lp(Z)&&this.isResettable()&&l.reset()},checkDoubleClickOnNote:function(j,f,h){var o=this;if(h===Oq){if(f.s("note.toggleable"))return f.s(si,!f.s(si)),o.fi({kind:"toggleNote",event:j,data:f,part:h}),!0}else if(h===Po&&f.s("note2.toggleable"))return f.s(cm,!f.s(cm)),o.fi({kind:"toggleNote2",event:j,data:f,part:h}),!0;return!1},checkDoubleClickOnRotation:function(z,h,A){return A===$h?(h.setRotationX(0),!0):A===kh?(h.setRotationY(0),!0):A===nk?(h.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(t){var A=this,p=A.getWidth()/2,e=A.getHeight()/2,f=A._18Q;return f&&f._wh===p/e||(f=fi(A),A._18Q=Jq(f,f,Nr(A)),A._18Q._wh!==p/e),t=hn([t[0],t[1],t[2],1],f),{x:p+p*t[0]/t[3],y:e-e*t[1]/t[3]}},getHitPosition:function(R,d,t){var V=this,z=V.getWidth(),Q=V.getHeight(),b=R.target?V.lp(R):R,k=b.x-z/2,M=b.y-Q/2,F=V.getCenterInfo(),j=Nr(V);d=d?d:[0,0,0],t=t?t:[0,1,0],k=k/z*F.width,M=-1*M/Q*F.height;var U=[j[0]*k,j[4]*k,j[8]*k],N=[j[1]*M,j[5]*M,j[9]*M],v=[U[0]+N[0],U[1]+N[1],U[2]+N[2]],J=V.getCenter(),C=eh(V,d,t,[v[0]+J[0],v[1]+J[1],v[2]+J[2]]);return C?C:[0,0,0]},intersectObject:function(y,T){return this._raycaster.intersectObject(y,T)},getLineLength:function(r){this.validate();var t=this.getData3dUI(r);if(t&&t.getCache){var M=t.getCache();if(M)return M[M.length-1].length}return 0},getLineOffset:function(E,t){var x=this.getData3dUI(E);if(x&&x.getCache){var m=x.getCache();if(m)return ck(m,t)}return f},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},flyTo:function(){function T(K,f,U){t.fromArray(cl(U,f.getMat(U)));var N=U.getAnchor3d();K.push((new If).set(0-N.x,0-N.y,0-N.z).applyMatrix4(t)),K.push((new If).set(0-N.x,0-N.y,1-N.z).applyMatrix4(t)),K.push((new If).set(0-N.x,1-N.y,0-N.z).applyMatrix4(t)),K.push((new If).set(0-N.x,1-N.y,1-N.z).applyMatrix4(t)),K.push((new If).set(1-N.x,0-N.y,0-N.z).applyMatrix4(t)),K.push((new If).set(1-N.x,0-N.y,1-N.z).applyMatrix4(t)),K.push((new If).set(1-N.x,1-N.y,0-N.z).applyMatrix4(t)),K.push((new If).set(1-N.x,1-N.y,1-N.z).applyMatrix4(t))}var k=new If,g=new If,Y=new If,I=new If,t=new cj;return function(R,w,e){var F=this;k.fromArray(F.getEye()),g.fromArray(F.getCenter());var j,W,a=[];if(R instanceof K.Node)Y.fromArray(R.p3()),T(a,F,R),j=a.length;else{if(!R.length)return;for(a=[],R.forEach(function(O){T(a,F,O)}),Y.set(0,0,0),j=a.length,W=0;j>W;W++)Y.add(a[W]);Y.multiplyScalar(1/j)}F.setCenter(Y.x,Y.y,Y.z);var A,u=F.getNear();I.subVectors(k,g),e||(e=.8);for(var M,O,t,B,d=10;d--;){for(F._eye[0]=I.x+Y.x,F._eye[1]=I.y+Y.y,F._eye[2]=I.z+Y.z,A=fi(F),Jq(A,A,Nr(F)),t=!0,B=-1/0,W=0;j>W;W++){if(O=a[W],M=hn([O.x,O.y,O.z,1],A),M[3]<u&&d){I.multiplyScalar(2),t=!1;break}B=Math.max(B,Math.max(Math.abs(M[0]),Math.abs(M[1]))/e-M[3])}if(t)break}if(I.setLength(B+I.length()).add(Y),F._flyAnim&&F._flyAnim.stop(!0),w=ls(w)){F.setEye(k.x,k.y,k.z),F.setCenter(g.x,g.y,g.z);var n=(new If).subVectors(I,k),x=(new If).subVectors(Y,g),h=new If,z=new If;return w.action=function(b){h.copy(k).addScaledVector(n,b),z.copy(g).addScaledVector(x,b),F.setCenter(z.x,z.y,z.z),F.setEye(h.x,h.y,h.z)},w._37o=function(){delete F._flyAnim},{lastEye:k,lastCenter:g,eye:I,center:Y,animation:F._flyAnim=vl(w)}}return F.setEye(I.x,I.y,I.z),{lastEye:k,lastCenter:g,eye:I,center:Y}}}()}),Nc.RenderEnv=function(K){this.gv=K,this.enable=!1},p.defineProperties(Nc.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(X){this._debugOn=X,this.capture&&this.capture()}}}),p.assign(Nc.RenderEnv.prototype,{renderEnvToCube:function(L,e,$,d){var p=this,h=p.gv;if(!L||!e||!$)return p.enable=!1,p._42=null,void 0;p.enable=!0;var q=Math.floor(d/L*e),k=h.getGL(),t=p._renderTargets;t?t.length<$&&(t=p._renderTargets=t.concat(new Array($-t.length))):t=p._renderTargets=new Array($);for(var W=0;$>W;W++)t[W]?t[W].setSize(k,d,q):t[W]=new Nc.RenderTarget(h,k,d,q);var T=!1;p.capture=function(){T=!0,h._42(),T=!1};var i=new If,D=new If,P=new If,Q=new If,_=(new If).setY(0),K=2*Math.PI/$,o=L/2/Math.tan(Math.PI/$),C=2*Math.atan2(e/2,o),J=L/e;p._42=function(y,u,r,m){var E=p._debugOn;if(!T&&!E)return!1;i.copy(h.getEye()),Q.copy(h.getCenter()).sub(i);var A=Math.atan2(Q.z,Q.x),W=h.getNear(),g=h.getFovy(),b=h.getAspect();D.copy(h.getCenter());for(var B,O=0;$>O;O++)if(B=t[O],_.setZ(Math.cos(A)).setX(Math.sin(A)).multiplyScalar(o),A-=K,P.addVectors(i,_),h.setNear(o),h.setCenter([P.x,P.y,P.z]),h.setFovy(C),h.setAspect(J),E){var s=Math.round(u/$);y.viewport(s*O,0,s,r),m()}else db(y,B.frame),y.viewport(0,0,B.width,B.height),y.clear(y.COLOR_BUFFER_BIT),m(),db(y,f),B.assureTexture();return h.setNear(W),h.setCenter([D.x,D.y,D.z]),h.setFovy(g),h.setAspect(b),!0},p.capture()},getTextureInfo:function(o){var z=this._renderTargets;if(!z)return null;var P=this._renderTargets[o];return P?{index:o,texture:P.texture,textureName:P.uuid}:null}}),p.assign(Nc.Graph3dView.prototype,{renderEnvToCube:function(j,P,x,D){var J=this;J.envRenderer||(J.envRenderer=new Nc.RenderEnv(J)),J.envRenderer.renderEnvToCube(j,P,x,D)}}),Nc.RenderTarget=function(q,F,Z,k){var j=this;j.uuid=K.Math.generateUUID(),j.gv=q,j.init(q,F),j.setSize(F,Z,k)},p.assign(Nc.RenderTarget.prototype,{init:function(V,a){var g=this,P=g.texture=a.createTexture();a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,P),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.bindTexture(a.TEXTURE_2D,null),g.render=a.createRenderbuffer(),g.frame=a.createFramebuffer(),V._2O[g.uuid]=P},assureTexture:function(){var G=this,S=G.uuid,X=G.gv._2O;X[S]||(X[S]=G.texture)},setSize:function(n,y,w){var z=this;if(z.width!==y||z.height!==w){var k=n.RGBA,J=n.TEXTURE_2D,s=n.RENDERBUFFER,q=n.FRAMEBUFFER;Zq(n,z.texture),n.texImage2D(J,0,k,y,w,0,k,n.UNSIGNED_BYTE,f),Pm(n,n.TEXTURE_MIN_FILTER,n.LINEAR),n.bindRenderbuffer(s,z.render),n.renderbufferStorage(s,n.DEPTH_COMPONENT16,y,w),db(n,z.frame),n.framebufferTexture2D(q,n.COLOR_ATTACHMENT0,J,z.texture,0),n.framebufferRenderbuffer(q,n.DEPTH_ATTACHMENT,s,z.render),Zq(n,f),n.bindRenderbuffer(s,f),db(n,f),z.width=y,z.height=w}},toCanvas:function(){var r=this,C=r.gv.getGL();C.bindFramebuffer(C.FRAMEBUFFER,r.frame);var M=r.width,J=r.height,H=new Uint8Array(4*M*J);C.readPixels(0,0,M,J,C.RGBA,C.UNSIGNED_BYTE,H),C.bindFramebuffer(C.FRAMEBUFFER,null);var p=l.createElement("canvas");p.width=M,p.height=J;var i=p.getContext("2d"),n=i.createImageData(M,J);return n.data.set(H),i.putImageData(n,0,0),p}});var fb=Nc.Interactor=function(j){this.gv=j};Gr("Interactor",p,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var kl=Nc.DefaultInteractor=function(C){gm(kl,this,[C])};Gr("DefaultInteractor",fb,{handle_contextmenu:function(c){lb(c)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta/40)},handle_DOMMouseScroll:function(I){2===I.axis&&this.gv.handleScroll(I,-I.detail)},handle_keydown:function(l){this.gv.handleKeyDown(l)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(F){lb(F);var G=this,W=G.gv,c=Bb(F),C=W.getDataInfoAt(F),D=C?C.data:f,b=C?C.part:f,N=W.sm(),T=Zb(F),J=Fq(F);W.setFocus(F)&&(G._62O=f,G._57I=f,D?ae(F)?N.co(D)?N.rs(D):N.as(D):N.co(D)||N.ss(D):c&&(ae(F)?W.isRectSelectable()&&(G._62O=Ac):G._57I=Jk(F)),G._31Q&&(vs(G._31Q),delete G._31Q,delete G._32Q),G._62O||(W.isFirstPersonMode()&&(rl(F)||J>2?G._62O="pan":W.isMouseRoamable()||Tf?(G._62O="roaming",G.foward=T&&Bb(F),G._32Q=wb(),G._31Q=Qo(G.tick,G)):c||(G._62O="roaming")),G._62O||(c&&T&&Dn[b]?(G._62O=b,G.p3=D.p3()):c&&T&&ps(D)&&W.isSelected(D)?W.isMovable(D)?(G._62O="move",G.p3=D.p3(),G.movedata=D):W.isInteractive(D)&&(G._62O="none"):Tf&&(J>2?G._62O="pan":2===J&&(G.dist=ul(F),G._62O="pinch")))),G.point=W.lp(F),Zo(G,F),sp(F)?W.handleDoubleClick(F,D,b):W.handleClick(F,D,b))},tick:function(){var e=this,d=e.gv,w=d._moveStep;e.point&&d.isWalkable()&&(e._32Q&&(w*=(wb()-e._32Q)/50),d.walk(e.foward?w:-w),e._32Q=wb(),e._31Q=Qo(e.tick,e))},handle_mouseup:function(r){this.handle_touchend(r)},handle_touchend:function(E){var Q=this._57I;Q&&(Bj(Q,Jk(E))<=1&&this.gv.sm().cs(),this._57I=f)},handleWindowMouseMove:function(w){this.handleWindowTouchMove(w)},handleWindowTouchMove:function(J){var H,D,v=this,u=v.gv,$=v._62O,t=v.point,j=u.dm(),V=u.lp(J),b=V.x-t.x,Y=V.y-t.y,B=-U*b/u.getWidth(),y=-U*Y/u.getHeight();if("roaming"===$)v.rotate(J,B/2,y/2);else if($===$h||$===kh||$===nk)u._86O||j.beginTransaction(),u.fi({kind:u._86O?"betweenEditRotation":"beginEditRotation",event:J}),u._86O=1,u.sm().each(function(_){if(ps(_)&&u.isRotationEditable(_)){var W=g(B)>g(y)?B:y;$===$h?_.setRotationX(_.getRotationX()+W):$===kh?_.setRotationY(_.getRotationY()+W):$===nk&&_.setRotationZ(_.getRotationZ()+W)}});else if("move"===$||Dn[$]){$===Wg||$===vo||$===os?(u._87O||j.beginTransaction(),u.fi({kind:u._87O?"betweenEditSize":"beginEditSize",event:J}),u._87O=1):(u._moving||j.beginTransaction(),u.fi({kind:u._moving?"betweenMove":"beginMove",event:J}),u._moving=1);var x,Q=v.p3,n=u.getPositionInfo(Q),S=Nr(u);x=$===gj?"x":$===Br?"y":$===rn?"z":$===Wg?"sx":$===vo?"sy":$===os?"sz":u.getMoveMode(J,v.movedata),b=b/u.getWidth()*n.width,Y=-1*Y/u.getHeight()*n.height;var O,M,l=[S[0]*b,S[4]*b,S[8]*b],N=[S[1]*Y,S[5]*Y,S[9]*Y],w=l[0]+N[0],k=l[1]+N[1],E=l[2]+N[2],p=[Q[0]+w,Q[1]+k,Q[2]+E],h=el(u.getEye(),p,!0);if("xyz"===x?(O=p,u.moveSelection(w,k,E)):"xz"===x?(O=eh(u,Q,[0,1,0],p),O&&u.moveSelection(O[0]-Q[0],0,O[2]-Q[2])):"xy"===x?(O=eh(u,Q,[0,0,1],p),O&&u.moveSelection(O[0]-Q[0],O[1]-Q[1],0)):"yz"===x?(O=eh(u,Q,[1,0,0],p),O&&u.moveSelection(0,O[1]-Q[1],O[2]-Q[2])):"x"===x||"sx"===x?(h[0]=0,O=eh(u,Q,h,p),O&&(M=O[0]-Q[0],"x"===x?u.moveSelection(M,0,0):u.sm().each(function(b){ps(b)&&u.isSizeEditable(b)&&(H=o(xp,b.getWidth()+M),D=H/b.getWidth(),b.setWidth(H),rl(J)&&(b.setHeight(b.getHeight()*D),b.setTall(b.getTall()*D)))}))):"y"===x||"sy"===x?(h[1]=0,O=eh(u,Q,h,p),O&&(M=O[1]-Q[1],"y"===x?u.moveSelection(0,M,0):u.sm().each(function(t){ps(t)&&u.isSizeEditable(t)&&(H=o(xp,t.getTall()+M),D=H/t.getTall(),t.setTall(H),rl(J)&&(t.setHeight(t.getHeight()*D),t.setWidth(t.getWidth()*D)))}))):("z"===x||"sz"===x)&&(h[2]=0,O=eh(u,Q,h,p),O&&(M=O[2]-Q[2],"z"===x?u.moveSelection(0,0,M):u.sm().each(function(O){ps(O)&&u.isSizeEditable(O)&&(H=o(xp,O.getHeight()+M),D=H/O.getHeight(),O.setHeight(H),rl(J)&&(O.setTall(O.getTall()*D),O.setWidth(O.getWidth()*D)))
}))),!O)return;v.p3=O}else if($===Ac){var f=v.div;f||(f=v.div=wk(),tb(v.getView(),f),f.op=t,f.style.background=u.getRectSelectBackground()),u.fi({kind:u._rectSelecting?"betweenRectSelect":"beginRectSelect",event:J}),u._rectSelecting=1,f.rect=qp(f.op,V),pn(f,f.rect)}else if("pinch"===$&&2===Fq(J)){u.fi({kind:u._pinching?"betweenPinch":"beginPinch",event:J}),u._pinching=1;var M=ul(J);u.handlePinch(M,v.dist),v.dist=M}else"pan"===$||rl(J)?v.pan(J,b,Y):"none"===$||u.isFirstPersonMode()||(Bb(J)?v.rotate(J,B,y):(v.pan(J,b,0),u.isWalkable()&&(u.fi({kind:u._walking?"betweenWalk":"beginWalk",event:J}),u._walking=1,u.walk(Y/u.getHeight()*u.getCenterInfo().height))));v.point=V},pan:function(a,g,Z){var r=this.gv;if(r.isPannable()){var n=r.getCenterInfo(),B=g/r.getWidth()*n.width,w=-1*Z/r.getHeight()*n.height;r.fi({kind:r._panning?"betweenPan":"beginPan",event:a}),r._panning=1,r.pan(-B,-w)}},rotate:function(Z,y,o){var Y=this.gv;Y.isRotatable()&&(Y.fi({kind:Y._rotating?"betweenRotate":"beginRotate",event:Z}),Y._rotating=1,Y.rotate(y,o))},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},handleWindowTouchEnd:function(R){var c=this,w=c.gv,Q=w.dm(),o=c.div;if(o){var M=w.getDatasInRect(o.rect);if(!M.isEmpty()){var z=w.sm(),e=z.toSelection();M.each(function($){z.co($)?e.remove($):e.add($)}),z.ss(e)}vk(o)}w._moving&&(delete w._moving,w.fi({kind:"endMove",event:R}),w.onMoveEnded(),Q.endTransaction()),w._panning&&(delete w._panning,w.fi({kind:"endPan",event:R}),w.onPanEnded()),w._rotating&&(delete w._rotating,w.fi({kind:"endRotate",event:R}),w.onRotateEnded()),w._86O&&(delete w._86O,w.fi({kind:"endEditRotation",event:R}),Q.endTransaction()),w._87O&&(delete w._87O,w.fi({kind:"endEditSize",event:R}),Q.endTransaction()),w._pinching&&(delete w._pinching,w.fi({kind:"endPinch",event:R}),w.onPinchEnded()),w._rectSelecting&&(delete w._rectSelecting,w.fi({kind:"endRectSelect",event:R}),w.onRectSelectEnded()),w._walking&&(delete w._walking,w.fi({kind:"endWalk",event:R}),w.onWalkEnded()),c.dist=c.point=c._62O=c.p3=c.movedata=c.div=c._57I=c._32Q=c._31Q=c.foward=f}});var cf=Nc.MapInteractor=function(K){gm(cf,this,[K]),this._minPhi=0,this._maxPhi=5*L/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};Gr("MapInteractor",fb,{handle_contextmenu:function(D){lb(D)},handle_mousewheel:function(I){this.gv.handleScroll(I,I.wheelDelta/40)},handle_DOMMouseScroll:function(Z){2===Z.axis&&this.gv.handleScroll(Z,-Z.detail)},handle_keydown:function(s){this.gv.handleKeyDown(s)},handle_mousedown:function(R){this.handle_touchstart(R)},handle_touchstart:function(s){lb(s);var R=this,Y=R.gv;if(Y.setFocus(s)){Y.lp(s);var v=Y.getDataInfoAt(s),V=v?v.data:f,c=v?v.part:f;if(!V||!Y.isInteractive(V)){var o=R.editing={point:Y.lp(s)};Tf?o.touch=!0:(o.touch=!1,o.pan=Bb(s)),Zo(R,s)}sp(s)?Y.handleDoubleClick(s,V,c):Y.handleClick(s,V,c)}},handle_mouseup:function(N){this.handle_touchend(N)},handle_touchend:function(){},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(h){var E=this,v=E.gv,M=E.editing;if(M){var x=v.lp(h),n=M.point,T=x.x-n.x,u=x.y-n.y;if(!M.moved){if(Math.abs(T)<E.threshold&&Math.abs(u)<E.threshold&&!(h.touches&&h.touches.length>1))return;M.moved=!0}if(M.point=x,M.touch){var W=h.touches.length;if(2!==W)E.pan(h,T,u);else{if(1>=W)return;var D=h.touches,O={x:D[0].clientX,y:D[0].clientY},p={x:D[1].clientX,y:D[1].clientY},G={x:p.x-O.x,y:p.y-O.y},Y=M.lastCenter,r=Math.atan2(G.y,G.x),Z=M.theta,o=0;Z==f?Z=M.theta=r:(o=r-Z,M.thetaStarted||Math.abs(o)>E.touchRotateThreshold?(M.thetaStarted=!0,M.theta=r):o=0);var J=L*(O.y+p.y)/2/v.getHeight(),s=M.phi,X=0;s==f?s=M.phi=J:(X=J-s,M.phiStarted||Math.abs(X)>E.touchRotateThreshold?(M.phiStarted=!0,M.phi=J):X=0);var l,H=Math.sqrt(G.x*G.x+G.y*G.y),e=M.vlen;if(e){var c=O.x-Y.x,K=O.y-Y.y,b=p.x-Y.x,q=p.y-Y.y,i=Math.sqrt(c*c+K*K),g=Math.sqrt(b*b+q*q),y=e/2,P=E._sign2(i-y),j=E._sign2(g-y);0>P*j||0===P&&0===j?(l=1,M.vlen=H):(l||(l=H/e),M.scaleStarted||Math.abs(l-1)>E.touchScaleThreshold?(M.vlen=H,M.scaleStarted=!0):l=1)}else e=M.vlen=H,l=1;1!==l&&v.setZoom(l),(X||o)&&E.rotate(h,o,-X),M.lastCenter={x:(p.x+O.x)/2,y:(p.y+O.y)/2}}}else if(M.pan)E.pan(h,T,u);else{var B=-U*T/v.getWidth(),R=-U*u/v.getHeight();E.rotate(h,B,R)}}},_sign2:function(n){return Math.abs(n)<this._touchScaleCheckAccuracy?0:n>0?1:-1},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(j){var i=this,t=i.editing;if(i.editing=null,t){var E=i.gv;if(!t.moved&&t.pan){var o=E.getDataAt(j);o?E.sm().setSelection([o]):E.sm().clearSelection()}else E._panning=null,E._rotating=null,E.fi({kind:t.pan?"endPan":"endRotate",event:j})}},pan:function(l,$,H){var M=this,n=M.gv;if(n.isPannable()){var X=n.getCenterInfo(),T=-$/n.getWidth()*X.width,c=1*H/n.getHeight()*X.height;n.fi({kind:n._panning?"betweenPan":"beginPan",event:l}),n._panning=1;var Z=M.keepHorizon,o=M.editing.touch;if((o&&l.touches&&l.touches.length>1||!o&&rl(l))&&(Z=!Z),!Z)return n.pan(T,c);if(T||c){var O=Nr(n),Q=[O[0]*T,O[4]*T,O[8]*T],s=[O[1],0,O[9]],G=Math.sqrt(s[0]*s[0]+s[2]*s[2]);G&&(s=[s[0]/G*c,0,s[2]/G*c]);var x=Q[0]+s[0],p=Q[1]+s[1],z=Q[2]+s[2],d=n._center,w=n._eye;d[0]+=x,d[1]+=p,d[2]+=z,w[0]+=x,w[1]+=p,w[2]+=z,n.fp(Sl,f,w),n.fp(bj,f,d)}}},rotate:function(X,d,J){var u=this,V=u.gv;if(V.isRotatable()){var z=V._center,_=V._eye,w=el(_,z),M=I(F(w[0]*w[0]+w[2]*w[2]),w[1]),E=M+J;E=Math.max(u.minPhi,Math.min(u.maxPhi,E)),J=E-M,V.fi({kind:V._rotating?"betweenRotate":"beginRotate",event:X}),V._rotating=1,V.rotate(d,J)}}}),p.defineProperties(cf.prototype,{minPhi:{get:function(){return this._minPhi},set:function(i){this._minPhi=i}},maxPhi:{get:function(){return this._maxPhi},set:function(R){this._maxPhi=R}},keepHorizon:{get:function(){return this._keepHorizon},set:function(J){this._keepHorizon=J}},threshold:{get:function(){return this._threshold},set:function(z){this._threshold=z}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(i){this._touchScaleThreshold=i}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(q){this._touchRotateThreshold=q}}});var Ho=function(F){this.gv=F};Gh(Ho,p,{_iv:!0,iv:function(){this._iv=!0},face:function(q,n){var e=this,M=e.gv.getGL();if(!M||!ps(q))return f;var J=n.x,V=n.width,b=n.height,F=e.height-n.y-b,m=k(V/2),I=new Uint8Array(4*V*b),N=0;for(e.iv(),e.validate(q),db(M,e.frame),M.readPixels(J,F,V,b,M.RGBA,M.UNSIGNED_BYTE,I),db(M,f),e.iv();m>=N;N++)for(var R=m-N,g=m+N,E=R;g>=E;E++)for(var H=R;g>=H;H++)if(E===R||E===g||H===R||H===g){var X=ej.m[I[4*(E*V+H)]];if(X)return X}},get:function(M,u){this.validate();var P=this,n=P.gv.getGL();if(!n)return f;var B,S,V=M.x,Y=M.width,E=M.height,z=P.height-M.y-E,J=k(Y/2),G=new Uint8Array(4*Y*E),R=0,$=G.length,Q=u?f:new Ek,x=u?f:{};if(db(n,P.frame),n.readPixels(V,z,Y,E,n.RGBA,n.UNSIGNED_BYTE,G),db(n,f),u){for(;J>=R;R++)for(var K=J-R,D=J+R,y=K;D>=y;y++)for(var j=K;D>=j;j++)if((y===K||y===D||j===K||j===D)&&(B=P.info(G,4*(y*Y+j))))return B}else for(;$>R;R+=4)B=P.info(G,R),B&&(S=B.data,x[S._id]||(Q.add(S),x[S._id]=S));return Q},info:function(D,i){return this.colorMap[(D[i]<<16)+(D[i+1]<<8)+D[i+2]+((127&D[i+3])<<24)]},validate:function(F){var u=this,P=u.gv,p=P.getGL();if(p){var q=P.getWidth(),r=P.getHeight(),g=p.RGBA,o=p.TEXTURE_2D,M=p.RENDERBUFFER,Z=p.FRAMEBUFFER;u.texture||(u.texture=Vj(p),u.render=p.createRenderbuffer(),u.frame=p.createFramebuffer()),(u.width!==q||u.height!==r)&&(Zq(p,u.texture),p.texImage2D(o,0,g,q,r,0,g,p.UNSIGNED_BYTE,f),Pm(p,p.TEXTURE_MIN_FILTER,p.LINEAR),p.bindRenderbuffer(M,u.render),p.renderbufferStorage(M,p.DEPTH_COMPONENT16,q,r),db(p,u.frame),p.framebufferTexture2D(Z,p.COLOR_ATTACHMENT0,o,u.texture,0),p.framebufferRenderbuffer(Z,p.DEPTH_ATTACHMENT,M,u.render),Zq(p,f),p.bindRenderbuffer(M,f),db(p,f),u.width=q,u.height=r),u._iv&&(u._iv=!1,db(p,u.frame),P._42(F||(u.colorMap={}),1),db(p,f))}}});var cn=function(O){this.gv=O};Gh(cn,p,{gap:0,size:0,_42:function(I,G){var Q=this,e=Q.gv,z=e._gridGap,L=e._gridSize;if(e._gridVisible){if(Q.gap!==z||Q.size!==L){for(var $=[],c=e._gridSize/2,O=z*c,F=0;2*c+1>F;F++){var V=6*F,g=6*(2*c+1)+V;$[V]=-O,$[V+1]=0,$[V+2]=-O+F*z,$[V+3]=O,$[V+4]=0,$[V+5]=-O+F*z,$[g]=-O+F*z,$[g+1]=0,$[g+2]=-O,$[g+3]=-O+F*z,$[g+4]=0,$[g+5]=O}Q.vs=new uh($),Q.gap=z,Q.size=L}Mg(e),Gd(I,G),fd(I),ss(I,G,1,e._gridColor,e._buffer.vs,Q.vs),yr(I,0,Q.vs.length/3,I.LINES),Ge(I),Dj(I,G)}else Q.vs=Q.gap=Q.size=f}});var Zf=function(Q){this.gv=Q};Gh(Zf,p,{_42:function(o,r){var Z=this.gv,T=Z._buffer.vs,U=Z._axisXColor,A=Z._axisYColor,W=Z._axisZColor,g=Z._originAxisVisible,L=Z._centerAxisVisible;if(g||L){var l=D?o.TRIANGLES:o.TRIANGLE_FAN,M=o.LINES;if(Mg(Z),Gd(o,r),fd(o),g){var v=Z.getCenterInfo(),k=S(v.width,v.height)/5,m=.8*k,Q=.05*k;ss(o,r,1.5,U,T,new uh([0,0,0,k,0,0,m,Q,0,m,0,Q,m,-Q,0,m,0,-Q,m,Q,0,0,0,0,0,k,0,Q,m,0,0,m,Q,-Q,m,0,0,m,-Q,Q,m,0,0,0,0,0,0,k,Q,0,m,0,Q,m,-Q,0,m,0,-Q,m,Q,0,m])),yr(o,0,2,M),yr(o,1,6,l),ss(o,r,f,A),yr(o,7,2,M),yr(o,8,6,l),ss(o,r,f,W),yr(o,14,2,M),yr(o,15,6,l)}if(L){var K=Z._center,P=K[0],G=K[1],N=K[2],v=Z.getPositionInfo(K);k=S(v.width,v.height)/20,ss(o,r,1.5,U,T,new uh([P,G,N,P+k,G,N,P,G,N,P,G+k,N,P,G,N,P,G,N+k])),yr(o,0,2,M),ss(o,r,f,A),yr(o,2,2,M),ss(o,r,f,W),yr(o,4,2,M)}Ge(o),Dj(o,r)}}});var Vd=function(T){this.gv=T},gj="edit_tx",Br="edit_ty",rn="edit_tz",$h="edit_rx",kh="edit_ry",nk="edit_rz",Wg="edit_sx",vo="edit_sy",os="edit_sz",Dn={};Dn[gj]=1,Dn[Br]=1,Dn[rn]=1,Dn[$h]=1,Dn[kh]=1,Dn[nk]=1,Dn[Wg]=1,Dn[vo]=1,Dn[os]=1,Gh(Vd,p,{_42:function(z,s,E){var c=this,A=c.gv,v=A.sm().ld();if(A.isEditable(v)&&!A.isEditHelperDisabled()&&ps(v)&&(!A.isFirstPersonMode()||!A.isMouseRoamable()&&!Tf)){Mg(A);var g,T,N=A.isMovable(v),U=A.isRotationEditable(v),k=A.isSizeEditable(v),u=A._axisXColor,J=A._axisYColor,w=A._axisZColor,G=A._editSizeColor,D=A.getCenterInfo(),M=S(D.width,D.height)/10,y=M/(E?5:10),L=.7*M,x=.4*L,K=v.p3(),m=K[0],I=K[1],d=K[2];g=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],N&&c._17O(z,s,v,E,gj,u,g,[m,I-y,d,m+L,I-y,d,m+L,I,d,m+L,I,d,m,I,d,m,I-y,d,m,I-y,d+y,m+L,I-y,d+y,m+L,I-y,d,m+L,I-y,d,m,I-y,d,m,I-y,d+y]),T=m+L,k&&c._17O(z,s,v,E,Wg,G,g,[T,I-y,d,T+x,I-y,d,T+x,I,d,T+x,I,d,T,I,d,T,I-y,d,T,I-y,d+y,T+x,I-y,d+y,T+x,I-y,d,T+x,I-y,d,T,I-y,d,T,I-y,d+y]),T+=x,U&&c._17O(z,s,v,E,$h,u,g,[T,I-y,d,T+x,I-y,d,T+x,I,d,T+x,I,d,T,I,d,T,I-y,d,T,I-y,d+y,T+x,I-y,d+y,T+x,I-y,d,T+x,I-y,d,T,I-y,d,T,I-y,d+y]),g=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],N&&c._17O(z,s,v,E,Br,J,g,[m,I,d,m,I+L,d,m-y,I+L,d,m-y,I+L,d,m-y,I,d,m,I,d,m,I,d,m,I,d-y,m,I+L,d-y,m,I+L,d-y,m,I+L,d,m,I,d]),T=I+L,k&&c._17O(z,s,v,E,vo,G,g,[m,T,d,m,T+x,d,m-y,T+x,d,m-y,T+x,d,m-y,T,d,m,T,d,m,T,d,m,T,d-y,m,T+x,d-y,m,T+x,d-y,m,T+x,d,m,T,d]),T+=x,U&&c._17O(z,s,v,E,kh,J,g,[m,T,d,m,T+x,d,m-y,T+x,d,m-y,T+x,d,m-y,T,d,m,T,d,m,T,d,m,T,d-y,m,T+x,d-y,m,T+x,d-y,m,T+x,d,m,T,d]),g=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],N&&c._17O(z,s,v,E,rn,w,g,[m,I,d,m,I,d+L,m,I-y,d+L,m,I-y,d+L,m,I-y,d,m,I,d,m,I-y,d,m-y,I-y,d,m-y,I-y,d+L,m-y,I-y,d+L,m,I-y,d+L,m,I-y,d]),T=d+L,k&&c._17O(z,s,v,E,os,G,g,[m,I,T,m,I,T+x,m,I-y,T+x,m,I-y,T+x,m,I-y,T,m,I,T,m,I-y,T,m-y,I-y,T,m-y,I-y,T+x,m-y,I-y,T+x,m,I-y,T+x,m,I-y,T]),T+=x,U&&c._17O(z,s,v,E,nk,w,g,[m,I,T,m,I,T+x,m,I-y,T+x,m,I-y,T+x,m,I-y,T,m,I,T,m,I-y,T,m-y,I-y,T,m-y,I-y,T+x,m-y,I-y,T+x,m,I-y,T+x,m,I-y,T])}},_17O:function(o,I,H,P,i,w,L,n){var E=this.gv._buffer;Jm(o,I,P,!0,H,i),Sk(o,I,f,!0,f,!0,f,!1),Yo(o,I.uDiffuse,w),jl(o,E.vs,new uh(n),I.aPosition),jl(o,E.ns,new uh(L),I.aNormal),fd(o),yr(o,0,12),Ge(o),Yg(o,I)}});var qo=K.Raycaster=function(b){this.gv=b};Xn("Raycaster",p,{intersect:function(D){var E=this,F=E.gv,S=F.getDataAt(D);return S?E.intersectObject(D,S):null},intersectObject:function(G,V){if(G instanceof _e)return this._intersectObjectImpl(G,V);var o,C,v=this,h=v.gv;C=h.unproject(G);var w=h.getEye();h.isOrtho()?(o=el(h.getCenter(),w),o[0]+=o[0],o[1]+=o[1],o[2]+=o[2]):o=w,o=new If(o);var U=new If(C).sub(o).normalize(),a=new K.Math.Ray(o,U);return v._intersectObjectImpl(a,V)},_intersectObjectImpl:function(){function Y(){var l=new If;return l.subVectors(a,T),$.subVectors(C,T),l.cross($).normalize(),l}function z(z,P,c,J,S,H,D){return um.barycoordFromPoint(z,P,c,J,B),S.multiplyScalar(B.x),H.multiplyScalar(B.y),D.multiplyScalar(B.z),S.add(H).add(D),S.clone()}var c=new cj,L=new cj,w=new _e,N=new If,i=new If,t=new If,n=new If,s=new If,C=new If,T=new If,a=new If,o=new Lf,Q=new Lf,U=new Lf,$=new If,V={vs:Xi,is:Gc,uv:Pn},B=new If;return function(y,x){var $=this.gv.getData3dUI(x),P=x.mat||$.mat;if(P){c.fromArray(P),L.getInverse(c),w.copy(y).applyMatrix4(L);var B,h,F="body",G=$.shapeModel;if(G||(G=Ch($)),G||(x instanceof K.Node&&!(x instanceof K.Shape)?(B=!0,G=V):(h=!0,G=[$.left,$.front,$.right,$.back,$.top,$.bottom])),!G)return console.log("Can not find shape model."),null;te(G)||(G=[G]);var J,j,m,p,d,A,O,E,b,e,S,g,X,M=1/0,Z=["","top_","bottom_"],D=!1;for(J=0,j=G.length;j>J;J++)if(g=G[J])for(m=0,p=Z.length;p>m;m++)if(X=Z[m],O=g[X+"vs"],E=g[X+"is"],b=g[X+"uv"]||g[X+"tuv"],O)for(d=0,A=E?E.length:O.length/3;A>d;d+=3)E?(i.fromArray(O,3*E[d]),t.fromArray(O,3*E[d+1]),n.fromArray(O,3*E[d+2])):(i.fromArray(O,3*d),t.fromArray(O,3*(d+1)),n.fromArray(O,3*(d+2))),e=w.intersectTriangle(i,t,n,!1,N),e&&(S=w.origin.distanceTo(e),M>S&&(M=S,s.copy(e),C.copy(i),T.copy(t),a.copy(n),""!==X?F=X.slice(0,-1):B?F=hk[Math.floor(d/6)]:h&&(F=hk[J]),b&&(D=!0,E?(o.fromArray(b,2*E[d]),Q.fromArray(b,2*E[d+1]),U.fromArray(b,2*E[d+2])):(o.fromArray(b,2*d),Q.fromArray(b,2*(d+1)),U.fromArray(b,2*(d+2))))));if(!isFinite(M))return null;var R,v=s.clone().applyMatrix4(c);D&&(R=z(s,C,T,a,o,Q,U));var r=Y(C,T,a),H=Y(C.applyMatrix4(c),T.applyMatrix4(c),a.applyMatrix4(c)),l=w.direction.dot(r);return l>0&&(r.multiplyScalar(-1),H.multiplyScalar(-1)),{world:v,local:s.clone(),worldNormal:H,normal:r,uv:R,part:F}}}}()});var Yr=function(k,t){this.gv=k,this.s=function(W,m,D){return m==f&&(m=D),m==f?t.getStyle(W):wn(m,t,k)},this.data=t};Gh(Yr,p,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(A,N,c,Y){var O=this,Z=O.data;if(!(Z instanceof zk)){var S,e,t,k,b,D,l,r=O.gv,W=Z._id,B=O.s("shape3d.alwaysOnTop")?null:O.s("batch"),V=r._batchIndexMap,P=r._batchModelMap,$=r.isSelectable(Z),o=r.getBrightness(Z),i=o!=f&&1!==o;if(O.needValidate(A)){if(t=Pr(V,P,Z,B),O.validate(t,B?hl[B]||Lr:f),t&&(k=V[W],b=k.size=t.vs.length/3-k.begin,l=t.rs))for(o=i?o:1,D=0;b>D;D++)l.push(o);if(ps(Z)){var v=r.getWireframeGeometry(Z);if(v)ie(r,Z,v);else{var d=r.getWireframe(Z);d&&ie(r,Z,d)}}O.labelInfo=O.label2Info=O.noteInfo=O.note2Info=O._38o=f,O._24O(Sp,"getLabel"),O._24O(xf,"getLabel2"),O._26O(Oq,"getNote"),O._26O(Po,"getNote2"),O._15O(),O.interactiveInfo=r.isInteractive(Z)?{}:f,O._iv=!1}i&&Yo(A,N.uBrightness,o),Yo(A,N.uAlphaTest,O.s("alphaTest")),e=Jm(A,N,c,$,Z,$g),e&&(Qq(e,V[W],P),Qq(e,r._polylineIndexMap[W],r._polylineModelMap),Qq(e,r._wireframeIndexMap[W],r._wireframeModelMap)),V[W]||O._80o(A,N,Y),r.isLabelVisible(Z)&&((S=O.labelInfo)&&(Jm(A,N,c,$,Z,Sp),O._28O(S,Sp,Y)),(S=O.label2Info)&&(Jm(A,N,c,$,Z,xf),O._28O(S,xf,Y))),r.isNoteVisible(Z)&&((S=O.noteInfo)&&(Jm(A,N,c,$,Z,Oq),O._29O(S,Oq,Y)),(S=O.note2Info)&&(Jm(A,N,c,$,Z,Po),O._29O(S,Po,Y))),(S=O._38o)&&O._99O(A,N,S,c,$,Y),i&&Yo(A,N.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return ig},_80o:function(){},dispose:function(){},_calcAnchorMat:function(d){if(d.hasOwnProperty("_anchor")||d.hasOwnProperty("_anchorElevation")){var C=d.getAnchor3d(),i={x:C.x-.5,y:C.y-.5,z:C.z-.5},s=dn();return dj(s,[-i.x,-i.y,-i.z]),s}},getBodyColor:function(g){var h=this.data,y=this.gv.getBodyColor(h);return y?y:g?h.getStyle(g):f},_24O:function(J,s){var o=this,Z=o.data,G=o.gv,O=o.s,_=G[s](Z);if(_!=f){var H=O(J+".scale"),B=O(J+".max"),b=o[J+"Info"]={label:_,textureScale:O(J+".texture.scale"),color:G[s+"Color"](Z),font:O(J+".font"),align:O(J+".align"),background:G[s+"Background"](Z)},t=b.rect=Sg(b,_);B>0&&B<t.width&&(b.labelWidth=t.width,t.width=B),t.x=t.y=0,t.width*=H,t.height*=H,b.mat=o._16O(O(J+".autorotate"),O(J+".position"),t,O(J+".face"),O(J+".t3"),O(J+".r3"),O(J+".rotationMode"));var a=t.width/2,d=t.height/2;b.vs=new uh([-a,d,0,-a,-d,0,a,-d,0,a,d,0]),t.width/=H,t.height/=H}},_26O:function(U,e){var T=this,V=T.data,N=T.gv,d=T.s,p=N[e](V);if(p!=f){var c=d(U+".scale"),A=this[U+"Info"]={note:p,textureScale:d(U+".texture.scale"),expanded:d(U+".expanded"),font:d(U+".font"),color:d(U+".color"),align:d(U+".align"),borderWidth:d(U+".border.width"),borderColor:d(U+".border.color"),background:N[e+"Background"](V)};if(A.expanded){var D=d(U+".max"),F=Sg(A,p);F.width+=6,F.height+=2,D>0&&D<F.width&&(A.labelWidth=F.width,F.width=D);var X={x:-F.width/2,y:-8-F.height,width:F.width,height:F.height+8}}else X={x:-6,y:-18,width:12,height:18};A.mat=T._16O(d(U+".autorotate"),d(U+".position"),f,d(U+".face"),d(U+".t3"),d(U+".r3"),d(U+".rotationMode")),A.rect=X,1!==c&&(X=lg(X),X.x*=c,X.height*=c,X.y=-X.height,X.width*=c);var L=X.x,v=X.y,m=X.width,C=X.height;A.vs=new uh([L,-v,0,L,-v-C,0,L+m,-v-C,0,L+m,-v,0])}},_28O:function(U,l,X){if(X(this.s(l+".transparent"))){var M=U.rect,y=U.textureScale,A=M.width*y,f=M.height*y;if(A>=1&&f>=1){var t=ml(A,f);1!==y&&(t.translate(t,M.x,M.y),t.scale(y,y),t.translate(t,-M.x,-M.y)),Yh(t,U),t.restore(),op(this,l,U.mat,U.vs,!0)}}},_29O:function(q,D,h){if(h(this.s(D+".transparent"))){var F=q.rect,_=q.textureScale,p=F.x,x=F.y,W=F.width*_,C=F.height*_;if(W>=1&&C>=1){F.x=F.y=0;var s=ml(W,C);1!==_&&s.scale(_,_),xq(s,q),s.restore(),F.x=p,F.y=x,op(this,D,q.mat,q.vs,!1)}}},_99O:function(y,w,n,X,Y,k){if(n){var E=this,o=E.gv,K=E.data,g=o._buffer,c=o._1O,G=n.icons;for(var x in G){var J=G[x],t=n.rects[x];if(t&&k(wn(J.transparent,K,o))){Jm(y,w,X,Y,K,x);var q=wn(J.shape3d,K,o),F=q?[q]:wn(J.names,K,o),s=F?F.length:0,A=wn(J.textureScale,K,o)||1,_=wn(J.light,K,o);_==f&&(_=q?!0:!1),Sk(y,w,wn(J.blend,K,o),_,wn(J.opacity,K,o),wn(J.reverseFlip,K,o),wn(J.reverseColor,K,o),wn(J.reverseCull,K,o));for(var H=0;s>H;H++){var h=F[H],r=t[H];if(Co(E,r.mat),q)uk(o,K,Ch(E,q),E);else{var U=fg(h);if(U){var u=r.width*A,S=r.height*A;if(u>=1&&S>=1){var T=ml(u,S);Do(T,U,wn(J.stretch,K,o),0,0,u,S,K,o),T.restore(),Vj(y,Pp,c),fd(y,w,c,wn(J.discardSelectable,K,o),g.uv,Rk),jl(y,g.vs,r.vs,w.aPosition),Hl(y,g.ns,Hc,w.aNormal),Pi(y,g.is,Gj),Ti(y,0,Gj.length),Ge(y,w,c)}}}zn(o)}Yg(y,w)}}}}});var Nd=function(W,j){gm(Nd,this,[W,j])};Gh(Nd,Yr,{_16O:function(c,m,z,O,y,B,S,v,R){var G=this.data,Y=G.getFinalScale3d(),s=ik(m,Y,z,O,v,R);if(G.hasOwnProperty("_anchor")||G.hasOwnProperty("_anchorElevation")){var $=G.getAnchor3d();s[0]-=($.x-.5)*Y[0],s[1]-=($.y-.5)*Y[1],s[2]-=($.z-.5)*Y[2]}return Qk(dn(),s,G.p3(),O,y,B,S,c,G.getFinalRotation3d(),G.getRotationMode())},clear:function(){var U=this;U.faceMat=U.mat=U.shapeModel=U.left=U.right=U.front=U.back=U.top=U.bottom=U.csg=f},needValidate:function(o){if(this._iv)return this._validateFrameId=o._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var t=o._renderInfo.frame;if(this._validateFrameId!==t)return this._validateFrameId=t,!0}return!1},validate:function(f,_){var J=this,o=J.gv,z=J.data,W=Ch(J);J._updateAutoRotation(),J._updateFixSize2d(),J._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Zk(o,z,"_wireframeModelMap","_wireframeIndexMap"),Zk(o,z,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var e=cl(z,o.getMat(z),W?J.s("shape3d.scaleable"):!0),S=J._calcAnchorMat(z);if(S&&Jq(e,e,S),z.mat=e,J.clear(),f){var B=[];W?Cg(o,z,W,J,J.getBodyColor(),[e],f,B):(zp(o,z,f,_,e,Rj,B,so),zp(o,z,f,_,e,$e,B,wj),zp(o,z,f,_,e,Jb,B,Vp),zp(o,z,f,_,e,De,B,Vf),zp(o,z,f,_,e,Wf,B,bf),zp(o,z,f,_,e,mb,B,lk)),B.length&&(nf(f.vs,B),nf(f.ns,$l(B)))}else J.mat=e,(J.shapeModel=W)||(J._cubeUvs=null,J.vf(Rj,0),J.vf($e,16),J.vf(Wf,8),J.vf(mb,24),J.vf(Jb,32),J.vf(De,40))},_updateAutoRotation:function(){var I=this,r=I.data,Q=I.s("shape3d.autorotate");if(!Q)return r._dynamicRotation&&delete r._dynamicRotation,void 0;var W,E=I.gv;W="string"==typeof Q?[Q.indexOf("x")<0?E._eye[0]:E._center[0],Q.indexOf("y")<0?E._eye[1]:E._center[1],Q.indexOf("z")<0?E._eye[2]:E._center[2]]:E._eye;var O=E._center,c=[W[0]-O[0],W[1]-O[1],W[2]-O[2]],j=r.p3(),F=Cq([j[0]+c[0],j[1]+c[1],j[2]+c[2]],j,E._up),V=r.r3(),C=qj(F,r.getRotationMode());Math.abs(V[0]-C[0])<1e-5&&Math.abs(V[1]-C[1])<1e-5&&Math.abs(V[2]-C[2])<1e-5||(r._dynamicRotation=C)},_updateFixSize2d:function(){var i=this,e=i.data,T=i.s("shape3d.fixSizeOnScreen");if(!T)return e._dynamicScale3d&&delete e._dynamicScale3d,void 0;var v=i.gv;e.getFinalScale3d();var d=cl(e,v.getMat(e)),z=wd([0,0,0],d),P=v.toViewPosition(z);if(!isNaN(P.x)&&!isNaN(P.y)){var M=wd([1,0,0],d),g=v.toViewPosition(M),F=wd([0,1,0],d),A=v.toViewPosition(F),y=g.x-P.x,C=A.y-P.y,a=e._dynamicScale3d||[1,1,1],f=fg(e.s("shape3d.image")),c=T[0]>0?T[0]:f?Nj(f,i):20,u=T[1]>0?T[1]:f?od(f,i):20,$=Math.abs(y/c),D=Math.abs(C/u);Math.abs($-1)<.001&&Math.abs(D-1)<.001||(e._dynamicScale3d=[a[0]/$,a[1]/D,a[2]])}},_updateOverlapping:function(){var g=this,a=g.s("hide.overlapping.group");if(!a)return g._rectOverlapping&&(g._rectOverlapping=b),void 0;var q,d,j,N=g.gv,c=g.data,U=cl(c,N.getMat(c)),Z=1/0,V=1/0,x=-1/0,f=-1/0,L=c.getAnchor3d(),K=L.x,I=L.y,$=L.z;for(q=0;8>q;q++){if(d=wd([(q>>2)-K,(1&q>>1)-I,(1&q)-$],U),j=N.toViewPosition(d),isNaN(j.x)||isNaN(j.y))return;Z=Math.min(Z,j.x),x=Math.max(x,j.x),V=Math.min(V,j.y),f=Math.max(f,j.y)}var w={x:Z,y:V,w:x-Z,h:f-V};g._rectOverlapping=N.overlappingBox.isOverlapping(a,w)},getVectorDynamicSize:function(){var L,Z=this,Y=Z.s("shape3d"),k=Z.data;if("billboard"===Y||"plane"===Y||(L=k._currentCubeElementId)!=f){var v,F,p=Z.gv,m=cl(k,p.getMat(k)),J=function(x,r){var L=p.toViewPosition(wd(x,m)),M=p.toViewPosition(wd(r,m)),D=L.x-M.x,T=L.y-M.y;return Math.min(2048,Math.sqrt(D*D+T*T))};if("billboard"===Y)v=J([-.5,0,0],[.5,0,0]),F=J([0,-.5,0],[0,.5,0]);else if("plane"===Y)v=J([-.5,0,0],[.5,0,0]),F=J([0,0,-.5],[0,0,.5]);else if(k._currentCubeElementId!=f){var X=3*Gc[L+1],S=3*Gc[L],n=3*Gc[L+2];v=J([Xi[X],Xi[X+1],Xi[X+2]],[Xi[n],Xi[n+1],Xi[n+2]]),F=J([Xi[X],Xi[X+1],Xi[X+2]],[Xi[S],Xi[S+1],Xi[S+2]])}return[v,F]}},getCachedTexture:function(){var V=this,K=V.data,Z=K._currentCubeElementId;return Z!=f?V._cubeCachedImage?V._cubeCachedImage[Z]:null:V._shape3dCachedImage},setCachedTexture:function(t){var S=this,W=S.data,c=W._currentCubeElementId;if(c!=f){if(!S._cubeCachedImage)return S._cubeCachedImage={};S._cubeCachedImage[c]=t}else S._shape3dCachedImage=t},invalidateCachedTexture:function(u){var J,D,$,O=this;if(($=O._shape3dCachedImage)&&(u.deleteTexture($),O._shape3dCachedImage=null),D=O._cubeCachedImage){for(J in D)u.deleteTexture(D[J]);O._cubeCachedImage=null}},vf:function(y,r){var R=this;if(R.gv.getFaceVisible(R.data,y)){var u=rb(R,y);u.mat&&(R.faceMat=!0);var v=u.uv;if(v){var X=R._cubeUvs;X||(X=R._cubeUvs=new uh([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var A=0;8>A;A++)X[r+A]=v[A]}return u}},_80o:function(n,G,r){var u=this;if(u._rectOverlapping)return!0;var J=u.gv,N=u.data,z=J._cube,R=u.shapeModel;Mg(J,u.mat),R?uk(J,N,R,u,u.getBodyColor(),r):(jl(n,z.vs,f,G.aPosition),jl(n,z.ns,f,G.aNormal),Ao(n,z.is),u._18O(n,G,u.left,0,r),u._18O(n,G,u.front,6,r),u._18O(n,G,u.right,12,r),u._18O(n,G,u.back,18,r),u._18O(n,G,u.top,24,r),u._18O(n,G,u.bottom,30,r)),zn(J),u.faceMat&&(u._18O(n,G,u.left,0,r,!0),u._18O(n,G,u.front,6,r,!0),u._18O(n,G,u.right,12,r,!0),u._18O(n,G,u.back,18,r,!0),u._18O(n,G,u.top,24,r,!0),u._18O(n,G,u.bottom,30,r,!0))},_18O:function(B,R,$,I,H,h){if($){if(!H($.transparent))return;if(h&&!$.mat||!h&&$.mat)return;h&&Mg(this.gv,$.mat);var b=this,N=b.data;N._currentCubeElementId=I;var U=b.gv,o=U.getTexture($.texture,N),E=$.uv,T=$.uvScale,y=$.uvOffset,K=$.discardSelectable;o?E?fd(B,R,o,K,U._buffer.uv,b._cubeUvs,y,T):fd(B,R,o,K,U._cube.uv,f,y,T):fd(B),Sk(B,R,$.blend,$.light,$.opacity,$.reverseFlip,$.reverseColor,$.reverseCull),Yo(B,R.uDiffuse,$.color),Ti(B,I,6),Yg(B,R),Ge(B,R,o),h&&zn(U),N._currentCubeElementId=null}}});var yf=function(t,w){gm(yf,this,[t,w])};Gh(yf,Yr,{_25Q:1,validate:function(Z){var E=this,L=E.gv,u=E.data,r=E.s,A=r("edge.width"),a=u._40I,Y=u._41I;if(E.shapeModel=E.info=f,a&&Y){var _,K,$,e,V,c,R,s,J,q,y=u.isLooped(),F=r(Qg),D=G.getEdgeType(F);if(D){var d=D(u,_o(E,L,u,y,F),L,E._19Q);if(!d.points||d.points.isEmpty())return;c=E.info={},R=d.segments,V=d.points,s=V.size();for(var C=a.getElevation(),Q=Y.getElevation(),v=0;s>v;v++){var O=V.get(v);O.e==f&&(O.e=C+(Q-C)*v/(s-1))}J=xb(V.get(0)),q=xb(V.get(s-1));var w=s%2;0===w?(c.c1=xb(V.get(s/2-1)),c.c2=xb(V.get(s/2))):c.p3=xb(V.get((s-w)/2)),c.s1=J,c.s2=xb(V.get(1)),c.t1=xb(V.get(s-2)),c.t2=q}else{V=new Ek,c=E.info={};var B=r("edge.offset"),I=r("edge.center"),U=r("edge.source.t3"),x=r("edge.target.t3"),W=a.p3(),h=Y.p3();if(U&&(W[0]+=U[0],W[1]+=U[1],W[2]+=U[2]),x&&(h[0]+=x[0],h[1]+=x[1],h[2]+=x[2]),F===tm){R=r("edge.segments");var m=c.points=r(Mc)||oi;if(s=m.size()){J=xb(m.get(0)),q=xb(m.get(s-1)),!I&&B&&($=el(J,W,!0),B=S(B,Bj(W,J)),W=[W[0]+$[0]*B,W[1]+$[1]*B,W[2]+$[2]*B],$=el(h,q,!0),B=S(B,Bj(q,h)),h=[h[0]-$[0]*B,h[1]-$[1]*B,h[2]-$[2]*B]);var w=s%2;0===w?(_=xb(m.get(s/2-1)),K=xb(m.get(s/2))):c.p3=xb(m.get((s-w)/2)),c.s1=W,c.s2=J,c.t1=q,c.t2=h}else!I&&B&&($=el(h,W,!0),e=Bj(W,h),B=Le(B,e),W=[W[0]+$[0]*B,W[1]+$[1]*B,W[2]+$[2]*B],h=[h[0]-$[0]*B,h[1]-$[1]*B,h[2]-$[2]*B]),_=W,K=h;V.add({x:W[0],y:W[2],e:W[1]}),V.addAll(m),V.add({x:h[0],y:h[2],e:h[1]})}else{var j=_o(E,L,u,y,F);if(E._19Q||(j=-j),y){var T=W[0],t=W[1],X=W[2],z=a.getTall()/2+j;_=[T-j,t+z,X],K=[T+j,t+z,X],V.add({x:T-j,y:X,e:t}),V.add({x:T-j,y:X,e:t+z}),V.add({x:T+j,y:X,e:t+z}),V.add({x:T+j,y:X,e:t})}else{$=el(h,W,!0),e=Bj(W,h);var H={x:W[0],y:W[2]},g={x:h[0],y:h[2]},o=Qm(f,H,g,j),p=o.x-H.x,k=o.y-H.y;B=Le(B,e),$[0]*=B,$[1]*=B,$[2]*=B,_=[W[0]+$[0]+p,W[1]+$[1],W[2]+$[2]+k],K=[h[0]-$[0]+p,h[1]-$[1],h[2]-$[2]+k],I?(V.add({x:W[0],y:W[2],e:W[1]}),V.add({x:_[0],y:_[2],e:_[1]}),V.add({x:K[0],y:K[2],e:K[1]}),V.add({x:h[0],y:h[2],e:h[1]})):(V.add({x:_[0],y:_[2],e:_[1]}),V.add({x:K[0],y:K[2],e:K[1]}))}}c.c1=_,c.c2=K}c.list=r(oe)===rg?E.createTubeModel(V,R,A/2,Z):E.createLineModel(V,R,A,"edge","edge.dash")}}});var Tc=function(z,n){gm(Tc,this,[z,n])};Gh(Tc,Nd,{_80o:function(A,b,o){var K=this,$=K.gv,m=K.shapeModel;Mg($,K.mat),m?uk($,K.data,m,K,K.getBodyColor(),o):(em(K,A,b,K.left,o),em(K,A,b,K.front,o),em(K,A,b,K.right,o),em(K,A,b,K.back,o),em(K,A,b,K.top,o),em(K,A,b,K.bottom,o)),zn($)},validate:function(K,i){var D,p,W=this,Q=W.s,s=W.data,a=s.p3(),e=s._thickness/2,w=s.isClosePath(),x=s.getPoints(),o=s.getSegments(),N=Q(Im),g=K&&K.uv;if(W.clear(),0>e)p=W.shapeModel=Vr(x,o,Q(mf),Q(ib),N,Q(Wo),s.getTall(),s.getShapeElevation(),w),Q(nq)?Q("shape3d.image")||delete p.uv:(delete p.vs,delete p.ns,delete p.uv),Q("shape3d.top.image")||delete p.top_uv,Q("shape3d.bottom.image")||delete p.bottom_uv;else if(Q(oe)===rg)D=Uj(x,o,N,w),p=W.shapeModel={vs:[]},Q("shape3d.image")&&(p.uv=[],p.sum=Q(Wo)||pg(D)||1,p.len=0),Q(mf)&&!w&&(p.top_vs=[],Q("shape3d.top.image")&&(p.top_uv=[])),Q(ib)&&!w&&(p.bottom_vs=[],Q("shape3d.bottom.image")&&(p.bottom_uv=[])),W._12O(D,e);else{var X,j,y,t,G,I,r,Y,v,V;if(D=Uj(x,o,N,w),G=W.vf(Wf,g,!1,i),e&&(I=W.vf(mb,g,!1,i),r=w?f:W.vf(Rj,g,!1,i),Y=w?f:W.vf($e,g,!1,i),v=W.vf(Jb,g,!1,i),V=W.vf(De,g,!1,i)),e){for(var c=0,E=D.length;E>c;c++)D[c]=W._tryRemoveBezierPoints(D[c],e);W._12O(D,e)}else G&&D.forEach(function(F){if(t=F.length,t>0)for(X=F[0],y=1;t>y;y++)j=F[y],W.addV(G.vs,X,j),X=j});W._20Q(D),K||(G&&(G.ns=$l(G.vs),qn(G,"vs"),qn(G,eq)),e&&(I&&(I.ns=$l(I.vs),qn(I,"vs"),qn(I,eq)),r&&(r.ns=$l(r.vs),qn(r,"vs"),qn(r,eq)),Y&&(Y.ns=$l(Y.vs),qn(Y,"vs"),qn(Y,eq)),v&&(v.ns=$l(v.vs),qn(v,"vs"),qn(v,eq)),V&&(V.ns=$l(V.vs),qn(V,"vs"),qn(V,eq))))}var m=W.mat=dn();dj(m,a),Yl(m,s.getFinalRotation3d(),s.getRotationMode());var U=s.getScale3d(),q=s._dynamicScale3d;q&&(U[0]*=q[0],U[1]*=q[1],U[2]*=q[2]),bd(m,U),dj(m,mo(a)),K&&(Je(W,m,K,p),W.clear())},_20Q:function(F){var G,h,A,z,M,N,Q,H=this,W=H.front,J=H.back,S=H.top,T=H.bottom,e=W?W.tuv:f,B=J?J.tuv:f,s=S?S.tuv:f,l=T?T.tuv:f,o=0;(e||B||s||l)&&(G=H.s(Wo)||pg(F)||1,F.forEach(function(D){if(h=D.length,h>0)for(N=D[0],A=1;h>A;A++)Q=D[A],z=o/G,o+=Bj(N,Q),M=o/G,H._14O(W,z,M),H._14O(J,1-M,1-z),H._14O(S,z,M),H._14O(T,z,M),N=Q}))},_14O:function(f,J,W){if(f){var t=f.uv,B=f.tuv;if(B){if(t)var g=t[0]+(t[6]-t[0])*J,z=t[1]+(t[7]-t[1])*J,w=t[2]+(t[4]-t[2])*J,e=t[3]+(t[5]-t[3])*J,q=t[2]+(t[4]-t[2])*W,P=t[3]+(t[5]-t[3])*W,Z=t[0]+(t[6]-t[0])*W,F=t[1]+(t[7]-t[1])*W;else g=J,z=0,w=J,e=1,q=W,P=1,Z=W,F=0;B.push(w,e,q,P,Z,F,Z,F,g,z,w,e)}}},_13O:function(h){var u=h.uv,m=h.tuv;m&&(u?m.push(u[2],u[3],u[4],u[5],u[6],u[7],u[6],u[7],u[0],u[1],u[2],u[3]):m.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(b,C){var n=b.length;if(4>n)return b;var z,j,g,o,A,f,U=!1,E=function(L){return b[L]},B=function(m){return b[n-1-m]};for(A=0;1>=A;A++)for(f=A?B:E,j=f(0),g=f(1),z=2;n-1>z;z++)if(o=f(z),!o.remove)if(o.b){var K=Qm(j,g,o,C);K.adjust?(o.remove=!0,U=!0):(j=g,g=o)}else j=g,g=o;if(!U)return b;var J=[];for(z=0;n>z;z++)b[z].remove||J.push(b[z]);return J},_12O:function(y,j){var v,L,H,X,A,s=this;y.forEach(function(d){if(A=d.length,A>0)for(v={p:d[0],n:!0},X=1;A>X;X++)L=d[X],H=A-1>X?d[X+1]:f,s.addPoint(v,L,H,j,d)})},addPoint:function(z,V,X,o,i){var C,q,g,B,d,n,T,b,e,s=this,r=z.p,_=z.f,H=z.b,F=s.s("shape3d.side")||Yp,W=s.s("shape3d.start.angle"),x=s.s("shape3d.sweep.angle"),D=s.shapeModel,u=s.data.isClosePath();if(z.n&&(z.n=!1,_=u&&i.length>2?Qm(i[i.length-2],r,V,o):Qm(f,r,V,o),H=vq(r,_),D?D.top_vs&&s._10O(H,_,F,W,x,D.top_vs,D.top_uv):(C=s.left)&&(s.addV(C.vs,H,_),s._13O(C))),q=X?Qm(r,V,X,o):u&&i.length>2?Qm(r,V,i[1],o):Qm(r,V,f,o),g=vq(V,q),D){var J,M,Z=D.vs,h=D.uv,N=D.sum;for(h&&(J=D.len/N,D.len+=Bj(r,V),M=D.len/N),n=s._9O(H,_,F,W,x),T=s._9O(g,q,F,W,x),b=0;F>b;b++)e=b+1,nf(Z,n[e]),nf(Z,T[b]),nf(Z,n[b]),nf(Z,T[b]),nf(Z,n[e]),nf(Z,T[e]),h&&(B=b/F,d=e/F,h.push(J,d,M,B,J,B,M,B,J,d,M,d));!X&&D.bottom_vs&&s._10O(g,q,F,W,x,D.bottom_vs,D.bottom_uv,!0)}else!X&&(C=s.right)&&(s.addV(C.vs,q,g),s._13O(C)),(C=s.front)&&s.addV(C.vs,_,q),(C=s.back)&&s.addV(C.vs,g,H),(C=s.top)&&s.addH(C.vs,_,q,g,H,!0),(C=s.bottom)&&s.addH(C.vs,H,g,q,_);z.p=V,z.f=q,z.b=g},_10O:function(o,B,x,l,F,D,S,P){var w,p,L=this,f=L.data,Y=L._9O(o,B,x,l,F),H=(o.x+B.x)/2,X=(o.y+B.y)/2,v=f.getShapeElevation(),s=0;for(s=0;x>s;s++)P?(nf(D,Y[s]),nf(D,Y[s+1])):(nf(D,Y[s+1]),nf(D,Y[s])),nf(D,[H,v,X]),S&&(P?(w=U*(s+1)/x+l,p=U*s/x+l):(w=U*s/x+l,p=U*(s+1)/x+l),S.push(.5-.5*t(p),.5-.5*e(p),.5-.5*t(w),.5-.5*e(w),.5,.5))},_9O:function(V,r,N,z,s){var Q,$,i=this,C=i.data,A=[],W=(V.x+r.x)/2,X=(V.y+r.y)/2,x=C.getTall()/2,m=C.getShapeElevation(),o=0;for(s=s||U;N>=o;o++)Q=s*o/N+z,$=t(Q),A.push([W+(V.x-W)*$,m+x*e(Q),X+(V.y-X)*$]);return A},addV:function(w,o,S){var m=o.x,T=o.y,f=S.x,M=S.y,g=this.data,Y=g.getShapeElevation(),q=g.getTall()/2;w.push(m,Y-q,T,f,Y-q,M,f,Y+q,M,f,Y+q,M,m,Y+q,T,m,Y-q,T)},addH:function(e,$,j,u,R,q){var y=this.data,l=y.getTall()/2,W=y.getShapeElevation()+(q?l:-l);e.push($.x,W,$.y,j.x,W,j.y,u.x,W,u.y,u.x,W,u.y,R.x,W,R.y,$.x,W,$.y)},vf:function(T,U,j,G){var Q,d=this,a=d.gv.getFaceVisible(d.data,T);return(j||a)&&(Q=rb(d,T,G),Q.vs=[],Q.tuv=a&&(Q.texture||U)?[]:f,Q.visible=a),Q}});var Ok=function(g,M){gm(Ok,this,[g,M])};Gh(Ok,Yr,{_25Q:1,validate:function(d){var l=this,z=l.data,B=l.s,p=z.getPoints(),H=p.size();if(l.shapeModel=l.info=f,H>1){var u=l.info={},c=z.getSegments(),E=z.getThickness(),i=xb(p.get(0)),v=xb(p.get(H-1)),K=H%2;0===K?(u.c1=xb(p.get(H/2-1)),u.c2=xb(p.get(H/2))):u.p3=xb(p.get((H-K)/2)),u.s1=i,u.s2=xb(p.get(1)),u.t1=xb(p.get(H-2)),u.t2=v,u.list=B(oe)===rg?l.createTubeModel(p,c,E/2,d):l.createLineModel(p,c,E,"shape.border","shape.dash")}var X=z.p3(),e=l.mat=dn();dj(e,X),Yl(e,z.getFinalRotation3d(),z.getRotationMode());var n=z.getScale3d(),$=z._dynamicScale3d;$&&(n[0]*=$[0],n[1]*=$[1],n[2]*=$[2]),bd(e,n),dj(e,mo(X))},_80o:function(X,R,u){var D=this,m=D.shapeModel;if(m){var l=D.gv;Mg(l,D.mat),uk(l,D.data,m,D,D.getBodyColor(),u),zn(l)
}}});var Jl=K.graph3d.VR=function(o){var j=this;j.gv=o,j._controllers=[],j.switch=new _p(j),j._enable=!1,j._defaultCallLater=K.Default.callLater,"undefined"!=typeof N&&"VRFrameData"in N&&(j._frameData=new N.VRFrameData),j.measureOflength=1,j.eyesOffset=[0,0,0]};Gh(Jl,p,{ms_fire:!0,_42:function(K,i,g,S){var Q=this,P=Q.gv,Y=Q._device;if(Y){var N=Q._measureOflength;if(Y.depthNear=P.getNear()*N,Y.depthFar=P.getFar()*N,Q._controllers.forEach(function(L){L&&L.update()}),Y.isPresenting===!1)return P.iv(),!1;var h=Q._frameData;Y.getFrameData(h);var C=h.pose.position;return C&&P.setEye(Q.toViewPosition(C)),K.viewport(0,0,i/2,g),Q._viewMatrix=Q._copyViewMatrix(h.leftViewMatrix),Q._projectMatrix=Q._copyProjectMatrix(h.leftProjectionMatrix),S(),K.viewport(i/2,0,i/2,g),Q._viewMatrix=Q._copyViewMatrix(h.rightViewMatrix),Q._projectMatrix=Q._copyProjectMatrix(h.rightProjectionMatrix),S(),Q._lastViewMatrix=Q._viewMatrix,Q._lastProjectMatrix=Q._projectMatrix,Q._viewMatrix=null,Q._projectMatrix=null,Q.submitFrame(),!0}},addController:function(e){e=e||0;var Y=this,M=Y.getController(e);return M?M:(M=new fn(Y,e),Y._controllers.push(M),M)},getController:function(e){e=e||0;for(var b=this._controllers,v=0,i=b.length;i>v;v++)if(b[v]&&b[v].id===e)return b[v];return null},removeController:function(U){U=U||0;for(var W=this._controllers,z=0,l=W.length;l>z;z++)if(W[z]&&W[z].id===U)return W.splice(z,1),!0;return!1},toViewPosition:function(h,B){var t=this,i=t._scaleFactor,Z=t._eyesOffset;return B?(B[0]=h[0]*i+Z[0],B[1]=h[1]*i+Z[1],B[2]=h[2]*i+Z[2],B):[h[0]*i+Z[0],h[1]*i+Z[1],h[2]*i+Z[2]]},_copyViewMatrix:function(d){var z=this.dup(d),R=this._scaleFactor;z[12]*=R,z[13]*=R,z[14]*=R;var t=this._eyesOffset;if(t&&(t[0]||t[1]||t[2])){var L=t[0],x=t[1],p=t[2];z[12]-=z[0]*L+z[4]*x+z[8]*p,z[13]-=z[1]*L+z[5]*x+z[9]*p,z[14]-=z[2]*L+z[6]*x+z[10]*p}return z},shutdown:function(){var P=this._device;P&&P.isPresenting&&P.exitPresent()},isPresenting:function(){var j=this._device;return j&&j.isPresenting},_copyProjectMatrix:function(M){var _=this.dup(M),N=this._scaleFactor;return _[14]*=N,_},dup:function(t,k){for(var Y=t.length,X=k||new Array(Y);Y--;)X[Y]=t[Y];return X},getViewMatrix:function(m){var p=this._viewMatrix;return p?this.dup(p,m):void 0},getProjectMatrix:function(){var z=this._projectMatrix;return z?this.dup(z):void 0},submitFrame:function(){var q=this;if(q._enable&&q._deviceInAction){var Y=q._device;Y&&Y.isPresenting&&(Y.submitFrame(),q.gv.iv())}},setDevice:function(W){var Y=this;Y._device=W},_injectCallLaterFunc:function(R){var q=this;if(!R)return Qo=K.Default.callLater=q._defaultCallLater,void 0;var q=this;Qo=K.Default.callLater=function(e,d,C,I){var F=q._device;return F&&F.isPresenting?I?$(function(){Qo(e,d,C)},I):F.requestAnimationFrame(function(){q._deviceInAction=!0,e.apply(d,C),q._deviceInAction=!1}):(q._defaultCallLater(e,d,C,C),void 0)}}}),p.defineProperties(Jl.prototype,{enable:{get:function(){return this._enable},set:function(b){var r=this;r._enable!==b&&(r._enable=b,b?(r.switch.showButton(),r._injectCallLaterFunc(!0)):(r.shutdown(),r.switch.hideButton(),r._injectCallLaterFunc(!1)))}},measureOflength:{get:function(){return this._measureOflength},set:function(f){this._measureOflength=f;var u=this._scaleFactor=1/f;this._controllers.forEach(function(n){n&&n._setScaleFactor(u)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(B){this._eyesOffset=B}}});var fn=function(Z,B){function E(d){var w=navigator.getGamepads&&navigator.getGamepads();if(w)for(var y=0,R=0,J=w.length;J>y;y++){var x=w[y];if(x){var c=x.id;if("OpenVR Gamepad"===c||"OpenVR Controller"===c||0===c.indexOf("Oculus Touch")||0===c.indexOf("Spatial Controller")){if(R===d)return x;R++}}}}function l(u,F,V){return Math.abs(u[0]-F[0])<V&&Math.abs(u[1]-F[1])<V&&Math.abs(u[2]-F[2])<V?!0:!1}var i=this;i.vr=Z,i.id=B;var q,X,v=[0,0],e=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],R=new Gk;i.getGamepad=function(){return X},i.getButtonState=function(k){e.forEach(function($){return $.id===k?$.pressed:void 0})},i.getNode=function(){return R};var U=.003;i.setRotationEpsilon=function(_){U=_};var p=5e-4,z=p;i.setPositionEpsilon=function(_){p=_,z=_*i.vr._scaleFactor},i._setScaleFactor=function(V){R.s3(V,V,V),z=p*V};var u,V=new lf,$=new cj,r=[0,0,0],L=[0,0,0],m=new If,n=new _e;i.getRay=function(){return u?(n.origin.fromArray(r),n.direction.copy(m),u=!1,n):n},i.update=function(){if(q=X,X=E(B),q!==X&&console.log("gamepad changed",X),!X||X.pose===b)return X=null,R.s("shape3d.visible",!1),void 0;R.dm()||Z.gv.dm().add(R),R.s("shape3d.visible",!0);var s=X.pose;if(null!==s){s.position&&(i.vr.toViewPosition(s.position,r),l(R.p3(),r,z)||(u=!0,R.p3(r))),s.orientation&&(V.fromArray(s.orientation),m.set(0,0,-1).applyQuaternion(V).normalize(),$.makeRotationFromQuaternion(V),qj($.el,R.getRotationMode(),L),l(R.r3(),L,U)||(u=!0,R.r3(L))),u&&Z.fp("gamepad.pose",null,{position:r,rotation:L,id:B});var o=X.axes;(v[0]!==o[0]||v[1]!==o[1])&&(v=[o[0],o[1]],Z.fp("gamepad.axes",null,{id:B,axes:v}));var g,y,N,T,f=X.buttons;for(g=0,y=f.length;y>g;g++)N=f[g],T=N.pressed,T!==e[g].pressed&&(e[g].pressed=T,Z.fp("gamepad.button."+e[g].id,null,{id:B,_62O:T?"down":"up"}))}}},_p=function(m){this.vr=m,this._button=null};Gh(_p,p,{showButton:function(){var q=this.assureButton();if(!q.parentNode){var B=this.vr.gv,J=B.getView();B._79O?J.insertBefore(q,B._79O):J.appendChild(q)}},hideButton:function(){var d=this._button;d&&d.parentNode&&d.parentNode.removeChild(d)},assureButton:function(){var G=this._button;return G?G:this._button=this.createButton(this.vr.gv)},createButton:function(k){function B(Q,b){Q.textContent=b&&b.isPresenting?" VR ":" VR "}function b(Q){T.style.display="",T.style.cursor="pointer",T.style.left="calc(50% - 50px)",T.style.width="100px",B(T,Q),T.onmouseenter=function(){T.style.opacity="1.0"},T.onmouseleave=function(){T.style.opacity="0.5"},T.onclick=function(){Q.isPresenting?Q.exitPresent():Q.requestPresent([{source:k.getCanvas()}])},k.vr.setDevice(Q)}function U(){T.style.display="",T.style.cursor="auto",T.style.left="calc(50% - 75px)",T.style.width="150px",B(T,null),T.onmouseenter=null,T.onmouseleave=null,T.onclick=null,k.vr.setDevice(null)}function x(x){x.style.position="absolute",x.style.bottom="20px",x.style.padding="12px 6px",x.style.border="1px solid #fff",x.style.borderRadius="4px",x.style.color="#000",x.style.font="normal 13px sans-serif",x.style.textAlign="center",x.style.opacity="0.5",x.style.outline="none",x.style.zIndex="999"}if("getVRDisplays"in navigator){var T=this._button=l.createElement("button");return T.style.display="none",x(T),N.addEventListener("vrdisplayconnect",function(g){b(g.display)},!1),N.addEventListener("vrdisplaydisconnect",function(){U()},!1),N.addEventListener("vrdisplaypresentchange",function(F){B(T,F.display)},!1),navigator.getVRDisplays().then(function(z){z.length>0?b(z[0]):U()}),T}var u=l.createElement("a");return u.href="https://webvr.info",u.innerHTML=" webvr",u.style.left="calc(50% - 90px)",u.style.width="180px",u.style.textDecoration="none",x(u),u}}),p.defineProperties(_p.prototype,{}),dd(G,{accordionViewExpandIcon:sc(hc),accordionViewCollapseIcon:sc(hc,!0),accordionViewLabelColor:Jf,accordionViewLabelFont:Ri,accordionViewTitleBackground:wc,accordionViewSelectBackground:$j,accordionViewSelectWidth:3,accordionViewSeparatorColor:b,splitViewDividerSize:1,splitViewDividerBackground:wc,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:rp,rect:[2,2,12,12],background:hc}]},propertyViewLabelColor:Xj,propertyViewLabelSelectColor:Jf,propertyViewLabelFont:Ri,propertyViewExpandIcon:sc(Ie),propertyViewCollapseIcon:sc(Ie,!0),propertyViewBackground:We,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:qs,propertyViewColumnLineColor:qs,propertyViewSelectBackground:$j,listViewLabelColor:Xj,listViewLabelSelectColor:Jf,listViewLabelFont:Ri,listViewRowLineVisible:!1,listViewRowLineColor:qs,listViewSelectBackground:$j,treeViewLabelColor:Xj,treeViewLabelSelectColor:Jf,treeViewLabelFont:Ri,treeViewExpandIcon:sc(di),treeViewCollapseIcon:sc(di,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:qs,treeViewSelectBackground:$j,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Xj,tableViewLabelSelectColor:Jf,tableViewLabelFont:Ri,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:qs,tableViewColumnLineColor:qs,tableViewSelectBackground:$j,treeTableViewLabelColor:Xj,treeTableViewLabelSelectColor:Jf,treeTableViewLabelFont:Ri,treeTableViewExpandIcon:sc(di),treeTableViewCollapseIcon:sc(di,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:qs,treeTableViewColumnLineColor:qs,treeTableViewSelectBackground:$j,tableHeaderLabelColor:Xj,tableHeaderLabelFont:Ri,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:jg,tableHeaderBackground:We,tableHeaderMoveBackground:Db,tableHeaderInsertColor:$j,tableHeaderSortDescIcon:Kk(Ie,!0),tableHeaderSortAscIcon:Kk(Ie),tabViewTabGap:1,tabViewLabelColor:Jf,tabViewLabelFont:Ri,tabViewTabBackground:wc,tabViewSelectWidth:3,tabViewSelectBackground:$j,tabViewMoveBackground:Db,tabViewInsertColor:$j,toolbarLabelColor:Xj,toolbarLabelSelectColor:Jf,toolbarLabelFont:Ri,toolbarBackground:We,toolbarSelectBackground:$j,toolbarItemGap:8,toolbarSeparatorColor:ms},!0);var oc={translateX:1,sortColumn:1},Uo={sortable:1,sortOrder:1,sortFunc:1},fm={focusData:1},Rh={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Np={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Uh=function(_,S){S.add(_),_.hasChildren()&&_.eachChild(function(H){Uh(H,S)})},bp=function(x,k,h,I,O,J,Q,F,a,$,P){var U,n=h.getValueType($),e=h.getAlign($);if(h.getEnumValues($)){var R=h.toEnumLabel(k,$),L=ii||0,K=0,E=J,T=G.getTextSize(I,R).width;return U=fg(h.toEnumIcon(k,$)),U&&(K=J+ii/2,"center"===e?K+=(F-(L+T))/2:"right"===e&&(K=K+F-(L+T)),_l(x,U,K,Q+a/2,$,P),E=K+ii/2),R!=f&&(U?Th(x,R,I,O,E,Q,F-(E-J),a):Th(x,R,I,O,J,Q,F,a,e)),void 0}return k=h.formatValue(k),k!=f?n===Ad?(tj(x,J,Q,F,a,k),void 0):n===rc||!n&&_g(k)?(U=fg(k?Jc:Yd),_l(x,U,J+F/2,Q+a/2,$,P),void 0):(Th(x,k,I,O,J,Q,F,a,e),void 0):void 0},nc=function(b,M){var s=M.view,T=jh(b),$=M.column||M.property;s.getDataModel().beginTransaction(),M.editor=b,b.info=M,s.setCurrentEditor(b),s.getView().insertBefore(T,s._79O),pn(b,M.editorRect),b.setFocus?b.setFocus():As(b),b.commitValue=function(x,E){b._17Q&&(b=b._17Q),E||s.setValue(M.data,$,b.getValue?b.getValue():b.value),b.close&&b.close(),vk(T)},$.onEditorCreated&&$.onEditorCreated(M)},li=function(d,C,A,m,N){var i=kc(d,A),F=C.value,I=C.view,q=N.getValueType(C.data);return i.onblur=i.onchange=function(){I.endEditing()},"input"===d?(F=N.formatValue(F),F!=f&&(i.value=F),i.onkeydown=function(K){kf(K)?I.endEditing():Xf(K)&&I.endEditing(!0)},(q===ke||q===cb)&&i.addEventListener(Xc,G.numberListener,!1)):d===Ac&&m.forEach(function(y){var O=l.createElement("option");O.innerHTML=N.toEnumLabel(y),O.value=y,N.isEnumEqual(F,y)&&(O.selected=!0),tb(i,O)}),nc(i,C),i},hb=K.widget={},Ke=function(X,b,p){Gh(r+".widget."+X,b,p)};dd(fr,{ms_value:function(Q){Q.getValue=function(k){var N=this.getItemById(k),z=N.element;return cr(z)?z:z?z.getValue?z.getValue():z.value:N.selected},Q.setValue=function(G,j){var x=this.getItemById(G);if(x){var i=x.element;i&&!cr(i)?i.setValue?i.setValue(j):i.value=j:_g(j)?(x.selected=j,this.iv()):(x.element=j,this.iv())}},Q.v=function(x,G){var C=this;if(2===arguments.length)C.setValue(x,G);else{if(!wg(x))return C.getValue(x);for(var Q in x)C.setValue(Q,x[Q])}return C}},_46o:function(S){S._icon=f,S._accessType=f,S._valueType=f,S._editable=!1,S._batchEditable=!0,S._align=Rj,S._nullable=!0,S._emptiable=!1,S.setParent=Kh,S.formatValue=function(e){var B=this,I=B._valueType;return B.getEnumValues()?B.toEnumLabel(e):I===rc?!!e:e!=f&&I===ke?X(e):e},S.setEnum=function(q,E,W,H,R,a,C){var I=this;q&&!te(q)&&q.values&&(H=q.editable,W=q.icons,E=q.labels,R=q.strict,a=q.maxHeight,C=q.dropDownWidth,q=q.values),td(q)&&(q=q._as),td(E)&&(E=E._as),td(W)&&(W=W._as),I._enumValues=q,I._enumLabels=E,I._enumIcons=W,I._enumEditable=H,I._enumStrict=R==f?!0:R,I._enumMaxHeight=a,I._enumDropDownWidth=C,q&&q.length&&mj(q[0])&&(I._valueType=cb),I.fp("enum",!1,!0)},S.getEnumDropDownWidth=function(){return this._enumDropDownWidth},S.getEnumMaxHeight=function(){return this._enumMaxHeight},S.isEnumEditable=function(){return this._enumEditable},S.getEnumValues=function(){return this._enumValues},S.getEnumLabels=function(){return this._enumLabels},S.getEnumIcons=function(){return this._enumIcons},S.isEnumStrict=function(){return this._enumStrict},S.isEnumEqual=function(J,Q){return this._enumStrict?J===Q:J==Q},S.toEnumLabel=function(x,A){var W=this,k=W.getEnumValues(A),Z=W.getEnumLabels(A);if(k&&Z)for(var t=0;t<k.length;t++)if(W.isEnumEqual(x,k[t]))return Z[t];return x},S.toEnumIcon=function(B,v){var o=this,D=o.getEnumValues(v),H=o.getEnumIcons(v);if(D&&H)for(var T=0;T<D.length;T++)if(o.isEnumEqual(B,D[T]))return H[T];return b}},_45o:function(Y){Y._87o=function(y,c,n,p,f,O){if(y){var k=this,K=k._90I,N=wk(1);k._columnLineVisible&&(f-=1),k._rowLineVisible&&(O-=1),0>=f||0>=O||(k._90I||(K=k._90I={}),K[c]||(K[c]=new Ek),pn(N,k.tx()+n,k.ty()+p,f,O),tb(N,y),k._view.insertBefore(N,k._79O),y.onParentAdded&&y.onParentAdded(N),K[c].add(N))}},Y._76o=function(){var L=this,f=L._90I;if(f){for(var l in f)f[l].each(function(L){vk(L)});delete L._90I}},Y._77o=function(L){var S=this;if(S._90I){var A=S._90I[L];A&&(A.each(function(d){vk(d)}),delete S._90I[L])}}},_47o:function(o){o.getValue=function(d,Q){return Q.getValue?Q.getValue(d,Q,this):Ck(d,Q.getAccessType(),Q.getName())},o.setValue=function(w,J,K){if(J.isEmptiable(w)||""!==K||(K=b),J.isNullable(w)||K!=f){var L=this,$=J.getName(w),s=J.getAccessType(w),m=J.getValueType(w);m===ke&&cr(K)?K=M(K):m===cb&&cr(K)?K=parseFloat(K):m===rc&&cr(K)&&(K="true"===K),L._batchEditable&&J._batchEditable&&L.isSelected(w)?L.sm().each(function(b){J.setValue?J.setValue(b,J,K,L):Wi(b,s,$,K)}):J.setValue?J.setValue(w,J,K,L):Wi(w,s,$,K)}},o.setCurrentEditor=function(E){this.endEditing(),this._currentEditor=E,this.redraw()},o.isEditing=function(m,x){var Q=this,q=Q._currentEditor;if(!q)return!1;if(x){var I=q.info;return I?(I.column||I.property)===x&&I.data===m:!1}return!0},o.endEditing=function(s){var v=this,T=v._currentEditor;T&&(delete v._currentEditor,T.commitValue&&T.commitValue(T.info,s),v.redraw(),v.getDataModel().endTransaction())},o.beginEditing=function(B){this.endEditing();var F=this,H=B.column||B.property;if(H.beginEditing)H.beginEditing(B);else{var c=B.data,$=B.value,b=F.getSelectBackground(c),d=H.getEnumValues(c),N=H.getSlider(c),h=H.getColorPicker(c);if(N){var u=$o(hb.Slider,N);return u.setValue($),u.getView().onblur=function(){F.endEditing()},u.isInstant()&&(u.onValueChanged=function(){F.setValue(c,H,u.getValue())}),nc(u,B),void 0}if(h||H.getValueType(c)===Ad){var p=$o(hb.ColorPicker,h);return p.setValue($),p.onClosed=function(){F.endEditing()},p.isInstant()&&(p.onValueChanged=function(p,n){F.setValue(c,H,n)}),nc(p,B),p.open(),void 0}if(d){if(hb.ComboBox){var M=new hb.ComboBox;M.setValue($),M.setValues(d),M.setLabels(H.getEnumLabels(c)),M.setIcons(H.getEnumIcons(c)),M.setEditable(H.isEnumEditable(c)),M.setStrict(H.isEnumStrict(c)),M.setMaxHeight(H.getEnumMaxHeight(c)),M.setDropDownWidth(H.getEnumDropDownWidth(c)),M.onClosed=function(){F.endEditing()},nc(M,B),M.open()}else li(Ac,B,b,d,H);return}var X=H.getValueType(c);if(X===rc||_g($))return F.setValue(c,H,!$),void 0;if(H.getItemEditor(c)){var r=Nf(H.getItemEditor(c)),G=new r(c,H,F,B),D=G.getView();return D._17Q=G,G.setValue($),Lh(D),nc(D,B),G.editBeginning&&G.editBeginning(),void 0}li("input",B,b,f,H)}}},_44o:function(Q){Q.init=function(G){var l=this,y=l.th=new jo(G),s=l._view=Yk(1,l);l.tv=l._tableView=G,tb(s,y.getView()),tb(s,G.getView()),y.mp(function(X){X.property===ee&&l.iv()}),l.iv()},Q.getTableView=function(){return this.tv},Q.getTableHeader=function(){return this.th},Q.getDataModel=function(){return this.tv.dm()},Q.getColumnModel=function(){return this.tv.getColumnModel()},Q.setColumns=function(X){this.tv.setColumns(X)},Q.addColumns=function($){this.tv.addColumns($)},Q.endEditing=function(){this.tv.endEditing()},Q.validateImpl=function(){var p=this,U=p.th,D=Hk(U),a={x:0,y:0,width:p.getWidth(),height:D};pn(U,a),a.y=D,a.height=o(0,p.getHeight()-D),pn(p.tv,a)}},ms_vs:function(L){L._41o=function(){return this._29I.height<this._59I},L._43o=function(){var Z=this;Z._41o()&&(Z._58I||($(function(){Z._94O()},Km),Z.iv()),Z._58I=new Date)},L._94O=function(){var u=this;if(u._58I){var x=new Date;x.getTime()-u._58I.getTime()>=Km?(delete u._58I,u.iv()):$(function(){u._94O()},Km)}},L._93I=function(){var I=this,r=I._27I;if(I._58I||!I._autoHideScrollBar){r||tb(I._79O,r=I._27I=wk());var x=I._29I,J=x.height,e=I._59I,t=I.getScrollBarSize(),T=x.width-t-2,M=J*(-I.ty()/e),X=J*(J/e),q=r.style;e>J?(No>X&&(M=M+X/2-No/2,0>M&&(M=0),M+No>J&&(M=J-No),X=No),q.visibility=Mb,q.background=I.getScrollBarColor(),q.borderRadius=t/2+se,pn(r,T,M,t,X)):q.visibility=gd}else r&&(r.style.visibility=gd)}},ms_hs:function(q){q._40o=function(){return this._29I.width<this._91I},q._42o=function(){var J=this;J._40o()&&(J._95O||($(function(){J._94I()},Km),J.iv()),J._95O=new Date)},q._94I=function(){var K=this;if(K._95O){var x=new Date;x.getTime()-K._95O.getTime()>=Km?(delete K._95O,K.iv()):$(function(){K._94I()},Km)}},q._92I=function(){var B=this,h=B._28I;if(B._95O||!B._autoHideScrollBar){h||tb(B._79O,h=B._28I=wk());var d=B._29I,U=d.width,H=B._91I,Z=B.getScrollBarSize(),P=d.height-Z-2,T=U*(-B.tx()/H),p=U*(U/H),n=h.style;H>U?(No>p&&(T=T+p/2-No/2,0>T&&(T=0),T+No>U&&(T=U-No),p=No),n.visibility=Mb,n.background=B.getScrollBarColor(),n.borderRadius=Z/2+se,pn(h,T,P,p,Z)):n.visibility=gd}else h&&(h.style.visibility=gd)}}}),up(Jc,On(16,16,[{type:Tr,rect:[1,1,14,14],background:$j},{type:Wh,rect:[1,1,14,14],width:1,color:Hi},{type:pl,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),up(Yd,On(16,16,{type:Wh,rect:[1,1,14,14],width:1,color:Hi})),up(Af,On(16,16,[{type:Yb,rect:[2,2,12,12],borderWidth:1,borderColor:Hi,background:"#FFF"},{type:Yb,rect:[4,4,8,8],background:$j}])),up(tf,On(16,16,{type:Yb,rect:[2,2,12,12],borderWidth:1,borderColor:Hi})),fr._15Q=function(G){G._29I=Xh,G._59I=0,G._91I=0,G._5o=function(Y){var j=this;j._30I=new Ek,j._rows=new Ek,j._rowMap={},j._31I=0,j._14I=0,j._view=Yk(1,j),j._canvas=Rc(j._view),tb(j._view,j._79O=wk()),j.dm(Y?Y:new Pl)},G.getCheckIcon=function(d){var O=this.sm(),V=O.co(d);return O.sg()?fg(V?Af:tf):fg(V?Jc:Yd)},G.checkData=function(l){var a=this.sm(),F=a.co(l);a.sg()&&F||(this._32o=1,F?a.rs(l):a.as(l),delete this._32o)},G.getDataAt=function(O){O.target&&(O=this.lp(O));var p=k(O.y/this._rowHeight),h=this._rows;return 0>p||p>=h.size()?f:h.get(p)},G.onDataDoubleClicked=function(){},G.onDataClicked=function(){},G.adjustTranslateX=function(){return 0},G.adjustTranslateY=function(I){var A=this.getHeight()-this._59I;return A>I&&(I=A),I>0?0:X(I)},G.onPropertyChanged=function(y){var d=this,s=y.property;Rh[s]?d.ivm():fm[s]||d.redraw(),s===lc?d._42o():s===Ym&&d._43o()},G.getLabel=function(e){return e.toLabel()},G.getLabelFont=function(){return this._labelFont},G.getLabelColor=function(S){var A=this;if(A.isCheckMode()){if(A._focusData===S)return A._labelSelectColor}else if(A.isSelected(S))return A._labelSelectColor;return A._labelColor},G.getStartRowIndex=function(){return this._31I},G.getEndRowIndex=function(){return this._14I},G.getRowDatas=function(){return this._rows},G.getRowIndex=function(u){return this._rowMap[u._id]},G.getRowSize=function(){return this._rows.size()},G.getViewRect=function(){return lg(this._29I)},G.isVisible=function(v){return this._visibleFunc?this._visibleFunc(v):!0},G.getCurrentSortFunc=function(){return this._sortFunc},G.setDataModel=function(O){var P=this,u=P._dataModel,T=P._selectionModel;u!==O&&(u&&(u.umm(P.handleDataModelChange,P),u.umd(P.handleDataPropertyChange,P),u.umh(P.handleHierarchyChange,P),T||u.sm().ums(P.handleSelectionChange,P)),P._dataModel=O,O.mm(P.handleDataModelChange,P),O.md(P.handleDataPropertyChange,P),O.mh(P.handleHierarchyChange,P),T?T._21I(O):O.sm().ms(P.handleSelectionChange,P),P.fp("dataModel",u,O))},G.validateModel=function(){var W=this;W._rows.clear(),W._rowMap={},W.buildChildren(W._dataModel._roots);var D=W._rows=W._rows.toList(W.isVisible,W),c=0,b=W.getCurrentSortFunc(),e=D.size();for(b&&D.sort(b);e>c;c++)W._rowMap[D.get(c)._id]=c},G.buildChildren=function(k){var W=this;k.each(function(p){W._rows.add(p),W.buildChildren(p._children)})},G.handleDataModelChange=function(){this.ivm()},G.handleDataPropertyChange=function(g){"parent"===g.property?this.ivm():this.invalidateData(g.data)},G.handleHierarchyChange=function(){this.ivm()},G.handleSelectionChange=function(N){N.datas.each(this.invalidateData,this),this.onSelectionChanged(N)},G.onSelectionChanged=function(h){var R=this,Y=R.sm();!R.isAutoMakeVisible()||1!==Y.size()||"set"!==h.kind&&"append"!==h.kind||R._32o||R.makeVisible(Y.ld())},G.handleBackgroundClick=function(X){Bb(X)&&!this.isCheckMode()&&this.sm().cs()},G.makeVisible=function(b){b&&(this._23I=b,this.iv())},G.scrollToIndex=function(d){var y=this,X=y._29I,J=X.height,N=y._rowHeight,F=N*d;d>=0&&d<y._rows.size()&&J>0&&(F+N>X.y+J?y.ty(-F+J-N):F<X.y&&y.ty(-F))},G.autoScroll=function(x,n){var C=this,H=C._rowHeight,u=H,r=H/4,b=C._29I,P=C.lp(x),Z={x:C.tx(),y:C.ty()};return H>0&&b&&(P.x-b.x<u?C.translate(r,0):b.x+b.width-P.x<u&&C.translate(-r,0),P.y-b.y<u?C.translate(0,r):b.y+b.height-P.y<u&&C.translate(0,-r)),Z.x=C.tx()-Z.x,Z.y=C.ty()-Z.y,n&&(n.x+=Z.x,n.y+=Z.y),Z},G.getTopRowOrderSelection=function(){var h=this.sm().getTopSelection(),E={},R=new Ek;return h.each(function(B){E[B._id]=B}),this._rows.each(function(r){E[r._id]&&R.add(r)}),R},G.getRowOrderSelection=function(){var x=new Ek;return this._rows.each(function(y){this.isSelected(y)&&x.add(y)},this),x},G.ivm=function(){this.invalidateModel()},G.invalidateModel=function(){var q=this;q._96I||(q._96I=1,q._32I=1,delete q._24I),q.iv()},G.redraw=function(){var K=this;K._32I||(K._32I=1,delete K._24I,K.iv())},G.invalidateData=function(j){var w=this;O?w.redraw():w._32I||(w._24I||(w._24I={}),w._24I[j._id]=j,w.iv())},G.getFocusData=function(){return this._focusData},G.setFocusDataById=function(J){this.setFocusData(this.dm().getDataById(J))},G.setFocusData=function(z){var N=this,W=N._focusData;W!==z&&(N._focusData=z,N.fp("focusData",W,z),W&&N.invalidateData(W),z&&(N.invalidateData(z),N.isAutoMakeVisible()&&N.makeVisible(z)))},G.drawRowBackground=function(S,Q,e,K,E,F,P){var y=this,N=y.isCheckMode();(Q===y._focusData&&N||e&&!N)&&tj(S,K,E,F,P,y.getSelectBackground(Q))},G.drawData=function(D,j,O){var x=this,Y=x._rowHeight,X=Y*O,m=x._29I,C=m.x,z=m.width;D.save(),D.beginPath(),D.rect(C,X,z,Y),D.clip(),x._87o(x.drawRow(D,j,x.isSelected(j),C,X,z,Y),O,C,X,z,Y),D.restore(),x._rowLineVisible&&tj(D,C,X+Y-1,z,1,x._rowLineColor)},G._12I=function(z){var H=this,Q=H._31I,s=H._29I,c=s.x,K=s.y,q=s.width,m=s.height;for(z.beginPath(),z.rect(c,K,q,m),z.clip(),z.clearRect(c,K,q,m),H._76o(),H._93db(z);Q<H._14I;Q++)H.drawData(z,H._rows.get(Q),Q);H._92db(z)},G._13I=function(v){for(var L,x=this,E=x._rowHeight,z=x._29I,n=z.x,H=z.width,h=x._31I,g=x._30I;h<x._14I;h++)L=x._rows.get(h),x._24I[L._id]&&g.add({data:L,index:h});g.isEmpty()||(v.beginPath(),g.each(function(A){v.rect(n,A.index*E,H,E)}),v.clip(),g.each(function(s){v.clearRect(n,s.index*E,H,E)}),g.each(function(m){x._77o(m.index)}),x._93db(v),g.each(function(M){x.drawData(v,M.data,M.index)}),x._92db(v),g.clear())},G.validateImpl=function(){var v=this,L=v._canvas,M=v.getWidth(),e=v.getHeight(),g=v._rowHeight,j=v._32I;(M!==L.clientWidth||e!==L.clientHeight)&&(ur(L,M,e),j=1);var T=h&&!Y;v._96I&&!T&&v.validateModel();var E=v._29I,_={x:-v.tx(),y:-v.ty(),width:M,height:e},R=v._rows.size(),n=Gi(L),y=v._23I;j||Gm(_,E)||(j=1),v._29I=_,v._59I=R*g,v._31I=k(_.y/g),v._14I=W((_.y+_.height)/g),v._31I<0&&(v._31I=0),v._14I>R&&(v._14I=R),v._99I&&j&&v._99I(),Dp(n,v.tx(),v.ty(),1),j?v._12I(n):v._24I&&v._13I(n),v._93I(),v._92I(),n.restore(),v._32I=v._24I=v._96I=f,y&&(v.scrollToIndex(v.getRowIndex(y)),delete v._23I),v.tx(v.tx()),v.ty(v.ty())}},fr._48o=function(F){F._rootVisible=!0,F._rootData=f,F._35o=function(){this._expandMap={},this._levelMap={}},F.validateModel=function(){var U=this,B=U._rootData;U._rows.clear(),U._levelMap={},U._rowMap={},U._currentLevel=0,B?U._rootVisible?U.isVisible(B)&&U.buildData(B):U.buildChildren(B):U.buildChildren(),delete U._currentLevel},F.buildData=function(j){var O=this,J=j._id,c=O._rows;O._rowMap[J]=c.size(),c.add(j),O._levelMap[J]=O._currentLevel,O.isExpanded(j)&&(O._currentLevel++,O.buildChildren(j),O._currentLevel--)},F.buildChildren=function(W){var n=this,i=W?W._children:n._dataModel._roots,G=n.getCurrentSortFunc();G&&n.isChildrenSortable(W)?i.toList(n.isVisible,n).sort(G).each(n.buildData,n):i.each(function(H){n.isVisible(H)&&n.buildData(H)})},F.getLevel=function(i){return this._levelMap[i._id]},F.getToggleIcon=function(t){var l=this,m=l._loader,H=l._collapseIcon;return m&&!m.isLoaded(t)?H:t.hasChildren()?l.isExpanded(t)?l._expandIcon:H:f},F.isCheckMode=function(){return this._checkMode!=f},F.isChildrenSortable=function(){return!0},F.handleDataModelChange=function(s){var Z=this;s.kind===Dm?delete Z._expandMap[s.data._id]:s.kind===Ak&&(Z._expandMap={}),Z.ivm()},F.toggle=function(M){var w=this;w.isExpanded(M)?w.collapse(M):w.expand(M)},F.isExpanded=function(P){return 1===this._expandMap[P._id]},F.expand=function(Q){var Y=this,m=Y._loader;Y.isExpanded(Q)||(m&&!m.isLoaded(Q)&&m.load(Q),Y._expandMap[Q._id]=1,Y.ivm(),Y.onExpanded(Q))},F.onExpanded=function(){},F.collapse=function(D){var x=this;x.isExpanded(D)&&(delete x._expandMap[D._id],x.ivm(),x.onCollapsed(D))},F.onCollapsed=function(){},F.expandAll=function(z){if(z)this.expand(z),z.eachChild(function(d){this.expandAll(d)},this);else{var b=this;b._dataModel.each(function(A){A.hasChildren()&&(b._expandMap[A._id]=1)}),b.ivm()}},F.collapseAll=function(){this._expandMap={},this.ivm()},F.makeVisible=function(A){if(A){var S=this;if(!S._rootData||A.isDescendantOf(S._rootData)){for(var d=A._parent;d;)S.expand(d),d=d._parent;S._23I=A,S.iv()}}},F.checkData=function(f){var o,d=this,k=d._checkMode,G=d.sm(),F=G.co(f);if(!G.sg()||!F){if(d._32o=1,k===ad)F?G.rs(f):G.as(f);else if(k===dc)o=new Ek(f),o.addAll(f._children);else if("descendant"===k)o=new Ek,Uh(f,o);else if("all"===k&&(o=new Ek,Uh(f,o),!F))for(var t=f._parent;t;)o.add(t),t=t._parent;o&&(F?G.rs(o):G.as(o)),delete d._32o}},F._97I=function(W,Q,Z,N,n,F,$){var w=this,p=w._indent,o=w._levelMap[Q._id],k=w.getIconWidth(Q),G=fg(w.getToggleIcon(Q));G?(N+=p*o,_l(W,G,N+p/2,n+$/2,Q,w),N+=p):N+=p*(o+1),w._checkMode&&(_l(W,w.getCheckIcon(Q),N+p/2,n+$/2,Q,w),N+=p),w.drawIcon(W,Q,N,n,k,$),w.drawLabel(W,Q,N+k,n,$)}},fr._14Q=function(e){e.getIcon=function(F){return F.getIcon()},e.getIconWidth=function(Z){return this.getIcon(Z)?this._indent:0},e.drawIcon=function(_,x,M,O,W,k){if(W){var T=this,B=T.getBodyColor(x),f=fg(T.getIcon(x),B);f&&(k-=T.isRowLineVisible()?1:0,Do(_,f,Sm,M,O,W,k,x,T,B),me(_,T.getBorderColor(x),M,O,W,k))}},e.drawLabel=function(_,r,L,J,w){var j=this;Th(_,j.getLabel(r),j.getLabelFont(r),j.getLabelColor(r),L,J,0,w)}},fr._50o=function(t){t._98I=function(){var B=this,b=B._39o=new Pl;B._60I=new Ek,b.mm(B._17o,B),b.md(B._18o,B),b.mh(B._19o,B)},t.setColumns=function(C){this._39o.clear(),this.addColumns(C)},t.addColumns=function(D){var M=this._39o;D.forEach(function(y){if(!(y instanceof vn)){var K=Nf(y.className);y=$o(K?K:vn,y)}M.add(y)})},t.onColumnClicked=function(){},t.onCheckColumnClicked=function(){},t._3Q=function(W){for(var l,k=0,M=this._60I,h=M.size();h>k;k++)if(l=M.get(k),l.column===W)return l;return f},t.getColumnAt=function(k){var u=this._4Q(k);return u?u.column:f},t._4Q=function(P){for(var s=this,d=P.target?s.lp(P).x:P.x,E=s._60I,D=0;D<E.size();D++){var N=E.get(D),b=N.startX;if(d>=b&&d<b+N.column.getWidth())return N}return f},t.getToolTip=function(_){var i=this,b=i.getDataAt(_),H=i.getColumnAt(_);return b&&H?H.getToolTip(b,i):f},t.adjustTranslateX=function(Q){var J=this.getWidth()-this._91I;return J>Q&&(Q=J),Q>0?0:X(Q)},t._99I=function(){var h=this,E=h._29I,P=h._60I;P.clear(),h._91I=0,h._39o._roots.each(function(z){if(z.isVisible()){var u=h._91I+z.getWidth();h._91I<=E.x+E.width&&u>=E.x&&P.add({column:z,startX:h._91I}),h._91I=u}})},t.drawData=function(j,P,G){var A=this,g=A._rowHeight,x=g*G,m=A.isSelected(P),p=A._29I,r=p.x,S=p.width;A.drawRowBackground(j,P,m,r,x,S,g),A._60I.each(function(i){var D=i.column,W=i.startX,L=D.getWidth();L>0&&!A.isEditing(P,D)&&(j.save(),j.beginPath(),j.rect(W,x,L,g),j.clip(),A._87o(A.drawCell(j,P,m,D,W,x,L,g),G,W,x,L,g),A._columnLineVisible&&tj(j,W+L-1,x,1,g,A._columnLineColor),j.restore())}),A._rowLineVisible&&tj(j,r,x+g-1,S,1,A._rowLineColor)},t.drawCell=function(x,r,p,d,v,J,y,V){var t=this;if(d.drawCell)return d.drawCell(x,r,p,d,v,J,y,V,t);var m=t.getValue(r,d);bp(x,m,d,t.getLabelFont(r,d,m),t.getLabelColor(r,d,m),v,J,y,V,r,t)},t.getColumnModel=function(){return this._39o},t._17o=function(){this.redraw()},t._18o=function(F){var i=this;F.data===i._sortColumn&&Uo[F.property]?i.ivm():(i._42o(),i.redraw())},t._19o=function(){this.redraw()},t.getCurrentSortFunc=function(){var F=this,S=F._sortColumn;if(S&&S.isSortable()){var d=S.getSortFunc(),p=uj===S.getSortOrder()?1:-1;return d||(d=ui),function(H,j){return d.call(F,F.getValue(H,S),F.getValue(j,S),H,j)*p}}return F._sortFunc},t.isCellEditable=function(x,S,R){return(!this.isCheckMode()&&this.isSelected(x)||this.isCheckMode()&&x===this._focusData)&&S.isEditable()&&this.isEditable()?S.isCellEditable?S.isCellEditable(x,S,R,this):!0:!1},t._37O=function(s,B){if(Bb(B))for(var W=this,O=W.lp(B),$=W._60I,g=W._rowHeight,w=W._29I,n=w.x,l=w.y,L=w.width,Z=w.height,I=0;I<$.size();I++){var E=$.get(I),u=E.startX,X=E.column,p=X.getWidth();if(X!==W._31o&&X!==W._4o&&O.x>=u&&O.x<u+p&&W.isCellEditable(s,X,B)){var d={x:u,y:W.getRowIndex(s)*g,width:p,height:g},v={x:d.x+W.tx(),y:d.y+W.ty(),width:d.width,height:d.height},G=0,K=0;return d.x<n?G=d.x-n:d.x+d.width>n+L&&(G=d.x+d.width-n-L),G&&(W.tx(W.tx()-G),v.x-=G),d.y<l?K=d.y-l:d.y+g>l+Z&&(K=d.y+g-l-Z),K&&(W.ty(W.ty()-K),v.y-=K),W.beginEditing({data:s,column:X,value:W.getValue(s,X),event:B,rect:d,editorRect:v,view:W}),void 0}}}},hb.BaseItemEditor=function(P,h,v,R){this._data=P,this._column=h,this._master=v,this._editInfo=R},Ke("BaseItemEditor",p,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var nj=K.Tab=function(){gm(nj,this)};Xn("Tab",yd,{ms_ac:["view","closable","disabled"],_icon:f,_closable:!1,_disabled:!1,setParent:Kh});var vn=K.Column=function(){gm(vn,this)};Xn("Column",yd,{_46o:1,ms_ac:["accessType","valueType",Mb,sh,en,Ej,"align",Ad,"sortOrder",Hd,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:uj,_sortFunc:f,_sortable:!0,_clickable:!0,setWidth:function(h){16>h&&(h=16);var v=this._width;this._width=h,this.fp(Ej,v,h)},getToolTip:function($,n){return this.formatValue(n.getValue($,this))}});var Jp=K.Property=function(){gm(Jp,this)};Xn("Property",yd,{_46o:1,ms_ac:["accessType","valueType",sh,en,"categoryName",Ad,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:f,getToolTip:function(H,X,k){var a=this;return X?a.formatValue(k.getValue(H,a)):k.getPropertyName(a)}}),hb.AccordionView=function(){var j=this;j._20o={},j._21o=new Ek,j._10o=f,j._9o=f,j._11o=f,j._view=Yk(0,j),j.iv()},Ke("AccordionView",p,{ms_v:1,ms_fire:1,ms_ac:[iq,bb,"titleHeight",Wb,Xd,"titleBackground","selectWidth",Qj,"orientation","separatorColor"],_expandIcon:G.accordionViewExpandIcon,_collapseIcon:G.accordionViewCollapseIcon,_titleHeight:_i,_labelColor:G.accordionViewLabelColor,_labelFont:G.accordionViewLabelFont,_titleBackground:G.accordionViewTitleBackground,_selectBackground:G.accordionViewSelectBackground,_selectWidth:G.accordionViewSelectWidth,_orientation:"v",_separatorColor:G.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()
},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(y,L,m,E){var U=this,H=wk();if(U._20o[y])throw y+" already exists";H.onmousedown=lb,H.style.cursor=aj,H.addEventListener(Tf?or:oo,function(m){lb(m)},!1),H.addEventListener(Tf?km:Kq,function(p){lb(p),Bb(p)&&(U._10o===y?U.collapse():U.expand(y))},!1),tb(U._view,H),U._20o[y]={content:L,div:H,canvas:Rc(H),icon:E},U._21o.add(y),m&&U.expand(y),U.iv()},remove:function(C){var k=this,i=k._20o[C];i&&(vk(i.div),delete k._20o[C],k._21o.remove(C),k.iv())},clear:function(){var y=this;y._21o.toArray().forEach(y.remove,y),y._20o={},y._21o.clear(),y.iv()},isExpanded:function(t){return this._10o===t},expand:function(I){var l=this;l._20o[I]&&l._10o!==I&&(l._10o=I,l.onExpanded(I),l.iv())},onExpanded:function(){},collapse:function(){var I=this;I._10o&&(I.onCollapsed(I._10o),delete I._10o,I.iv())},onCollapsed:function(){},initCanvas:function(y,x,c){ur(y,x,c);var U=Gi(y);return Dp(U,0,0,1),U.clearRect(0,0,x,c),U},drawTitle:function(y,Z,n,J,N){var b=this,O=fg(N.icon),U=b.isExpanded(Z),Q=b._titleHeight,F=b._titleBackground,h=b._selectWidth,j=b._separatorColor,C=fg(U?b._expandIcon:b._collapseIcon),V=h+4;tj(y,0,0,n,J,F),U&&h&&tj(y,0,0,h,J,b._selectBackground),(U||b._21o.get(b._21o.size()-1)!==Z)&&tj(y,0,J-1,n,1,j?j:Wm(F)),O&&(_l(y,O,V+Nj(O)/2,Q/2),V+=Nj(O)+2),Th(y,Z,b.getLabelFont(Z),b.getLabelColor(Z),V,0,0,Q),C&&_l(y,C,n-Nj(C)/2-4,Q/2)},validateImpl:function(){var R=this,Z=R._view,n=0,g=0,H=R.getWidth(),W=R.getHeight(),z=R._titleHeight,h=R._21o.size()*z,v=R._11o,t=R._9o;delete R._11o,delete R._9o,R._21o.each(function(y){var u,T,$=R._20o[y],v=$.content,I=R._10o===y;Pk(R)?(pn($.div,n,0,z,W),u=R.initCanvas($.canvas,z,W),_h(u,0,W),Df(u,-x),R.drawTitle(u,y,W,z,$),u.restore(),I?(T=o(0,H-h),v&&(R._11o=v,R._9o=jh(v),pn(v,n+z,0,T,W)),n+=z+T):n+=z):(pn($.div,0,g,H,z),u=R.initCanvas($.canvas,H,z),R.drawTitle(u,y,H,z,$),u.restore(),I?(T=o(0,W-h),v&&(R._11o=v,R._9o=jh(v),pn(v,0,g+z,H,T)),g+=z+T):g+=z)});var G=R._9o;v&&v!==R._11o&&v.endEditing&&v.endEditing(),G&&G!==t&&tb(Z,G),t&&t!==G&&vk(t)}}),hb.SplitView=function(E,l,B,x){var W=this,m=W._dividerDiv=wk(),j=W._60O=Rc(),H=W._61O=Rc(),s=j.style,A=H.style;W._view=Yk(1,W),tb(W._view,m),s.msTouchAction=Uq,s.pointerEvents=Uq,s.cursor=aj,A.msTouchAction=Uq,A.pointerEvents=Uq,A.cursor=aj,E&&W.setLeftView(E),l&&W.setRightView(l),B&&W.setOrientation(B),x!=f&&W.setPosition(x),W.setStatus(no),new sn(W)},Ke("SplitView",p,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:G.splitViewDividerSize,_dividerBackground:G.splitViewDividerBackground,_dragOpacity:G.splitViewDragOpacity,_toggleIcon:G.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(W,K){var n=this,p=n._position;isNaN(W)||(K||(n._82O=0>W?-1:W>1?1:0),n._position=W,n.fp(Zd,p,W))},getLeftView:function(){return this._leftView},setLeftView:function(l){var $=this,t=$._leftView,j=$._view;if($._leftView!==l){if(t&&t!==$._rightView){var Y=jh(t);Y.parentNode===j&&vk(Y)}if($._leftView=l,l){var v=jh(l);v.parentNode!==j&&j.insertBefore(v,$._dividerDiv)}$.fp("leftView",t,l)}},getRightView:function(){return this._rightView},setRightView:function(R){var x=this,$=x._rightView,Q=x._view;if(x._rightView!==R){if($&&$!==x._leftView){var f=jh($);f.parentNode===Q&&vk(f)}if(x._rightView=R,R){var d=jh(R);d.parentNode!==Q&&Q.insertBefore(d,x._dividerDiv)}x.fp("rightView",$,R)}},validateImpl:function(){var I=this,k=I._draggable,V=I._position,M=I.getWidth(),K=I.getHeight(),g=I._dividerSize,T=I._dividerBackground,C=Tf?18:8,U=I._dividerDiv,a=I._82O,n=I._60O,i=I._61O,l=I._toggleIcon,b=I._status,O=U.style,r=null,m=Tf?20:4,G=l.comps[0];g>=C||0===g?I._coverDiv&&(vk(I._coverDiv),delete I._coverDiv):I._coverDiv||(I._coverDiv=wk(),D&&(I._coverDiv.style.background=fj),tb(U,I._coverDiv)),I._togglable?n.parentNode||(tb(U,n),tb(U,i)):(vk(n),vk(i));var R=I._coverDiv,e=I._leftView,d=I._rightView;if(Pk(I)){if(g>M&&(g=M),b===no)if(1===a)var c=S(V,M),F=o(0,M-g-c);else-1===a?(F=S(-V,M),c=o(0,M-g-F)):(c=X((M-g)*V),F=o(0,M-g-c));else"cl"===b?(c=0,F=o(0,M-g)):"cr"===b&&(F=0,c=o(0,M-g));e&&pn(e,0,0,c,K),d&&pn(d,c+g,0,F,K),pn(U,c,0,g,K),I._22o=c,R&&(pn(R,g/2-C/2,0,C,K),R.style.cursor=k?zl:""),U.style.cursor=k?zl:"";var j=U.clientHeight/2,p=U.clientWidth;ur(n,p,p),pn(n,0,j-p-m,p,p),r=Gi(n),Dp(r,0,0,1),G.rotation=-x,ei(r,l,0,0,p,p),r.restore(),ur(i,p,p),pn(i,0,j+m,p,p),r=Gi(i),Dp(r,0,0,1),G.rotation=x,ei(r,l,0,0,p,p),r.restore()}else{if(g>K&&(g=K),b===no)if(1===a)var N=S(V,K),h=o(0,K-g-N);else-1===a?(h=S(-V,K),N=o(0,K-g-h)):(N=X((K-g)*V),h=o(0,K-g-N));else"cl"===b?(N=0,h=o(0,K-g)):"cr"===b&&(h=0,N=o(0,K-g));e&&pn(e,0,0,M,N),d&&pn(d,0,N+g,M,h),pn(U,0,N,M,g),I._22o=N,R&&(pn(R,0,g/2-C/2,M,C),R.style.cursor=k?vi:""),O.cursor=k?vi:"";var z=U.clientWidth/2,p=U.clientHeight;ur(n,p,p),pn(n,z-p-m,0,p,p),r=Gi(n),Dp(r,0,0,1),G.rotation=0,ei(r,l,0,0,p,p),r.restore(),ur(i,p,p),pn(i,z+m,0,p,p),r=Gi(i),Dp(r,0,0,1),G.rotation=L,ei(r,l,0,0,p,p),r.restore()}O.background=T}});var sn=function(b){this.sv=b,this.addListeners()};Gh(sn,p,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(H){var K=this,D=K.sv,O=D._dividerDiv,i=D._60O,I=D._61O,n=D._status,b=H.target;if(b===i)n===no?D.setStatus("cl"):"cr"===n&&D.setStatus(no);else if(b===I)n===no?D.setStatus("cr"):"cl"===n&&D.setStatus(no);else if(Zb(H)&&(b===O||b===D._coverDiv)&&(lb(H),D.isDraggable())){D.getLeftView(),D.getRightView();var R=K.maskDiv=wk();if(R.style.left=0,R.style.top=0,R.style.width=D.getWidth()+"px",R.style.height=D.getHeight()+"px",D.getView().appendChild(R),!D.isContinuousLayout()){var S=K.resizeDiv=wk();S.style.left=O.style.left,S.style.top=O.style.top,S.style.width=O.style.width,S.style.height=O.style.height,S.style.opacity=D.getDragOpacity(),S.style.background=D.getDividerBackground(),tb(K.getView(),S)}K._lastAbsPosition=D._22o,K._86o=Pk(D)?Jk(H).x:Jk(H).y,Zo(K,H)}},handleWindowTouchMove:function(U){Zb(U)&&this.update(U,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(y){var $=this;$.update(y,!0),$.sv.setStatus(no),$.maskDiv&&vk($.maskDiv),$.resizeDiv&&vk($.resizeDiv),$.maskDiv=$.resizeDiv=f},handle_mousedown:function(y){Bb(y)&&this.handle_touchstart(y)},handleWindowMouseMove:function(I){this.handleWindowTouchMove(I)},handleWindowMouseUp:function(N){this.handleWindowTouchEnd(N)},update:function(R,$){var x=this,U=x.sv,w=Pk(U)?U.getWidth():U.getHeight(),N=U._dividerSize,Z=x._lastAbsPosition-x._86o;Pk(U)?(Z+=Jk(R).x,Z>w-N&&(Z=w-N),0>Z&&(Z=0),x.resizeDiv&&(x.resizeDiv.style.left=Z+se)):(Z+=Jk(R).y,Z>w-N&&(Z=w-N),0>Z&&(Z=0),x.resizeDiv&&(x.resizeDiv.style.top=Z+se)),$&&w!==N&&(1===U._82O?U.setPosition(Z,1):-1===U._82O?U.setPosition(Z-w+N,1):U.setPosition(Z/(w-N),1))}}),hb.TabView=function(){var m=this,y=m._view=Yk(1,m),L=m._91O=wk(1),X=m._tabModel=new Pl,P=X.sm(),t=m.invalidate;m._7o=new Ek,m._canvas=Rc(L),tb(y,L),tb(y,m._92O=wk(1)),P.setSelectionMode(yl),P.ms(m.handleSelectionChange,m),X.mm(t,m),X.md(t,m),X.mh(t,m),new vm(m),m.iv()},Ke("TabView",p,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Wb,Xd,"tabBackground","selectWidth",Qj,"moveBackground","insertColor"],_tabPosition:Jb,_tabHeight:_i,_tabGap:G.tabViewTabGap,_labelColor:G.tabViewLabelColor,_labelFont:G.tabViewLabelFont,_tabBackground:G.tabViewTabBackground,_selectWidth:G.tabViewSelectWidth,_selectBackground:G.tabViewSelectBackground,_moveBackground:G.tabViewMoveBackground,_insertColor:G.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(R,f,i){var E=new nj,Z=this._tabModel;return E.setName(R),E.setView(f),Z.add(E),i&&Z.sm().ss(E),E},getLabel:function(m){return m.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(Z){this._23o=Z,this.iv()},get:function(q){var A=this,Z=A._tabModel;if(mj(q))return Z._roots.get(q);if(cr(q)){var d;return Z.each(function(O){q===A.getLabel(O)&&(d=O)}),d}return q instanceof nj?q:f},select:function(S){this._tabModel.sm().ss(this.get(S))},remove:function(k){var o=this;if(k=o.get(k)){var z=o._tabModel,X=z._roots.indexOf(k);o._tabModel.remove(k),o._12Q(--X)}},getCurrentTab:function(){return this._8o},hideTabView:function(b,q){q.parentNode===this._92O&&(Dl(q)?(q.style.display=tp,q._tab_=b):vk(q),Rb())},showTabView:function(f,$){Dl($)&&($.style.display="block",$._tab_=f),$.parentNode!==this._92O&&(tb(this._92O,$),Rb())},_24o:function(){var s,T=this,m=T._8o,r=T._9o,E=T._tabModel.sm().ld();E&&(s=jh(E.getView())),s!==r&&(r&&(m.getView()&&m.getView().endEditing&&m.getView().endEditing(),T.hideTabView(m,r)),s&&T.showTabView(E,s)),T._8o=E,T._9o=s,m!==E&&T.onTabChanged(m,E)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(q,h){this._12Q(--h)},_12Q:function(i){var l=this,X=l._tabModel,p=X.size();if(p&&!X.sm().ld()){i==f&&(i=0),i>=p&&(i=p-1),0>i&&(i=0);for(var M=i;M>=0;M--){var D=l.get(M);if(!D.isDisabled())return l.select(D),D}for(M=i+1;p>M;M++)if(D=l.get(M),!D.isDisabled())return l.select(D),D}},getTabWidth:function(y){var g=4,Y=fg(y.getIcon());Y&&(g+=Nj(Y,y)+4);var q=this.getLabel(y);return q&&(g+=kn(this.getLabelFont(y),q).width+4),y.isClosable()&&(g+=10),g},drawTab:function(r,e,E,Y,y,G,n){var D,m=this,p=m._tabPosition,F=E+4,T=m._selectWidth,z=fg(e.getIcon()),v=e.isDisabled(),j=m.getLabelColor(e),H=m.getLabelFont(e),g=m.getLabel(e),l=m._selectBackground,i=p===Rj+"-vertical",q=p===$e+"-vertical";(i||q)&&(F=Y+4),v&&(r.globalAlpha=ko),tj(r,E,Y,y,G,n),e===m._8o&&T&&(p===Jb?tj(r,E,Y+G-T,y,T,l):p===Rj?tj(r,E+y-T,Y,T,G,l):p===$e?tj(r,E,Y,T,G,l):i?tj(r,E+y-T,Y,T,G,l):q?tj(r,E,Y,T,G,l):tj(r,E,Y,y,T,l));var U=y/2;if(i&&(_h(r,U,Y+G/2),Df(r,L),_h(r,-U,-Y-G/2)),z){var I=od(z,e),h=Nj(z,e);if(i||q){var N=E+y/2,O=F+I/2;_h(r,N,O),Df(r,x),_h(r,-N,-O),_l(r,z,E+y/2,F+I/2,e,m),_h(r,N,O),Df(r,-x),_h(r,-N,-O),F+=I+4}else _l(r,z,F+h/2,Y+G/2,e,m),F+=h+4}return i||q?(_h(r,y/2,F+y/2),Df(r,x),_h(r,-y/2,-F-y/2),Th(r,g,H,j,E,F,G,y),_h(r,y/2,F+y/2),Df(r,-x),_h(r,-y/2,-F-y/2)):Th(r,g,H,j,F,Y,y,G),i&&(_h(r,U,Y+G/2),Df(r,-L),_h(r,-U,-Y-G/2)),e.isClosable()&&(D=q?{x:E+y-12,y:Y+G-12,width:12,height:12}:{x:E+y-12,y:Y+2,width:12,height:12},this.drawCloseIcon(e,r,j,D)),v&&(r.globalAlpha=1),D},drawCloseIcon:function(G,D,J,v){var K=v.x,Y=v.y;D.strokeStyle=J,D.lineWidth=1,D.beginPath(),D.moveTo(K+2,Y+8),D.lineTo(K+8,Y+2),D.moveTo(K+8,Y+8),D.lineTo(K+2,Y+2),D.stroke()},validateImpl:function(){var U=this;U._24o();var Z,C=U._canvas,R=U._tabPosition,F=U._91O,S=U._92O,g=U._tabModel,V=U.getWidth(),I=U.getHeight(),d=U._tabHeight,t=U._7o,q=U._tabGap,h=R===Jb,b=R===Rj,T=R===$e,r=R===Rj+"-vertical",j=R===$e+"-vertical",x=U._23o,n=0;if((b||T)&&g._roots.each(function(t){n=o(U.getTabWidth(t),n)}),h?(pn(F,0,0,V,d),Z={x:0,y:d,width:V,height:o(0,I-d)}):b?(pn(F,0,0,n,I),Z={x:n,y:0,width:o(0,V-n),height:I}):T?(pn(F,V-n,0,n,I),Z={x:0,y:0,width:o(0,V-n),height:I}):r?(pn(F,0,0,d,I),Z={x:d,y:0,width:o(0,V-d),height:I}):j?(pn(F,V-d,0,d,I),Z={x:0,y:0,width:o(0,V-d),height:I}):(pn(F,0,I-d,V,d),Z={x:0,y:0,width:V,height:o(0,I-d)}),pn(S,Z),r||j){U._9o&&(Z.x=0,pn(U._8o.getView(),Z)),ur(C,d,I);var M=Gi(C),l=0;if(Dp(M,0,U.ty(),1),M.clearRect(0,0,d,I),t.clear(),g._roots.each(function(R){var r,z=U.getTabWidth(R);x&&x.tab===R||(r=U.drawTab(M,R,0,l,d,z,U._tabBackground)),t.add({_75o:r,tab:R,startY:l,endY:l+z,height:z}),l+=z+q}),U._23Q=o(0,l-q),x){var A=x.position;U.drawTab(M,x.tab,0,x.startY,d,x.height,U._moveBackground),tj(M,0,A,d,1,U._insertColor)}if(M.restore(),U._selectionChanged){U._selectionChanged=!1;for(var Q=U.ty(),O=0;O<t.size();O++){var E=t.get(O);if(E.tab===U._8o){if(E.endY+Q<0){U.ty(-E.startY);break}if(E.startY+Q>I){U.ty(I-E.endY);break}}}}U.ty(U.ty())}else if(b||T){U._9o&&(Z.x=0,pn(U._8o.getView(),Z)),ur(C,n,I);var M=Gi(C),l=0;if(Dp(M,0,U.ty(),1),M.clearRect(0,0,n,I),t.clear(),g._roots.each(function(k){var B;x&&x.tab===k||(B=U.drawTab(M,k,0,l,n,d,U._tabBackground)),t.add({_75o:B,tab:k,startY:l,endY:l+d,height:d}),l+=d+q}),U._23Q=o(0,l-q),x){var A=x.position;U.drawTab(M,x.tab,0,x.startY,n,x.height,U._moveBackground),tj(M,0,A,n,1,U._insertColor)}if(M.restore(),U._selectionChanged){U._selectionChanged=!1;for(var Q=U.ty(),O=0;O<t.size();O++){var E=t.get(O);if(E.tab===U._8o){if(E.endY+Q<0){U.ty(-E.startY);break}if(E.startY+Q>I){U.ty(I-E.endY);break}}}}U.ty(U.ty())}else{U._9o&&(Z.y=0,pn(U._8o.getView(),Z)),ur(C,V,d);var M=Gi(C),_=0;if(Dp(M,U.tx(),0,1),M.clearRect(0,0,V,d),t.clear(),g._roots.each(function(G){var b,H=U.getTabWidth(G);x&&x.tab===G||(b=U.drawTab(M,G,_,0,H,d,U._tabBackground)),t.add({_75o:b,tab:G,startX:_,endX:_+H,width:H}),_+=H+q}),U._64I=o(0,_-q),x){var A=x.position;U.drawTab(M,x.tab,x.startX,0,x.width,d,U._moveBackground),Vk(M,U._insertColor,A,0,d)}if(M.restore(),U._selectionChanged){U._selectionChanged=!1;for(var f=U.tx(),O=0;O<t.size();O++){var E=t.get(O);if(E.tab===U._8o){if(E.endX+f<0){U.tx(-E.startX);break}if(E.startX+f>V){U.tx(V-E.endX);break}}}}U.tx(U.tx())}for(var J=[],m=S.children,O=0;O<m.length;O++){var c=m[O],k=c._tab_;k&&!g.contains(k)&&J.push(c)}J.forEach(function(T){S.removeChild(T)})}});var vm=function(x){this.tv=x,this.addListeners()};Gh(vm,p,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(i){this.handleScroll(i,10*(i.wheelDelta/40))},handle_DOMMouseScroll:function(T){this.handleScroll(T,10*-T.detail)},handleScroll:function(O,M){lb(O);var b=this.tv,r=b._tabPosition;!b._40o()||r!==Jb&&r!==De||b.tx(this.tv.tx()+M),!b._41o()||r!==Rj&&r!==$e&&r!==Rj+"-vertical"&&r!==$e+"-vertical"||b.ty(this.tv.ty()+M)},_8Q:function(X){var K,M,y=this.tv,P=y._tabPosition,Q=y._7o;if(P===Jb||P===De){var w=y.lp(X).x;for(K=0;K<Q.size();K++)if(M=Q.get(K),M.startX<=w&&w<=M.endX)return M}else if(P===Rj||P===$e||P===Rj+"-vertical"||P===$e+"-vertical"){var W=y.lp(X).y;for(K=0;K<Q.size();K++)if(M=Q.get(K),M.startY<=W&&W<=M.endY)return M}return f},isClickable:function(K){var k=this.tv,o=k._tabPosition,t=this._73o=this._8Q(K);return!k._40o()||o!==Jb&&o!==De?!k._41o()||o!==Rj&&o!==$e&&o!==Rj+"-vertical"&&o!==$e+"-vertical"?t&&(!t.tab.isDisabled()||k.isMovable()):!0:!0},handle_mousemove:function(D){var u=this;Ab?u._74o=u._8Q(D):u.getView().style.cursor=u.isClickable(D)?aj:""},handle_mousedown:function(P){this.handle_mousemove(P),this.handle_touchstart(P)},handle_touchstart:function(p){var f=this,n=f.tv,m=n._tabPosition;lb(p),Bb(p)&&f.isClickable(p)&&(m===Jb||m===De?(f.x=Jk(p).x,f.lp=n.lp(p),f.tx=n.tx()):(f.y=Jk(p).y,f.lp=n.lp(p),f.ty=n.ty()),Zo(f,p))},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(W){var u,s=this,T=s.tv,B=T._tabPosition,E=s._73o;if(B===Jb||B===De){if(u=Jk(W).x-s.x,!s._25o&&!s.moving&&g(u)>2&&(T._40o()&&!ae(W)?s._25o=1:E&&T.isMovable()&&(s.moving=1)),s._25o)T.tx(s.tx+u);else if(s.moving){var X=s.lp.x+u,w=T._tabGap/2;T._7o.each(function(l){var $=l.endX,c=X-l.startX<$-X;X>=l.startX&&$>=X&&T._7Q({tab:E.tab,startX:E.startX+u,width:E.width,front:c,insertTab:l.tab,position:c?o(0,l.startX-w):S(T._64I,$+w)})})}}else if(u=Jk(W).y-s.y,!s._25o&&!s.moving&&g(u)>2&&(T._41o()&&!ae(W)?s._25o=1:E&&T.isMovable()&&(s.moving=1)),s._25o)T.ty(s.ty+u);else if(s.moving){var O=s.lp.y+u,w=T._tabGap/2;T._7o.each(function(f){var y=f.endY,j=O-f.startY<y-O;O>=f.startY&&y>=O&&T._7Q({tab:E.tab,startY:E.startY+u,height:E.height,front:j,insertTab:f.tab,position:j?o(0,f.startY-w):S(T._23Q,y+w)})})}},handleWindowMouseUp:function(k){this.handleWindowTouchEnd(k)},handleWindowTouchEnd:function(){var J=this,n=J.tv,x=n._tabPosition,k=n.getTabModel(),V=k._roots,g=J._73o;if(J.moving){var j=n._23o;if(j&&j.insertTab!==j.tab){var S=j.tab,K=V.remove(S),d=V.indexOf(j.insertTab);d>=0&&(j.front||d++,d<=V.size()&&(V.add(S,d),k._38I(S,K,d)))}n._7Q(f),delete J.moving}else if(!J._25o&&g){S=g.tab;var l=J._74o;if(!l||l.tab===S)if(!S.isDisabled()&&xn(g._75o,J.lp)){var $=function(){var w=V.indexOf(S);k.remove(S),n.onTabClosed(S,w)};n.onTabClosing(S,$)&&$()}else S.isDisabled()||n._8o===S||k.sm().ss(S)}J._25o=J._73o=J._74o=x===Jb||x===De?J.x=J.lp=J.tx=f:J.y=J.lp=J.ty=f}}),hb.PropertyView=function(Z){var X=this;X._view=Yk(1,X),X._canvas=Rc(X._view),tb(X._view,X._79O=wk()),X._rows=new Ek,X._28o=new Ek,X._26o={},X._26Q={};var o=X._propertyModel=new Pl,K=X.ivm;o.mm(K,X),o.md(K,X),o.mh(K,X),X.dm(Z?Z:new Pl),new tr(X)},Ke("PropertyView",p,{ms_ac:[Wb,Cl,Xd,sh,en,"categorizable",tc,Hd,jf,iq,bb,mr,$f,Mr,"selectRowIndex",Qj,"background",tk,_n,Dd,qd,Ec],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Xh,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:ii,_background:G.propertyViewBackground,_expandIcon:G.propertyViewExpandIcon,_collapseIcon:G.propertyViewCollapseIcon,_scrollBarColor:Td,_scrollBarSize:og,_autoHideScrollBar:Ml,_selectBackground:G.propertyViewSelectBackground,_rowHeight:ok,_rowLineVisible:G.propertyViewRowLineVisible,_rowLineColor:G.propertyViewRowLineColor,_10I:.5,_columnLineVisible:G.propertyViewColumnLineVisible,_columnLineColor:G.propertyViewColumnLineColor,_labelColor:G.propertyViewLabelColor,_labelSelectColor:G.propertyViewLabelSelectColor,_labelFont:G.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(J){0>J&&(J=0),J>1&&(J=1);var d=this,Y=d._10I;d._10I=J,d.fp("columnPosition",Y,J)},getPropertyName:function(r){return r.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(n,M,N){return N===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(l,L){return L===this._selectRowIndex?this._labelSelectColor:l.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(R){var t=this.getHeight()-this._59I;return t>R&&(R=t),R>0?0:X(R)},isExpanded:function(p){if(!p)return!0;var F=this._26o[p];return F?F.isExpanded:!(this._26Q[p]===!1)},toggle:function(K){var z=this;z.isExpanded(K)?z.collapse(K):z.expand(K)},expandAll:function(){this.validate();for(var N in this._26o)this.expand(N)},expand:function(n){if(n&&n!==tp){var o=this,N=o._26o[n];N&&!N.isExpanded&&(N.isExpanded=!0,o.onExpanded(n),o.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var G in this._26o)this.collapse(G)},collapse:function(B){if(B&&B!==tp){var Y=this,y=Y._26o[B];y&&y.isExpanded&&(y.isExpanded=!1,Y.onCollapsed(B),Y.ivm())}},onCollapsed:function(){},getCategoryName:function(Y){if(!this.isCategorizable())return tp;var $=Y.getCategoryName();return $?$:tp},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(F){var x=this,b=x._dataModel;b!==F&&(b&&(b.umd(x.handlePropertyChange,x),x._selectionModel||b.sm().ums(x.handleSelectionChange,x)),x._dataModel=F,F.md(x.handlePropertyChange,x),x._selectionModel?x._selectionModel._21I(F):F.sm().ms(x.handleSelectionChange,x),x.fp(pp,b,F))},isVisible:function(S){return this._visibleFunc?this._visibleFunc(S):!0},onPropertyChanged:function(h){var w=this,B=h.property;Np[B]?w.ivm():w.iv(),B===Ym&&w._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:oi},handlePropertyChange:function(i){this._27o===i.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var z=this;z._96I||(z.setSelectRowIndex(-1),z._96I=1,z.iv())},redraw:function(){this.iv()},validateModel:function(){var L=this,i=L._rows,H=L._28o,w={},_=new Ek,B=L._27o;L.updateCurrentData(),B!==L._27o&&L.endEditing(),i.clear(),H.clear(),L.getRawProperties().each(function(C){if(L.isVisible(C)){_.add(C);var D=L.getCategoryName(C);w[D]||(H.add(D,D===tp?0:b),w[D]={isExpanded:L.isExpanded(D),properties:new Ek})}}),L._sortFunc&&_.sort(L._sortFunc);for(var O in L._26o)L._26Q[O]=L.isExpanded(O);L._26o=w,H.each(function($){$!==tp&&i.add($);var S=w[$];S.isExpanded&&_.each(function(Y){L.getCategoryName(Y)===$&&(S.properties.add(Y),i.add({property:Y,data:L._27o}))},L)})},validateImpl:function(){var E=this;E._76o(),E._96I&&(E.validateModel(),delete E._96I);var p=E._canvas,K=E.getWidth(),S=E.getHeight(),P=-E.ty(),t=E._rowHeight,m=E._indent,b=K-m,R=E._rows,l=R.size(),Y=E._9I=m+b*E._10I,d=E._59I=l*t;ur(p,K,S),E._29I={x:0,y:P,width:K,height:S},E._31I=k(P/t),E._14I=W((P+S)/t),E._31I<0&&(E._31I=0),E._14I>l&&(E._14I=l);var N,M=Gi(p),z=E._background;Dp(M,0,-P,1),M.beginPath(),M.rect(0,P,K,S),M.clip(),M.clearRect(0,P,K,S),E._93db(M),z&&tj(M,0,0,m,d,z);for(var u=E._31I;u<E._14I;u++){var V=R.get(u),P=t*u;if(cr(V))z&&tj(M,m,P,b,t,z),N=fg(E.isExpanded(V)?E._expandIcon:E._collapseIcon),N&&Do(M,N,Sm,0,P,m,t),M.save(),M.beginPath(),M.rect(m,P,b,t),M.clip(),E.drawCategoryName(M,V,u,m,P,b,t),M.restore();else{var O=V.property,I=V.data,N=fg(O.getIcon()),Q=E._selectRowIndex===u?E.getSelectBackground():f;if(N&&Do(M,N,Sm,0,P,m,t),Q&&tj(M,m,P,b,t,Q),M.save(),M.beginPath(),M.rect(m,P,Y-m,t),M.clip(),E.drawPropertyName(M,O,u,m,P,Y-m,t),M.restore(),!E.isEditing(I,O)){var n=Y+1,y=K-Y-1;M.save(),M.beginPath(),M.rect(n,P,y,t),M.clip(),E._87o(E.drawPropertyValue(M,O,E.getValue(I,O),u,n,P,y,t,I),u,n,P,y,t),M.restore()}}E._rowLineVisible&&tj(M,m,P+t-1,b,1,E._rowLineColor)}E._columnLineVisible&&(tj(M,Y,0,1,d,E._columnLineColor),tj(M,K-1,0,1,d)),E._92db(M),E._93I(),M.restore(),E.ty(E.ty())},drawCategoryName:function(r,i,j,K,Q,B,A){Th(r,i,this.getCategoryFont(i),this.getCategoryColor(i),K,Q,B,A)},drawPropertyName:function($,b,L,M,e,l,W){return b.drawPropertyName?(b.drawPropertyName($,b,L,M,e,l,W,this),void 0):(Th($,this.getPropertyName(b),this.getPropertyFont(b,L),this.getPropertyColor(b,L),M,e,l,W),void 0)},drawPropertyValue:function(K,W,C,i,R,F,A,z,x){return W.drawPropertyValue?W.drawPropertyValue(K,W,C,i,R,F,A,z,x,this):(bp(K,C,W,this.getLabelFont(W,C,i),this.getLabelColor(W,C,i),R,F,A,z,x,this),void 0)},isPropertyEditable:function(J){return J.isEditable()&&this.isEditable()},setProperties:function(k){this._propertyModel.clear(),this.addProperties(k)},addProperties:function(J){if(J){var N=this._propertyModel;J.forEach(function(J){if(!(J instanceof Jp)){var r=Nf(J.className);J=$o(r?r:Jp,J)}N.add(J)})}},getRowIndexAt:function(V){var P=this,x=k(P.lp(V).y/P._rowHeight);return x>=0&&x<P._rows.size()?x:-1},getPropertyAt:function(o){var d=this,v=d.getRowIndexAt(o);return v>=0?d._rows.get(v).property:f},getToolTip:function(G){var w=this,N=w.getPropertyAt(G),z=w._27o;return N&&z?N.getToolTip(z,w._9I<w.lp(G).x,w):f}});var tr=function(t){this.pv=t,this.addListeners()};Gh(tr,p,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(O){this.getView().style.cursor=O},clear:function(){var r=this;r._62O=r.cp=r.ty=r.p=f,r.setCursor(ad)},handle_mousedown:function(D){this.handle_touchstart(D)},handle_touchstart:function(F){var m=this,G=m.pv;lb(F),G.setFocus(F)&&(Bb(F)?(m.cp=Jk(F),m.ty=G.ty(),m.p=G.getColumnPosition(),m.handle_touchmove(F)):G.setSelectRowIndex(G.getRowIndexAt(F)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(c){this.handle_touchend(c)},handle_touchend:function(j){var M=this;if(M.cp&&!M._62O){var G=M.pv,e=G.lp(j),Y=e.x,A=e.y,w=G._indent,H=G.getRowIndexAt(j),l=G._9I;if(H>=0){var y=G._rowHeight,d=y*H,E=G._rows.get(H),J=E.property;if(cr(E))fg(G.isExpanded(E)?G._expandIcon:G._collapseIcon)&&Y>=0&&w>=Y&&A>=d&&d+y>=A?G.toggle(E):sp(j)&&G.toggle(E);else if(Y>l&&G.isPropertyEditable(J,j)){var R={x:l+1,y:d,width:G.getWidth()-l-1,height:y},W={x:R.x+G.tx(),y:R.y+G.ty(),width:R.width,height:R.height},z=0,f=G._29I;R.y<f.y?z=R.y-f.y:R.y+y>f.y+f.height&&(z=R.y+y-f.y-f.height),z&&(G.ty(G.ty()-z),W.y-=z),G.beginEditing({data:E.data,property:J,value:G.getValue(E.data,J),event:j,rect:R,editorRect:W,view:G})}}G.setSelectRowIndex(H)}M.clear()},handleWindowMouseMove:function(c){this.handleWindowTouchMove(c)},handleWindowTouchMove:function(A){var V=this,P=V.pv,m=V.ty,B=V.cp,E=Jk(A),L=V._62O;if("p"===L)P.setTranslateY(m+E.y-B.y);else if("c"===L){var n=P.getWidth()-P._indent;if(n>16){var C=V.p-(B.x-E.x)/n,N=16/n;N>C&&(C=N),C>1-N&&(C=1-N),P.setColumnPosition(C)}}else"s"===L&&P.setTranslateY(m+(B.y-E.y)*P._59I/P._29I.height)},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(s){if(!Ab&&Bb(s)){var a=this,z=a.pv,D=g(z.lp(s).x-z._9I)<=(Tf?8:3);a.cp?a._62O||(D?(a._62O="c",Zo(a)):g(Jk(s).y-a.cp.y)>=2&&(a._62O=a.isV(s)?"s":"p",Zo(a))):(D?a.setCursor(zl):a.setCursor(ad),a.isV(s)&&z._43o())}},isV:function(r){var P=this.pv,h=P._29I;return P._41o()&&h.x+h.width-P.lp(r).x<Yq},handle_mousewheel:function(S){this.handleScroll(S,S.wheelDelta/40)},handle_DOMMouseScroll:function(k){2===k.axis&&this.handleScroll(k,-k.detail)},handleScroll:function($,B){var S=this.pv;lb($),S.endEditing(),S.translate(0,B*S.getRowHeight())},handle_keydown:function(D){var i=this.pv,u=i._rows.size(),o=i._selectRowIndex+(Um(D)?-1:1);(Um(D)||Xb(D))&&(0>o&&(o=0),o>=u&&(o=u-1),i.setSelectRowIndex(o))}}),hb.ListView=function(R){this._5o(R),new Tp(this)},Ke("ListView",p,{ms_ac:[Wb,Cl,Xd,tk,tc,_n,Dd,Hd,jf,mr,$f,Mr,Tq,Qj],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:ii,_rowHeight:ok,_rowLineVisible:G.listViewRowLineVisible,_rowLineColor:G.listViewRowLineColor,_scrollBarColor:Td,_scrollBarSize:og,_autoMakeVisible:ir,_autoHideScrollBar:Ml,_selectBackground:G.listViewSelectBackground,_labelColor:G.listViewLabelColor,_labelSelectColor:G.listViewLabelSelectColor,_labelFont:G.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(q){var Z=this,L=Z._checkMode;Z._checkMode=q,Z.fp(wi,L,q)},drawRow:function(T,P,Z,H,B,$,z){var q=this,b=0,y=q._indent,X=q.getIconWidth(P);q.drawRowBackground(T,P,Z,H,B,$,z),q._checkMode&&(_l(T,fg(q.getCheckIcon(P)),b+y/2,B+z/2,P,q),b+=y),q.drawIcon(T,P,b,B,X,z),q.drawLabel(T,P,b+X,B,z)}});var Tp=function(g){this.list=g,this._lastSelectDataTime=wb(),this.addListeners()};Gh(Tp,p,{ms_listener:1,getView:function(){return this.list._view},clear:function(Z){var n=this,l=n.list;Z&&"d"===n._62O&&!n.dragCancel&&l.handleDragAndDrop(Z,"end"),l.draggingData&&(l.draggingData=null,l.redraw()),n.dragCancel=n._62O=n._isV=n._isH=n.cp=n.tx=n.ty=f},handle_mousedown:function(i){this.handle_touchstart(i)},handle_touchstart:function(T){var O=this,Q=O.list;if(lb(T),Q.setFocus(T)){var Y=Q.getDataAt(T);O.cp=Jk(T),O.tx=Q.tx(),O.ty=Q.ty(),Bb(T)?Y&&Q.handleDragAndDrop&&!O.isV(T)&&!O.isH(T)&&(Q.draggingData=Y,Q.redraw(),Q.handleDragAndDrop(T,"prepare")):(Y&&O._33o(T,Y),O.clear(T))}},handleWindowMouseUp:function(p){this.clear(p)},handleWindowTouchEnd:function(D){this.clear(D)},handle_mouseup:function(H){this.handle_touchend(H)},handle_touchend:function(i){var Y=this,d=Y.list;if(!Y._isV&&!Y._isH&&Y.cp&&!Y._62O){var M=d.getDataAt(i);M?(d.isCheckMode()?Y._34o(i,M):Y._33o(i,M),sp(i)?d.onDataDoubleClicked(M,i):d.onDataClicked(M,i)):d.handleBackgroundClick(i)}Y.clear(i)},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowTouchMove:function(t){var B=this,Z=B.list,x=B._62O,g=B.tx,N=B.ty,P=B.cp,$=Jk(t),J=Z._29I;"p"===x?Z.setTranslate(g+$.x-P.x,N+$.y-P.y):"v"===x?Z.ty(N+(P.y-$.y)*Z._59I/J.height):"h"===x?Z.tx(g+(P.x-$.x)*Z._91I/J.width):"d"===x&&(B.dragCancel||Z.handleDragAndDrop(t,"between"))},handle_mousemove:function(D){this.handle_touchmove(D)},handle_touchmove:function(g){if(!Ab&&Bb(g)){var m=this,n=m.list;if(m._isV=m.isV(g),m._isH=m.isH(g),m.cp){if(!m._62O){if(Bj(Jk(g),m.cp)<2)return;m._isV?m._62O="v":m._isH?m._62O="h":n.draggingData&&!this.dragCancel?(m._62O="d",n.handleDragAndDrop(g,"begin")):m._62O="p",m._62O&&"d"!==m._62O&&n.draggingData&&(n.draggingData=null,n.redraw()),Zo(m)}}else m._isV&&n._43o(),m._isH&&n._42o()}},isV:function(A){var U=this.list,x=U._29I;return U._41o()&&x.x+x.width-U.lp(A).x<Yq},isH:function(L){var y=this.list,V=y._29I;return y._40o()&&V.y+V.height-y.lp(L).y<Yq},handle_mousewheel:function(b){this.handleScroll(b,b.wheelDelta/40,b.wheelDelta!==b.wheelDeltaX)},handle_DOMMouseScroll:function(I){this.handleScroll(I,-I.detail,1)},handleScroll:function(p,j,V){var f=this.list;lb(p),f.endEditing&&f.endEditing(),V&&f._41o()?f.translate(0,j*f.getRowHeight()):f._40o()&&f.translate(10*j,0)},handle_keydown:function(T){if(!G.isInput(T.target)){var r,h=this.list,d=h.sm(),I=h._rows,z=I.size();if(zo(T))h.selectAll();else if(Un(T))h.handleDelete&&h.handleDelete(T);else if(Xf(T))"d"!==this._62O||this.dragCancel||(h.handleDragAndDrop(T,"cancel"),this.dragCancel=!0);else if(Lp(T))h.isCheckMode()&&(r=h.getFocusData(),r&&h.checkData(r));else if(Um(T)||Xb(T)){var e=h.isCheckMode();if(r=e?h.getFocusData():d.ld()){var O=h.getRowIndex(r);O>=0&&(Um(T)?0!==O&&(r=I.get(O-1),e?h.setFocusData(r):d.ss(r)):O!==z-1&&(r=I.get(O+1),e?h.setFocusData(r):d.ss(r)))}else z>0&&(r=I.get(0),e?h.setFocusData(r):d.ss(r))}}},_34o:function(O,$){var w=this.list,p=w.lp(O).x;return p>=0&&p<=w._indent?(w.checkData($),void 0):(w.setFocusData($),void 0)},_33o:function(c,T){var v=this.list,w=v.sm(),t=w.ld();if(ae(c))v.isSelected(T)?w.rs(T):w.as(T);else if(rl(c))if(t)for(var W=v.getRowIndex(t),u=v.getRowIndex(T);W!==u;)W+=u>W?1:-1,w.as(v._rows.get(W));else w.ss(T);else if(Bb(c)){var x=wb();if(w.contains(T)){var f=x-this._lastSelectDataTime;v.handleDataDoubleSelect&&f>500&&1500>f&&v.handleDataDoubleSelect(c,T)}w.ss(T),this._lastSelectDataTime=x}else w.contains(T)||w.ss(T)}}),hb.TreeView=function(d){var Y=this;Y._35o(),Y._5o(d),new il(Y)},Ke("TreeView",p,{ms_ac:[Wb,Cl,Xd,"rootVisible",wi,"rootData",Hd,jf,mr,$f,Mr,tc,tk,_n,Dd,iq,bb,Tq,Qj,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:f,_indent:ii,_rowHeight:ok,_rowLineVisible:G.treeViewRowLineVisible,_rowLineColor:G.treeViewRowLineColor,_scrollBarColor:Td,_scrollBarSize:og,_autoHideScrollBar:Ml,_expandIcon:G.treeViewExpandIcon,_collapseIcon:G.treeViewCollapseIcon,_autoMakeVisible:ir,_selectBackground:G.treeViewSelectBackground,_labelColor:G.treeViewLabelColor,_labelSelectColor:G.treeViewLabelSelectColor,_labelFont:G.treeViewLabelFont,_doubleClickToToggle:G.treeViewDoubleClickToToggle,drawRow:function(p,G,e,y,t,I,A){var h=this;h.drawRowBackground(p,G,e,y,t,I,A),h._97I(p,G,e,0,t,I,A)},isOnToggleIcon:function(T){var R=this.getDataAt(T);if(R){var E=this.getIndent(),B=this.lp(T).x;if(fg(this.getToggleIcon(R))){var y=E*this.getLevel(R);if(B>=y&&y+E>=B)return!0}}return!1}});var il=function(a){gm(il,this,[a])};Gh(il,Tp,{toggle:function(D,A,r,m){var K=this.list,R=K.lp(D).x;if(fg(K.getToggleIcon(A))){var n=r*m;if(R>=n&&n+r>=R)return K.toggle(A),!0}return K.isDoubleClickToToggle()&&sp(D)?(K.toggle(A),!0):!1},_34o:function(j,O){var U=this.list,R=U.lp(j).x,I=U._levelMap[O._id],Q=U._indent,$=Q*(I+1);return R>=$&&$+Q>=R?(U.checkData(O),void 0):(this.toggle(j,O,Q,I)||U.setFocusData(O),void 0)},_33o:function(h,F){var Q=this,d=Q.list;Q.toggle(h,F,d._indent,d.getLevel(F))||il.superClass._33o.call(Q,h,F)},handle_keydown:function(T){if(gh(T)||Tg(T)){var o=this.list,z=o._rows,_=o.isCheckMode(),M=o.sm(),L=_?o.getFocusData():M.ld();L?L.hasChildren()&&(gh(T)?o.collapse(L):o.expand(L)):z.size()>0&&(L=z.get(0),_?o.setFocusData(L):M.ss(L))}else il.superClass.handle_keydown.call(this,T)}});var co=hb.TableView=function(i){this._98I(),this._5o(i),new Re(this)};Ke("TableView",p,{ms_ac:[Wb,Cl,Xd,"sortMode",sh,en,tk,_n,Dd,qd,Ec,"sortColumn",Hd,jf,mr,$f,Mr,Tq,Qj],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Hp,_editable:!0,_batchEditable:!1,_rowHeight:ok,_rowLineVisible:G.tableViewRowLineVisible,_rowLineColor:G.tableViewRowLineColor,_columnLineVisible:G.tableViewColumnLineVisible,_columnLineColor:G.tableViewColumnLineColor,_scrollBarColor:Td,_scrollBarSize:og,_autoHideScrollBar:Ml,_autoMakeVisible:ir,_selectBackground:G.tableViewSelectBackground,_labelColor:G.tableViewLabelColor,_labelSelectColor:G.tableViewLabelSelectColor,_labelFont:G.tableViewLabelFont,getCheckColumn:function(){var i=this;
if(!i._31o){var c=i._31o=new vn;c.setEditable(!0),c.setWidth(40),c.getValue=i.getCheckColumValue,c.drawCell=i.drawCheckColumnCell}return i._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(_){var T=this,F=T._39o,y=T.getCheckColumn();_!==T.isCheckMode()&&(_?F.add(y,0):F.remove(y),T.fp(wi,!_,_))},getCheckColumValue:function(t,q,L){return L.isSelected(t)},drawCheckColumnCell:function(g,s,k,O,F,q,M,e,K){_l(g,K.getCheckIcon(s),F+M/2,q+e/2,s,K)}});var Re=function(r){gm(Re,this,[r])};Gh(Re,Tp,{_34o:function(M,F){var l=this.list,I=l._31o;if(l.isCellEditable(F,I,M)){var E=l._3Q(I),n=l.lp(M).x;if(E&&n>=E.startX&&n<E.startX+I.getWidth())return l.checkData(F),void 0}l._37O(F,M),l.setFocusData(F)},_33o:function(J,k){this.list._37O(k,J),Re.superClass._33o.apply(this,arguments)}});var Ed=hb.TreeTableView=function(r){var e=this,O=e._4o=new vn;e._35o(),e._98I(),e._5o(r),O.setDisplayName("Name"),O.setEditable(!0),O.setWidth(180),O.drawCell=xl,O.getValue=Zn,e._39o.add(O),new ng(e)},xl=function(n,x,O,z,h,y,G,l,S){S._97I(n,x,O,h,y,G,l)},Zn=function(u,S,M){return M.getLabel(u)};Ke("TreeTableView",p,{ms_ac:[Wb,Cl,Xd,"sortMode",sh,en,tc,wi,"rootData","rootVisible",Hd,jf,"sortColumn",iq,bb,mr,$f,Mr,Tq,Dd,tk,_n,qd,Ec,Qj,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Hp,_checkMode:f,_editable:!0,_batchEditable:!1,_indent:ii,_rowHeight:ok,_rowLineVisible:G.treeTableViewRowLineVisible,_rowLineColor:G.treeTableViewRowLineColor,_columnLineVisible:G.treeTableViewColumnLineVisible,_columnLineColor:G.treeTableViewColumnLineColor,_expandIcon:G.treeTableViewExpandIcon,_collapseIcon:G.treeTableViewCollapseIcon,_scrollBarColor:Td,_scrollBarSize:og,_autoHideScrollBar:Ml,_autoMakeVisible:ir,_selectBackground:G.treeTableViewSelectBackground,_labelColor:G.treeTableViewLabelColor,_labelSelectColor:G.treeTableViewLabelSelectColor,_labelFont:G.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var ng=function(r){gm(ng,this,[r])};Gh(ng,Tp,{_34o:function(_,h){var R=this.list,H=R._4o,f=R._3Q(H),r=R.lp(_).x;if(f){var z=R._indent,J=f.startX+z*R.getLevel(h);if(fg(R.getToggleIcon(h))&&r>=J&&J+z>=r)return R.toggle(h),void 0;if(R.isCellEditable(h,H)&&(J+=z,r>=J&&J+z>=r))return R.checkData(h),void 0}R._37O(h,_),R.setFocusData(h)},_33o:function(r,$){var q=this.list,J=q.lp(r).x;if(fg(q.getToggleIcon($))){var m=q._3Q(q._4o);if(m){var C=q._indent,Q=m.startX+C*q.getLevel($);if(J>=Q&&Q+C>=J)return q.toggle($),void 0}}q._37O($,r),ng.superClass._33o.apply(this,arguments)}});var jo=hb.TableHeader=function(m){var g=this,o=g._view=Yk(1,g),Q=g._39o=m.getColumnModel(),p=g.iv;g.tv=g._tableView=m,g._60I=new Ek,g._canvas=Rc(o),o.style.background=G.tableHeaderBackground||"",o.style.height=Ih+se,Q.mm(p,g),Q.md(p,g),Q.mh(p,g),m.mp(function(A){oc[A.property]&&g.iv()},g),new Od(g),g.iv()};Ke("TableHeader",p,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Wb,Xd,tc,"moveBackground","insertColor",qd,Ec,"resizable","movable"],_checkIcon:Yd,_movable:!0,_resizable:!0,_labelColor:G.tableHeaderLabelColor,_labelFont:G.tableHeaderLabelFont,_columnLineColor:G.tableHeaderColumnLineColor,_columnLineVisible:G.tableHeaderColumnLineVisible,_sortDescIcon:G.tableHeaderSortDescIcon,_sortAscIcon:G.tableHeaderSortAscIcon,_moveBackground:G.tableHeaderMoveBackground,_insertColor:G.tableHeaderInsertColor,_indent:ii,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(Y){return Y.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(v){return v.getColor()||this._labelColor},getLabelAlign:function(v){return v._align},onPropertyChanged:function(){this.iv()},_5Q:function(t){this._61I=t,this.iv()},getLogicalPoint:function(u){return Pe(u,this._canvas,this.tv.tx())},validateImpl:function(){var y=this,i=y._canvas,K=y.getWidth(),a=y.getHeight(),j=y.tv,D=y._60I,W=y._61I,e=-j.tx(),n=0;(K!==i.clientWidth||a!==i.clientHeight)&&ur(i,K,a),D.clear(),y._39o._roots.each(function(A){if(A.isVisible()){var i=n+A.getWidth();e+K>=n&&i>=e&&D.add({column:A,startX:n}),n=i}});var F=Gi(i);if(Dp(F,-e,0,1),F.beginPath(),F.rect(e,0,K,a),F.clip(),F.clearRect(e,0,K,a),D.each(function(U){var C=U.column,v=U.startX,q=C.getWidth();q>0&&(F.save(),F.beginPath(),F.rect(v,0,q,a),F.clip(),W&&W.column===C||y.drawColumn(F,C,v,0,q,a),y._columnLineVisible&&tj(F,v+q-1,0,1,a,y._columnLineColor),F.restore())}),W){var Q=W.column,n=W.startX,f=W.position,o=Q.getWidth();F.save(),F.beginPath(),F.rect(n,0,o,a),F.clip(),F.fillStyle=y._moveBackground,F.fill(),y.drawColumn(F,Q,n,0,o,a),F.restore(),Vk(F,y._insertColor,f,0,a)}F.restore()},_6Q:function(b){var N=this.tv;return N._31o===b&&N.sm().getSelectionMode()===wo},drawColumn:function(e,p,D,K,C,N){var q=this,b=q.tv,v=fg(p.getIcon()),J=q.getLabelAlign(p);if(q._6Q(p)){var s=fg(q._checkIcon);_l(e,s,D+C/2,K+N/2,p,q)}else{var G=q.getLabel(p),w=q.getLabelFont(p),W=q.getLabelColor(p),c=kn(w,G).width,n=v?q._indent:0;J===Rj?(v&&Do(e,v,Sm,D,K,n,N),Th(e,G,w,W,D+n,K,C,N,Rj)):J===$e?(v&&Do(e,v,Sm,D+C-c-n,K,n,N),Th(e,G,w,W,D,K,C,N,$e)):(v&&Do(e,v,Sm,D+(C-c-n)/2,K,n,N),Th(e,G,w,W,D+(C-c+n)/2,K,0,N,Rj))}if(p.isSortable()&&b.getSortColumn()===p&&(v=fg(p.getSortOrder()===uj?q._sortAscIcon:q._sortDescIcon))){var V=Nj(v,p)/2+2;_l(e,v,J===$e?D+V:D+C-V,K+N/2,p,b)}}});var Od=function(j){var h=this;h.th=j,h.tv=j._tableView,h.addListeners()};Gh(Od,p,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(T){this.getView().style.cursor=T},handle_mousemove:function(k){if(!Ab){var Y=this;delete Y._29o,Y.setCursor(ad);for(var I=Y.th,t=I._60I,n=I.lp(k).x,y=t.size()-1;y>=0;y--){var D=t.get(y),P=D.column,O=D.startX+P.getWidth();if(I.isResizable()&&g(O-n)<=(Tf?10:3))return Y._29o=D,Y.setCursor(zl),void 0;n>D.startX&&O>n&&(Y._29o=D),(P.isClickable()||P.isSortable()||I.isMovable()||Y.tv.getCheckColumn&&P===Y.tv.getCheckColumn())&&n>D.startX&&O>n&&Y.setCursor(aj)}}},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(E){var g=this;lb(E),g.tv.endEditing(),g.handle_mousemove(E),g._29o&&(g.x=Jk(E).x,g.lx=g.th.lp(E).x,g.w=g._29o.column.getWidth(),Zo(g,E))},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowTouchMove:function(U){var Y=this,b=Y.th,j=Y.getView().style.cursor,k=Y._29o,J=Jk(U).x-Y.x;if(Y.resizing||Y.moving||(j===zl?Y.resizing=1:b.isMovable()&&j===aj&&g(J)>2&&(Y.moving=1)),Y.resizing)k.column.setWidth(Y.w+J);else if(Y.moving){var E=Y.lx+J;b._60I.each(function(T){var H=T.startX,s=H+T.column.getWidth();if(E>=H&&s>=E){var j={column:k.column,startX:k.startX+J,front:s-E>E-H,insertColumn:T.column};j.position=j.front?H:s,b._5Q(j)}})}},_16Q:function(N,G){var A=this,j=A.tv,U=A.th,u=U._checkIcon;if(U._6Q(N)){var K=fg(u),i=A.lx,_=N.getWidth(),v=Nj(K,N);if(i>=G+_/2-v&&G+_/2+v>=i){U.setCheckIcon(u===Jc?Yd:Jc);var r=j.sm(),d=j._rows;return u===Jc?r.rs(d):r.ss(d),j.onCheckColumnClicked(N),!0}}return!1},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function($){var l=this,v=l.tv,r=l.th,n=l._29o;if(l.moving){var V=r._61I;if(V&&V.insertColumn!==V.column){var A=V.column,z=v.getColumnModel()._roots,c=z.remove(A),K=z.indexOf(V.insertColumn);K>=0&&(V.front||K++,K<=z.size()&&(z.add(A,K),v.getColumnModel()._38I(A,c,K)))}r._5Q(f),delete l.moving}else if(!l.resizing&&n){A=n.column;var C=r.lp($).x,u=n.startX,x=!0;if(r.onColumnClicked){var W=r.onColumnClicked(A,$,u);W===!1&&(x=!1)}if(x&&C>=u&&C<=u+A.getWidth()&&!l._16Q(A,u)){if(A.isSortable()){var J=v.getSortMode(),R=A.getSortOrder();J===Hp?v.getSortColumn()===A?(R===Eb&&v.setSortColumn(f),A.setSortOrder(R===uj?Eb:uj)):v.setSortColumn(A):"bistate"===J&&(v.getSortColumn()===A?A.setSortOrder(R===uj?Eb:uj):v.setSortColumn(A))}v.onColumnClicked(A,$,u)}}l._29o=l.resizing=l.x=l.lx=l.w=f}}),hb.TablePane=function(T){this.init(new co(T))},Ke("TablePane",p,{ms_v:1,_44o:1}),hb.TreeTablePane=function(P){this.init(new Ed(P))},Ke("TreeTablePane",p,{ms_v:1,_44o:1}),hb.Toolbar=function(z){var h=this,w=h._view=Yk(1,h),V=w.style;V.background=G.toolbarBackground||"",V.height=_i+se,h._canvas=Rc(w),h._30o=new Ek,h._90I=new Ek,h.setItems(z||[]),w.handleGroupSelectedChanged=function(E){if(E.isSelected()){var j=E.getGroupId();null!=j&&h._items.forEach(function(O){var l=O.element;l&&l!==E&&l.setSelected&&l.getGroupId&&l.getGroupId()===j&&l.setSelected(!1)})}},new Ic(h)},Ke("Toolbar",p,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Sd,Wb,Xd,Cl,Qj,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:G.toolbarLabelColor,_labelSelectColor:G.toolbarLabelSelectColor,_labelFont:G.toolbarLabelFont,_selectBackground:G.toolbarSelectBackground,_itemGap:G.toolbarItemGap,_separatorColor:G.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(a){var I=this.getItemInfoAt(a);return I?I.item.toolTip:f},getLabelColor:function(Z){return Z&&Z.selected&&Z.type!==Jc&&Z.type!==Mj?this._labelSelectColor:this._labelColor},onPropertyChanged:function(f){this.iv(),f.property===Sd&&this._items.forEach(function(y){Kj(y)})},redraw:function(){this.iv()},addItem:function(p,k){var c=this._items;k==f?c.push(p):c.splice(k,0,p),this.fp(Sd,f,c)},removeItem:function(g){if(g)for(var p=this._items,V=0;V<p.length;V++)g===p[V]&&(p.splice(V,1),this.fp(Sd,f,p))},removeItemById:function(j){if(j!=f)for(var i=this._items,r=0;r<i.length;r++)if(j===i[r].id){var Y=i.splice(r,1)[0];return this.fp(Sd,f,i),Y}},getItemById:function(n){if(n!=f)for(var I=this._items,q=0;q<I.length;q++){var t=I[q];if(n===t.id)return t}},setItemVisible:function(j,t){var I=this.getItemById(j);I&&(I.visible=t)},getItemInfos:function(){return this._30o},getItemInfoAt:function(h){var m=this,n=0,T=m._30o,K=m.lp(h),S=K.x,c=K.y;if(c>=0&&c<=m.getHeight())for(;n<T.size();n++){var N=T.get(n);if(N.startX<=S&&S<=N.endX)return N}return f},drawItem:function(G,m,n,r,S){if(m.visible===!1)return 0;if(Cr(m.visible)&&!m.visible())return 0;var X=this,h=m.disabled;h&&(G.globalAlpha=ko);var t=X.drawItemImpl(G,m,n,r,S),b=X._itemGap;return h&&(G.globalAlpha=1),this._currentItem!==m||"separator"===m||m.separator===!0||m.unfocusable||me(G,X._separatorColor,n-b/2,0,t+b,r),t},drawItemImpl:function(q,T,r,Q,J){var t=this,k=t._view,p=t._itemGap,G=Q/2,H=T.type,B=T.element,D=T.label;cr(B)&&(D=B,B=f);var g,A=t.getLabelFont(T),Y=t.getLabelColor(T),m=T.selected,R=fg(T.icon),n=Nj(R,T),s=0,$=n+(D?kn(A,D).width:0);if("separator"===T||T.separator===!0)return Vk(q,t._separatorColor,r,Q/4,G),1;if(B){R&&_l(q,R,r+n/2,G,T,t),Th(q,D,A,Y,r+n,0,0,Q);var e=jh(B);J||t._90I.add(e),e.parentNode!==k&&tb(k,e),B.iv&&B.iv(),B.validate&&B.validate();var u=e.getBoundingClientRect(),Z=u.width,W=e.style;return Lh(e),W.left=t.tx()+r+$+se,W.top=(Q-u.height)/2+se,$+Z}return H===Mj?g=fg(m?Af:tf):H===Jc&&(g=fg(m?Jc:Yd)),g?(s=Nj(g,T),_l(q,g,r+s/2,G,T,t),r+=s,$+=s):m&&tj(q,r-p/2,0,$+p,Q,t.getSelectBackground(T)),R&&_l(q,R,r+n/2,G,T,t),Th(q,D,A,Y,r+n,0,0,Q),$},validateImpl:function(){var W=this,S=W._canvas,u=W.getWidth(),s=W.getHeight(),D=W._30o,n=W._items;ur(S,u,s);var e=Gi(S),U=W._itemGap,b=U/2;Dp(e,W.tx(),0,1),e.clearRect(0,0,u,s);var z=W._90I;W._90I=new Ek,D.clear(),n.forEach(function(J){var t=W.drawItem(e,J,b,s);D.add({item:J,startX:b,endX:b+t,width:t}),t&&(b+=t+U)}),z.each(function($){W._90I.contains($)||vk($)});var J=W._64I;W._64I=o(0,b),e.restore(),W._stickToRight?(W._65O=0,e=Gi(S),b=u-W._64I+U,Dp(e,0,0,1),e.clearRect(0,0,u,s),D.clear(),n.forEach(function(B){var I=W.drawItem(e,B,b,s,!0);D.add({item:B,startX:b,endX:b+I,width:I}),I&&(b+=I+U)}),e.restore()):W.tx(W.tx()),J!==W._64I&&W.onSumWidthChanged(J,W._64I)},onSumWidthChanged:function(){},handleClick:function(u,a){var M=this,s=u.type,p=u.action,w=u.groupId,T=u.selected;u.disabled||(w!=f?T||(u.selected=!0,this._items.forEach(function(v){v.groupId===w&&u!==v&&(v.selected=!1)}),p&&u.action(u,M,a)):s===Jc||"toggle"===s?(u.selected=!T,p&&u.action(u,M,a)):p&&u.action(u,M,a)),Rb(),M.iv()}});var Ic=function(f){this.tb=f,this.addListeners()};Gh(Ic,p,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(D){this.handleScroll(D,10*(D.wheelDelta/40))},handle_DOMMouseScroll:function(P){this.handleScroll(P,10*-P.detail)},handleScroll:function(A,c){lb(A);var q=this.tb;q.isScrollable()&&!q._stickToRight&&(q.tx(q.tx()+c),Pg())},handle_mousemove:function(O){var s=this;Ab||s.setItem(O)},handle_mouseout:function(E){var N=this;E.target===N.getView()?N.tb.setCurrentItem(f):N.handle_mousemove(E)},handle_mousedown:function(M){this.handle_mousemove(M),this.handle_touchstart(M)},handle_touchstart:function(g){var v=this,A=v.tb,D=g.target;Bb(g)&&(D===v.getView()||D===A._canvas)&&(lb(g),A.setFocus(g)&&(this.setItem(g,!0),(A.isScrollable()||v.info&&!v.info.item.disabled)&&(v.x=Jk(g).x,v.tx=A.tx(),Zo(v,g))))},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(Y){var d=this,W=d.tb;if(!W._stickToRight){var X=Jk(Y).x-d.x;!d._25o&&g(X)>2&&W.isScrollable()&&(d._25o=1),d._25o&&W.tx(d.tx+X)}},handleWindowMouseUp:function(M){this.handleWindowTouchEnd(M)},handleWindowTouchEnd:function(K){var R=this,C=R.tb,O=R.info,X=R.tb.getItemInfoAt(K);if(!R._25o&&O){var z=O.item;X&&X.item===z&&C.handleClick(z,K)}R._25o=R.x=R.tx=f,R.setItem()},setItem:function(A,d){var g=this,k=g.tb,b=g.info=A?k.getItemInfoAt(A):f,w=b?b.item:f;k.setCurrentItem(w),d&&w&&Cr(w.onDown)&&w.onDown(A)}}),hb.BorderPane=function(){this._view=Yk(1,this),this.iv()},Ke("BorderPane",p,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(i,u){this._12o("leftView",i),u!=f&&this.setLeftWidth(u)},getRightView:function(){return this._rightView},setRightView:function(r,l){this._12o("rightView",r),l!=f&&this.setRightWidth(l)},getTopView:function(){return this._topView},setTopView:function(u,H){this._12o("topView",u),H!=f&&this.setTopHeight(H)},getBottomView:function(){return this._bottomView},setBottomView:function(o,d){this._12o("bottomView",o),d!=f&&this.setBottomHeight(d)},getCenterView:function(){return this._centerView},setCenterView:function(h){this._12o("centerView",h)},_12o:function(M,N){var E=this,o="_"+M,x=E._view,B=E[o];B!==N&&(B&&(B.getView?vk(B.getView()):vk(B)),E[o]=N,N&&(N.getView?tb(x,N.getView(),1):tb(x,N,1)),E.fp(M,B,N))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var P=this,p=P._topView,x=P._bottomView,k=P._leftView,l=P._rightView,I=P._centerView,n=P.getWidth(),L=P.getHeight(),N=0,$=0,r=n,R=L,W=0,E=0,K=0,c=0;p&&(W=P._topHeight==f?Hk(p):P._topHeight,$=W),x&&(E=P._bottomHeight==f?Hk(x):P._bottomHeight,R=L-E),k&&(K=P._leftWidth==f?rh(k):P._leftWidth,N=K),l&&(c=P._rightWidth==f?rh(l):P._rightWidth,r=n-c);var v=o(0,r-N),A=o(0,R-$);p&&pn(p,0,0,n,W),x&&pn(x,0,R,n,E),k&&pn(k,0,$,K,A),l&&pn(l,r,$,c,A),I&&pn(I,N,$,v,A)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);